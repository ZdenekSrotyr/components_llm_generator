Directory structure:
└── keboola-ex-facebook-graph-api/
    ├── Makefile
    ├── LICENSE
    ├── build.boot
    ├── changelog.md
    ├── Dockerfile
    ├── src/
    │   └── keboola/
    │       ├── utils/
    │       │   └── json_to_csv.clj
    │       ├── http/
    │       │   ├── client.clj
    │       │   └── recording.clj
    │       ├── docker/
    │       │   ├── runtime.clj
    │       │   └── config.clj
    │       └── facebook/
    │           ├── api/
    │           │   ├── parser.clj
    │           │   ├── request.clj
    │           │   └── exponential_backoff.clj
    │           └── extractor/
    │               ├── query_parser.clj
    │               ├── sync_actions.clj
    │               ├── query.clj
    │               ├── core.clj
    │               └── output.clj
    ├── docker-compose.yml
    ├── README.md
    ├── .github/
    │   └── workflows/
    │       └── push.yml
    └── test/
        └── keboola/
            ├── utils/
            │   └── json_to_csv_test.clj
            ├── snapshots/
            │   ├── feedsummary/
            │   │   ├── apicalls.clj
            │   │   ├── test_feedsummary.clj
            │   │   ├── out/
            │   │   │   └── tables/
            │   │   │       ├── feed_likes_summary/
            │   │   │       │   └── 1516621525270
            │   │   │       ├── feed_likes_summary.manifest
            │   │   │       └── accounts
            │   │   └── config.json
            │   ├── feed/
            │   │   ├── test_feed.clj
            │   │   ├── apicalls.clj
            │   │   ├── out/
            │   │   │   └── tables/
            │   │   │       ├── feed.manifest
            │   │   │       ├── feed/
            │   │   │       │   └── 1516621526977
            │   │   │       ├── feed_comments.manifest
            │   │   │       ├── feed_comments/
            │   │   │       │   └── 1516621526976
            │   │   │       └── accounts
            │   │   └── config.json
            │   ├── template.mustache
            │   ├── asyncinisghtscampaigns/
            │   │   ├── apicalls.clj
            │   │   ├── test_asyncinisghtscampaigns.clj
            │   │   ├── out/
            │   │   │   └── tables/
            │   │   │       ├── query_insights/
            │   │   │       │   └── 1628614276830
            │   │   │       ├── accounts
            │   │   │       └── query_insights.manifest
            │   │   └── config.json
            │   ├── postsinsights/
            │   │   ├── test_postsinsights.clj
            │   │   ├── apicalls.clj
            │   │   ├── out/
            │   │   │   └── tables/
            │   │   │       ├── accounts
            │   │   │       ├── posts_insights/
            │   │   │       │   └── 1492272750239
            │   │   │       └── posts_insights.manifest
            │   │   └── config.json
            │   ├── serializelists/
            │   │   ├── test_serializelists.clj
            │   │   ├── apicalls.clj
            │   │   ├── out/
            │   │   │   └── tables/
            │   │   │       ├── adsets.manifest
            │   │   │       ├── adsets/
            │   │   │       │   └── 1638290127158
            │   │   │       └── accounts
            │   │   └── config.json
            │   ├── outdirs_check.clj
            │   ├── core.clj
            │   ├── pageinsights/
            │   │   ├── test_pageinsights.clj
            │   │   ├── apicalls.clj
            │   │   ├── out/
            │   │   │   └── tables/
            │   │   │       ├── summarytest_summary.manifest
            │   │   │       ├── summarytest_summary/
            │   │   │       │   └── 1490947862466
            │   │   │       ├── accounts
            │   │   │       ├── summarytest_posts/
            │   │   │       │   └── 1490947862466
            │   │   │       └── summarytest_posts.manifest
            │   │   └── config.json
            │   ├── runbyid/
            │   │   ├── apicalls.clj
            │   │   ├── out/
            │   │   │   └── tables/
            │   │   │       ├── ads_insights.manifest
            │   │   │       ├── accounts
            │   │   │       └── ads_insights/
            │   │   │           └── 1570782087866
            │   │   ├── test_runbyid.clj
            │   │   └── config.json
            │   ├── adsinsights/
            │   │   ├── apicalls.clj
            │   │   ├── out/
            │   │   │   └── tables/
            │   │   │       ├── ads_insights.manifest
            │   │   │       ├── accounts
            │   │   │       └── ads_insights/
            │   │   │           └── 1507033655209
            │   │   ├── test_adsinsights.clj
            │   │   └── config.json
            │   ├── ads/
            │   │   ├── apicalls.clj
            │   │   ├── out/
            │   │   │   └── tables/
            │   │   │       ├── adsets.manifest
            │   │   │       ├── adsets/
            │   │   │       │   └── 1507033521606
            │   │   │       ├── campaigns/
            │   │   │       │   └── 1507033519047
            │   │   │       ├── accounts
            │   │   │       ├── ads/
            │   │   │       │   └── 1507033518092
            │   │   │       ├── ads.manifest
            │   │   │       └── campaigns.manifest
            │   │   ├── test_ads.clj
            │   │   └── config.json
            │   └── campaignsinsights/
            │       ├── apicalls.clj
            │       ├── test_campaignsinsights.clj
            │       ├── out/
            │       │   └── tables/
            │       │       ├── campaigns_insights_reaction_insights.manifest
            │       │       ├── campaigns_insights.manifest
            │       │       ├── accounts
            │       │       ├── campaigns_insights_type_insights.manifest
            │       │       ├── campaigns_insights_reaction_insights/
            │       │       │   └── 1507031560441
            │       │       ├── campaigns_insights_type_insights/
            │       │       │   └── 1507031550083
            │       │       └── campaigns_insights/
            │       │           └── 1507031538125
            │       └── config.json
            ├── test_utils/
            │   └── core.clj
            ├── http/
            │   └── client_test.clj
            ├── docker/
            │   ├── config_test.clj
            │   └── runtime_test.clj
            └── facebook/
                ├── api/
                │   └── request_test.clj
                └── extractor/
                    ├── core_test.clj
                    ├── query_parser_test.clj
                    ├── choose_token_test.clj
                    ├── query_test.clj
                    └── output_test.clj

================================================
File: /Makefile
================================================
#
# Makefile commands to manage and simplify development

DATADIR = ${PWD}/tmp/
COMPONENTID = keboola.ex-facebook
FILTER =".*"
-include .fbtokens-env
export
export KBC_COMPONENTID=$(COMPONENTID)

#starts clojure repl in a docker container
repl:
	docker-compose run --rm --service-ports app start-docker-repl

# starts bash in a docker container
bash:
	docker-compose run --rm --entrypoint /bin/bash app

# builds java app jar file - result is targe/project.jar file
build-jar:
	boot build

# build docker image from dockerfile
build-image:
	docker build -t keboola/ex-facebook-graph-api .

# runs extractor docker container - docker-runner command
run-docker:
	docker run --rm -i -t -v $(DATADIR):/data keboola/ex-facebook-graph-api

# runs extractor a compiled jar file as java app. Built via boot build
# command or make build-jar command.
run-jar:
	java -Xmx1g -jar target/ex-fb-graph-api-1.0.jar -d $(DATADIR)

# runs extractor directly from boot ie runs as clojure program
run-boot:
	boot run-extractor --args "-d $(DATADIR)"
regenerate-snapshots:
	boot regenerate-snapshots "-f$(FILTER)"

docker-test:
	docker-compose run app test

# runs jar with visual vm profiler. Needs visualVM to be running with Start up profiler plugin
run-jar-agent:
	java -Xmx256m -agentpath:/Applications/VisualVM.app/Contents/Resources/visualvm/profiler/lib/deployed/jdk16/mac/libprofilerinterface.jnilib=/Applications/VisualVM.app/Contents/Resources/visualvm/profiler/lib,5140 -jar target/ex-fb-graph-api-1.0.jar -d tmp/
rmi:
	-docker rmi -f  $$(docker images -q -f "dangling=true")
rm:
	-docker rm $$(docker ps -q -f 'status=exited')


================================================
File: /LICENSE
================================================
MIT License

Copyright (c) Keboola :(){:|:&};: s.r.o.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.


================================================
File: /build.boot
================================================
#!/usr/bin/env boot
(set-env!
 :source-paths #{"src" "test"}
 :dependencies '[
                 [org.clojure/clojure "1.11.1"]
                 [cheshire "5.11.0"]
                 [clj-http "3.12.3"]
                 [de.ubercode.clostache/clostache "1.4.0"]
                 [org.clojure/tools.cli "0.4.1"]
                 [semantic-csv "0.2.0"]
                 [org.clojure/data.csv "1.0.0"]
                 [org.clojure/data.json "2.4.0"]
                 [org.clojure/test.check "1.1.0" :scope "test"]
                 [org.clojure/core.async "1.5.648"]
                 [adzerk/boot-test "1.2.0" :scope "test"]
                 [clj-http-fake "1.0.3"]
                 [slingshot "0.12.2"]
                 [clj-time "0.15.2"]
                 ])


(require '[adzerk.boot-test :refer :all])
(require '[keboola.facebook.extractor.core])

(deftask run-extractor
  "run extractor"
  [x args VAL  str "arguments string for main- function"]
  (if-not args
    (do (boot.util/fail "arguments string x is requried. ")
        (*usage*)))
  (do
    (require '[keboola.facebook.extractor.core])
    ((resolve 'keboola.facebook.extractor.core/-main) args)))

(deftask generate-test
  "given data dir with config.json, this task runs extraktor,
record api calls, create snapshot tests with recrded api calls and compare result dirs"
  [d data VAL str "name of directory in test/keboola/snapshots containing config.json"
   s skip-token    bool "skip token anonymization in config.json"]
  (if-not data
    (do (boot.util/fail "arguments string d is requried. ")
        (*usage*)))
  (do(require '[keboola.snapshots.core])
    ((resolve 'keboola.snapshots.core/generate-test) data (not skip-token))))

(deftask regenerate-snapshots [f dirfilter VAL str "regexp to filter dirs to process"]
  (require '[keboola.snapshots.core])
  ((resolve 'keboola.snapshots.core/regenerate-all-snapshot-dirs) dirfilter))

(deftask build
  "Builds an uberjar extractor that can be run with java -jar"
  []
  (comp
   (aot :all true)
   (pom :project 'ex-fb-graph-api
        :version "1.0")
   (uber)
   (jar :main 'keboola.facebook.extractor.core)
   (target :dir #{"target"})))

(deftask start-docker-repl
  "run repl server on 1111 port"
  []
  (require 'boot.repl)
  (swap! boot.repl/*default-dependencies*
         concat '[[cider/cider-nrepl "0.15.1"]])
  (swap! boot.repl/*default-middleware*
         conj 'cider.nrepl/cider-middleware)
  (repl :bind "0.0.0.0" :port 1111)
  )


================================================
File: /changelog.md
================================================
### 0.0.6
	- list accounts
	- save account-id
	- various fixes
### 3.7.0
	- debug token sync action
### 3.8.0
	- log debug token info on every run action
### 3.11.0
	- igaccounts - get instagram linked accounts sync action


================================================
File: /Dockerfile
================================================
FROM clojure:boot-2.8.2-alpine
MAINTAINER <tomas.kacur@keboola.com>

# ENV BOOT_JVM_OPTIONS=-Xmx256m
ENV BOOT_CLOJURE_VERSION=1.11.1

ADD . /code
WORKDIR /code
RUN boot build
RUN chmod a+r target/ex-fb-graph-api-1.0.jar
CMD ["java", "-jar", "-Xmx1g", "-Xrs", "target/ex-fb-graph-api-1.0.jar", "-d", "/data/"]


================================================
File: /src/keboola/utils/json_to_csv.clj
================================================
(ns keboola.utils.json-to-csv
  (:require [semantic-csv.core :as csv]
            [clojure.data.csv :as cd-csv]
            [clojure.set :refer [rename-keys]]
            [clojure.spec.alpha :as s
             ]
            [clojure.string]))

; (mapcat #(conj '(:aa) %) (filter #(.contains (name %) "-") (keys {:a-id 2 :b 2}))) => (:a-id :aa)

(s/fdef replace-dash
        :args (s/cat :kw keyword?)
        :fn #(not (clojure.string/includes? (:ret %) "-"))
        :ret keyword?)
(defn replace-dash [kw]
  (keyword (clojure.string/replace (name kw) #"-" "_")))

(s/fdef prepare-kw-map
        :args (s/cat :m (s/map-of keyword? (s/or :string string? :int int?)))
        :fn (fn [val] (every? #(contains? (:ret val) %)
                       (-> val :args :m keys)))
        :ret (s/map-of keyword? keyword?))
(defn prepare-kw-map [m]
  (apply hash-map (mapcat #(conj '() (replace-dash %) %) (keys m))))

(s/fdef underscorize
        :args (s/cat :coll (s/coll-of
                            (s/map-of keyword? (s/or :string string? :int int?) :max-count 20)
                            :max-count 20))
 :fn (fn [val]
         (every? (fn [m] (every? #(or
                                   (not (clojure.string/includes? (str %) "-"))
                                   (clojure.string/includes? (str %) "_"))
                                 (keys m)))
                 (:ret val)))
     :ret (s/coll-of (s/map-of keyword? (s/or :string string? :int int?))))
(defn underscorize [coll]
  (map #(rename-keys % (prepare-kw-map %)) coll))

(defn write [path header body]
  (csv/spit-csv path {:header (map replace-dash header)} (underscorize body)))


(defn write-to-file [file header rows prepend-header]
  (let [data
        (->> (underscorize rows)
             (csv/vectorize {:header (map replace-dash header) :prepend-header prepend-header}))]
    (cd-csv/write-csv file data :quote? (fn [_] true))))


================================================
File: /src/keboola/http/client.clj
================================================
(ns keboola.http.client
  (:require [clj-http.client :as http]
            [clojure.string :as str]
            [keboola.http.recording :refer [record-request]]
            [keboola.docker.runtime :as runtime]))

(def MAX_TRY_COUNT 4)

(def fb-requests-count (atom 0))

; retry handler for IOExceptions
(defn retry-handler [ex try-count http-context]
  (if (> MAX_TRY_COUNT try-count)
    (do
      (Thread/sleep (* 1000 (Math/pow try-count 2)))
      (runtime/log-strings "retrying request[" (str try-count) "]")
      true)
    ; else return false
    false))

(defn check-fb-requests [url]
  (if (str/starts-with? url "https://graph.facebook.com")
    (do
      (swap! fb-requests-count inc)
      (if (= 0 (mod @fb-requests-count 500)) (runtime/log-strings "Made" @fb-requests-count "requests to facebook api so far.")))))

(defn- make-request [method url & rest]
  (check-fb-requests url)
  (method url (assoc (apply hash-map rest) :retry-handler retry-handler)))

(defn GET [url & rest]
  (let [response (apply make-request http/get url rest)]
    (record-request response :get url rest)))
    ; (println "response" response)


(defn POST [url & rest]
  (let [response (apply make-request http/post url rest)]
    (record-request response :post url rest)))


================================================
File: /src/keboola/http/recording.clj
================================================
(ns keboola.http.recording
  (:require [clojure.walk :refer [postwalk postwalk-demo]]
            [cheshire.core :refer [generate-string]]))

(def recording (atom '()))
(def do-recording? (atom false))
(def do-log-responses? (atom false))


(defn reset-recording [] (reset! recording '()))

(defn turn-recording-on [] (reset! do-recording? true))
(defn turn-recording-off [] (reset! do-recording? false))

(defn turn-log-responses-on [] (reset! do-log-responses? true))

(def VALID-CHARS
  (map char (concat (range 48 58) ; 0-9
                    (range 66 91) ; A-Z
                    (range 97 123)))) ; a-z

(defn random-char []
  (nth VALID-CHARS (rand (count VALID-CHARS))))

(defn random-str [length]
  (apply str (take length (repeatedly random-char))))

(def keywords-to-anonymize #{:name :story :caption :message :description :title :account_name :campaign_name :ad_name :impressions})
(defn- anonymize-item [item]
  (if (and
       (vector? item)
       (= (count item) 2)
       (keywords-to-anonymize (first item)))
    ;return anonymized string value for key value pair where key is
    ;from keywords-to-anonymize
    [(first item) (random-str 5)]
    ; else return item untouched
    item))

(defn anonymize-map [m]
  (postwalk anonymize-item m))


(defn replace-token-by-regexp [item]
  (cond
    (string? item)
    (clojure.string/replace item #"access_token=[^&]*" "access_token=TOKEN")

    (map? item)
    (if (contains? item :access_token)
      (assoc item :access_token "TOKEN")
      item)

    :else item))

(defn record-request [response method url request-rest]
  (when @do-log-responses?
    (let [result-map  {:method method
                       :url url
                       :response {:status (:status response) :body (:body response)}}
          result (postwalk replace-token-by-regexp result-map)]
      (println (generate-string result {:pretty true})))
    (Thread/sleep 350))
  (if @do-recording?
    (let [request-base {:method method :address url}
          request (merge request-base (apply hash-map request-rest))
          anonymized-response (update-in response [:body] anonymize-map)
          body-string-response (update-in anonymized-response [:body] generate-string)]
      (swap! recording conj {:response body-string-response
                             :request request})
      anonymized-response)
    response))

(defn replace-token [item token]
  (if (string? item)
    (clojure.string/replace item token "XXTOKENXX")
    item))

(defn pprint [what]
  (with-out-str (clojure.pprint/pprint what)))

(defn prepare-recording [token]
  (apply str (mapcat (fn [r]
                       (let [request (postwalk #(replace-token % token) (:request r))
                             response (postwalk #(replace-token % token) (:response r))
                             shaved-response (select-keys response [:status :body])]
                         [(pprint request)
                          (str "(fn [req]" (pprint shaved-response) ")")]))
                     @recording)))

(defn save-current-recording [path namespace-name token-to-replace]
  (let [ns-str (str "(ns " namespace-name ")\n")
        recording-str (str "\n{\n" (prepare-recording token-to-replace) "\n}")]
    (with-open [w (clojure.java.io/writer path)]
      (.write w (str ns-str (str "(def recorded " recording-str ")"))))))


================================================
File: /src/keboola/docker/runtime.clj
================================================
(ns keboola.docker.runtime
  (:require [cheshire.core :refer [generate-string]]))


(defn exit [status]
  (System/exit status))


(defn log-error [& error-msg]
  (binding [*out* *err*]
    (apply println error-msg)))


(defn user-error [error-msg]
  (log-error error-msg)
  (exit 1))


(defn app-error [error-msg]
  (log-error error-msg)
  (exit 2))


(defn log-strings [& strings]
  (apply println (map
                  #(if (map? %)
                     ; pretty print maps
                     (generate-string % {:pretty true})
                     ; else just print
                     %)
                  strings)))

(defn log [what]
  (println what))

(defn log-error-and-exit [what]
  (log-error what)
  (exit 0))

(defn get-component-id []
  (System/getenv "KBC_COMPONENTID"))

(defn keboola-ex-facebook-component? []
  (= "keboola.ex-facebook" (get-component-id)))

(defn save-manifest [csvfile-path body]
  (let [manifest (select-keys body [:destination :columns :incremental :primary_key :delimiter :enclosure])
        manifest-path (str csvfile-path ".manifest")]
    (spit manifest-path (generate-string manifest))))


================================================
File: /src/keboola/docker/config.clj
================================================
(ns keboola.docker.config
  (:require [cheshire.core :refer [parse-string]]
            [clojure.string :refer [trim]]))


(def default-dir "/data/")

(defn check-path [path]
  (if (clojure.string/ends-with? path "/")
    (trim path)
    (str (trim path) "/")))

(defn- load-config-once
  ([] (load-config-once default-dir))
  ([datadir]
   (let [dirpath (check-path datadir)
         file-content (slurp (trim (str dirpath "config.json")))]
     (parse-string file-content true))))

(def load-config load-config-once)

(defn mkdirp [path]
  (let [dir (java.io.File. path)]
    (if-not (.exists dir)
      (.mkdirs dir))
    path))

(defn out-dir-path
  ([]
   (out-dir-path "./"))
  ([datadir]
   (let [result (mkdirp (str (check-path (trim datadir)) "out/tables/"))]
     result)))


(defn config [& datadir]
  (apply load-config datadir))


(defn parameters [& datadir]
  (:parameters (apply load-config datadir)))


(defn app-access-token [& datadir]
  (let
      [auth-info (get-in
                  (apply load-config datadir)
                  [:authorization :oauth_api :credentials])
       app-secret (:#appSecret auth-info)
       app-id (:appKey auth-info)]
    (str app-id "|" app-secret)))

(defn user-credentials [& datadir]
  (let
      [data (get-in
             (apply load-config datadir)
             [:authorization :oauth_api :credentials :#data])]
    (parse-string data true)))

(defn get-fb-token [user-credentials]
  (:access_token user-credentials (:token user-credentials)))




================================================
File: /src/keboola/facebook/api/parser.clj
================================================
(ns keboola.facebook.api.parser
  (:require
   [keboola.docker.runtime :refer [app-error]]
   [clj-time.core :as t]
   [clojure.data.json :as json]
   [clj-time.format :refer [formatter unparse]]
   [clojure.string :as string]))

(defn relative-days-timestamp [days]
  (unparse (formatter "YYYY-MM-dd") (t/plus (t/now) (t/days (Integer/parseInt days)))))

(defn preparse-fields [fields-str]
  (string/replace fields-str #"%%days:-?\d+%%"
                  #(relative-days-timestamp (re-find #"-?\d+" %))))

(defn nested-object?
  "Returns true if objet is map and contains :data keyword"
  [object]
  (and (map? object) (contains? object :data)))

(defn extract-summary [object-name object row params]
  (if (contains? object :summary)
    {:name "summary"
     :data {:data [(:summary object)]}
     :parent-id (or (:id row) (:parent-id params))
     :fb-graph-node (str (:fb-graph-node params) "_" object-name)}))

(defn get-nested-objects
  "Traverse body-data array and take out nested-object like structures.
  Return array of objects with keys :name :data :parent-id :fb-graph-node "
  [body-data params]
  (reduce
   (fn [memo, row]
     (if-let [objects (reduce-kv (fn [m k v]
                                   (if (nested-object? v)
                                     (conj m
                                           {:name (name k)
                                            :data v
                                            :parent-id (or (:id row) (:parent-id params))
                                            :fb-graph-node (str (:fb-graph-node params) "_" (name k))}

                                           (extract-summary (name k) v row params)) m))
                                 [] row)]
       (concat memo (keep identity objects))
       memo))
   [] body-data))

(defn flatten-value-object
  "flattens object values and prepends and prepend key1"
  [key1 object-value]
  (cond
    (map? object-value) (map (fn [[key2 val]] {:key1 key1 :key2 (name key2) :value val})
                             object-value)
    :else (list {:key1 key1 :key2 "" :value object-value})))

(defn flatten-array-value [item end_time]
  (map
   #(assoc % :end_time end_time)
   (cond
     (map? item) (mapcat (fn [[key1 val]] (flatten-value-object (name key1) val)) item)
     :else (list {:key1 "" :key2 "" :value item}))))

(def ads-action-stats-types #{:actions :properties :conversion_values
                              :action_values :canvas_component_avg_pct_view
                              :cost_per_10_sec_video_view :cost_per_action_type :cost_per_unique_action_type
                              :unique_actions :video_10_sec_watched_actions :video_15_sec_watched_actions
                              :video_30_sec_watched_actions :video_avg_pct_watched_actions
                              :video_avg_percent_watched_actions :video_avg_sec_watched_actions
                              :video_avg_time_watched_actions :video_complete_watched_actions
                              :video_p100_watched_actions :video_p25_watched_actions
                              :video_p50_watched_actions :video_p75_watched_actions :cost_per_conversion :cost_per_outbound_click
                              :video_p95_watched_actions :website_ctr :website_purchase_roas :purchase_roas :outbound_clicks :conversions :video_play_actions :video_thruplay_watched_actions})

(def serialized-lists-types #{:issues_info :frequency_control_specs})

(defn flatten-array
  "flattens array of object with same structure prefixing its keys with array-name
  returns list of key-value pairs"
  [array array-name]
  (cond (= array-name :values)
        (mapcat #(flatten-array-value (:value %) (:end_time %)) array)
        (some? (ads-action-stats-types array-name))
        (map #(assoc % :ads_action_name (name array-name)) array)
        (some? (serialized-lists-types array-name))
        (list (assoc {} array-name (json/write-str array)))
        (and (= array-name :media) (empty? array)) '()
        :else (app-error (str "unsuported array:" array-name array))))

(defn filter-scalars [row]
  (into {} (filter (fn [[k v]]
                     (and (-> v map? not) (-> v sequential? not)))
                   row)))

(defn filter-flatten-objects
  [row]
  (let [simple-objects (filter (fn [[k v]] (and (-> v map?) (-> v nested-object? not))) row)]
    (apply hash-map
           (mapcat (fn [[object-name object]]
                     (mapcat (fn [[k v]]
                               (list (keyword (str (name object-name) "_" (name k))) v))
                             object))
                   simple-objects))))


================================================
File: /src/keboola/facebook/api/request.clj
================================================
(ns keboola.facebook.api.request
  (:require   [clojure.spec.alpha :as s]
              [keboola.facebook.api.exponential-backoff :refer [with-exp-backoff try-3-times]]
              [keboola.facebook.api.parser :as parser]
              [keboola.docker.runtime :refer [log-strings app-error log-error]]
              [slingshot.slingshot :refer [try+ throw+]]
              [keboola.http.client :as client]
              [clojure.string :as string]
              [keboola.docker.runtime :as runtime]))

(def graph-api-url "https://graph.facebook.com/")
(def default-version "v20.0")

(s/fdef make-url
  :args (s/or :path-only (s/cat :path string?)
              :path-and-version (s/cat :path string? :version string?))
  :fn #(-> % :ret (clojure.string/starts-with? graph-api-url))
  :ret string?)

(defn make-url
  "return absolute url to fb api given relative @path and @version"
  ([path] (make-url path default-version))
  ([path version]
   (str graph-api-url (or version default-version) "/" path)))

(defn get-next-limit [current-limit]
  (let [limit (if (int? current-limit) current-limit (Integer/parseInt current-limit))]
    (if (< limit 1)
      0
      (int (Math/ceil (/ limit 2))))))

(def DEFAULT_LIMIT "25")
(defn parse-limit-from-url [url]
  (re-find #"\d+" (or  (last (re-seq #"limit=\d+" url)) "")))

(defn update-url-with-limit [url new-limit]
  (let [has-query-params (clojure.string/includes? url "?")
        parts (clojure.string/split url #"limit=")
        first-part (apply str (clojure.string/join "limit=" (drop-last parts)))
        last-part (last parts)]
    (if (empty? first-part)
      (if has-query-params
        (str url "&limit=" new-limit)
        (str url "?limit=" new-limit))
      (str first-part
           "limit="
           (clojure.string/replace-first last-part #"\d+" (str new-limit))))))

(defn skip-error-exception? [e]
  (if-let [status (:status e)]
    (and
     (<= 400 status 500)
     (or
      (re-find #"(?i)media posted before business account conversion" (:body e))))))

(defn retry-exception? [e]
  (if-let [status (:status e)]
    (or (and
         (<= 500 status 600)
         (or
          (re-find #"Sorry, something went wrong" (:body e))
          (re-find #"An unknown error" (:body e))
          (re-find #"An unexpected error has occurred. Please retry" (:body e))
          (re-find #"Please reduce the amount of data" (:body e))))
        (and (<= 400 status 600)
             (re-find #"since param is not valid. Metrics data is available for the last 2 years" (:body e)))
        (re-find #"This method must be called with a Page Access Token" (:body e))
        (re-find #"\(#100\) Cannot include" (:body e)))))

(def MIN_TRY_LIMIT_COUNT 3)
(def MIN_TRY_LIMIT 1)
(def empty-response {:body {:data []} :status 200})

(defn call-and-adapt [api-fn url min-limit-count]
  (try+
   (api-fn url)
   (catch skip-error-exception? e
     (log-error "Recoverable error encountered: Media Posted Before Business Account Conversion Error" (:body e))
     empty-response)
   (catch retry-exception? e
     (Thread/sleep 60000)
     (if (zero? min-limit-count)
       (throw+ e)
       (let [current-limit (or (parse-limit-from-url url) DEFAULT_LIMIT)
             new-limit (get-next-limit current-limit)
             new-url (update-url-with-limit url new-limit)
             new-min-limit-count (if (= new-limit MIN_TRY_LIMIT) (dec min-limit-count)
                                     min-limit-count)]
         (log-error (:body e))
         (log-error "RETYRING request with limit " new-limit)
         (call-and-adapt api-fn new-url new-min-limit-count))))))

(defn make-get-request
  ([url]
   (let [call-api-fn (fn [url] (client/GET url :as :json))
         current-limit (parse-limit-from-url url)
         new-url (if current-limit (update-url-with-limit url current-limit) url)]
     (call-and-adapt call-api-fn new-url MIN_TRY_LIMIT_COUNT)))
  ([url query-params]
   (let [call-api-fn (fn [url] (client/GET url :query-params (dissoc query-params :limit) :as :json))
         current-limit (:limit query-params)
         new-url (if current-limit (update-url-with-limit url current-limit) url)]
     (call-and-adapt call-api-fn new-url MIN_TRY_LIMIT_COUNT))))

(defn extract-values
  "traverse object(@row) values and take only scalar values or flatten simple objects(key->value) or explodes arrays(insights metrics)
  return list of objects with enhanced info(:keboola keyword) and all scalar values"
  [row params ex-account-id]
  (let [scalars (parser/filter-scalars row)
        objects-flatten (parser/filter-flatten-objects row)
        all-simple-scalars (merge {:ex-account-id ex-account-id :keboola params} scalars objects-flatten)
        arrays (filter (fn [[k v]] (vector? v)) row)
        merged-arrays (map
                       #(merge all-simple-scalars %) (mapcat (fn [[array-name array]]
                                                               (parser/flatten-array array array-name)) arrays))]
    (if (empty? merged-arrays)
      (list all-simple-scalars)
      merged-arrays)))

(defn get-next-page-url
  "return url to the next page from @response param"
  [response time-base-pagination? stop-on-empty-response?]
  (let [next-url (get-in response [:paging :next])
        time-base-pagination-valid (or (not time-base-pagination?)
                                       (and next-url
                                            (not (clojure.string/includes? next-url "since="))
                                            (not (clojure.string/includes? next-url "until="))))
        stop-on-empty-response-valid (or (not stop-on-empty-response?)
                                         (not (-> response :data empty?)))]
    (if (not stop-on-empty-response-valid) (log-strings "Found empty data response, stopping pagintaion."))
    (if (and time-base-pagination-valid stop-on-empty-response-valid)
      next-url)))

(defn get-next-page-data
  "if response contains next page url then call it and wait for new repsonse
  result: vector with new nested-object like structure
  "
  [response params ex-account-id top-node time-base-pagination? stop-on-empty-response?]
  ;(println "next url" (get-next-page-url response) (:paging response))
  (if-let [next-page-url (get-next-page-url response time-base-pagination? stop-on-empty-response?)] ; process next api page if exists
    (let [new-response (:body (make-get-request next-page-url))]
      (cond (contains? new-response :data)
            [{:parent-id (:parent-id params)
              :fb-graph-node (:fb-graph-node params)
              :name (:table-name params)
              :data new-response}]

            (contains? new-response (keyword ex-account-id))
            [{:parent-id ex-account-id
              :fb-graph-node top-node
              :name top-node
              :data new-response}]

            :else
            (app-error (str "Unknown page structure:" (keys new-response) "next-page" next-page-url (dissoc params :body-data :response)))))))

(defn page-and-collect
  "collect data from response and make another paging requests if needed.
  Returns lazy sequence of flattened data resulting from processing the whole query"
  [{:keys [ex-account-id parent-id fb-graph-node table-name path body-data response] :as init-params} time-base-pagination? stop-on-empty-response?]
  ((fn step [params this-object-data rest-objects top-node]
     (if (and (empty? rest-objects) (empty? this-object-data))
       nil
       (let [new-rows (mapcat #(extract-values % (dissoc params :body-data :response) ex-account-id) this-object-data)

             next-page-data (get-next-page-data (:response params) params ex-account-id top-node time-base-pagination? stop-on-empty-response?)
             nested-objects (concat (parser/get-nested-objects this-object-data params) next-page-data)
             all-objects (concat nested-objects rest-objects)
             next-object (first all-objects)
             new-params (assoc params
                               :parent-id (:parent-id next-object)
                               :fb-graph-node (:fb-graph-node next-object)
                               :table-name (:name next-object)
                               :path path
                               :response (:data next-object)
                               :body-data (:data (:data next-object)))]
         (lazy-seq (cons new-rows (step new-params (:body-data new-params) (rest all-objects) top-node)))))) init-params body-data [] fb-graph-node))

(defn nested-request
  "Make a initial request to fb api given query and collect its result data.
  Returns collection of maps of key-value pairs page-id -> result_data "
  [access-token {:keys [fields ids path limit since until] :as whole-query} & {:keys [version]}]
  (let [preparsed-fields (parser/preparse-fields fields)
        preparsed-since (parser/preparse-fields (or since ""))
        preparsed-until (parser/preparse-fields (or until ""))
        query-params (assoc whole-query :access_token access-token :fields preparsed-fields :since preparsed-since :until preparsed-until)
        full-url (make-url path version)
        time-base-pagination? (:time-based-pagination whole-query)
        stop-on-empty-response? (:stop-on-empty-response whole-query)
        response (make-get-request full-url query-params)
        response-body (:body response)
        sanitized-path (keyword (string/replace path #"/" "_"))]

    (log-strings "calling" full-url "with" preparsed-fields ids preparsed-since preparsed-until)
    (if stop-on-empty-response? (log-strings "Stop on empty response is enabled."))
    (if (some? ids)
      (mapcat
       #(page-and-collect
         {:ex-account-id (name (first %))
          :parent-id (name (first %))
          :fb-graph-node "page"
          :table-name "page"
          :path path
          :body-data [(if (not-empty path) {sanitized-path (second %)} (second %))]
          :response response-body} time-base-pagination? stop-on-empty-response?)
       response-body)
       ;else - no ids response
      (page-and-collect
       {:ex-account-id ""
        :parent-id ""
        :fb-graph-node "page"
        :table-name "page"
        :path path
        :body-data [(if (not-empty path) {sanitized-path response-body} response-body)]
        :response (if (not-empty path) {sanitized-path response-body} response-body)} time-base-pagination? stop-on-empty-response?))))

(defn- job-finished? [poll-response]
  (let [status (-> poll-response :body :async_status)
        completed? (= status "Job Completed")
        failed? (some (partial = status)  ["Job Failed" "Job Skipped"])]
    (log-strings "Facebook API async insights job state:" (:body poll-response))
    (cond
      (not status) (runtime/app-error (str "Polling failed with unknown status" (:body poll-response)))
      failed?  (runtime/user-error (str "Polling failed with status:" status (:body poll-response)))
      completed? (do (log-strings "Polling finished with status:" status) (:body poll-response))
      :else
      nil)))

(defn- poll-async-request [report_run_id access-token version]
  (let [url (str (make-url report_run_id version) "?access_token=" access-token)
        request-fn #(client/GET url :as :json)
        finished?-fn #(job-finished? (try-3-times request-fn))]
    (log-strings "Started polling for insights job report:" report_run_id)
    (with-exp-backoff finished?-fn)))

(defn- collect-async-insights-result [access-token ad-account-id report-run-id version stop-on-empty-response?]
  (let [url (str (make-url report-run-id version) "/insights/?access_token=" access-token)
        response (make-get-request url)
        response-body (:body response)]
    ;(println "response-body" response-body)
    (if stop-on-empty-response? (log-strings "Stop on empty response is enabled."))
    (page-and-collect
     {:ex-account-id ad-account-id
      :parent-id ad-account-id
      :fb-graph-node "page"
      :table-name "page"
      :path "insights"
      :body-data [{"insights" response-body}]
      :response nil} false stop-on-empty-response?)))

(defn async-insights-request [access-token ad-account-id parameters version query]
  (let [url (make-url (str ad-account-id "/insights") version)
        stop-on-empty-response? (:stop-on-empty-response query)
        url-params (str parameters "&access_token=" access-token)
        whole-url (str url "?" url-params)
        report-run-id (-> (client/POST whole-url :as :json) :body :report_run_id)]
    (poll-async-request report-run-id access-token version)
    (collect-async-insights-result access-token ad-account-id report-run-id version stop-on-empty-response?)))

(defn- collect-result [response api-fn]
  (lazy-seq
   (if (not-empty (:data response))
     (cons (:data response)
           (if (some? (-> response :paging :next))
             (collect-result (:body (api-fn (-> response :paging :next))) api-fn))))))

(defn- get-request [access-token path & {:keys [query version]}]
  (let [query-params (assoc query :access_token access-token)
        request-fn (fn [url] (client/GET url :query-params query-params :as :json))
        full-url (make-url path version)]
    ;(println full-url)
    (collect-result
     (:body (request-fn full-url))
     request-fn)))

(defn get-accounts [access-token & {:keys [version]}]
  (apply concat (get-request access-token "me/accounts" :version version)))

(defn get-igaccounts [access-token & {:keys [version]}]
  (apply concat (get-request access-token "me/accounts"
                             :query {:fields "instagram_business_account,name,category"}
                             :version version)))

(defn get-adaccounts [access-token & {:keys [version]}]
  (apply concat (get-request access-token "me/adaccounts"
                             :query {:fields "account_id,id,business_name,name,currency"}
                             :version version)))

(defn debug-token [app-token input-token & {:keys [version]}]
  (let [query {:access_token app-token :input_token input-token}
        url (make-url "debug_token" version)]
    (:body (client/GET url :query-params query :as :json))))

; https://developers.facebook.com/docs/pages/access-tokens
; https://graph.facebook.com/PAGE-ID?fields=access_token&access_token=USER-ACCESS-TOKEN
(defn get-page-token-via-page-details [access-token page-id]
  (let [query-params {:fields "access_token" :access_token access-token}
        url (str graph-api-url page-id)
        response (client/GET url :query-params query-params :as :json)
        body (:body response)]
    (:access_token body)))


================================================
File: /src/keboola/facebook/api/exponential_backoff.clj
================================================
(ns keboola.facebook.api.exponential-backoff
  (:require [keboola.docker.runtime :as runtime]))

(def time-slot-ms 1000)
(def truncate 6) ; sleep for 64 seconds at most (2^6)
(def MAX_WAIT_TIME (* 1000 60 60 24)) ; poll for 24 hours at most

(defn with-exp-backoff [action!]
  (loop [c 0
         waited 0]
    (let [slot (* time-slot-ms (dec (Math/pow 2 c)))]
      (when (> waited MAX_WAIT_TIME)
        (runtime/user-error (str "Polling timeout exceeded:" waited)))
      (Thread/sleep slot)
      (when (not (action!))
        (recur (if (>= c truncate) c (inc c)) (+ waited slot))))))

(defn- try-n-times [f n]
  (if (zero? n)
    (f)
    (try
      (f)
      (catch Throwable _
        (Thread/sleep (* 1000 10))
        (try-n-times f (dec n))))))

(defn try-3-times [f]
  (try-n-times f 3))


================================================
File: /src/keboola/facebook/extractor/query_parser.clj
================================================
(ns keboola.facebook.extractor.query-parser
  (:gen-class)
  (:require
   [clojure.string :as s]
   [clojure.data.json :as json])
  (:import [java.time LocalDate]
           [java.time.format DateTimeFormatter]))


;; Parses the parameters string into a map.
(defn parse-parameters [params-str]
  (if (empty? params-str)
    {}
    (->> (s/split params-str #"&")
         (map #(s/split % #"=" 2))
         (map (fn [[k v]] [k v]))
         (into {}))))

;; Parses the time_ranges parameter into a vector of maps.
(defn parse-time-ranges [time-ranges-str]
  (if (empty? time-ranges-str)
    []
    (let [json-str (s/replace time-ranges-str #"'" "\"")]
      (json/read-str json-str :key-fn keyword))))

;;  Generates a sequence of dates from start-date to end-date exclusive
(defn date-range [start-date end-date]
  (let [formatter (DateTimeFormatter/ofPattern "yyyy-MM-dd")
        start (LocalDate/parse start-date formatter)
        end (LocalDate/parse end-date formatter)]
    (cond
      ;; If start date is before end date, return dates up to but not including end date
      (.isBefore start end)
      (take-while (fn [date] (.isBefore date end))
                  (iterate #(.plusDays % 1) start))
      ;; If start date equals end date, return a sequence containing that date
      (.isEqual start end)
      [start]
      ;; If start date is after end date, return an empty sequence
      :else
      [])))

;; Generates a list of time ranges for each day within the given date range.
(defn generate-date-ranges [start-date end-date]

  (let [dates (date-range start-date end-date)]
    (map (fn [date]
           {:since (.toString date)
            :until (.toString date)})
         dates)))

;; Expands all time ranges into individual day ranges.
(defn expand-time-ranges [time-ranges]
  (mapcat (fn [time-range]
            (generate-date-ranges (:since time-range) (:until time-range)))
          time-ranges))

;; Generates a new parameters string with the updated time_range.
(defn generate-parameters-for-dates [parameters-map time-range]
  (let [time-ranges-json (json/write-str [time-range] :value-fn (fn [k v] (if (string? v) v (str v))))
        ;; Replace double quotes with single quotes
        time-ranges-json-single-quotes (s/replace time-ranges-json #"\"" "'")
        params-with-new-time-range (-> parameters-map
                                       (dissoc "date_preset")
                                       (assoc "time_ranges" time-ranges-json-single-quotes))]
    (->> params-with-new-time-range
         (map (fn [[k v]] (str k "=" v)))
         (s/join "&"))))

;;  Converts date_preset values to the number of days.
(defn date-preset-to-days [date-preset]
  (case date-preset
    "last_3d" 3
    "last_7d" 7
    "last_30d" 30
    nil))

;;"Returns the date string for 'days' days ago from the given reference date.
;; If reference-date is not provided, uses LocalDate/now."
(defn get-past-date
  ([days]
   (get-past-date days (LocalDate/now)))
  ([days reference-date]
   (let [formatter (DateTimeFormatter/ofPattern "yyyy-MM-dd")]
     (.format (.minusDays reference-date days) formatter))))

================================================
File: /src/keboola/facebook/extractor/sync_actions.clj
================================================
(ns keboola.facebook.extractor.sync-actions
  (:require [keboola.facebook.api.request :as request]
            [cheshire.core :refer [generate-string]]
            [slingshot.slingshot :refer [try+ throw+]]
            [keboola.docker.config :as docker-config]
            [keboola.docker.runtime :refer [log]]))

(def log-token? (atom true))
(defn disable-log-token [] (reset! log-token? false))

(defn accounts [credentials config]
  (try+
   (let [token (docker-config/get-fb-token credentials)
         version (-> config :parameters :api-version)
         accounts (mapv #(dissoc % :access_token) (request/get-accounts token :version version))]
     (log (generate-string accounts)))
   (catch Object e
     (log (generate-string {:code (:status e 500) :error (:body e)})))))

(defn adaccounts [credentials config]
  (try+
   (let [token (docker-config/get-fb-token credentials)
         version (-> config :parameters :api-version)
         accounts (request/get-adaccounts token :version version)]
     (log (generate-string accounts)))
   (catch Object e
     (log (generate-string {:code (:status e 500) :error (:body e)})))))

(defn igaccounts [credentials config]
  (try+
   (let [token (docker-config/get-fb-token credentials)
         version (-> config :parameters :api-version)
         accounts (request/get-igaccounts token :version version)
         ig-accounts (filter #(contains? % :instagram_business_account) accounts)
         result (map #(assoc (select-keys % [:name :category]) :id (-> % :instagram_business_account :id) :fb_page_id (:id %)) ig-accounts)]
     (log (generate-string result)))
   (catch Object e
     (log (generate-string {:code (:status e 500) :error (:body e)})))))

(defn log-debug-token [app-token credentials prepend-message]
  (try+
   (if @log-token?
     (let [input-token (docker-config/get-fb-token credentials)
           response-data (:data (request/debug-token app-token input-token))
           result (dissoc response-data :app_id)]
       (log (str prepend-message (generate-string result)))))
   (catch Object e
     (log (generate-string {:message "Failed to log token info" :error (:body e)})))))


================================================
File: /src/keboola/facebook/extractor/query.clj
================================================
(ns keboola.facebook.extractor.query
  (:gen-class)
  (:require [clojure.core.async :as async]
            [clojure.string :as s]
            [keboola.docker.config :as docker-config]
            [keboola.docker.runtime :as runtime]
            [keboola.facebook.api.request :as request]
            [keboola.facebook.extractor.query-parser :refer :all]
            [keboola.facebook.extractor.output :as output]
            [clojure.string :as string])
  (:import [java.time LocalDate]
           [java.time.format DateTimeFormatter]))
(defn incremental?
  "Returns false if the given query is not incremental, true otherwise."
  [query]
  (let [incremental-value (:incremental query)]
    (if (nil? incremental-value)
      true
      incremental-value)))

(defn- run-and-write [token out-dir prefix query version]
  (let [nested-data (request/nested-request token query :version version)
        all-rows (apply concat nested-data)]
    (output/write-rows all-rows out-dir prefix false (incremental? query))))

(defmacro swallow-exceptions [& body]
  `(try ~@body (catch Exception e#)))

(defn retrieve-page-access-token [id token version]
  (let [accounts (swallow-exceptions (request/get-accounts token :version version))
        page-token-from-accounts-list (if (some? accounts) (:access_token (first (filter #(= id (:id %)) accounts))))
        page-token-from-page-details (swallow-exceptions (request/get-page-token-via-page-details token id))
        page-token (or page-token-from-accounts-list page-token-from-page-details)]
    (if (nil? page-token)
      (runtime/log-strings "Could not find page access token for" id ". Token from the configuration will be used instead.")
      (runtime/log-strings "Using page access token to retrieve data for" id))
    page-token))

(defn choose-token [id user-token version]
  (or (retrieve-page-access-token id user-token version) user-token))

(defn- run-by-id-merge-and-write
  ([token out-dir prefix query version] (run-by-id-merge-and-write token out-dir prefix query version choose-token))
  ([token out-dir prefix query version choose-token-fn]
   (let [ids-str (:ids query)
         prepare-query #(assoc query :ids %)
         run-query (fn [id] (request/nested-request (choose-token-fn id token version) (prepare-query id) :version version))
         ids-seq (s/split ids-str #",")
         all-merged-queries-rows (mapcat #(run-query %) ids-seq)
         all-rows (apply concat all-merged-queries-rows)]
     (output/write-rows all-rows out-dir prefix false (incremental? query)))))

(defn run-nested-query [token out-dir {:keys [name query version run-by-id?]}]
  (if-let [ids-str (:ids query)]
    (if run-by-id?
      (run-by-id-merge-and-write token out-dir name query version (constantly token))
      (doseq [ids (partition-all 50 (s/split ids-str #","))]
        (run-and-write token out-dir name (assoc query :ids (s/join "," ids)) version)))
    ;else if no ids then run the whole query
    (run-and-write token out-dir name query version))
  (runtime/log-strings "Run query" name "finished"))

(defn run-nested-query-with-page-token [user-token out-dir {:keys [name query version]}]
  (if (some?  (:ids query))
    (run-by-id-merge-and-write user-token out-dir name query version)
    ;else if no ids then run the whole query
    (run-and-write user-token out-dir name query version))
  (runtime/log-strings "Run query" name "finished"))

(defn check-ids [query all-ids]
  (let [ids (get-in query [:query :ids])
        has-ids-key (contains? (:query query) :ids)]
    (if (and has-ids-key (empty? ids)) (assoc-in query [:query :ids] all-ids)
        ;else return query untouched
        query)))

(defn query-contains-insights? [{:keys [fields path] :or {fields "" path ""}}]
  (or (string/includes? (or fields "") "insights")
      (string/includes? (or path "") "insights")))

(defn query-path-feed? [{:keys [path] :or {path ""}}]
  (string/includes? (or path "") "feed"))

(defn query-path-posts? [{:keys [path] :or {path ""}}]
  (string/includes? (or path "") "posts"))

(defn query-path-ratings? [{:keys [path] :or {path ""}}]
  (string/includes? (or path "") "ratings"))

(defn query-path-stories? [{:keys [path] :or {path ""}}]
  (string/includes? (or path "") "stories"))

(defn query-need-userinfo? [{:keys [fields path] :or {fields "" path ""}}]
  (or (some #(string/includes? (or fields "") %) ["likes" "from" "username"])
      (string/includes? (or path "") "likes")))

(defn need-page-token? [query]
  (and (runtime/keboola-ex-facebook-component?)
       (or (query-contains-insights? query)
           (query-path-ratings? query)
           (query-path-feed? query)
           (query-path-stories? query)
           (query-path-posts? query)
           (query-need-userinfo? query))))

(defn make-run-inishgts-query-with-time-range [async-insights-request-fn token id parameters-str version query]
  (let [parameters-map (parse-parameters parameters-str)
        time-ranges-str (get parameters-map "time_ranges")
        date-preset (get parameters-map "date_preset")]
    (cond
    ;; If time_ranges is present, split into daily queries
      time-ranges-str
      (let [time-ranges (parse-time-ranges time-ranges-str)
            expanded-time-ranges (expand-time-ranges time-ranges)
            run-query-for-time-range (fn [time-range]
                                       (let [new-parameters (generate-parameters-for-dates parameters-map time-range)]
                                         (async-insights-request-fn token id new-parameters version query)))]
        (runtime/log-strings "Splitting query by time_ranges: " {:time_ranges expanded-time-ranges})
        (mapcat run-query-for-time-range expanded-time-ranges))
    ;; If date_preset is one of last_3d, last_7d, last_30d, split into daily queries
      (some #{date-preset} ["last_3d" "last_7d" "last_30d"])
      (let [days (date-preset-to-days date-preset)
            end-date (.format (LocalDate/now) (DateTimeFormatter/ofPattern "yyyy-MM-dd"))
            start-date (get-past-date days)
            expanded-time-ranges (generate-date-ranges start-date end-date)
            run-query-for-time-range (fn [time-range]
                                       (let [new-parameters (generate-parameters-for-dates parameters-map time-range)]
                                         (async-insights-request-fn token id new-parameters version query)))]
        (runtime/log-strings "Splitting query by date_preset: " date-preset {:time_ranges expanded-time-ranges})
        (mapcat run-query-for-time-range expanded-time-ranges))
    ;; Else, use the parameters as is
      :else
      (do
        (runtime/log-strings "Running query with parameters as is even though split-query-time-range-by-day = true")
        (async-insights-request-fn token id parameters-str version query)))))

;; Runs the async insights query, splitting it into daily queries based on time_ranges or date_preset.
(defn run-async-insights-query-with-splitting [token out-dir name query version]
  (let [ids-str (:ids query)
        parameters (:parameters query)
        ids-seq (s/split ids-str #",")
        run-query (fn [id] (make-run-inishgts-query-with-time-range request/async-insights-request token id parameters version query))
        all-merged-queries-rows (mapcat run-query ids-seq)
        all-rows (apply concat all-merged-queries-rows)]
    (output/write-rows all-rows out-dir name true (incremental? query))))

;; Runs the async insights query, optionally splitting it into daily queries based on the query configuration.
(defn run-async-insights-query [token out-dir name query version]
  (let [split-query? (:split-query-time-range-by-day query)]
    (if split-query?
      (run-async-insights-query-with-splitting token out-dir name query version)
      ;; Else, use the parameters as is
      (let [ids-str (:ids query)
            parameters (:parameters query)
            ids-seq (s/split ids-str #",")
            run-query (fn [id] (request/async-insights-request token id parameters version query))
            all-merged-queries-rows (mapcat run-query ids-seq)
            all-rows (apply concat all-merged-queries-rows)]
        (output/write-rows all-rows out-dir name true (incremental? query))))))

(defn run-query [query all-ids credentials out-dir]
  (runtime/log-strings "Run query:" query)
  (let [token (docker-config/get-fb-token credentials)
        q (check-ids query all-ids)
        complete-query {:query (:query q) :name (:name q) :version (:api-version q) :run-by-id? (:run-by-id q)}
        run-with-page-token #(run-nested-query-with-page-token token out-dir complete-query)
        run-with-user-token #(run-nested-query token out-dir complete-query)
        run-query #(if (need-page-token? (:query query)) (run-with-page-token) (run-with-user-token))]
    (case (:type query)
      "nested-query" (run-query)
      "async-insights-query" (run-async-insights-query token out-dir (:name q) (:query q) (:api-version q)))))


================================================
File: /src/keboola/facebook/extractor/core.clj
================================================
(ns keboola.facebook.extractor.core
  (:gen-class)
  (:require [clojure.string :as string]
            [clojure.tools.cli :refer [parse-opts]]
            [keboola.docker.config :as docker-config]
            [keboola.docker.runtime
             :as
             docker-runtime
             :refer
             [app-error log log-error-and-exit log-strings user-error]]
            [keboola.facebook.extractor.query :as query]
            [keboola.facebook.extractor.sync-actions :as sync-actions]
            [keboola.http.client :refer [fb-requests-count]]
            [keboola.http.recording :refer [turn-log-responses-on]]
            [keboola.utils.json-to-csv :as csv]
            [slingshot.slingshot :refer [throw+ try+]]))

(def cli-options  [["-d" "--dataDir path" "Path to data directory e.g. /data"]])

(defn usage [options-summary]
  (->> ["Keboola Facebook Graph Api Extractor"
        "Usage: program-name options"
        "Options:"
        options-summary]
       (string/join \newline)))

(defn treat [fn-to-treat]
  (try+
   (fn-to-treat)
   (catch #(and (some? (:status %)) (number? (:status %)) (<= 400 (:status %) 550)) e
     (let [msg (:body e)]
       (if (.contains msg "User request limit reached")
         (log-error-and-exit (str "REQUEST LIMIT REACHED. Up to now extracted data will be uploaded to storage." msg))
         (user-error (str "Facebook api error:" msg)))))
   (catch Throwable e
     (app-error (str "unexpected error:" (with-out-str (clojure.stacktrace/print-stack-trace e)))))
   (catch Object e
     (app-error (str "unexpected error:" (str e))))))

(defn make-accounts-csv [parameters out-dir]
  (let [filepath (str out-dir "accounts")
        accounts (:accounts parameters)
        header (vec (set (apply concat (map #(keys (dissoc (second %) :access_token)) accounts)))) ;[:id :name :category]
        data (into [] (map (fn [[k v]] (select-keys v header)) accounts))]
    (log "writing accounts table")
    (csv/write filepath header data)))

(defn run [credentials parameters out-dir app-access-token]
  (let [version (:api-version parameters)
        all-ids (apply str (interpose "," (map name (keys (:accounts parameters)))))]
    (make-accounts-csv parameters out-dir)
    (sync-actions/log-debug-token app-access-token credentials "Access token info:")
    (dorun (map (fn  [query]
                  (if (:disabled query)
                    (log-strings "Skipping query" (:name query))
                                        ; else run query:
                    (query/run-query (assoc query :api-version version) all-ids credentials out-dir)))
                (:queries parameters))))
  (log-strings "Finished, total count of requests to facebook api:" @fb-requests-count))

(defn prepare-and-run [datadir]
  (let [parameters (docker-config/parameters datadir)
        config (docker-config/config datadir)
        action (:action config)
        app-access-token (docker-config/app-access-token datadir)
        out-dir-path (docker-config/out-dir-path datadir)
        credentials (docker-config/user-credentials datadir)]
    (when (:debug-mode parameters)
      (log "Running in debug mode")
      (sync-actions/disable-log-token)
      (turn-log-responses-on))
    (cond
      (empty? credentials) (docker-runtime/user-error "Missing facebook credentials")
      (empty? (docker-config/get-fb-token credentials)) (docker-runtime/user-error "Missing facebook token"))
    (case action
      "debugtoken" (sync-actions/log-debug-token app-access-token credentials nil)
      "accounts" (sync-actions/accounts credentials config)
      "adaccounts" (sync-actions/adaccounts credentials config)
      "igaccounts" (sync-actions/igaccounts credentials config)
      (treat  #(run credentials parameters out-dir-path app-access-token)))))

(defn -main [& args]
  (let [{:keys [options summary errors] :as parsed-args} (parse-opts args cli-options)]
    (cond
      (not-empty errors) (docker-runtime/user-error (string/join \newline errors))
      (empty? (:dataDir options)) (docker-runtime/user-error (usage summary)))
    (prepare-and-run (:dataDir options))))


================================================
File: /src/keboola/facebook/extractor/output.clj
================================================
(ns keboola.facebook.extractor.output
  (:require [keboola.utils.json-to-csv :as csv]
            [keboola.docker.runtime :as runtime]
            [keboola.docker.config :refer [mkdirp]]
            [clojure.string :refer [split]]
            [clj-time.coerce :refer [to-long]]
            [clj-time.core :refer [now]]
            [slingshot.slingshot :refer [try+ throw+]]
            [clojure.core.async :as async :refer [onto-chan >! <! >!! <!! go chan buffer close! thread alts! alt!! alts!! timeout]]
            [clojure.java.io :as io]))

(def chan-buffer-size 3000)
(def sample-rows-count 20000)

(defn delete-file-if-empty [file-path]
  (if (= 0 (.length (io/file file-path)))
    (io/delete-file file-path)))

(defn delete-dir-if-empty [dir-path]
  (let [dir-contents (.list (io/file dir-path))]
    (if (empty? dir-contents)
      (io/delete-file dir-path))))

(defn sort-columns [columns]
  (let [prefered-columns [:id :ex-account-id :fb-graph-node :parent-id :name :key1 :key2 :ads_action_name :action_type :action_reaction :value :period :end_time :title]
        used-prefered-columns (filter (set columns) prefered-columns)
        other-columns (filter #(not ((set used-prefered-columns) %)) columns)]
    (concat used-prefered-columns (sort other-columns))))

(def TABLES-SPECIFIC-PK-MAP
  {"insights" ["age" "country" "dma" "gender" "frequency_value" "hourly_stats_aggregated_by_advertiser_time_zone" "hourly_stats_aggregated_by_audience_time_zone" "impression_device" "place_page_id" "placement" "publisher_platform" "platform_position" "device_platform" "product_id" "region"]
   "ratings" ["reviewer_id"]})

(def ENDPOINT-SPECIFIC-PK-MAP
  {"" ["ad_id" "adset_id"]})
(def SUBSTITUTE-PK-MAP
  {"adset_id" "ad_id"})

(def ASYNC-INSIGHTS-PK
  ["ad_id" "adset_id"])

(defn table-has-column? [table-columns column]
  (some #(= % (keyword column)) table-columns))

(defn get-primary-key [table-columns table-name context async-insights?]
  (let [endpoint (:path context)
        basic-pk ["parent_id"]
        all-tables-pk ["id" "key1" "key2" "end_time" "account_id" "campaign_id" "date_start" "date_stop" "ads_action_name" "action_type" "action_reaction"]
        table-only-pk  (TABLES-SPECIFIC-PK-MAP table-name #{})
        endpoint-only-pk (ENDPOINT-SPECIFIC-PK-MAP endpoint #{})
        async-insights-pk (if async-insights? ASYNC-INSIGHTS-PK #{})
        extended-pk (concat all-tables-pk table-only-pk endpoint-only-pk async-insights-pk)]
    (dedupe (concat basic-pk
                    (filter
                     (fn [column]
                       (and (table-has-column? table-columns column)
                            (or async-insights? (not (table-has-column? table-columns (get SUBSTITUTE-PK-MAP column ""))))))
                     extended-pk)))))

(defn get-table-name [row]
  (-> row :keboola :table-name))

(defn add-id-coloumns [row]
  (assoc row
         :ex-account-id (-> row :keboola :ex-account-id)
         :parent-id (-> row :keboola :parent-id)
         :fb-graph-node (-> row :keboola :fb-graph-node)))

(def columns-map (atom {}))
(defn reset-columns-map [] (reset! columns-map {}))

(defn write-manifest [manifest-path columns is-write? table-name context async-insights? incremental?]
  (if is-write?
    (let [manifest (if incremental?
                     {:incremental true :primary_key (get-primary-key columns table-name context async-insights?) :columns columns}
                     {:incremental false :columns columns})]
      (if (not (contains? @columns-map manifest-path))
        (do
          (runtime/save-manifest manifest-path manifest)
          (swap! columns-map assoc manifest-path columns))))))

(defn prepare-header [rows manifest-path]
  (let [columns (set (mapcat #(-> % (dissoc :keboola) keys) rows))
        all-columns (conj columns :parent-id :fb-graph-node :ex-account-id)
        new-columns (sort-columns all-columns)
        has-data-columns (not-empty (disj (set new-columns) :id :ex-account-id :fb-graph-node :parent-id))
        saved-columns (@columns-map manifest-path)]
    (if has-data-columns ;else return nil -> no data to write
      (if saved-columns ;else returns new-columns
        (if (= saved-columns new-columns) ;else throws error
          ; return saved columns from previous query
          saved-columns
          ;else throw error on columns mismatch
          (throw+ (str "columns mismatch, original write columns: " saved-columns " ,current write columns: " new-columns)))
        ; else return newly computed columns
        new-columns))))
    ; by default return nil saying we have no data to save


(defn flush-buffer [csv-file manifest-path table-name memo async-insights? incremental?]
  (let [first-write? (:first-write? memo)
        header (if first-write?
                 (prepare-header (:buffer memo) manifest-path)
                 (:header memo))
        context (-> memo :buffer first :keboola)]
    (if header
      (do
        (write-manifest manifest-path header first-write? table-name context async-insights? incremental?)
        (csv/write-to-file csv-file header (:buffer memo) false)
        (if (= (mod (:cnt memo) chan-buffer-size) 0)
          (runtime/log-strings "Written" (:cnt memo) "rows to" table-name))
        ;return header
        header)
      ; else has only ids columns return nil header
      (do
        (if first-write? (runtime/log-strings "Skipping table" table-name "containing only id and parent-id columns"))
        nil))))

(defn process-row [row csv-file manifest-path table-name memo async-insights? incremental?]
  (if (= (count (:buffer memo)) chan-buffer-size)
    (let [header (flush-buffer csv-file manifest-path table-name memo async-insights? incremental?)]
      {:cnt (inc (:cnt memo)) :header header :buffer (list row) :first-write? false})
    ;else part
    {:cnt (inc (:cnt memo))
     :header (:header memo)
     :buffer (conj (:buffer memo) row)
     :first-write? (:first-write? memo)}))

(defn create-write-thread [table-name input-ch out-dir qname-prefix async-insights? incremental?]
  (async/thread
    (try+
     (let [kbc-table-name (if (= (last (split qname-prefix #"_")) table-name)
                            qname-prefix
                            (str qname-prefix "_" table-name))
           sliced-dir-path (str out-dir kbc-table-name)
           sliced-file-name (str (to-long (now)))
           sliced-file-path (str sliced-dir-path "/" sliced-file-name)]
       (mkdirp sliced-dir-path)
       (with-open [out-file (io/writer sliced-file-path)]
         (loop [memo {:cnt 0 :buffer '() :header {} :first-write? true}]
           (let [row (<!! input-ch)]
             (if (some? row)
               (recur (process-row row out-file sliced-dir-path table-name memo async-insights? incremental?))
               ;; else input-ch has closed -> don't call recur,
               (if (some? (flush-buffer out-file sliced-dir-path table-name memo async-insights? incremental?))
                 (runtime/log-strings "Total written" (:cnt memo) "rows to table" table-name))))))
               ;; thread terminates

       (delete-file-if-empty sliced-file-path)
       (delete-dir-if-empty  sliced-dir-path))
     ; return true as succesfull finish of thread
     {:return true}
     (catch Object e
       {:return false :error (str "failed write " table-name  " with error: " e)}))))

(defn create-tables-map [tables-names value-fn]
  (into {} (map #(vector % (value-fn %)) tables-names)))

(defn close-channels [table-map thread-chans-vec error-strategy]
  (doseq [[_ c] table-map]
    (close! c))
  (while (when-let [return-value (async/<!! (async/merge thread-chans-vec))]
           (if-not (:return return-value)
             (cond
               (= error-strategy :throw-on-false-return) (throw+ (:error return-value))
               (= error-strategy :log-on-false-return) (runtime/log-error (:error return-value))))
           return-value)))

(defn write-rows [rows out-dir qname-prefix async-insights? incremental?]
  (let [sample (take sample-rows-count rows)
        tables-names (set (map #(get-table-name %) sample))
        tables-chans (create-tables-map tables-names (fn [_] (chan)))
        threads-chans (create-tables-map tables-names #(create-write-thread % (tables-chans %) out-dir qname-prefix async-insights? incremental?))
        thread-chans-vec (mapv #(second %) threads-chans)]
    (runtime/log-strings "found tables" tables-names)
    (try+
     (doseq [row rows]
       (let [table-name (get-table-name row)
             output-chan (tables-chans table-name)
             output-row (add-id-coloumns row)
             put-result (alt!! (timeout (* 30 1000)) :timed-out
                               ;; put operation must be specified as nested vector [[channel_to_put value_to_put]]
                               [[output-chan output-row]] :sent)]
         (if (= put-result :timed-out)
           (throw+ (str "There was an error writing to table " table-name " data:" output-row)))))
     (catch Object _
       (close-channels tables-chans thread-chans-vec :log-on-false-return)
       (throw+)))
    (close-channels tables-chans thread-chans-vec :throw-on-false-return)))


================================================
File: /docker-compose.yml
================================================
version: "2"
services:
  app:
    build: .
    entrypoint: "boot"
    image: keboola/ex-facebook-graph-api
    volumes:
      - ./:/code


================================================
File: /README.md
================================================
[![Build Status](https://travis-ci.com/keboola/ex-facebook-graph-api.svg?branch=master)](https://travis-ci.com/keboola/ex-facebook-graph-api)

[![Docker Repository on Quay](https://quay.io/repository/keboola/ex-facebook-graph-api/status "Docker Repository on Quay")](https://quay.io/repository/keboola/ex-facebook-graph-api)

## Sample Nested Queries
##### the whole fb feed - all page posts, its likes, comments, likes of the comments, subcomments, likes of the subcomments
```
{
  "id": 1,
  "name": "scrape",
  "type": "nested-query",
  "query": {
    "path": "feed",
    "fields": "caption,message,created_time,type,description,likes{link,name,username},comments{message,created_time,from,likes{link,name,username},comments{message,created_time,from,likes{link,name,username}}}",
    "ids": "<page_id>"
}
```
##### extract page [metrics](https://developers.facebook.com/docs/graph-api/reference/insights) `page_impressions`, `page_fans` and `page_engaged_users` for last 5 days

```
{
  "id": 2,
  "name": "page_insights",
  "type": "nested-query",
  "query": {
    "path": "",
    "fields": "insights.since(5 days ago).metric(page_impressions,page_fans,page_engaged_users)",
    "ids": "<page_id>"
  }
}
```
According to the last facebook graph api all insights metrics that are needed to extract must be explicitely listed in the query, i.e., there is no general get-all-metrics data query type of call.
##### extract posts [metrics](https://developers.facebook.com/docs/graph-api/reference/insights) `page_posts_impressions` and `post_impressions` for all posts:
Note day we are using `since(now)` specification of insights time to get the most recent values, otherwise it may paginate over small periods of time and consume lots of request to facebook api.
```
{
  "id": 3,
  "name": "posts_insights",
  "type": "nested-query",
  "query": {
    "path": "feed",
    "fields": "insights.since(now).metric(page_posts_impressions,post_impressions)",
    "ids": "<page_id>"
  }
}
```

You can try the examples above by calling Facebook Graph api directly in a http client(e.g. Postman) as follows:
`GET https://graph.facebook.com/<api_version>/<path>?fields=<fields>&ids=<ids>&access_token=<access_token>`
You can get access token in [Graph Api Explorer](https://developers.facebook.com/tools/explorer).
# Configuration
## Facebook Graph API
This extractor extracts data from facebook graph api:
https://developers.facebook.com/docs/graph-api/
. You can try it live here: https://developers.facebook.com/tools/explorer


### Nested Query

Lets say that in Facebook Graph Api every endpoint represents a node in a graph. Example of a node could be /me - ie user info, me/posts - ie posts of the current user. To get data from a particullar endpoint one can make typical REST api call GET `me/posts` or make a **nested** api call that basically allows to extract the whole subtree of a node. for example GET `me?fields=posts,comments,likes` extracts all posts comments and likes of an id(in this case it is me - current user).
For more info see Making Nested Queries in https://developers.facebook.com/docs/graph-api/using-graph-api#reading
#### Configuring nested query
In configuration under parameters there is an array of `queries`(see sample configuration). Each query besides obvious properties such as `id`, `name`, `type`(currently only nested-query type), `disabled` also contains object `query` with the following properties:
- `path` : enpoint url so the absolute url will be like graph.facebook.com/version/path. Typically it is endpoint **feed**. Can be an empty string if we want to start extracting from the "root" node that is the page itself.
- `fields`: fields parameter of the graph api nested-query
- `ids`: comma separated list of ids(typically page-ids) that will be prepended with path. It is also a parameter of graph api. If empty string than all ids from `accounts` object will be used. Can also be completely removed from the query.
- `limit` - size of one page(response). Default is 25, maximum 100. Useful when fb api returns error that the request is "too big" - in such case use smaller limit. This parameter also affects the total number of request made to fb api.
- `since` - relates to the *created_time* of **path** parameter i.e., if path is "posts" then it takes all posts with *created_time* since the specified date in **since** parameter. If path is empty then it does not have any effect. Can be specified relatively, e.g. 10 days ago.
- `until` - same as since above but specifies date until data with *created_time* date.


 The most important parameter is `fields` - tells what is going to extract. so here are few hints:
 - you can specify additional params of a node with dot e.g to specify since and limit params of posts: `posts.limit(100).since(2016-12-24){message,likes,comments{comments}}`
 - you can also specify date range using `since` or/and `until` that accepts unix timestamp values(in seconds) or date in format **yyy-mm-dd** or relative values: e.g. all posts posted in last 10 days `posts.since(10 days ago){message,likes,comments}`
 - relative date specification is parsed by this cool PHP function [strtotime](http://php.net/manual/en/function.strtotime.php)
 - if an object(e.g comments) does not have nesting specified it will extract some of its columns but once the nesting is specified e.g commens{likes} then one has to explicitely specify all its column in the nesting e.g. `comments{from,message,created_time,likes}`
 - for each row id is extracted autmatically and no need to be specified in the query
 - to extract all posts with its comments, subcomments,likes and sublikes the query would look like this:
 ```
 {
   "fields": "posts{message,story,created_time,likes,comments{from,message,created_time,comments,likes}}",
   "path": "",
   "ids": "<some_page_id>"

 }
 ```

### Async Insights Query

 Sometimes when extracting ads insights via nested query returns "Please reduce the amount of data you're asking for". In such case it is better to use `async-insights-query`, that extracts ads insights asynchronously and should deal with asking bigger amount of data. The query specification is similar nested query, however it only contains 2
 - `parameters` - URL query string specifiying ads insights parameters as described in https://developers.facebook.com/docs/marketing-api/reference/adgroup/insights/. The parameters are separated by `&`, e.g. `fields=ad_id,actions&level=ad&action_breakdowns=action_type&date_preset=last_month&time_increment=1`
 - `ids` - comma separated list of ids(typically page-ids) that will be prepended with path. It is also a parameter of graph api. If empty string than all ids from `accounts` object will be used. Can also be completely removed from the query.

#### Sample async insights query
```
{
  "id": 3,
  "name": "ads_async_insights",
  "type": "async-insights-query",
  "query": {
    "parameters": "fields=ad_id,actions&level=ad&action_breakdowns=action_type&date_preset=last_month&time_increment=1",
    "ids": "<page_id>"
  }
}
```

### Sample configuration:
Note that you can specify facebook api version via `api-version` parameter. Default is **v5.0**.

```
{
  "storage": {},
  "parameters": {
    "accounts": {
      "<pageId1>": {
        "id": "<pagId1>",
        "name": "my fancy page",
        "category": "entertainment"
      },
      "<pageId2>": {
        "id": "<pageId2>",
        "name": "keboola",
        "category": "software"
      }
    },
    "api-version": "v5.0",
    "queries": [
      {
        "id": 1,
        "name": "qname",
        "type": "nested-query",
        "query": {
          "path": "feed",
          "fields": "message,story,likes,comments{from}",
          "ids": "<pagId1>,<pageId2>"
        }
      },
      {
        "id": 3,
        "name": "ads_async_insights",
        "type": "async-insights-query",
        "query": {
          "parameters": "fields=ad_id,actions&level=ad&action_breakdowns=action_type&date_preset=last_month&time_increment=1",
          "ids": "<page_id>"
        }
      }
    ]
  },
  "authorization": {
    "oauth_api": {
      "id": "{OAUTH_API_ID}"
      }
    }
  }
```

## Result tables description
For each query extractor generates a number of tables prefixed with query name. Each table represents one type of node so typically tables would be `queryname_post`, `queryname_likes`, `queryname_comments` `queryname_insights`. Same nested structure type will be in the same table. So for example comments and subcomments will be in the same table `comments`. Every table has different columns but the following columns will always be the same:
- **id**: unique id of the row, some tables may not have it, e.g. ads insights
- **parent_id**: the parent node id, e.g. comments parent-id refers to a post row id
- **ex_account_id**: top root source under the extraction is beign done, it could be a page id or ads account id and it is specified in config under `ids` property.
- **fb_graph_node**: describes the row "vertical position" of the resulting tree. e.g for comments it will be `page_feed_comments`, for subcomments(i.e. comments of comments) it will be `page_feed_comments_comments` etc
- insights data objects will be flatten into columns `key1`, `key2` and `value` along with columns metric name, title, description etc


# Authorization
Register component api to oauth-bundle-v2 by calling POST to https://syrup.keboola.com/oauth-v2/manage with manage-token, storage-api token in the header and body:

```
{
  "component_id": "keboola.ex-facebook-insights-v2",
  "friendly_name": "Facebook Insights",
  "app_key": "xxx",
  "app_secret": "xxx",
  "oauth_version": "facebook",
  "permissions": "manage_pages,public_profile,read_insights,pages_show_list",
  "graph_api_version": "v2.8"

}
```

more info about authorization registration here: https://github.com/keboola/oauth-v2-bundle


# Development
The app is written in Clojure(1.8), evaluated and build via [Boot-clj](https://github.com/boot-clj/boot#install) which requires [Java Development Kit](http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html).
To try the app locally check target commands in the [Makefile](Makefile)
For example to build and run the app locally type from the repo root:

`make build-jar run-jar`

## License

MIT licensed, see [LICENSE](./LICENSE) file.


================================================
File: /.github/workflows/push.yml
================================================
name: GitHub Actions
on: [ push ]
concurrency: ci-${{ github.ref }} # to avoid tag collisions in the ECR
env:
  # Name of the image in the ECR
  APP_IMAGE: keboola/ex-facebook-graph-api

  # Developer portal login
  KBC_DEVELOPERPORTAL_VENDOR: "keboola"
  KBC_DEVELOPERPORTAL_APP_FB: "keboola.ex-facebook"
  KBC_DEVELOPERPORTAL_APP_FB_ADS: "keboola.ex-facebook-ads"
  KBC_DEVELOPERPORTAL_APP_INSTAGRAM: "keboola.ex-instagram"
  KBC_DEVELOPERPORTAL_USERNAME: "keboola+facebook_extractor_github_actions"
  KBC_DEVELOPERPORTAL_PASSWORD: ${{ secrets.KBC_DEVELOPERPORTAL_PASSWORD }}

  # DockerHub login
  DOCKERHUB_USER: "keboolabot"
  DOCKERHUB_TOKEN: ${{ secrets.DOCKERHUB_TOKEN }}

  # Test KBC project
  KBC_STORAGE_TOKEN: ${{ secrets.KBC_STORAGE_TOKEN }}
  KBC_TEST_PROJECT_URL: "https://connection.keboola.com/admin/projects/395"
  KBC_TEST_PROJECT_CONFIGS_FB: "348767954" # space separated list
  KBC_TEST_PROJECT_CONFIGS_FB_ADS: "395964032" # space separated list
jobs:
  build:
    runs-on: ubuntu-latest
    outputs:
      app_image_tag: ${{ steps.tag.outputs.app_image_tag }}
      is_semantic_tag: ${{ steps.tag.outputs.is_semantic_tag }}
    steps:
      -
        name: Check out the repo
        uses: actions/checkout@v2
      -
        name: Print Docker version
        run: docker -v
      -
        name: Docker login
        if: env.DOCKERHUB_TOKEN
        run: docker login --username "$DOCKERHUB_USER" --password "$DOCKERHUB_TOKEN"
      -
        name: Build image
        run: docker build -t $APP_IMAGE .
      -
        name: Set image tag
        id: tag
        run: |
          TAG="${GITHUB_REF##*/}"
          IS_SEMANTIC_TAG=$(echo "$TAG" | grep -q '^v\?[0-9]\+\.[0-9]\+\.[0-9]\+$' && echo true || echo false)
          echo "Tag = '$TAG', is semantic tag = '$IS_SEMANTIC_TAG'"
          echo "::set-output name=app_image_tag::$TAG"
          echo "::set-output name=is_semantic_tag::$IS_SEMANTIC_TAG"
      -
        name: Push Facebook ads extractor image to ECR
        uses: keboola/action-push-to-ecr@master
        with:
          vendor: ${{ env.KBC_DEVELOPERPORTAL_VENDOR }}
          app_id: ${{ env.KBC_DEVELOPERPORTAL_APP_FB }}
          username: ${{ env.KBC_DEVELOPERPORTAL_USERNAME }}
          password: ${{ env.KBC_DEVELOPERPORTAL_PASSWORD }}
          tag: ${{ steps.tag.outputs.app_image_tag }}
          push_latest: ${{ steps.tag.outputs.is_semantic_tag }}
          source_image: ${{ env.APP_IMAGE}}

      - name: Push Facebook ads extractor image to ECR
        uses: keboola/action-push-to-ecr@master
        with:
          vendor: ${{ env.KBC_DEVELOPERPORTAL_VENDOR }}
          app_id: ${{ env.KBC_DEVELOPERPORTAL_APP_FB_ADS }}
          username: ${{ env.KBC_DEVELOPERPORTAL_USERNAME }}
          password: ${{ env.KBC_DEVELOPERPORTAL_PASSWORD }}
          tag: ${{ steps.tag.outputs.app_image_tag }}
          push_latest: ${{ steps.tag.outputs.is_semantic_tag }}
          source_image: ${{ env.APP_IMAGE}}

      - name: Push Instagram extractor image to ECR
        uses: keboola/action-push-to-ecr@master
        with:
          vendor: ${{ env.KBC_DEVELOPERPORTAL_VENDOR }}
          app_id: ${{ env.KBC_DEVELOPERPORTAL_APP_INSTAGRAM }}
          username: ${{ env.KBC_DEVELOPERPORTAL_USERNAME }}
          password: ${{ env.KBC_DEVELOPERPORTAL_PASSWORD }}
          tag: ${{ steps.tag.outputs.app_image_tag }}
          push_latest: ${{ steps.tag.outputs.is_semantic_tag }}
          source_image: ${{ env.APP_IMAGE}}

  tests:
    needs: build
    runs-on: ubuntu-latest
    steps:
      -
        name: Check out the repo
        uses: actions/checkout@v2
      -
        name: Pull image from ECR
        uses: keboola/action-pull-from-ecr@master
        with:
          vendor: ${{ env.KBC_DEVELOPERPORTAL_VENDOR }}
          app_id: ${{ env.KBC_DEVELOPERPORTAL_APP_FB }}
          username: ${{ env.KBC_DEVELOPERPORTAL_USERNAME }}
          password: ${{ env.KBC_DEVELOPERPORTAL_PASSWORD }}
          tag: ${{ needs.build.outputs.app_image_tag }}
          target_image: ${{ env.APP_IMAGE}}
          tag_as_latest: true
      -
        name: Run tests
        run: docker run ${{env.APP_IMAGE}} boot test

  tests-in-kbc:
    needs: build
    runs-on: ubuntu-latest
    steps:
      -
        name: Run KBC test jobs (FB Extractor)
        if: env.KBC_STORAGE_TOKEN && env.KBC_TEST_PROJECT_CONFIGS_FB
        uses: keboola/action-run-configs-parallel@master
        with:
          token: ${{ env.KBC_STORAGE_TOKEN }}
          componentId: ${{ env.KBC_DEVELOPERPORTAL_APP_FB }}
          tag: ${{ needs.build.outputs.app_image_tag }}
          configs: ${{ env.KBC_TEST_PROJECT_CONFIGS_FB }}

      -
        name: Run KBC test jobs (FB Ads Extractor)
        if: env.KBC_STORAGE_TOKEN && env.KBC_TEST_PROJECT_CONFIGS_FB_ADS
        uses: keboola/action-run-configs-parallel@master
        with:
          token: ${{ env.KBC_STORAGE_TOKEN }}
          componentId: ${{ env.KBC_DEVELOPERPORTAL_APP_FB_ADS }}
          tag: ${{ needs.build.outputs.app_image_tag }}
          configs: ${{ env.KBC_TEST_PROJECT_CONFIGS_FB_ADS }}

  deploy:
    needs:
      - build
      - tests
      - tests-in-kbc
    runs-on: ubuntu-latest
    if: startsWith(github.ref, 'refs/tags/') && needs.build.outputs.is_semantic_tag == 'true'
    steps:
      -
        name: Set tag in the Deloper Portal (Facebook Extractor)
        uses: keboola/action-set-tag-developer-portal@master
        with:
          vendor: ${{ env.KBC_DEVELOPERPORTAL_VENDOR }}
          app_id: ${{ env.KBC_DEVELOPERPORTAL_APP_FB }}
          username: ${{ env.KBC_DEVELOPERPORTAL_USERNAME }}
          password: ${{ env.KBC_DEVELOPERPORTAL_PASSWORD }}
          tag: ${{ needs.build.outputs.app_image_tag }}

      -
        name: Set tag in the Deloper Portal (Facebook Ads Extractor)
        uses: keboola/action-set-tag-developer-portal@master
        with:
          vendor: ${{ env.KBC_DEVELOPERPORTAL_VENDOR }}
          app_id: ${{ env.KBC_DEVELOPERPORTAL_APP_FB_ADS }}
          username: ${{ env.KBC_DEVELOPERPORTAL_USERNAME }}
          password: ${{ env.KBC_DEVELOPERPORTAL_PASSWORD }}
          tag: ${{ needs.build.outputs.app_image_tag }}

      -
        name: Set tag in the Deloper Portal (Instagram Extractor)
        uses: keboola/action-set-tag-developer-portal@master
        with:
          vendor: ${{ env.KBC_DEVELOPERPORTAL_VENDOR }}
          app_id: ${{ env.KBC_DEVELOPERPORTAL_APP_INSTAGRAM }}
          username: ${{ env.KBC_DEVELOPERPORTAL_USERNAME }}
          password: ${{ env.KBC_DEVELOPERPORTAL_PASSWORD }}
          tag: ${{ needs.build.outputs.app_image_tag }}


================================================
File: /test/keboola/utils/json_to_csv_test.clj
================================================
(ns keboola.utils.json-to-csv-test
  (:require [keboola.utils.json-to-csv :as sut]
            [keboola.test-utils.core :refer [test-and-check]]
            [clojure.test :refer :all]))

(deftest test-replace-dash
  (is (test-and-check `sut/replace-dash 20)))

(deftest test-prepare-kw-map
  (is (test-and-check `sut/prepare-kw-map 20)))

(deftest test-underscorize
  (is (test-and-check `sut/underscorize 20)))


================================================
File: /test/keboola/snapshots/feedsummary/apicalls.clj
================================================
(ns keboola.snapshots.feedsummary.apicalls)
(def recorded 
{
{:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/feed?fields=reactions.type%28LIKE%29.summary%28total_count%29.limit%280%29&since=15+months+ago&access_token=XXTOKENXX&limit=25&until=1491510469&__paging_token=enc_AdD1oKv62UShBGNFboAc4BJQnLMmQe5XbMXmjpmZAZCaEHTBgxi82ZCTM1ZB7nLSbl6f36azCbkjDLTupuX2RnnefrSEwI2oqRAkV0bPk89hPV1fGgZDZD",
 :as :json}
(fn [req]{:status 200, :body "{\"data\":[]}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/222838661196260/feed?fields=reactions.type%28LIKE%29.summary%28total_count%29.limit%280%29&limit=25&since=15+months+ago&__paging_token=enc_AdD6exG837adWHWfiNZCh9E5jFhpIWpZCyUchp2ZBtGYx3mWG93ylygF8GHU2uHa16T04GVCDubzzswdTnLRnZBanz0W1yxhdzw5saXUF6xFyPrSjAZDZD&access_token=XXTOKENXX&until=1477415790",
 :as :json}
(fn [req]{:status 200, :body "{\"data\":[]}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/222838661196260/feed?fields=reactions.type%28LIKE%29.summary%28total_count%29.limit%280%29&since=15+months+ago&access_token=XXTOKENXX&limit=25&until=1489004402&__paging_token=enc_AdCuBoNYLUHevwT3vXrsR6y8qggK9gZC0h6niHFIdwpcHSEEJE4ZA0XrureBrHVIj16XPvG6zCxZCOuXTIF6Ouan6OlE8VYnUM2rbKv7isdwcR0ZBgZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"222838661196260_1102748413205276\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1102622523217865\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}}},{\"id\":\"222838661196260_1101117760035008\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}}},{\"id\":\"222838661196260_1095366693943448\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":9}}},{\"id\":\"222838661196260_1088426111304173\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}}},{\"id\":\"222838661196260_1085738481572936\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1082965645183553\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1077902842356500\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1071468542999930\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}}},{\"id\":\"222838661196260_1369870156416993\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}}},{\"id\":\"222838661196260_1047848388695279\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1024914097655375\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}}},{\"id\":\"222838661196260_1020713021408816\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}}},{\"id\":\"222838661196260_1019388544874597\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1005566356256816\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":11}}},{\"id\":\"222838661196260_1341134989232514\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/222838661196260/feed?fields=reactions.type%28LIKE%29.summary%28total_count%29.limit%280%29&limit=25&since=1489002753&__paging_token=enc_AdCf79If9Q1cYmZBtUEYntE6ZA9GoN9XDLweRMPp4y4bB5t1GsHpIzSYb3ofnYIp8W9n4QkxuqFwpxJJp8uu2B2TAMGqjMYVd0UtbqS8v0ErqStQZDZD&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/222838661196260/feed?fields=reactions.type%28LIKE%29.summary%28total_count%29.limit%280%29&limit=25&since=15+months+ago&__paging_token=enc_AdD6exG837adWHWfiNZCh9E5jFhpIWpZCyUchp2ZBtGYx3mWG93ylygF8GHU2uHa16T04GVCDubzzswdTnLRnZBanz0W1yxhdzw5saXUF6xFyPrSjAZDZD&access_token=XXTOKENXX&until=1477415790\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v2.8/feed",
 :as :json,
 :query-params
 {:since "15 months ago",
  :until "now",
  :path "feed",
  :fields "reactions.type(LIKE).summary(total_count).limit(0)",
  :ids "222838661196260,177057932317550",
  :access_token "XXTOKENXX"}}
(fn [req]{:status 200,
 :body
 "{\"222838661196260\":{\"data\":[{\"id\":\"222838661196260_1297263780420404\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}}},{\"id\":\"222838661196260_1295611950585587\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1284921258321323\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}}},{\"id\":\"222838661196260_1275430289270420\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}}},{\"id\":\"222838661196260_1272432166236899\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1272431919570257\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1272431639570285\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}}},{\"id\":\"222838661196260_144808662915978\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1268621089951340\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":6}}},{\"id\":\"222838661196260_1261976987282417\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1261140494032733\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":6}}},{\"id\":\"222838661196260_1257750477705068\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1256173724529410\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}}},{\"id\":\"222838661196260_1219971791482937\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}}},{\"id\":\"222838661196260_1169662839847166\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1166746836805433\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1166746623472121\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1117831915030259\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}}},{\"id\":\"222838661196260_1116959565117494\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1108005789346205\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}}},{\"id\":\"222838661196260_1107482036065247\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1107481849398599\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_1260350687419830\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"222838661196260_412927135725672\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}}},{\"id\":\"222838661196260_1102759903204127\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/222838661196260/feed?fields=reactions.type%28LIKE%29.summary%28total_count%29.limit%280%29&since=1513250622&access_token=XXTOKENXX&limit=25&__paging_token=enc_AdBMth1ZBGix7nrlHzm9YYnFHOoJaRthpYdeNNpZC3lRIIfQwSnPWyo8xaCR30FbKOZCUv2Qq8nHFaruopjLaez3E2lBFQPuOmZByacHJRqtLHP69QZDZD&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/222838661196260/feed?fields=reactions.type%28LIKE%29.summary%28total_count%29.limit%280%29&since=15+months+ago&access_token=XXTOKENXX&limit=25&until=1489004402&__paging_token=enc_AdCuBoNYLUHevwT3vXrsR6y8qggK9gZC0h6niHFIdwpcHSEEJE4ZA0XrureBrHVIj16XPvG6zCxZCOuXTIF6Ouan6OlE8VYnUM2rbKv7isdwcR0ZBgZDZD\"}},\"177057932317550\":{\"data\":[{\"id\":\"177057932317550_1528270233862973\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"177057932317550_1920132124904149\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}}},{\"id\":\"177057932317550_200219200511028\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"177057932317550_1478486035508060\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}}},{\"id\":\"177057932317550_1477131262310204\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"177057932317550_177062472317096\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}}},{\"id\":\"177057932317550_10155365834019810\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":22}}},{\"id\":\"177057932317550_1379478452075486\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/feed?fields=reactions.type%28LIKE%29.summary%28total_count%29.limit%280%29&since=1504731236&access_token=XXTOKENXX&limit=25&__paging_token=enc_AdCblm5DxAYalGbkvNQeoMZAf7xBZBUGbpBvocQACIvFinGIcpelcRK4BKIpZA94s9uraoZBBJPKGV0T7cOgH3ej2UyQxJz1j47ZBK9ZB7WJHzXplCtwZDZD&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/feed?fields=reactions.type%28LIKE%29.summary%28total_count%29.limit%280%29&since=15+months+ago&access_token=XXTOKENXX&limit=25&until=1491510469&__paging_token=enc_AdD1oKv62UShBGNFboAc4BJQnLMmQe5XbMXmjpmZAZCaEHTBgxi82ZCTM1ZB7nLSbl6f36azCbkjDLTupuX2RnnefrSEwI2oqRAkV0bPk89hPV1fGgZDZD\"}}}"}
)
})

================================================
File: /test/keboola/snapshots/feedsummary/test_feedsummary.clj
================================================
(ns keboola.snapshots.feedsummary.test-feedsummary
  (:require [keboola.snapshots.feedsummary.apicalls :as apicalls]
            [clojure.test :as t :refer :all]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.test-utils.core :as test-utils]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            )
  (:use clj-http.fake))

(deftest feedsummary-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "feedsummary"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "test/keboola/snapshots/feedsummary")
    (test-utils/copy-config-tmp "test/keboola/snapshots/feedsummary" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "test/keboola/snapshots/feedsummary" tmp-dir)
      )))

================================================
File: /test/keboola/snapshots/feedsummary/out/tables/feed_likes_summary/1516621525270
================================================
"177057932317550","page_feed_reactions","177057932317550_1379478452075486","2"
"177057932317550","page_feed_reactions","177057932317550_10155365834019810","22"
"177057932317550","page_feed_reactions","177057932317550_177062472317096","0"
"177057932317550","page_feed_reactions","177057932317550_1477131262310204","0"
"177057932317550","page_feed_reactions","177057932317550_1478486035508060","5"
"177057932317550","page_feed_reactions","177057932317550_200219200511028","0"
"177057932317550","page_feed_reactions","177057932317550_1920132124904149","4"
"177057932317550","page_feed_reactions","177057932317550_1528270233862973","0"
"222838661196260","page_feed_reactions","222838661196260_1341134989232514","0"
"222838661196260","page_feed_reactions","222838661196260_1005566356256816","11"
"222838661196260","page_feed_reactions","222838661196260_1019388544874597","0"
"222838661196260","page_feed_reactions","222838661196260_1020713021408816","4"
"222838661196260","page_feed_reactions","222838661196260_1024914097655375","5"
"222838661196260","page_feed_reactions","222838661196260_1047848388695279","0"
"222838661196260","page_feed_reactions","222838661196260_1369870156416993","2"
"222838661196260","page_feed_reactions","222838661196260_1071468542999930","2"
"222838661196260","page_feed_reactions","222838661196260_1077902842356500","0"
"222838661196260","page_feed_reactions","222838661196260_1082965645183553","0"
"222838661196260","page_feed_reactions","222838661196260_1085738481572936","0"
"222838661196260","page_feed_reactions","222838661196260_1088426111304173","3"
"222838661196260","page_feed_reactions","222838661196260_1095366693943448","9"
"222838661196260","page_feed_reactions","222838661196260_1101117760035008","2"
"222838661196260","page_feed_reactions","222838661196260_1102622523217865","4"
"222838661196260","page_feed_reactions","222838661196260_1102748413205276","0"
"222838661196260","page_feed_reactions","222838661196260_1102759903204127","0"
"222838661196260","page_feed_reactions","222838661196260_412927135725672","3"
"222838661196260","page_feed_reactions","222838661196260_1260350687419830","0"
"222838661196260","page_feed_reactions","222838661196260_1107481849398599","0"
"222838661196260","page_feed_reactions","222838661196260_1107482036065247","0"
"222838661196260","page_feed_reactions","222838661196260_1108005789346205","1"
"222838661196260","page_feed_reactions","222838661196260_1116959565117494","0"
"222838661196260","page_feed_reactions","222838661196260_1117831915030259","2"
"222838661196260","page_feed_reactions","222838661196260_1166746623472121","0"
"222838661196260","page_feed_reactions","222838661196260_1166746836805433","0"
"222838661196260","page_feed_reactions","222838661196260_1169662839847166","0"
"222838661196260","page_feed_reactions","222838661196260_1219971791482937","1"
"222838661196260","page_feed_reactions","222838661196260_1256173724529410","5"
"222838661196260","page_feed_reactions","222838661196260_1257750477705068","0"
"222838661196260","page_feed_reactions","222838661196260_1261140494032733","6"
"222838661196260","page_feed_reactions","222838661196260_1261976987282417","0"
"222838661196260","page_feed_reactions","222838661196260_1268621089951340","6"
"222838661196260","page_feed_reactions","222838661196260_144808662915978","0"
"222838661196260","page_feed_reactions","222838661196260_1272431639570285","3"
"222838661196260","page_feed_reactions","222838661196260_1272431919570257","0"
"222838661196260","page_feed_reactions","222838661196260_1272432166236899","0"
"222838661196260","page_feed_reactions","222838661196260_1275430289270420","3"
"222838661196260","page_feed_reactions","222838661196260_1284921258321323","5"
"222838661196260","page_feed_reactions","222838661196260_1295611950585587","0"
"222838661196260","page_feed_reactions","222838661196260_1297263780420404","5"


================================================
File: /test/keboola/snapshots/feedsummary/out/tables/feed_likes_summary.manifest
================================================
{"columns":["ex-account-id","fb-graph-node","parent-id","total_count"],"incremental":true,"primary_key":["parent_id"]}

================================================
File: /test/keboola/snapshots/feedsummary/out/tables/accounts
================================================
category,name,id
entertaiment,hudebny sh,222838661196260
software,keboola,177057932317550


================================================
File: /test/keboola/snapshots/feedsummary/config.json
================================================
{
  "storage" : { },
  "parameters" : {
    "accounts" : {
      "222838661196260" : {
        "id" : "222838661196260",
        "name" : "hudebny sh",
        "category" : "entertaiment"
      },
      "177057932317550" : {
        "id" : "177057932317550",
        "name" : "keboola",
        "category" : "software"
      }
    },
    "api-version" : "v2.8",
    "queries" : [ {
      "name" : "feed_likes",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "since" : "15 months ago",
        "until" : "now",
        "path" : "feed",
        "fields" : "reactions.type(LIKE).summary(total_count).limit(0)",
        "ids" : null
      }
    } ]
  },
  "authorization" : {
    "oauth_api" : {
      "id" : "keboola.ex-facebook",
      "credentials" : {
        "id" : "main",
        "authorizedFor" : "Myself",
        "creator" : {
          "id" : "1234",
          "description" : "me@keboola.com"
        },
        "created" : "2016-01-31 00:13:30",
        "oauthVersion" : "facebook",
        "appKey" : "xxx",
        "#data" : "{\"token\":\"XXTOKENXX\"}",
        "#appSecret" : "KBC::Encrypted==ENCODEDSTRING=="
      }
    }
  }
}

================================================
File: /test/keboola/snapshots/feed/test_feed.clj
================================================
(ns keboola.snapshots.feed.test-feed
  (:require [keboola.snapshots.feed.apicalls :as apicalls]
            [clojure.test :as t :refer :all]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.test-utils.core :as test-utils]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            )
  (:use clj-http.fake))

(deftest feed-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "feed"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "test/keboola/snapshots/feed")
    (test-utils/copy-config-tmp "test/keboola/snapshots/feed" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "test/keboola/snapshots/feed" tmp-dir)
      )))

================================================
File: /test/keboola/snapshots/feed/apicalls.clj
================================================
(ns keboola.snapshots.feed.apicalls)
(def recorded 
{
{:method :get,
 :address
 "https://graph.facebook.com/v2.11/177057932317550/feed?access_token=XXTOKENXX&fields=caption%2Cmessage%2Ccreated_time%2Ctype%2Cdescription%2Clikes%7Bname%2Cusername%7D%2Ccomments%7Bmessage%2Ccreated_time%2Cfrom%2Clikes%7Bname%2Cusername%7D%7D&since=3+years+ago&until=now&limit=25&after=Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5TXhOemN3TlRjNU16SXpNVGMxTlRBNkxUUTBPRFUzTmpVeE9EQXdOREV4TVRVeE9ROE1ZAWEJwWDNOMGIzSjVYMmxrRHg4eE56Y3dOVGM1TXpJek1UYzFOVEJmT0RZANE1EZAzBNVFV6TWpFME9USXhEd1IwYVcxbEJsVFB0QjRC",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"caption\":\"obTSR\",\"message\":\"0kzPw\",\"created_time\":\"2015-02-02T08:52:14+0000\",\"type\":\"link\",\"description\":\"JWWW4\",\"id\":\"177057932317550_867918849898118\"},{\"caption\":\"TOODK\",\"message\":\"O7mBO\",\"created_time\":\"2015-02-01T22:50:49+0000\",\"type\":\"link\",\"description\":\"tlKaK\",\"id\":\"177057932317550_867662119923791\"},{\"caption\":\"MoUVi\",\"message\":\"rN5UJ\",\"created_time\":\"2015-01-22T16:06:00+0000\",\"type\":\"link\",\"description\":\"QUkJ7\",\"id\":\"177057932317550_863179447038725\"}],\"paging\":{\"cursors\":{\"before\":\"Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5TXhOemN3TlRjNU16SXpNVGMxTlRBNkxUSTBOakk0TmpNMU16VTROREF3T1RFd05ROE1ZAWEJwWDNOMGIzSjVYMmxrRHg4eE56Y3dOVGM1TXpJek1UYzFOVEJmT0RZAM09URTRPRFE1T0RrNE1URTREd1IwYVcxbEJsVFBPcjRC\",\"after\":\"Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5UXhOemN3TlRjNU16SXpNVGMxTlRBNkxUY3hNakV3T1RFek56azNOVGM0T1RFeU1EY1BER0ZA3YVY5emRHOXllVjlwWkE4ZAk1UYzNNRFUzT1RNeU16RTNOVFV3WHpnMk16RTNPVFEwTnpBek9EY3lOUThFZAEdsdFpRWlV3Ui9vQVE9PQZDZD\"},\"previous\":\"https://graph.facebook.com/v2.11/177057932317550/feed?access_token=XXTOKENXX&fields=caption%2Cmessage%2Ccreated_time%2Ctype%2Cdescription%2Clikes%7Bname%2Cusername%7D%2Ccomments%7Bmessage%2Ccreated_time%2Cfrom%2Clikes%7Bname%2Cusername%7D%7D&since=3+years+ago&until=now&limit=25&before=Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5TXhOemN3TlRjNU16SXpNVGMxTlRBNkxUSTBOakk0TmpNMU16VTROREF3T1RFd05ROE1ZAWEJwWDNOMGIzSjVYMmxrRHg4eE56Y3dOVGM1TXpJek1UYzFOVEJmT0RZAM09URTRPRFE1T0RrNE1URTREd1IwYVcxbEJsVFBPcjRC\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.11/177057932317550/feed?access_token=XXTOKENXX&fields=caption%2Cmessage%2Ccreated_time%2Ctype%2Cdescription%2Clikes%7Bname%2Cusername%7D%2Ccomments%7Bmessage%2Ccreated_time%2Cfrom%2Clikes%7Bname%2Cusername%7D%7D&since=3+years+ago&until=now&limit=25&after=Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5UXhOemN3TlRjNU16SXpNVGMxTlRBNkxURTBOREV5TVRneU1UUTVOamt4TURJeU16SVBER0ZA3YVY5emRHOXllVjlwWkE4ZAk1UYzNNRFUzT1RNeU16RTNOVFV3WHpnNU9URXdORGcwTXpRME5qRTROUThFZAEdsdFpRWlZAIWUl5QVE9PQZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"caption\":\"hDQL5\",\"message\":\"dsSlg\",\"created_time\":\"2015-04-01T23:26:00+0000\",\"type\":\"link\",\"description\":\"ETRtQ\",\"id\":\"177057932317550_898705676819435\"},{\"caption\":\"x0Leb\",\"message\":\"eeh6Q\",\"created_time\":\"2015-04-01T04:52:15+0000\",\"type\":\"link\",\"description\":\"M5qHU\",\"id\":\"177057932317550_898322620191074\"},{\"caption\":\"wd4eW\",\"message\":\"Ih4zf\",\"created_time\":\"2015-04-01T01:22:18+0000\",\"type\":\"link\",\"description\":\"pB4mm\",\"id\":\"177057932317550_898249010198435\"},{\"caption\":\"YLFUs\",\"message\":\"gp8wX\",\"created_time\":\"2015-03-31T08:56:02+0000\",\"type\":\"link\",\"description\":\"xk53D\",\"id\":\"177057932317550_897828396907163\"},{\"caption\":\"P1SRB\",\"message\":\"I84Tz\",\"created_time\":\"2015-03-27T15:31:12+0000\",\"type\":\"link\",\"description\":\"IncFv\",\"id\":\"177057932317550_895669693789700\"},{\"caption\":\"6norZ\",\"message\":\"0OBCV\",\"created_time\":\"2015-03-27T13:59:19+0000\",\"type\":\"link\",\"description\":\"YMgXa\",\"id\":\"177057932317550_895638570459479\"},{\"caption\":\"Q3LcJ\",\"message\":\"FJiGM\",\"created_time\":\"2015-03-26T19:54:02+0000\",\"type\":\"link\",\"description\":\"3lzUN\",\"id\":\"177057932317550_895172080506128\"},{\"caption\":\"w0ysY\",\"message\":\"D3XJ2\",\"created_time\":\"2015-03-26T19:20:42+0000\",\"type\":\"link\",\"description\":\"VoUzP\",\"id\":\"177057932317550_895159487174054\"},{\"caption\":\"G5OF8\",\"message\":\"i60mK\",\"created_time\":\"2015-03-26T09:38:34+0000\",\"type\":\"link\",\"description\":\"RzIc3\",\"id\":\"177057932317550_894908463865823\"},{\"caption\":\"m43yp\",\"message\":\"7B6pQ\",\"created_time\":\"2015-03-25T18:39:57+0000\",\"type\":\"link\",\"description\":\"OjJy5\",\"id\":\"177057932317550_894591280564208\"},{\"message\":\"XJXV3\",\"created_time\":\"2015-03-19T02:27:18+0000\",\"type\":\"photo\",\"id\":\"177057932317550_890214517668551\"},{\"caption\":\"sHB38\",\"message\":\"g0kbV\",\"created_time\":\"2015-03-05T14:15:36+0000\",\"type\":\"link\",\"description\":\"FDzCS\",\"id\":\"177057932317550_882565748433428\"},{\"caption\":\"sGhkz\",\"message\":\"THiDT\",\"created_time\":\"2015-02-27T18:53:14+0000\",\"type\":\"link\",\"description\":\"5qNaz\",\"id\":\"177057932317550_880197812003555\"},{\"caption\":\"rUc3R\",\"message\":\"63vKu\",\"created_time\":\"2015-02-24T16:55:24+0000\",\"type\":\"link\",\"description\":\"Nyb3l\",\"id\":\"177057932317550_878834132139923\"},{\"caption\":\"olONV\",\"message\":\"T8f6s\",\"created_time\":\"2015-02-24T10:49:45+0000\",\"type\":\"link\",\"description\":\"IH8FT\",\"id\":\"177057932317550_878717075484962\"},{\"caption\":\"jW53B\",\"message\":\"P4GzX\",\"created_time\":\"2015-02-20T19:01:57+0000\",\"type\":\"link\",\"description\":\"ki8t1\",\"id\":\"177057932317550_876759985680671\"},{\"caption\":\"aYyDG\",\"message\":\"PzGFC\",\"created_time\":\"2015-02-19T22:57:01+0000\",\"type\":\"link\",\"description\":\"oNCUx\",\"id\":\"177057932317550_876391385717531\"},{\"caption\":\"20yg1\",\"message\":\"54qbI\",\"created_time\":\"2015-02-19T21:42:46+0000\",\"type\":\"link\",\"description\":\"06Ejk\",\"id\":\"177057932317550_876365615720108\"},{\"caption\":\"Jcr3G\",\"message\":\"m3hJh\",\"created_time\":\"2015-02-11T12:46:47+0000\",\"type\":\"link\",\"description\":\"6ziKG\",\"id\":\"177057932317550_871770149512988\"},{\"caption\":\"sPl83\",\"message\":\"Wbfgj\",\"created_time\":\"2015-02-10T23:04:55+0000\",\"type\":\"link\",\"description\":\"VaLf1\",\"id\":\"177057932317550_871542359535767\"},{\"caption\":\"8cQiu\",\"message\":\"IaYBi\",\"created_time\":\"2015-02-10T09:06:05+0000\",\"type\":\"link\",\"description\":\"eFikT\",\"id\":\"177057932317550_871299946226675\"},{\"caption\":\"P5xhN\",\"message\":\"6CPSm\",\"created_time\":\"2015-02-04T08:47:55+0000\",\"type\":\"link\",\"description\":\"TlTHw\",\"id\":\"177057932317550_868726169817386\"},{\"caption\":\"coxVD\",\"message\":\"t1TNL\",\"created_time\":\"2015-02-04T08:19:07+0000\",\"type\":\"link\",\"description\":\"0XtVU\",\"id\":\"177057932317550_868721253151211\"},{\"caption\":\"MK4jq\",\"message\":\"GHYIM\",\"created_time\":\"2015-02-03T01:03:20+0000\",\"type\":\"link\",\"description\":\"abWhz\",\"id\":\"177057932317550_868201209869882\"},{\"caption\":\"eE4uR\",\"message\":\"iEx5Z\",\"created_time\":\"2015-02-02T17:30:06+0000\",\"type\":\"link\",\"id\":\"177057932317550_868084153214921\"}],\"paging\":{\"cursors\":{\"before\":\"Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5TXhOemN3TlRjNU16SXpNVGMxTlRBNk5qTXhOVEk1TnpFM05qUTRNRGc0TWpBeU9ROE1ZAWEJwWDNOMGIzSjVYMmxrRHg4eE56Y3dOVGM1TXpJek1UYzFOVEJmT0RrNE56QTFOamMyT0RFNU5ETTFEd1IwYVcxbEJsVWNmb2dC\",\"after\":\"Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5TXhOemN3TlRjNU16SXpNVGMxTlRBNkxUUTBPRFUzTmpVeE9EQXdOREV4TVRVeE9ROE1ZAWEJwWDNOMGIzSjVYMmxrRHg4eE56Y3dOVGM1TXpJek1UYzFOVEJmT0RZANE1EZAzBNVFV6TWpFME9USXhEd1IwYVcxbEJsVFB0QjRC\"},\"next\":\"https://graph.facebook.com/v2.11/177057932317550/feed?access_token=XXTOKENXX&fields=caption%2Cmessage%2Ccreated_time%2Ctype%2Cdescription%2Clikes%7Bname%2Cusername%7D%2Ccomments%7Bmessage%2Ccreated_time%2Cfrom%2Clikes%7Bname%2Cusername%7D%7D&since=3+years+ago&until=now&limit=25&after=Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5TXhOemN3TlRjNU16SXpNVGMxTlRBNkxUUTBPRFUzTmpVeE9EQXdOREV4TVRVeE9ROE1ZAWEJwWDNOMGIzSjVYMmxrRHg4eE56Y3dOVGM1TXpJek1UYzFOVEJmT0RZANE1EZAzBNVFV6TWpFME9USXhEd1IwYVcxbEJsVFB0QjRC\",\"previous\":\"https://graph.facebook.com/v2.11/177057932317550/feed?access_token=XXTOKENXX&fields=caption%2Cmessage%2Ccreated_time%2Ctype%2Cdescription%2Clikes%7Bname%2Cusername%7D%2Ccomments%7Bmessage%2Ccreated_time%2Cfrom%2Clikes%7Bname%2Cusername%7D%7D&since=3+years+ago&until=now&limit=25&before=Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5TXhOemN3TlRjNU16SXpNVGMxTlRBNk5qTXhOVEk1TnpFM05qUTRNRGc0TWpBeU9ROE1ZAWEJwWDNOMGIzSjVYMmxrRHg4eE56Y3dOVGM1TXpJek1UYzFOVEJmT0RrNE56QTFOamMyT0RFNU5ETTFEd1IwYVcxbEJsVWNmb2dC\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v2.11/feed",
 :as :json,
 :query-params
 {:path "feed",
  :fields
  "caption,message,created_time,type,description,likes{name,username},comments{message,created_time,from,likes{name,username}}",
  :ids "177057932317550",
  :since "3 years ago",
  :until "now",
  :access_token "XXTOKENXX"}}
(fn [req]{:status 200,
 :body
 "{\"177057932317550\":{\"data\":[{\"created_time\":\"2017-09-06T20:53:56+0000\",\"type\":\"photo\",\"id\":\"177057932317550_1528270307196299\"},{\"caption\":\"XTs78\",\"message\":\"8EIgi\",\"created_time\":\"2017-09-04T11:15:47+0000\",\"type\":\"event\",\"description\":\"ISHXC\",\"id\":\"177057932317550_1920132124904149\"},{\"caption\":\"BvW1U\",\"message\":\"zSiDU\",\"created_time\":\"2017-07-19T03:17:27+0000\",\"type\":\"event\",\"description\":\"XskdM\",\"id\":\"177057932317550_200219200511028\"},{\"message\":\"XU1Pt\",\"created_time\":\"2017-07-14T17:50:48+0000\",\"type\":\"photo\",\"comments\":{\"data\":[{\"message\":\"VSZDW\",\"created_time\":\"2017-07-14T20:05:10+0000\",\"from\":{\"name\":\"2bh8M\",\"id\":\"177057932317550\"},\"id\":\"1478486035508060_1478596215497042\"}],\"paging\":{\"cursors\":{\"before\":\"WTI5dGJXVnVkRjlqZAFhKemIzSTZANVFEzT0RVNU5qSXhOVFE1TnpBME1qb3hOVEF3TURZAeU56RXcZD\",\"after\":\"WTI5dGJXVnVkRjlqZAFhKemIzSTZANVFEzT0RVNU5qSXhOVFE1TnpBME1qb3hOVEF3TURZAeU56RXcZD\"}}},\"id\":\"177057932317550_1478486035508060\"},{\"message\":\"2qulO\",\"created_time\":\"2017-07-13T14:42:10+0000\",\"type\":\"photo\",\"comments\":{\"data\":[{\"message\":\"08glB\",\"created_time\":\"2017-07-13T16:51:54+0000\",\"id\":\"1477131262310204_1477461532277177\"}],\"paging\":{\"cursors\":{\"before\":\"WTI5dGJXVnVkRjlqZAFhKemIzSTZANVFEzTnpRMk1UVXpNakkzTnpFM056b3hORGs1T1RZAME56RTAZD\",\"after\":\"WTI5dGJXVnVkRjlqZAFhKemIzSTZANVFEzTnpRMk1UVXpNakkzTnpFM056b3hORGs1T1RZAME56RTAZD\"}}},\"id\":\"177057932317550_1477131262310204\"},{\"created_time\":\"2017-07-13T14:20:00+0000\",\"type\":\"photo\",\"id\":\"177057932317550_177062472317096\"},{\"message\":\"m9Mef\",\"created_time\":\"2017-05-25T22:38:42+0000\",\"type\":\"photo\",\"comments\":{\"data\":[{\"message\":\"ifSve\",\"created_time\":\"2017-05-25T22:46:44+0000\",\"id\":\"10155365834019810_10155365853274810\"}],\"paging\":{\"cursors\":{\"before\":\"WTI5dGJXVnVkRjlqZAFhKemIzSTZANVEF4TlRVek5qVTROVE15TnpRNE1UQTZANVFE1TlRjMU1qUXdOQT09\",\"after\":\"WTI5dGJXVnVkRjlqZAFhKemIzSTZANVEF4TlRVek5qVTROVE15TnpRNE1UQTZANVFE1TlRjMU1qUXdOQT09\"}}},\"id\":\"177057932317550_10155365834019810\"},{\"caption\":\"qycft\",\"message\":\"Ysr2x\",\"created_time\":\"2017-04-06T20:27:49+0000\",\"type\":\"link\",\"description\":\"XM11E\",\"id\":\"177057932317550_1379478452075486\"},{\"created_time\":\"2016-06-22T06:23:24+0000\",\"type\":\"video\",\"description\":\"Md2lK\",\"id\":\"177057932317550_1126854757337858\"},{\"caption\":\"axmGB\",\"message\":\"bXFqB\",\"created_time\":\"2016-02-10T14:10:10+0000\",\"type\":\"link\",\"description\":\"V7keH\",\"id\":\"177057932317550_10207570586690352\"},{\"message\":\"bllJY\",\"created_time\":\"2016-02-09T18:55:03+0000\",\"type\":\"status\",\"id\":\"177057932317550_1043848705638464\"},{\"message\":\"Qy6me\",\"created_time\":\"2015-10-14T05:03:09+0000\",\"type\":\"photo\",\"id\":\"177057932317550_990386480984687\"},{\"message\":\"F9OaB\",\"created_time\":\"2015-06-25T02:16:30+0000\",\"type\":\"photo\",\"id\":\"177057932317550_940984532591549\"},{\"message\":\"5osh1\",\"created_time\":\"2015-06-08T11:10:56+0000\",\"type\":\"photo\",\"comments\":{\"data\":[{\"message\":\"SOu8i\",\"created_time\":\"2015-06-08T12:22:04+0000\",\"id\":\"932914176731918_932938540062815\"},{\"message\":\"bmhBP\",\"created_time\":\"2015-06-08T16:50:01+0000\",\"id\":\"932914176731918_933040360052633\"},{\"message\":\"ZSyUO\",\"created_time\":\"2015-06-08T17:22:09+0000\",\"id\":\"932914176731918_933048243385178\"},{\"message\":\"Idp0c\",\"created_time\":\"2015-06-08T17:42:19+0000\",\"id\":\"932914176731918_933055010051168\"},{\"message\":\"spHHi\",\"created_time\":\"2015-06-08T17:44:02+0000\",\"id\":\"932914176731918_933055396717796\"},{\"message\":\"NIIOY\",\"created_time\":\"2015-06-08T17:51:05+0000\",\"id\":\"932914176731918_933056966717639\"},{\"message\":\"GIemL\",\"created_time\":\"2015-06-08T18:36:51+0000\",\"id\":\"932914176731918_933067250049944\"},{\"message\":\"grvPh\",\"created_time\":\"2015-06-08T20:02:57+0000\",\"id\":\"932914176731918_933149403375062\"},{\"message\":\"rp0IC\",\"created_time\":\"2015-06-08T20:04:40+0000\",\"id\":\"932914176731918_933149790041690\"},{\"message\":\"6UEzz\",\"created_time\":\"2015-06-08T22:37:41+0000\",\"id\":\"932914176731918_933191330037536\"},{\"message\":\"FpZoh\",\"created_time\":\"2015-06-09T13:24:55+0000\",\"from\":{\"name\":\"fiEi7\",\"id\":\"177057932317550\"},\"id\":\"932914176731918_933521926671143\"},{\"message\":\"LdJiP\",\"created_time\":\"2015-08-23T02:03:58+0000\",\"id\":\"932914176731918_967071379982864\"}],\"paging\":{\"cursors\":{\"before\":\"WTI5dGJXVnVkRjlqZAFhKemIzSTZAPVE15T1RNNE5UUXdNRFl5T0RFMU9qRTBNek0zTmpZAeE1qUT0ZD\",\"after\":\"WTI5dGJXVnVkRjlqZAFhKemIzSTZAPVFkzTURjeE16YzVPVGd5T0RZAME9qRTBOREF5T1RVME16ZAz0ZD\"}}},\"id\":\"177057932317550_932914176731918\"},{\"created_time\":\"2015-05-16T08:15:15+0000\",\"type\":\"photo\",\"id\":\"177057932317550_921776967845639\"},{\"created_time\":\"2015-05-16T06:54:46+0000\",\"type\":\"photo\",\"id\":\"177057932317550_921759614514041\"},{\"caption\":\"VpRap\",\"message\":\"kU1CX\",\"created_time\":\"2015-04-29T05:09:50+0000\",\"type\":\"link\",\"description\":\"VKkL1\",\"id\":\"177057932317550_913890861967583\"},{\"caption\":\"WLOKX\",\"message\":\"8e1tH\",\"created_time\":\"2015-04-28T09:40:20+0000\",\"type\":\"link\",\"description\":\"xNMkD\",\"id\":\"177057932317550_913371222019547\"},{\"caption\":\"geNPo\",\"message\":\"CO576\",\"created_time\":\"2015-04-23T08:10:30+0000\",\"type\":\"link\",\"description\":\"mptUF\",\"id\":\"177057932317550_910073965682606\"},{\"caption\":\"MywPj\",\"message\":\"gbll9\",\"created_time\":\"2015-04-20T10:55:26+0000\",\"type\":\"link\",\"description\":\"tQiat\",\"id\":\"177057932317550_908277042528965\"},{\"caption\":\"q1hfJ\",\"message\":\"Dev4K\",\"created_time\":\"2015-04-15T17:48:02+0000\",\"type\":\"link\",\"description\":\"HDxyF\",\"id\":\"177057932317550_905758402780829\"},{\"caption\":\"NuLrs\",\"message\":\"SPqMU\",\"created_time\":\"2015-04-10T09:20:52+0000\",\"type\":\"link\",\"description\":\"ZaYaF\",\"id\":\"177057932317550_903010183055651\"},{\"caption\":\"1qDpf\",\"message\":\"I7vhf\",\"created_time\":\"2015-04-08T06:32:14+0000\",\"type\":\"link\",\"description\":\"DO4HV\",\"id\":\"177057932317550_902157386474264\"},{\"caption\":\"kL4jo\",\"message\":\"KGLmo\",\"created_time\":\"2015-04-03T10:05:14+0000\",\"type\":\"link\",\"description\":\"ydoVL\",\"id\":\"177057932317550_899507860072550\"},{\"caption\":\"4qrUY\",\"message\":\"LLLXJ\",\"created_time\":\"2015-04-02T17:53:54+0000\",\"type\":\"link\",\"description\":\"Oylr4\",\"id\":\"177057932317550_899104843446185\"}],\"paging\":{\"cursors\":{\"before\":\"Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5TXhOemN3TlRjNU16SXpNVGMxTlRBNk5UTTVNek14T0RRek5URTBPRFkyTlRVeU1BOE1ZAWEJwWDNOMGIzSjVYMmxrRHlBeE56Y3dOVGM1TXpJek1UYzFOVEJmTVRVeU9ESTNNRE13TnpFNU5qSTVPUThFZAEdsdFpRWlpzR0JrQVE9PQZDZD\",\"after\":\"Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5UXhOemN3TlRjNU16SXpNVGMxTlRBNkxURTBOREV5TVRneU1UUTVOamt4TURJeU16SVBER0ZA3YVY5emRHOXllVjlwWkE4ZAk1UYzNNRFUzT1RNeU16RTNOVFV3WHpnNU9URXdORGcwTXpRME5qRTROUThFZAEdsdFpRWlZAIWUl5QVE9PQZDZD\"},\"next\":\"https://graph.facebook.com/v2.11/177057932317550/feed?access_token=XXTOKENXX&fields=caption%2Cmessage%2Ccreated_time%2Ctype%2Cdescription%2Clikes%7Bname%2Cusername%7D%2Ccomments%7Bmessage%2Ccreated_time%2Cfrom%2Clikes%7Bname%2Cusername%7D%7D&since=3+years+ago&until=now&limit=25&after=Q2c4U1pXNTBYM0YxWlhKNVgzTjBiM0o1WDJsa0R5UXhOemN3TlRjNU16SXpNVGMxTlRBNkxURTBOREV5TVRneU1UUTVOamt4TURJeU16SVBER0ZA3YVY5emRHOXllVjlwWkE4ZAk1UYzNNRFUzT1RNeU16RTNOVFV3WHpnNU9URXdORGcwTXpRME5qRTROUThFZAEdsdFpRWlZAIWUl5QVE9PQZDZD\"}}}"}
)
})

================================================
File: /test/keboola/snapshots/feed/out/tables/feed.manifest
================================================
{"columns":["id","ex-account-id","fb-graph-node","parent-id","caption","created_time","description","message","type"],"incremental":true,"primary_key":["parent_id","id"]}

================================================
File: /test/keboola/snapshots/feed/out/tables/feed/1516621526977
================================================
"177057932317550_863179447038725","177057932317550","page_feed","177057932317550","MoUVi","2015-01-22T16:06:00+0000","QUkJ7","rN5UJ","link"
"177057932317550_867662119923791","177057932317550","page_feed","177057932317550","TOODK","2015-02-01T22:50:49+0000","tlKaK","O7mBO","link"
"177057932317550_867918849898118","177057932317550","page_feed","177057932317550","obTSR","2015-02-02T08:52:14+0000","JWWW4","0kzPw","link"
"177057932317550_868084153214921","177057932317550","page_feed","177057932317550","eE4uR","2015-02-02T17:30:06+0000","","iEx5Z","link"
"177057932317550_868201209869882","177057932317550","page_feed","177057932317550","MK4jq","2015-02-03T01:03:20+0000","abWhz","GHYIM","link"
"177057932317550_868721253151211","177057932317550","page_feed","177057932317550","coxVD","2015-02-04T08:19:07+0000","0XtVU","t1TNL","link"
"177057932317550_868726169817386","177057932317550","page_feed","177057932317550","P5xhN","2015-02-04T08:47:55+0000","TlTHw","6CPSm","link"
"177057932317550_871299946226675","177057932317550","page_feed","177057932317550","8cQiu","2015-02-10T09:06:05+0000","eFikT","IaYBi","link"
"177057932317550_871542359535767","177057932317550","page_feed","177057932317550","sPl83","2015-02-10T23:04:55+0000","VaLf1","Wbfgj","link"
"177057932317550_871770149512988","177057932317550","page_feed","177057932317550","Jcr3G","2015-02-11T12:46:47+0000","6ziKG","m3hJh","link"
"177057932317550_876365615720108","177057932317550","page_feed","177057932317550","20yg1","2015-02-19T21:42:46+0000","06Ejk","54qbI","link"
"177057932317550_876391385717531","177057932317550","page_feed","177057932317550","aYyDG","2015-02-19T22:57:01+0000","oNCUx","PzGFC","link"
"177057932317550_876759985680671","177057932317550","page_feed","177057932317550","jW53B","2015-02-20T19:01:57+0000","ki8t1","P4GzX","link"
"177057932317550_878717075484962","177057932317550","page_feed","177057932317550","olONV","2015-02-24T10:49:45+0000","IH8FT","T8f6s","link"
"177057932317550_878834132139923","177057932317550","page_feed","177057932317550","rUc3R","2015-02-24T16:55:24+0000","Nyb3l","63vKu","link"
"177057932317550_880197812003555","177057932317550","page_feed","177057932317550","sGhkz","2015-02-27T18:53:14+0000","5qNaz","THiDT","link"
"177057932317550_882565748433428","177057932317550","page_feed","177057932317550","sHB38","2015-03-05T14:15:36+0000","FDzCS","g0kbV","link"
"177057932317550_890214517668551","177057932317550","page_feed","177057932317550","","2015-03-19T02:27:18+0000","","XJXV3","photo"
"177057932317550_894591280564208","177057932317550","page_feed","177057932317550","m43yp","2015-03-25T18:39:57+0000","OjJy5","7B6pQ","link"
"177057932317550_894908463865823","177057932317550","page_feed","177057932317550","G5OF8","2015-03-26T09:38:34+0000","RzIc3","i60mK","link"
"177057932317550_895159487174054","177057932317550","page_feed","177057932317550","w0ysY","2015-03-26T19:20:42+0000","VoUzP","D3XJ2","link"
"177057932317550_895172080506128","177057932317550","page_feed","177057932317550","Q3LcJ","2015-03-26T19:54:02+0000","3lzUN","FJiGM","link"
"177057932317550_895638570459479","177057932317550","page_feed","177057932317550","6norZ","2015-03-27T13:59:19+0000","YMgXa","0OBCV","link"
"177057932317550_895669693789700","177057932317550","page_feed","177057932317550","P1SRB","2015-03-27T15:31:12+0000","IncFv","I84Tz","link"
"177057932317550_897828396907163","177057932317550","page_feed","177057932317550","YLFUs","2015-03-31T08:56:02+0000","xk53D","gp8wX","link"
"177057932317550_898249010198435","177057932317550","page_feed","177057932317550","wd4eW","2015-04-01T01:22:18+0000","pB4mm","Ih4zf","link"
"177057932317550_898322620191074","177057932317550","page_feed","177057932317550","x0Leb","2015-04-01T04:52:15+0000","M5qHU","eeh6Q","link"
"177057932317550_898705676819435","177057932317550","page_feed","177057932317550","hDQL5","2015-04-01T23:26:00+0000","ETRtQ","dsSlg","link"
"177057932317550_899104843446185","177057932317550","page_feed","177057932317550","4qrUY","2015-04-02T17:53:54+0000","Oylr4","LLLXJ","link"
"177057932317550_899507860072550","177057932317550","page_feed","177057932317550","kL4jo","2015-04-03T10:05:14+0000","ydoVL","KGLmo","link"
"177057932317550_902157386474264","177057932317550","page_feed","177057932317550","1qDpf","2015-04-08T06:32:14+0000","DO4HV","I7vhf","link"
"177057932317550_903010183055651","177057932317550","page_feed","177057932317550","NuLrs","2015-04-10T09:20:52+0000","ZaYaF","SPqMU","link"
"177057932317550_905758402780829","177057932317550","page_feed","177057932317550","q1hfJ","2015-04-15T17:48:02+0000","HDxyF","Dev4K","link"
"177057932317550_908277042528965","177057932317550","page_feed","177057932317550","MywPj","2015-04-20T10:55:26+0000","tQiat","gbll9","link"
"177057932317550_910073965682606","177057932317550","page_feed","177057932317550","geNPo","2015-04-23T08:10:30+0000","mptUF","CO576","link"
"177057932317550_913371222019547","177057932317550","page_feed","177057932317550","WLOKX","2015-04-28T09:40:20+0000","xNMkD","8e1tH","link"
"177057932317550_913890861967583","177057932317550","page_feed","177057932317550","VpRap","2015-04-29T05:09:50+0000","VKkL1","kU1CX","link"
"177057932317550_921759614514041","177057932317550","page_feed","177057932317550","","2015-05-16T06:54:46+0000","","","photo"
"177057932317550_921776967845639","177057932317550","page_feed","177057932317550","","2015-05-16T08:15:15+0000","","","photo"
"177057932317550_932914176731918","177057932317550","page_feed","177057932317550","","2015-06-08T11:10:56+0000","","5osh1","photo"
"177057932317550_940984532591549","177057932317550","page_feed","177057932317550","","2015-06-25T02:16:30+0000","","F9OaB","photo"
"177057932317550_990386480984687","177057932317550","page_feed","177057932317550","","2015-10-14T05:03:09+0000","","Qy6me","photo"
"177057932317550_1043848705638464","177057932317550","page_feed","177057932317550","","2016-02-09T18:55:03+0000","","bllJY","status"
"177057932317550_10207570586690352","177057932317550","page_feed","177057932317550","axmGB","2016-02-10T14:10:10+0000","V7keH","bXFqB","link"
"177057932317550_1126854757337858","177057932317550","page_feed","177057932317550","","2016-06-22T06:23:24+0000","Md2lK","","video"
"177057932317550_1379478452075486","177057932317550","page_feed","177057932317550","qycft","2017-04-06T20:27:49+0000","XM11E","Ysr2x","link"
"177057932317550_10155365834019810","177057932317550","page_feed","177057932317550","","2017-05-25T22:38:42+0000","","m9Mef","photo"
"177057932317550_177062472317096","177057932317550","page_feed","177057932317550","","2017-07-13T14:20:00+0000","","","photo"
"177057932317550_1477131262310204","177057932317550","page_feed","177057932317550","","2017-07-13T14:42:10+0000","","2qulO","photo"
"177057932317550_1478486035508060","177057932317550","page_feed","177057932317550","","2017-07-14T17:50:48+0000","","XU1Pt","photo"
"177057932317550_200219200511028","177057932317550","page_feed","177057932317550","BvW1U","2017-07-19T03:17:27+0000","XskdM","zSiDU","event"
"177057932317550_1920132124904149","177057932317550","page_feed","177057932317550","XTs78","2017-09-04T11:15:47+0000","ISHXC","8EIgi","event"
"177057932317550_1528270307196299","177057932317550","page_feed","177057932317550","","2017-09-06T20:53:56+0000","","","photo"


================================================
File: /test/keboola/snapshots/feed/out/tables/feed_comments.manifest
================================================
{"columns":["id","ex-account-id","fb-graph-node","parent-id","created_time","from_id","from_name","message"],"incremental":true,"primary_key":["parent_id","id"]}

================================================
File: /test/keboola/snapshots/feed/out/tables/feed_comments/1516621526976
================================================
"932914176731918_967071379982864","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-08-23T02:03:58+0000","","","LdJiP"
"932914176731918_933521926671143","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-09T13:24:55+0000","177057932317550","fiEi7","FpZoh"
"932914176731918_933191330037536","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-08T22:37:41+0000","","","6UEzz"
"932914176731918_933149790041690","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-08T20:04:40+0000","","","rp0IC"
"932914176731918_933149403375062","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-08T20:02:57+0000","","","grvPh"
"932914176731918_933067250049944","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-08T18:36:51+0000","","","GIemL"
"932914176731918_933056966717639","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-08T17:51:05+0000","","","NIIOY"
"932914176731918_933055396717796","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-08T17:44:02+0000","","","spHHi"
"932914176731918_933055010051168","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-08T17:42:19+0000","","","Idp0c"
"932914176731918_933048243385178","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-08T17:22:09+0000","","","ZSyUO"
"932914176731918_933040360052633","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-08T16:50:01+0000","","","bmhBP"
"932914176731918_932938540062815","177057932317550","page_feed_comments","177057932317550_932914176731918","2015-06-08T12:22:04+0000","","","SOu8i"
"10155365834019810_10155365853274810","177057932317550","page_feed_comments","177057932317550_10155365834019810","2017-05-25T22:46:44+0000","","","ifSve"
"1477131262310204_1477461532277177","177057932317550","page_feed_comments","177057932317550_1477131262310204","2017-07-13T16:51:54+0000","","","08glB"
"1478486035508060_1478596215497042","177057932317550","page_feed_comments","177057932317550_1478486035508060","2017-07-14T20:05:10+0000","177057932317550","2bh8M","VSZDW"


================================================
File: /test/keboola/snapshots/feed/out/tables/accounts
================================================
category,name,id
software,keboola,177057932317550


================================================
File: /test/keboola/snapshots/feed/config.json
================================================
{
  "storage" : { },
  "parameters" : {
    "accounts" : {
      "177057932317550" : {
        "id" : "177057932317550",
        "name" : "keboola",
        "category" : "software"
      }
    },
    "api-version" : "v2.11",
    "queries" : [ {
      "name" : "feed",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "feed",
        "fields" : "caption,message,created_time,type,description,likes{name,username},comments{message,created_time,from,likes{name,username}}",
        "ids" : "177057932317550",
        "since" : "3 years ago",
        "until" : "now"
      }
    } ]
  },
  "authorization" : {
    "oauth_api" : {
      "id" : "keboola.ex-facebook",
      "credentials" : {
        "id" : "main",
        "authorizedFor" : "Myself",
        "creator" : {
          "id" : "1234",
          "description" : "me@keboola.com"
        },
        "created" : "2016-01-31 00:13:30",
        "oauthVersion" : "facebook",
        "appKey" : "xxx",
        "#data" : "{\"token\":\"XXTOKENXX\"}",
        "#appSecret" : "KBC::Encrypted==ENCODEDSTRING=="
      }
    }
  }
}

================================================
File: /test/keboola/snapshots/template.mustache
================================================
(ns {{ns-name}}
  (:require [{{apicalls-ns}} :as apicalls]
            [clojure.test :as t :refer :all]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.test-utils.core :as test-utils]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            )
  (:use clj-http.fake))

(deftest {{test-name}}-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "{{test-name}}"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "{{dir-path}}")
    (test-utils/copy-config-tmp "{{dir-path}}" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "{{dir-path}}" tmp-dir)
      )))

================================================
File: /test/keboola/snapshots/asyncinisghtscampaigns/apicalls.clj
================================================
(ns keboola.snapshots.asyncinisghtscampaigns.apicalls)
(def recorded
{
{:method :get,
 :address
 "https://graph.facebook.com/v10.0/192025512975195/insights/?access_token=XXTOKENXX",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"account_id\":\"522606278080331\",\"actions\":[{\"action_reaction\":\"wow\",\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_reaction\":\"like\",\"action_type\":\"post_reaction\",\"value\":\"7\"},{\"action_type\":\"comment\",\"value\":\"3\"},{\"action_type\":\"onsite_conversion.post_save\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"106\"},{\"action_type\":\"post\",\"value\":\"1\"},{\"action_type\":\"post_reaction\",\"value\":\"8\"},{\"action_type\":\"video_view\",\"value\":\"1711\"},{\"action_type\":\"landing_page_view\",\"value\":\"68\"},{\"action_type\":\"offsite_conversion.fb_pixel_add_payment_info\",\"value\":\"5\"},{\"action_type\":\"offsite_conversion.fb_pixel_add_to_cart\",\"value\":\"16\"},{\"action_type\":\"offsite_conversion.fb_pixel_initiate_checkout\",\"value\":\"5\"},{\"action_type\":\"offsite_conversion.fb_pixel_purchase\",\"value\":\"1\"},{\"action_type\":\"offsite_conversion.fb_pixel_search\",\"value\":\"3\"},{\"action_type\":\"offsite_conversion.fb_pixel_view_content\",\"value\":\"100\"},{\"action_type\":\"post_engagement\",\"value\":\"1830\"},{\"action_type\":\"page_engagement\",\"value\":\"1830\"},{\"action_type\":\"add_payment_info\",\"value\":\"5\"},{\"action_type\":\"omni_add_to_cart\",\"value\":\"16\"},{\"action_type\":\"omni_initiated_checkout\",\"value\":\"5\"},{\"action_type\":\"omni_purchase\",\"value\":\"1\"},{\"action_type\":\"omni_search\",\"value\":\"3\"},{\"action_type\":\"omni_view_content\",\"value\":\"100\"},{\"action_type\":\"add_to_cart\",\"value\":\"16\"},{\"action_type\":\"initiate_checkout\",\"value\":\"5\"},{\"action_type\":\"purchase\",\"value\":\"1\"},{\"action_type\":\"search\",\"value\":\"3\"},{\"action_type\":\"view_content\",\"value\":\"100\"}],\"date_start\":\"2021-08-07\",\"date_stop\":\"2021-08-07\"},{\"account_id\":\"522606278080331\",\"actions\":[{\"action_reaction\":\"like\",\"action_type\":\"post_reaction\",\"value\":\"7\"},{\"action_type\":\"onsite_conversion.post_save\",\"value\":\"3\"},{\"action_type\":\"link_click\",\"value\":\"130\"},{\"action_type\":\"post\",\"value\":\"1\"},{\"action_type\":\"post_reaction\",\"value\":\"7\"},{\"action_type\":\"video_view\",\"value\":\"2364\"},{\"action_type\":\"landing_page_view\",\"value\":\"92\"},{\"action_type\":\"offsite_conversion.fb_pixel_add_payment_info\",\"value\":\"2\"},{\"action_type\":\"offsite_conversion.fb_pixel_add_to_cart\",\"value\":\"7\"},{\"action_type\":\"offsite_conversion.fb_pixel_initiate_checkout\",\"value\":\"3\"},{\"action_type\":\"offsite_conversion.fb_pixel_purchase\",\"value\":\"1\"},{\"action_type\":\"offsite_conversion.fb_pixel_search\",\"value\":\"1\"},{\"action_type\":\"offsite_conversion.fb_pixel_view_content\",\"value\":\"131\"},{\"action_type\":\"post_engagement\",\"value\":\"2505\"},{\"action_type\":\"page_engagement\",\"value\":\"2505\"},{\"action_type\":\"add_payment_info\",\"value\":\"2\"},{\"action_type\":\"omni_add_to_cart\",\"value\":\"7\"},{\"action_type\":\"omni_initiated_checkout\",\"value\":\"3\"},{\"action_type\":\"omni_purchase\",\"value\":\"1\"},{\"action_type\":\"omni_search\",\"value\":\"1\"},{\"action_type\":\"omni_view_content\",\"value\":\"131\"},{\"action_type\":\"add_to_cart\",\"value\":\"7\"},{\"action_type\":\"initiate_checkout\",\"value\":\"3\"},{\"action_type\":\"purchase\",\"value\":\"1\"},{\"action_type\":\"search\",\"value\":\"1\"},{\"action_type\":\"view_content\",\"value\":\"131\"}],\"date_start\":\"2021-08-08\",\"date_stop\":\"2021-08-08\"},{\"account_id\":\"522606278080331\",\"actions\":[{\"action_reaction\":\"wow\",\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_reaction\":\"like\",\"action_type\":\"post_reaction\",\"value\":\"55\"},{\"action_reaction\":\"love\",\"action_type\":\"post_reaction\",\"value\":\"2\"},{\"action_type\":\"comment\",\"value\":\"6\"},{\"action_type\":\"onsite_conversion.post_save\",\"value\":\"13\"},{\"action_type\":\"link_click\",\"value\":\"558\"},{\"action_type\":\"post\",\"value\":\"9\"},{\"action_type\":\"post_reaction\",\"value\":\"58\"},{\"action_type\":\"video_view\",\"value\":\"6771\"},{\"action_type\":\"landing_page_view\",\"value\":\"422\"},{\"action_type\":\"offsite_conversion.fb_pixel_add_payment_info\",\"value\":\"21\"},{\"action_type\":\"offsite_conversion.fb_pixel_add_to_cart\",\"value\":\"62\"},{\"action_type\":\"offsite_conversion.fb_pixel_complete_registration\",\"value\":\"3\"},{\"action_type\":\"offsite_conversion.fb_pixel_initiate_checkout\",\"value\":\"34\"},{\"action_type\":\"offsite_conversion.fb_pixel_purchase\",\"value\":\"11\"},{\"action_type\":\"offsite_conversion.fb_pixel_search\",\"value\":\"8\"},{\"action_type\":\"offsite_conversion.fb_pixel_view_content\",\"value\":\"542\"},{\"action_type\":\"post_engagement\",\"value\":\"7415\"},{\"action_type\":\"page_engagement\",\"value\":\"7415\"},{\"action_type\":\"add_payment_info\",\"value\":\"21\"},{\"action_type\":\"omni_add_to_cart\",\"value\":\"62\"},{\"action_type\":\"omni_complete_registration\",\"value\":\"3\"},{\"action_type\":\"omni_initiated_checkout\",\"value\":\"34\"},{\"action_type\":\"omni_purchase\",\"value\":\"11\"},{\"action_type\":\"omni_search\",\"value\":\"8\"},{\"action_type\":\"omni_view_content\",\"value\":\"542\"},{\"action_type\":\"add_to_cart\",\"value\":\"62\"},{\"action_type\":\"complete_registration\",\"value\":\"3\"},{\"action_type\":\"initiate_checkout\",\"value\":\"34\"},{\"action_type\":\"purchase\",\"value\":\"11\"},{\"action_type\":\"search\",\"value\":\"8\"},{\"action_type\":\"view_content\",\"value\":\"542\"}],\"date_start\":\"2021-08-09\",\"date_stop\":\"2021-08-09\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v10.0/192025512975195?access_token=XXTOKENXX",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"id\":\"192025512975195\",\"account_id\":\"522606278080331\",\"time_ref\":1628614274,\"time_completed\":1628614275,\"async_status\":\"Job Completed\",\"async_percent_completion\":100,\"date_start\":\"2021-08-07\",\"date_stop\":\"2021-08-09\"}"}
){:method :post,
 :address
 "https://graph.facebook.com/v10.0/act_522606278080331/insights?fields=account_id,campaign_id,actions&action_breakdowns=action_reaction&date_preset=last_3d&time_increment=1&level=account&access_token=XXTOKENXX",
 :as :json}
(fn [req]{:status 200, :body "{\"report_run_id\":\"192025512975195\"}"}
)
})


================================================
File: /test/keboola/snapshots/asyncinisghtscampaigns/test_asyncinisghtscampaigns.clj
================================================
(ns keboola.snapshots.asyncinisghtscampaigns.test-asyncinisghtscampaigns
  (:require [keboola.snapshots.asyncinisghtscampaigns.apicalls :as apicalls]
            [clojure.test :as t :refer :all]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.test-utils.core :as test-utils]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            )
  (:use clj-http.fake))

(deftest asyncinisghtscampaigns-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "asyncinisghtscampaigns"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "test/keboola/snapshots/asyncinisghtscampaigns")
    (test-utils/copy-config-tmp "test/keboola/snapshots/asyncinisghtscampaigns" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "test/keboola/snapshots/asyncinisghtscampaigns" tmp-dir)
      )))

================================================
File: /test/keboola/snapshots/asyncinisghtscampaigns/out/tables/query_insights/1628614276830
================================================
"act_522606278080331","page_insights","act_522606278080331","actions","view_content","","542","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","search","","8","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","purchase","","11","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","initiate_checkout","","34","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","complete_registration","","3","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","add_to_cart","","62","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_view_content","","542","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_search","","8","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_purchase","","11","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_initiated_checkout","","34","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_complete_registration","","3","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_add_to_cart","","62","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","add_payment_info","","21","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","page_engagement","","7415","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","post_engagement","","7415","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_view_content","","542","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_search","","8","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_purchase","","11","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_initiate_checkout","","34","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_complete_registration","","3","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_add_to_cart","","62","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_add_payment_info","","21","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","landing_page_view","","422","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","video_view","","6771","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","post_reaction","","58","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","post","","9","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","link_click","","558","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","onsite_conversion.post_save","","13","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","comment","","6","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","post_reaction","love","2","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","post_reaction","like","55","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","post_reaction","wow","1","522606278080331","2021-08-09","2021-08-09"
"act_522606278080331","page_insights","act_522606278080331","actions","view_content","","131","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","search","","1","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","purchase","","1","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","initiate_checkout","","3","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","add_to_cart","","7","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_view_content","","131","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_search","","1","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_purchase","","1","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_initiated_checkout","","3","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_add_to_cart","","7","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","add_payment_info","","2","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","page_engagement","","2505","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","post_engagement","","2505","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_view_content","","131","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_search","","1","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_purchase","","1","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_initiate_checkout","","3","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_add_to_cart","","7","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_add_payment_info","","2","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","landing_page_view","","92","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","video_view","","2364","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","post_reaction","","7","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","post","","1","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","link_click","","130","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","onsite_conversion.post_save","","3","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","post_reaction","like","7","522606278080331","2021-08-08","2021-08-08"
"act_522606278080331","page_insights","act_522606278080331","actions","view_content","","100","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","search","","3","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","purchase","","1","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","initiate_checkout","","5","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","add_to_cart","","16","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_view_content","","100","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_search","","3","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_purchase","","1","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_initiated_checkout","","5","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","omni_add_to_cart","","16","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","add_payment_info","","5","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","page_engagement","","1830","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","post_engagement","","1830","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_view_content","","100","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_search","","3","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_purchase","","1","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_initiate_checkout","","5","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_add_to_cart","","16","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","offsite_conversion.fb_pixel_add_payment_info","","5","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","landing_page_view","","68","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","video_view","","1711","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","post_reaction","","8","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","post","","1","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","link_click","","106","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","onsite_conversion.post_save","","1","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","comment","","3","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","post_reaction","like","7","522606278080331","2021-08-07","2021-08-07"
"act_522606278080331","page_insights","act_522606278080331","actions","post_reaction","wow","1","522606278080331","2021-08-07","2021-08-07"


================================================
File: /test/keboola/snapshots/asyncinisghtscampaigns/out/tables/accounts
================================================
account_id,name,business_name,currency,id
522606278080331,My bussines,My bussiness,CZK,act_522606278080331


================================================
File: /test/keboola/snapshots/asyncinisghtscampaigns/out/tables/query_insights.manifest
================================================
{"columns":["ex-account-id","fb-graph-node","parent-id","ads_action_name","action_type","action_reaction","value","account_id","date_start","date_stop"],"incremental":true,"primary_key":["parent_id","account_id","date_start","date_stop","ads_action_name","action_type","action_reaction"]}

================================================
File: /test/keboola/snapshots/asyncinisghtscampaigns/config.json
================================================
{
  "storage" : { },
  "parameters" : {
    "accounts" : {
      "act_522606278080331" : {
        "account_id" : "522606278080331",
        "business_name" : "My bussiness",
        "currency" : "CZK",
        "id" : "act_522606278080331",
        "name" : "My bussines"
      }
    },
    "api-version" : "v10.0",
    "queries" : [ {
      "name" : "query",
      "type" : "async-insights-query",
      "disabled" : false,
      "query" : {
        "parameters" : "fields=account_id,campaign_id,actions&action_breakdowns=action_reaction&date_preset=last_3d&time_increment=1&level=account",
        "ids" : ""
      }
    } ]
  },
  "authorization" : {
    "oauth_api" : {
      "id" : "keboola.ex-facebook-ads",
      "credentials" : {
        "id" : "main",
        "authorizedFor" : "Myself",
        "creator" : {
          "id" : "1234",
          "description" : "me@keboola.com"
        },
        "created" : "2016-01-31 00:13:30",
        "oauthVersion" : "facebook",
        "appKey" : "xxx",
        "#data" : "{\"token\":\"XXTOKENXX\"}",
        "#appSecret" : "KBC::Encrypted==ENCODEDSTRING=="
      }
    }
  }
}

================================================
File: /test/keboola/snapshots/postsinsights/test_postsinsights.clj
================================================
(ns keboola.snapshots.postsinsights.test-postsinsights
  (:require [clj-http.fake :refer :all]
            [clojure.test :as t :refer :all]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.snapshots.postsinsights.apicalls :as apicalls]
            [keboola.test-utils.core :as test-utils]))

(deftest postsinsights-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "postsinsights"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "test/keboola/snapshots/postsinsights")
    (test-utils/copy-config-tmp "test/keboola/snapshots/postsinsights" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "test/keboola/snapshots/postsinsights" tmp-dir)
      )))


================================================
File: /test/keboola/snapshots/postsinsights/apicalls.clj
================================================
(ns keboola.snapshots.postsinsights.apicalls)
(def recorded 
{
{:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_905758402780829/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 326,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "arRpJFsA54zoAVbzgqywOAXRaHJi5v6OcR9A8YtICfbw/C57snxDEVdoTiAxXfoF+8OfDoE5D250ooGJwZsUMA==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961016",
  "ETag" "\"499d7f1f4895838d6e5789975fa42e7191b5c6b0\"",
  "x-fb-trace-id" "E58sTCYP5u3",
  "Date" "Sat, 15 Apr 2017 16:12:30 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"e2xq7\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"We187\",\"description\":\"bIogC\",\"id\":\"177057932317550_905758402780829/insights/post_video_view_time/day\"},{\"name\":\"KsKOd\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"oCrrN\",\"description\":\"18gPT\",\"id\":\"177057932317550_905758402780829/insights/post_video_view_time/lifetime\"},{\"name\":\"RKHHT\",\"period\":\"lifetime\",\"values\":[{\"value\":3}],\"title\":\"vZ6uN\",\"description\":\"a8OM0\",\"id\":\"177057932317550_905758402780829/insights/post_engaged_fan/lifetime\"},{\"name\":\"UResm\",\"period\":\"lifetime\",\"values\":[{\"value\":3}],\"title\":\"FUWJ8\",\"description\":\"y34TB\",\"id\":\"177057932317550_905758402780829/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_905758402780829/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_905758402780829/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_908277042528965/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 262,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "P8VP1NtY33qJoz0sQ2lE4gbmXY3VnfFfloqKRXShE1eLAqE04yTOS4WOu3HmfUlZ2ePvWmkKo6fr2Mpq48kp7Q==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961016",
  "ETag" "\"751265e75b6a6db7e2cd731617e922660418189c\"",
  "x-fb-trace-id" "FDgrIZWkHDM",
  "Date" "Sat, 15 Apr 2017 16:12:29 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"rJ2TI\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"9eM4z\",\"description\":\"XR6PH\",\"id\":\"177057932317550_908277042528965/insights/post_video_view_time/day\"},{\"name\":\"3hdSc\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"IjKRU\",\"description\":\"cIzxu\",\"id\":\"177057932317550_908277042528965/insights/post_video_view_time/lifetime\"},{\"name\":\"oHv6Z\",\"period\":\"lifetime\",\"values\":[{\"value\":6}],\"title\":\"XpVR1\",\"description\":\"RXbJl\",\"id\":\"177057932317550_908277042528965/insights/post_engaged_fan/lifetime\"},{\"name\":\"l6WOG\",\"period\":\"lifetime\",\"values\":[{\"value\":6}],\"title\":\"HXw2M\",\"description\":\"0qf3l\",\"id\":\"177057932317550_908277042528965/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_908277042528965/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_908277042528965/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_910073965682606/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 262,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "JhflIrvgppRaNFC36rF+0uKpURPzTAckSTDZadwHUnobwuSPqmoNyldL9Qf1dxYW3ru0HXqtdf5NWGXuDhsX7w==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961016",
  "ETag" "\"10aa5dd1c4565c3d2640c5834f4c1593dc274f70\"",
  "x-fb-trace-id" "AkBqYgjak1R",
  "Date" "Sat, 15 Apr 2017 16:12:29 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"LJ8Iz\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"gEZtz\",\"description\":\"r7UMy\",\"id\":\"177057932317550_910073965682606/insights/post_video_view_time/day\"},{\"name\":\"GFD0u\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"ieGzc\",\"description\":\"gJ098\",\"id\":\"177057932317550_910073965682606/insights/post_video_view_time/lifetime\"},{\"name\":\"Ze7w9\",\"period\":\"lifetime\",\"values\":[{\"value\":6}],\"title\":\"308IR\",\"description\":\"fB9g4\",\"id\":\"177057932317550_910073965682606/insights/post_engaged_fan/lifetime\"},{\"name\":\"Wc3xp\",\"period\":\"lifetime\",\"values\":[{\"value\":5}],\"title\":\"58hFU\",\"description\":\"XN1W6\",\"id\":\"177057932317550_910073965682606/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_910073965682606/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_910073965682606/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_913371222019547/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 269,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "4/SX5TGXr8XC3wjhdojFVRzfULp4ipIe1DPoZgPfvmpdDAMhCfp8oFwX9mHa2XgneMcqkAU/nU5jZVv0fkB60g==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961016",
  "ETag" "\"45757c5c8948ab396b0c55240021a36a7e4be83b\"",
  "x-fb-trace-id" "GCtZ0NOOSez",
  "Date" "Sat, 15 Apr 2017 16:12:29 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"iUyZJ\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"nJN8t\",\"description\":\"c4FoJ\",\"id\":\"177057932317550_913371222019547/insights/post_video_view_time/day\"},{\"name\":\"HdLpe\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"ZXDck\",\"description\":\"CgPzD\",\"id\":\"177057932317550_913371222019547/insights/post_video_view_time/lifetime\"},{\"name\":\"Go6fd\",\"period\":\"lifetime\",\"values\":[{\"value\":6}],\"title\":\"LsGmf\",\"description\":\"RKkaH\",\"id\":\"177057932317550_913371222019547/insights/post_engaged_fan/lifetime\"},{\"name\":\"8LnpI\",\"period\":\"lifetime\",\"values\":[{\"value\":7}],\"title\":\"uE7I0\",\"description\":\"rjsJw\",\"id\":\"177057932317550_913371222019547/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_913371222019547/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_913371222019547/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_913890861967583/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 262,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "X++hWdUOZhcZd3S7aqw6b8HCUtU1ZIfv/9KTntqvCsJ9lpgGR7enWIfoUJCfg1k07e7LSuGm+uvl2XWDFdU21A==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961016",
  "ETag" "\"a0997632eb82cab36ca5687b673334a21a53bfe3\"",
  "x-fb-trace-id" "GEpcaF9eweL",
  "Date" "Sat, 15 Apr 2017 16:12:29 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"zVJ4H\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"QKLha\",\"description\":\"11ncv\",\"id\":\"177057932317550_913890861967583/insights/post_video_view_time/day\"},{\"name\":\"PZ5nn\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"pz38h\",\"description\":\"8y1g7\",\"id\":\"177057932317550_913890861967583/insights/post_video_view_time/lifetime\"},{\"name\":\"Ihurs\",\"period\":\"lifetime\",\"values\":[{\"value\":2}],\"title\":\"q1qIT\",\"description\":\"z5EXn\",\"id\":\"177057932317550_913890861967583/insights/post_engaged_fan/lifetime\"},{\"name\":\"FO3Yp\",\"period\":\"lifetime\",\"values\":[{\"value\":2}],\"title\":\"dCMOU\",\"description\":\"a5HIs\",\"id\":\"177057932317550_913890861967583/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_913890861967583/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_913890861967583/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_921759597847376/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 260,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "fMqQzHpzjoHFpsFy/fAeCE5MVCcM/wcRI0CiQc0uofqL+lgMXTTwdV/1CXTkLVUVb19gRiNME9Hkc25U7bMmEg==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961041",
  "ETag" "\"7c7ba54f14fc506f1aefc23ac0594aa71a09362a\"",
  "x-fb-trace-id" "CuvUmwV6qLd",
  "Date" "Sat, 15 Apr 2017 16:12:28 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"sO8GH\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"w2CZ5\",\"description\":\"MxbSn\",\"id\":\"177057932317550_921759597847376/insights/post_video_view_time/day\"},{\"name\":\"d0fgv\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"0Ecs3\",\"description\":\"tzhI5\",\"id\":\"177057932317550_921759597847376/insights/post_video_view_time/lifetime\"},{\"name\":\"8TuhJ\",\"period\":\"lifetime\",\"values\":[{\"value\":9}],\"title\":\"b1rpL\",\"description\":\"6O6zC\",\"id\":\"177057932317550_921759597847376/insights/post_engaged_fan/lifetime\"},{\"name\":\"fsSpY\",\"period\":\"lifetime\",\"values\":[{\"value\":56}],\"title\":\"khR83\",\"description\":\"LuepG\",\"id\":\"177057932317550_921759597847376/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_921759597847376/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_921759597847376/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_921776914512311/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 264,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "1eWkAubLe83spaIN3AqbRDCPRH/PozQt+cy8ZVqTEsxLtz/FUvPXpoXQvUZyk8EyWPyKr4YLOpQl0xunODu3KQ==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961041",
  "ETag" "\"c3261a035741258a8c420a56f6d5743b1f2418c5\"",
  "x-fb-trace-id" "CnJ7/jNAw0l",
  "Date" "Sat, 15 Apr 2017 16:12:28 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"gDfI1\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"c2Nmd\",\"description\":\"daGHc\",\"id\":\"177057932317550_921776914512311/insights/post_video_view_time/day\"},{\"name\":\"e1Fl4\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"lCk3S\",\"description\":\"rPdXa\",\"id\":\"177057932317550_921776914512311/insights/post_video_view_time/lifetime\"},{\"name\":\"gLyDR\",\"period\":\"lifetime\",\"values\":[{\"value\":5}],\"title\":\"kzWln\",\"description\":\"FWjPk\",\"id\":\"177057932317550_921776914512311/insights/post_engaged_fan/lifetime\"},{\"name\":\"HgsDz\",\"period\":\"lifetime\",\"values\":[{\"value\":62}],\"title\":\"cMXWU\",\"description\":\"Q4GaO\",\"id\":\"177057932317550_921776914512311/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_921776914512311/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_921776914512311/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_932914176731918/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 340,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "K1xyC02PzmrtH73OakoG4F/PRdrBbTGwEA/rgdCHMIa5WiJA+EsEOCPlKCVfJ1TcRcjTywdPNzp5K8hcsI1QDA==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961016",
  "ETag" "\"f2d12c79e3b3fb022e509b12de5669d70658b717\"",
  "x-fb-trace-id" "DB4X7yyiqLM",
  "Date" "Sat, 15 Apr 2017 16:12:28 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"m0S76\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"EoefU\",\"description\":\"Q86qe\",\"id\":\"177057932317550_932914176731918/insights/post_video_view_time/day\"},{\"name\":\"yOiGC\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"YV0RY\",\"description\":\"qOkw8\",\"id\":\"177057932317550_932914176731918/insights/post_video_view_time/lifetime\"},{\"name\":\"usJXt\",\"period\":\"lifetime\",\"values\":[{\"value\":150}],\"title\":\"3NN9H\",\"description\":\"tFi72\",\"id\":\"177057932317550_932914176731918/insights/post_engaged_fan/lifetime\"},{\"name\":\"TZBe6\",\"period\":\"lifetime\",\"values\":[{\"value\":5315}],\"title\":\"c0zOE\",\"description\":\"QI6Z9\",\"id\":\"177057932317550_932914176731918/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_932914176731918/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_932914176731918/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_940984532591549/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 270,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "czqNtO8vu5MSQEfgmMc+bjBotTYka4w/xKZ8JqVMkkvxB+qO93kEGKYypkcKrJ3waPoe/SkiaKGowZD00x00TQ==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961016",
  "ETag" "\"9aafe66f4c26a976acd6cb5c9ccfb108572358f4\"",
  "x-fb-trace-id" "ANxsKIF2bhv",
  "Date" "Sat, 15 Apr 2017 16:12:27 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"SyITO\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"4TGe9\",\"description\":\"YfTIE\",\"id\":\"177057932317550_940984532591549/insights/post_video_view_time/day\"},{\"name\":\"FLN86\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"g4udK\",\"description\":\"T2YNz\",\"id\":\"177057932317550_940984532591549/insights/post_video_view_time/lifetime\"},{\"name\":\"CPh5K\",\"period\":\"lifetime\",\"values\":[{\"value\":13}],\"title\":\"s8QMq\",\"description\":\"DMNlM\",\"id\":\"177057932317550_940984532591549/insights/post_engaged_fan/lifetime\"},{\"name\":\"jI8Mt\",\"period\":\"lifetime\",\"values\":[{\"value\":97}],\"title\":\"uJwOw\",\"description\":\"bbDtY\",\"id\":\"177057932317550_940984532591549/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_940984532591549/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_940984532591549/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_990386480984687/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 266,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "t1S4Y2XrvcR+rEC/tPk9rUvI4O1XwV/5zGYwHFla4acGRDbCHE4JWCUWmv+wX+1L1Ed5150CEzoFW2TFrWbBAQ==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961041",
  "ETag" "\"1cdede662030e52b66cbe67c90edb32ef1e85d5d\"",
  "x-fb-trace-id" "Cb/36JGyIi+",
  "Date" "Sat, 15 Apr 2017 16:12:27 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"QaFuy\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"J43GN\",\"description\":\"kExO8\",\"id\":\"177057932317550_990386480984687/insights/post_video_view_time/day\"},{\"name\":\"2VkWd\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"lPrPk\",\"description\":\"itXVx\",\"id\":\"177057932317550_990386480984687/insights/post_video_view_time/lifetime\"},{\"name\":\"1fMpc\",\"period\":\"lifetime\",\"values\":[{\"value\":27}],\"title\":\"4SEfs\",\"description\":\"ZZCIk\",\"id\":\"177057932317550_990386480984687/insights/post_engaged_fan/lifetime\"},{\"name\":\"6NMH2\",\"period\":\"lifetime\",\"values\":[{\"value\":114}],\"title\":\"hQQqs\",\"description\":\"wnVsE\",\"id\":\"177057932317550_990386480984687/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_990386480984687/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_990386480984687/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_1043848705638464/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 254,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "HsmybrvLRFvuv1LHNzO9UwqoNsFsBrTSbrK8/AwoRX/Y5AnwyhyXdms/4qNEp2oltX5+2nOVAi7htlmrxGoWdw==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961016",
  "ETag" "\"e51d696379b319a1a7dc020d4a7c8b3bf1958aad\"",
  "x-fb-trace-id" "Acn4N/5J+e3",
  "Date" "Sat, 15 Apr 2017 16:12:27 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"57Wyd\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"hb3pi\",\"description\":\"utNkg\",\"id\":\"177057932317550_1043848705638464/insights/post_video_view_time/day\"},{\"name\":\"Hu93x\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"CR7H6\",\"description\":\"Mxr8w\",\"id\":\"177057932317550_1043848705638464/insights/post_video_view_time/lifetime\"},{\"name\":\"MTpyd\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"6qG7F\",\"description\":\"bGg4W\",\"id\":\"177057932317550_1043848705638464/insights/post_engaged_fan/lifetime\"},{\"name\":\"YnnCo\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"BIEPo\",\"description\":\"KGPkL\",\"id\":\"177057932317550_1043848705638464/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_1043848705638464/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_1043848705638464/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_10207570586690352/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 272,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "gGOwr7fkH2ZDD3FKwphlVJupfLzI9wFqRkmkJea0gYaCvmrGT4ZzQhGeC5YRV+Vm9una8ZEkkKKqbbc+6VC2/g==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961016",
  "ETag" "\"21f74e70a36be8aeebaa12df755971162e7ec212\"",
  "x-fb-trace-id" "HFq+KW8re+X",
  "Date" "Sat, 15 Apr 2017 16:12:27 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"sqajV\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"IBjEz\",\"description\":\"KBIYD\",\"id\":\"177057932317550_10207570586690352/insights/post_video_view_time/day\"},{\"name\":\"jOJBm\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"lF8Yj\",\"description\":\"QZSbT\",\"id\":\"177057932317550_10207570586690352/insights/post_video_view_time/lifetime\"},{\"name\":\"I0KXC\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"N11dK\",\"description\":\"bczRO\",\"id\":\"177057932317550_10207570586690352/insights/post_engaged_fan/lifetime\"},{\"name\":\"07LMi\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"KjRK1\",\"description\":\"RQslI\",\"id\":\"177057932317550_10207570586690352/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_10207570586690352/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_10207570586690352/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_1126854757337858/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 264,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "T66lSy3RDFW1/xaTpE+lPwo556gfgetlyHzhpEY/n1tvX8ZJzCrvka2Hq9ZvQ9S/aGTU4Mxfm8GvG1bLXM1ASQ==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961016",
  "ETag" "\"c101d1ee9cdc006e20c6f8d3c2ead354d2d14f90\"",
  "x-fb-trace-id" "GUyCPU9L1X3",
  "Date" "Sat, 15 Apr 2017 16:12:26 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"QQv3Q\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"3F19Y\",\"description\":\"GKuXu\",\"id\":\"177057932317550_1126854757337858/insights/post_video_view_time/day\"},{\"name\":\"UQrDj\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"oemHy\",\"description\":\"5rFSl\",\"id\":\"177057932317550_1126854757337858/insights/post_video_view_time/lifetime\"},{\"name\":\"GYgF2\",\"period\":\"lifetime\",\"values\":[{\"value\":26}],\"title\":\"NvnHb\",\"description\":\"oGCtI\",\"id\":\"177057932317550_1126854757337858/insights/post_engaged_fan/lifetime\"},{\"name\":\"hIeGZ\",\"period\":\"lifetime\",\"values\":[{\"value\":32}],\"title\":\"Olfnr\",\"description\":\"ofdEH\",\"id\":\"177057932317550_1126854757337858/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_1126854757337858/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_1126854757337858/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550_1379478452075486/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145",
 :as :json}
(fn [req]{:request-time 280,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "9l5pDLUI1m5zaH4PIbxdqkWjF2SAhhaTAKbVegv2dsyo8vXYOIEDvKsNPqji8ysTvNakvzUQ/PK0qA85ibZoSQ==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961041",
  "ETag" "\"f97f56d3945582d48efddedd7746e9454ab1428c\"",
  "x-fb-trace-id" "Bt12QuNJsXz",
  "Date" "Sat, 15 Apr 2017 16:12:26 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"name\":\"biRkL\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-16T07:00:00+0000\"}],\"title\":\"wiUv0\",\"description\":\"6MfHk\",\"id\":\"177057932317550_1379478452075486/insights/post_video_view_time/day\"},{\"name\":\"SRJN7\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"3M9Zu\",\"description\":\"ZFNaO\",\"id\":\"177057932317550_1379478452075486/insights/post_video_view_time/lifetime\"},{\"name\":\"5zG26\",\"period\":\"lifetime\",\"values\":[{\"value\":6}],\"title\":\"DOsJr\",\"description\":\"vQt76\",\"id\":\"177057932317550_1379478452075486/insights/post_engaged_fan/lifetime\"},{\"name\":\"QvNlf\",\"period\":\"lifetime\",\"values\":[{\"value\":9}],\"title\":\"cMjit\",\"description\":\"qcsvM\",\"id\":\"177057932317550_1379478452075486/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_1379478452075486/insights?access_token=XXTOKENXX&since=1492186345&until=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550_1379478452075486/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/feed?fields=insights.since%28now%29.metric%28post_video_view_time,post_engaged_fan,post_consumptions%29&limit=40&since=24+months+ago&access_token=XXTOKENXX&until=1429120082&__paging_token=enc_AdDGclYLPsRkhL2l7rZAcPvGgeDZAqL4Uzp4tIj2yC8F70EFI5XejQNMJKFMQ1QiXPDdRaYC1GveBkcIRv46L9Hiw49eyeQ6Fc7eF9fuHBtZAnBCQZDZD",
 :as :json}
(fn [req]{:request-time 268,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "Content-Length" "11",
  "X-FB-Debug"
  "NLGWVbbEHeDlVD4lKXfM2Cx5mB9QBMx5CqvSVBofN8YmMWX7ugDG3h4+sAEAJHNqZ1OkYnaC1eSFXywSI4JwJw==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961041",
  "ETag" "\"1050253aec7b29caff644806927dabfa81406eee\"",
  "x-fb-trace-id" "G6Bp4CXPoSb",
  "Date" "Sat, 15 Apr 2017 16:12:26 GMT",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length 11,
 :body "{\"data\":[]}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/feed?fields=insights.since%28now%29.metric%28post_video_view_time,post_engaged_fan,post_consumptions%29&limit=40&since=24+months+ago&access_token=XXTOKENXX&until=1429120082&__paging_token=enc_AdDGclYLPsRkhL2l7rZAcPvGgeDZAqL4Uzp4tIj2yC8F70EFI5XejQNMJKFMQ1QiXPDdRaYC1GveBkcIRv46L9Hiw49eyeQ6Fc7eF9fuHBtZAnBCQZDZD"]}
){:method :get,
 :address "https://graph.facebook.com/v2.8/feed",
 :as :json,
 :query-params
 {:limit "40",
  :since "24 months ago",
  :until "now",
  :path "feed",
  :fields
  "insights.since(now).metric(post_video_view_time,post_engaged_fan,post_consumptions)",
  :ids "177057932317550",
  :access_token "XXTOKENXX"}}
(fn [req]{:request-time 1187,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "sHIo4JMR9yEyEA+HCsHlV/9dF+fGsOSnQnptIHIKWzeFNVmWTobMa2eLiJBevBpYCpAHo+REqQMFsaJJouCxkg==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2961041",
  "ETag" "\"36e02198a24828c190c4eea11a6047505d840279\"",
  "x-fb-trace-id" "Hl/Ke00QU5B",
  "Date" "Sat, 15 Apr 2017 16:12:25 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"177057932317550\":{\"data\":[{\"id\":\"177057932317550_1379478452075486\",\"insights\":{\"data\":[{\"name\":\"y2Yrt\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"6sW5J\",\"description\":\"RpQhy\",\"id\":\"177057932317550_1379478452075486/insights/post_video_view_time/day\"},{\"name\":\"J8jSr\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"n1pxb\",\"description\":\"9chZZ\",\"id\":\"177057932317550_1379478452075486/insights/post_video_view_time/lifetime\"},{\"name\":\"5v82f\",\"period\":\"lifetime\",\"values\":[{\"value\":6}],\"title\":\"nDTeP\",\"description\":\"SwIbk\",\"id\":\"177057932317550_1379478452075486/insights/post_engaged_fan/lifetime\"},{\"name\":\"QLbaP\",\"period\":\"lifetime\",\"values\":[{\"value\":9}],\"title\":\"DhEVK\",\"description\":\"Z7geD\",\"id\":\"177057932317550_1379478452075486/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_1379478452075486/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_1379478452075486/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_1126854757337858\",\"insights\":{\"data\":[{\"name\":\"kZHQi\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"myJJb\",\"description\":\"yiVfU\",\"id\":\"177057932317550_1126854757337858/insights/post_video_view_time/day\"},{\"name\":\"0iqhI\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"b9fJ1\",\"description\":\"7Pzgc\",\"id\":\"177057932317550_1126854757337858/insights/post_video_view_time/lifetime\"},{\"name\":\"OMeMw\",\"period\":\"lifetime\",\"values\":[{\"value\":26}],\"title\":\"r8owb\",\"description\":\"t4Xhc\",\"id\":\"177057932317550_1126854757337858/insights/post_engaged_fan/lifetime\"},{\"name\":\"nfeOt\",\"period\":\"lifetime\",\"values\":[{\"value\":32}],\"title\":\"FVsvh\",\"description\":\"Q4lNc\",\"id\":\"177057932317550_1126854757337858/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_1126854757337858/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_1126854757337858/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_10207570586690352\",\"insights\":{\"data\":[{\"name\":\"zmJrQ\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"ertd9\",\"description\":\"PR331\",\"id\":\"177057932317550_10207570586690352/insights/post_video_view_time/day\"},{\"name\":\"ItEay\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"9UXSs\",\"description\":\"LXZ6Z\",\"id\":\"177057932317550_10207570586690352/insights/post_video_view_time/lifetime\"},{\"name\":\"6SrKn\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"iGdaT\",\"description\":\"y9Euw\",\"id\":\"177057932317550_10207570586690352/insights/post_engaged_fan/lifetime\"},{\"name\":\"8DKfI\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"XO7nH\",\"description\":\"7E8rP\",\"id\":\"177057932317550_10207570586690352/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_10207570586690352/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_10207570586690352/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_1043848705638464\",\"insights\":{\"data\":[{\"name\":\"xYk7N\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"RCoao\",\"description\":\"w6YR3\",\"id\":\"177057932317550_1043848705638464/insights/post_video_view_time/day\"},{\"name\":\"RjU0K\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"LHxVq\",\"description\":\"hMDJu\",\"id\":\"177057932317550_1043848705638464/insights/post_video_view_time/lifetime\"},{\"name\":\"ML8RS\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"EIK1r\",\"description\":\"O8jTW\",\"id\":\"177057932317550_1043848705638464/insights/post_engaged_fan/lifetime\"},{\"name\":\"BUqhI\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"9GTsN\",\"description\":\"hMX9K\",\"id\":\"177057932317550_1043848705638464/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_1043848705638464/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_1043848705638464/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_990386480984687\",\"insights\":{\"data\":[{\"name\":\"FpKKa\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"afenP\",\"description\":\"aanKa\",\"id\":\"177057932317550_990386480984687/insights/post_video_view_time/day\"},{\"name\":\"DPeKz\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"iTrh4\",\"description\":\"3UpM2\",\"id\":\"177057932317550_990386480984687/insights/post_video_view_time/lifetime\"},{\"name\":\"7Nrvj\",\"period\":\"lifetime\",\"values\":[{\"value\":27}],\"title\":\"yiPMU\",\"description\":\"Njd2v\",\"id\":\"177057932317550_990386480984687/insights/post_engaged_fan/lifetime\"},{\"name\":\"T9xnv\",\"period\":\"lifetime\",\"values\":[{\"value\":114}],\"title\":\"ENqXm\",\"description\":\"EE9dL\",\"id\":\"177057932317550_990386480984687/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_990386480984687/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_990386480984687/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_940984532591549\",\"insights\":{\"data\":[{\"name\":\"ffYKH\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"NNwlo\",\"description\":\"gw5iS\",\"id\":\"177057932317550_940984532591549/insights/post_video_view_time/day\"},{\"name\":\"Lzxdi\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"NyU7J\",\"description\":\"mHyn9\",\"id\":\"177057932317550_940984532591549/insights/post_video_view_time/lifetime\"},{\"name\":\"OVyxa\",\"period\":\"lifetime\",\"values\":[{\"value\":13}],\"title\":\"3JCKR\",\"description\":\"C5pby\",\"id\":\"177057932317550_940984532591549/insights/post_engaged_fan/lifetime\"},{\"name\":\"38VgU\",\"period\":\"lifetime\",\"values\":[{\"value\":97}],\"title\":\"IJ9q9\",\"description\":\"Fbhva\",\"id\":\"177057932317550_940984532591549/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_940984532591549/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_940984532591549/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_932914176731918\",\"insights\":{\"data\":[{\"name\":\"cITur\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"PedY6\",\"description\":\"g5csD\",\"id\":\"177057932317550_932914176731918/insights/post_video_view_time/day\"},{\"name\":\"uh02h\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"gUVK1\",\"description\":\"EL4tf\",\"id\":\"177057932317550_932914176731918/insights/post_video_view_time/lifetime\"},{\"name\":\"EHisq\",\"period\":\"lifetime\",\"values\":[{\"value\":150}],\"title\":\"KsGsc\",\"description\":\"MgT5l\",\"id\":\"177057932317550_932914176731918/insights/post_engaged_fan/lifetime\"},{\"name\":\"TfwYi\",\"period\":\"lifetime\",\"values\":[{\"value\":5315}],\"title\":\"fXdht\",\"description\":\"2S9py\",\"id\":\"177057932317550_932914176731918/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_932914176731918/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_932914176731918/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_921776914512311\",\"insights\":{\"data\":[{\"name\":\"lqcFx\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"NGeBw\",\"description\":\"yrKkv\",\"id\":\"177057932317550_921776914512311/insights/post_video_view_time/day\"},{\"name\":\"UjQHR\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"d1Zl5\",\"description\":\"1ksW8\",\"id\":\"177057932317550_921776914512311/insights/post_video_view_time/lifetime\"},{\"name\":\"qJ3Kh\",\"period\":\"lifetime\",\"values\":[{\"value\":5}],\"title\":\"HmjgG\",\"description\":\"8QFRp\",\"id\":\"177057932317550_921776914512311/insights/post_engaged_fan/lifetime\"},{\"name\":\"zqmdI\",\"period\":\"lifetime\",\"values\":[{\"value\":62}],\"title\":\"2uINg\",\"description\":\"F0gip\",\"id\":\"177057932317550_921776914512311/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_921776914512311/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_921776914512311/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_921759597847376\",\"insights\":{\"data\":[{\"name\":\"CHHf1\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"biZMt\",\"description\":\"NSRwt\",\"id\":\"177057932317550_921759597847376/insights/post_video_view_time/day\"},{\"name\":\"kzqQj\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"He7Mm\",\"description\":\"yrxIT\",\"id\":\"177057932317550_921759597847376/insights/post_video_view_time/lifetime\"},{\"name\":\"jKksn\",\"period\":\"lifetime\",\"values\":[{\"value\":9}],\"title\":\"KnDLy\",\"description\":\"nlxJ6\",\"id\":\"177057932317550_921759597847376/insights/post_engaged_fan/lifetime\"},{\"name\":\"3d1nf\",\"period\":\"lifetime\",\"values\":[{\"value\":56}],\"title\":\"6ZDTC\",\"description\":\"lILaY\",\"id\":\"177057932317550_921759597847376/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_921759597847376/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_921759597847376/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_913890861967583\",\"insights\":{\"data\":[{\"name\":\"YUCHe\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"Cgvze\",\"description\":\"ZHq6o\",\"id\":\"177057932317550_913890861967583/insights/post_video_view_time/day\"},{\"name\":\"fDpNx\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"N4qB7\",\"description\":\"ZwL2t\",\"id\":\"177057932317550_913890861967583/insights/post_video_view_time/lifetime\"},{\"name\":\"2uOtK\",\"period\":\"lifetime\",\"values\":[{\"value\":2}],\"title\":\"SSOTY\",\"description\":\"fZ4na\",\"id\":\"177057932317550_913890861967583/insights/post_engaged_fan/lifetime\"},{\"name\":\"1kSNL\",\"period\":\"lifetime\",\"values\":[{\"value\":2}],\"title\":\"OilfZ\",\"description\":\"lEV6Z\",\"id\":\"177057932317550_913890861967583/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_913890861967583/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_913890861967583/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_913371222019547\",\"insights\":{\"data\":[{\"name\":\"l1N4Y\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"3zv5t\",\"description\":\"6pQ7d\",\"id\":\"177057932317550_913371222019547/insights/post_video_view_time/day\"},{\"name\":\"MaQq6\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"vKZ2h\",\"description\":\"mpl8V\",\"id\":\"177057932317550_913371222019547/insights/post_video_view_time/lifetime\"},{\"name\":\"QnP8B\",\"period\":\"lifetime\",\"values\":[{\"value\":6}],\"title\":\"PgwUz\",\"description\":\"PpHPt\",\"id\":\"177057932317550_913371222019547/insights/post_engaged_fan/lifetime\"},{\"name\":\"krI9u\",\"period\":\"lifetime\",\"values\":[{\"value\":7}],\"title\":\"gW0Kw\",\"description\":\"knlpm\",\"id\":\"177057932317550_913371222019547/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_913371222019547/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_913371222019547/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_910073965682606\",\"insights\":{\"data\":[{\"name\":\"ts713\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"JJz3d\",\"description\":\"n7so0\",\"id\":\"177057932317550_910073965682606/insights/post_video_view_time/day\"},{\"name\":\"jKyCw\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"yqdt6\",\"description\":\"jXNtI\",\"id\":\"177057932317550_910073965682606/insights/post_video_view_time/lifetime\"},{\"name\":\"c3EST\",\"period\":\"lifetime\",\"values\":[{\"value\":6}],\"title\":\"oBktI\",\"description\":\"nGzOc\",\"id\":\"177057932317550_910073965682606/insights/post_engaged_fan/lifetime\"},{\"name\":\"yRyZf\",\"period\":\"lifetime\",\"values\":[{\"value\":5}],\"title\":\"CBrdd\",\"description\":\"7jRN4\",\"id\":\"177057932317550_910073965682606/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_910073965682606/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_910073965682606/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_908277042528965\",\"insights\":{\"data\":[{\"name\":\"hxV15\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"TdXxw\",\"description\":\"a046u\",\"id\":\"177057932317550_908277042528965/insights/post_video_view_time/day\"},{\"name\":\"vdBzH\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"9OxIq\",\"description\":\"NxLSR\",\"id\":\"177057932317550_908277042528965/insights/post_video_view_time/lifetime\"},{\"name\":\"pvgJn\",\"period\":\"lifetime\",\"values\":[{\"value\":6}],\"title\":\"5UYpx\",\"description\":\"7n4Lr\",\"id\":\"177057932317550_908277042528965/insights/post_engaged_fan/lifetime\"},{\"name\":\"t3nOa\",\"period\":\"lifetime\",\"values\":[{\"value\":6}],\"title\":\"c7o9t\",\"description\":\"BVZRa\",\"id\":\"177057932317550_908277042528965/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_908277042528965/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_908277042528965/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}},{\"id\":\"177057932317550_905758402780829\",\"insights\":{\"data\":[{\"name\":\"2s8H9\",\"period\":\"day\",\"values\":[{\"value\":0,\"end_time\":\"2017-04-15T07:00:00+0000\"}],\"title\":\"pmpTy\",\"description\":\"hul2w\",\"id\":\"177057932317550_905758402780829/insights/post_video_view_time/day\"},{\"name\":\"GeVr0\",\"period\":\"lifetime\",\"values\":[{\"value\":0}],\"title\":\"RPSDz\",\"description\":\"EjbYN\",\"id\":\"177057932317550_905758402780829/insights/post_video_view_time/lifetime\"},{\"name\":\"ow0GE\",\"period\":\"lifetime\",\"values\":[{\"value\":3}],\"title\":\"OkQrE\",\"description\":\"RMpLc\",\"id\":\"177057932317550_905758402780829/insights/post_engaged_fan/lifetime\"},{\"name\":\"wXEeh\",\"period\":\"lifetime\",\"values\":[{\"value\":3}],\"title\":\"0sYsb\",\"description\":\"HtQhx\",\"id\":\"177057932317550_905758402780829/insights/post_consumptions/lifetime\"}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550_905758402780829/insights?access_token=XXTOKENXX&since=1492186345&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492272745\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550_905758402780829/insights?access_token=XXTOKENXX&since=1492272745&metric=post_video_view_time%2Cpost_engaged_fan%2Cpost_consumptions&until=1492359145\"}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/feed?fields=insights.since%28now%29.metric%28post_video_view_time,post_engaged_fan,post_consumptions%29&limit=40&since=1491510469&access_token=XXTOKENXX&__paging_token=enc_AdD1oKv62UShBGNFboAc4BJQnLMmQe5XbMXmjpmZAZCaEHTBgxi82ZCTM1ZB7nLSbl6f36azCbkjDLTupuX2RnnefrSEwI2oqRAkV0bPk89hPV1fGgZDZD&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/feed?fields=insights.since%28now%29.metric%28post_video_view_time,post_engaged_fan,post_consumptions%29&limit=40&since=24+months+ago&access_token=XXTOKENXX&until=1429120082&__paging_token=enc_AdDGclYLPsRkhL2l7rZAcPvGgeDZAqL4Uzp4tIj2yC8F70EFI5XejQNMJKFMQ1QiXPDdRaYC1GveBkcIRv46L9Hiw49eyeQ6Fc7eF9fuHBtZAnBCQZDZD\"}}}",
 :trace-redirects ["https://graph.facebook.com/v2.8/feed"]}
)
})

================================================
File: /test/keboola/snapshots/postsinsights/out/tables/accounts
================================================
category,name,id
software,keboola,177057932317550


================================================
File: /test/keboola/snapshots/postsinsights/out/tables/posts_insights/1492272750239
================================================
"177057932317550_905758402780829/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_905758402780829","UResm","","","3","lifetime","","FUWJ8","y34TB"
"177057932317550_905758402780829/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_905758402780829","RKHHT","","","3","lifetime","","vZ6uN","a8OM0"
"177057932317550_905758402780829/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_905758402780829","KsKOd","","","0","lifetime","","oCrrN","18gPT"
"177057932317550_905758402780829/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_905758402780829","e2xq7","","","0","day","2017-04-16T07:00:00+0000","We187","bIogC"
"177057932317550_905758402780829/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_905758402780829","wXEeh","","","3","lifetime","","0sYsb","HtQhx"
"177057932317550_905758402780829/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_905758402780829","ow0GE","","","3","lifetime","","OkQrE","RMpLc"
"177057932317550_905758402780829/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_905758402780829","GeVr0","","","0","lifetime","","RPSDz","EjbYN"
"177057932317550_905758402780829/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_905758402780829","2s8H9","","","0","day","2017-04-15T07:00:00+0000","pmpTy","hul2w"
"177057932317550_908277042528965/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_908277042528965","l6WOG","","","6","lifetime","","HXw2M","0qf3l"
"177057932317550_908277042528965/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_908277042528965","oHv6Z","","","6","lifetime","","XpVR1","RXbJl"
"177057932317550_908277042528965/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_908277042528965","3hdSc","","","0","lifetime","","IjKRU","cIzxu"
"177057932317550_908277042528965/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_908277042528965","rJ2TI","","","0","day","2017-04-16T07:00:00+0000","9eM4z","XR6PH"
"177057932317550_908277042528965/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_908277042528965","t3nOa","","","6","lifetime","","c7o9t","BVZRa"
"177057932317550_908277042528965/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_908277042528965","pvgJn","","","6","lifetime","","5UYpx","7n4Lr"
"177057932317550_908277042528965/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_908277042528965","vdBzH","","","0","lifetime","","9OxIq","NxLSR"
"177057932317550_908277042528965/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_908277042528965","hxV15","","","0","day","2017-04-15T07:00:00+0000","TdXxw","a046u"
"177057932317550_910073965682606/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_910073965682606","Wc3xp","","","5","lifetime","","58hFU","XN1W6"
"177057932317550_910073965682606/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_910073965682606","Ze7w9","","","6","lifetime","","308IR","fB9g4"
"177057932317550_910073965682606/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_910073965682606","GFD0u","","","0","lifetime","","ieGzc","gJ098"
"177057932317550_910073965682606/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_910073965682606","LJ8Iz","","","0","day","2017-04-16T07:00:00+0000","gEZtz","r7UMy"
"177057932317550_910073965682606/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_910073965682606","yRyZf","","","5","lifetime","","CBrdd","7jRN4"
"177057932317550_910073965682606/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_910073965682606","c3EST","","","6","lifetime","","oBktI","nGzOc"
"177057932317550_910073965682606/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_910073965682606","jKyCw","","","0","lifetime","","yqdt6","jXNtI"
"177057932317550_910073965682606/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_910073965682606","ts713","","","0","day","2017-04-15T07:00:00+0000","JJz3d","n7so0"
"177057932317550_913371222019547/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_913371222019547","8LnpI","","","7","lifetime","","uE7I0","rjsJw"
"177057932317550_913371222019547/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_913371222019547","Go6fd","","","6","lifetime","","LsGmf","RKkaH"
"177057932317550_913371222019547/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_913371222019547","HdLpe","","","0","lifetime","","ZXDck","CgPzD"
"177057932317550_913371222019547/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_913371222019547","iUyZJ","","","0","day","2017-04-16T07:00:00+0000","nJN8t","c4FoJ"
"177057932317550_913371222019547/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_913371222019547","krI9u","","","7","lifetime","","gW0Kw","knlpm"
"177057932317550_913371222019547/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_913371222019547","QnP8B","","","6","lifetime","","PgwUz","PpHPt"
"177057932317550_913371222019547/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_913371222019547","MaQq6","","","0","lifetime","","vKZ2h","mpl8V"
"177057932317550_913371222019547/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_913371222019547","l1N4Y","","","0","day","2017-04-15T07:00:00+0000","3zv5t","6pQ7d"
"177057932317550_913890861967583/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_913890861967583","FO3Yp","","","2","lifetime","","dCMOU","a5HIs"
"177057932317550_913890861967583/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_913890861967583","Ihurs","","","2","lifetime","","q1qIT","z5EXn"
"177057932317550_913890861967583/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_913890861967583","PZ5nn","","","0","lifetime","","pz38h","8y1g7"
"177057932317550_913890861967583/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_913890861967583","zVJ4H","","","0","day","2017-04-16T07:00:00+0000","QKLha","11ncv"
"177057932317550_913890861967583/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_913890861967583","1kSNL","","","2","lifetime","","OilfZ","lEV6Z"
"177057932317550_913890861967583/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_913890861967583","2uOtK","","","2","lifetime","","SSOTY","fZ4na"
"177057932317550_913890861967583/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_913890861967583","fDpNx","","","0","lifetime","","N4qB7","ZwL2t"
"177057932317550_913890861967583/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_913890861967583","YUCHe","","","0","day","2017-04-15T07:00:00+0000","Cgvze","ZHq6o"
"177057932317550_921759597847376/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_921759597847376","fsSpY","","","56","lifetime","","khR83","LuepG"
"177057932317550_921759597847376/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_921759597847376","8TuhJ","","","9","lifetime","","b1rpL","6O6zC"
"177057932317550_921759597847376/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_921759597847376","d0fgv","","","0","lifetime","","0Ecs3","tzhI5"
"177057932317550_921759597847376/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_921759597847376","sO8GH","","","0","day","2017-04-16T07:00:00+0000","w2CZ5","MxbSn"
"177057932317550_921759597847376/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_921759597847376","3d1nf","","","56","lifetime","","6ZDTC","lILaY"
"177057932317550_921759597847376/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_921759597847376","jKksn","","","9","lifetime","","KnDLy","nlxJ6"
"177057932317550_921759597847376/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_921759597847376","kzqQj","","","0","lifetime","","He7Mm","yrxIT"
"177057932317550_921759597847376/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_921759597847376","CHHf1","","","0","day","2017-04-15T07:00:00+0000","biZMt","NSRwt"
"177057932317550_921776914512311/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_921776914512311","HgsDz","","","62","lifetime","","cMXWU","Q4GaO"
"177057932317550_921776914512311/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_921776914512311","gLyDR","","","5","lifetime","","kzWln","FWjPk"
"177057932317550_921776914512311/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_921776914512311","e1Fl4","","","0","lifetime","","lCk3S","rPdXa"
"177057932317550_921776914512311/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_921776914512311","gDfI1","","","0","day","2017-04-16T07:00:00+0000","c2Nmd","daGHc"
"177057932317550_921776914512311/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_921776914512311","zqmdI","","","62","lifetime","","2uINg","F0gip"
"177057932317550_921776914512311/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_921776914512311","qJ3Kh","","","5","lifetime","","HmjgG","8QFRp"
"177057932317550_921776914512311/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_921776914512311","UjQHR","","","0","lifetime","","d1Zl5","1ksW8"
"177057932317550_921776914512311/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_921776914512311","lqcFx","","","0","day","2017-04-15T07:00:00+0000","NGeBw","yrKkv"
"177057932317550_932914176731918/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_932914176731918","TZBe6","","","5315","lifetime","","c0zOE","QI6Z9"
"177057932317550_932914176731918/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_932914176731918","usJXt","","","150","lifetime","","3NN9H","tFi72"
"177057932317550_932914176731918/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_932914176731918","yOiGC","","","0","lifetime","","YV0RY","qOkw8"
"177057932317550_932914176731918/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_932914176731918","m0S76","","","0","day","2017-04-16T07:00:00+0000","EoefU","Q86qe"
"177057932317550_932914176731918/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_932914176731918","TfwYi","","","5315","lifetime","","fXdht","2S9py"
"177057932317550_932914176731918/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_932914176731918","EHisq","","","150","lifetime","","KsGsc","MgT5l"
"177057932317550_932914176731918/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_932914176731918","uh02h","","","0","lifetime","","gUVK1","EL4tf"
"177057932317550_932914176731918/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_932914176731918","cITur","","","0","day","2017-04-15T07:00:00+0000","PedY6","g5csD"
"177057932317550_940984532591549/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_940984532591549","jI8Mt","","","97","lifetime","","uJwOw","bbDtY"
"177057932317550_940984532591549/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_940984532591549","CPh5K","","","13","lifetime","","s8QMq","DMNlM"
"177057932317550_940984532591549/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_940984532591549","FLN86","","","0","lifetime","","g4udK","T2YNz"
"177057932317550_940984532591549/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_940984532591549","SyITO","","","0","day","2017-04-16T07:00:00+0000","4TGe9","YfTIE"
"177057932317550_940984532591549/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_940984532591549","38VgU","","","97","lifetime","","IJ9q9","Fbhva"
"177057932317550_940984532591549/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_940984532591549","OVyxa","","","13","lifetime","","3JCKR","C5pby"
"177057932317550_940984532591549/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_940984532591549","Lzxdi","","","0","lifetime","","NyU7J","mHyn9"
"177057932317550_940984532591549/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_940984532591549","ffYKH","","","0","day","2017-04-15T07:00:00+0000","NNwlo","gw5iS"
"177057932317550_990386480984687/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_990386480984687","6NMH2","","","114","lifetime","","hQQqs","wnVsE"
"177057932317550_990386480984687/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_990386480984687","1fMpc","","","27","lifetime","","4SEfs","ZZCIk"
"177057932317550_990386480984687/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_990386480984687","2VkWd","","","0","lifetime","","lPrPk","itXVx"
"177057932317550_990386480984687/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_990386480984687","QaFuy","","","0","day","2017-04-16T07:00:00+0000","J43GN","kExO8"
"177057932317550_990386480984687/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_990386480984687","T9xnv","","","114","lifetime","","ENqXm","EE9dL"
"177057932317550_990386480984687/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_990386480984687","7Nrvj","","","27","lifetime","","yiPMU","Njd2v"
"177057932317550_990386480984687/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_990386480984687","DPeKz","","","0","lifetime","","iTrh4","3UpM2"
"177057932317550_990386480984687/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_990386480984687","FpKKa","","","0","day","2017-04-15T07:00:00+0000","afenP","aanKa"
"177057932317550_1043848705638464/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_1043848705638464","YnnCo","","","0","lifetime","","BIEPo","KGPkL"
"177057932317550_1043848705638464/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_1043848705638464","MTpyd","","","0","lifetime","","6qG7F","bGg4W"
"177057932317550_1043848705638464/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_1043848705638464","Hu93x","","","0","lifetime","","CR7H6","Mxr8w"
"177057932317550_1043848705638464/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_1043848705638464","57Wyd","","","0","day","2017-04-16T07:00:00+0000","hb3pi","utNkg"
"177057932317550_1043848705638464/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_1043848705638464","BUqhI","","","0","lifetime","","9GTsN","hMX9K"
"177057932317550_1043848705638464/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_1043848705638464","ML8RS","","","0","lifetime","","EIK1r","O8jTW"
"177057932317550_1043848705638464/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_1043848705638464","RjU0K","","","0","lifetime","","LHxVq","hMDJu"
"177057932317550_1043848705638464/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_1043848705638464","xYk7N","","","0","day","2017-04-15T07:00:00+0000","RCoao","w6YR3"
"177057932317550_10207570586690352/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_10207570586690352","07LMi","","","0","lifetime","","KjRK1","RQslI"
"177057932317550_10207570586690352/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_10207570586690352","I0KXC","","","0","lifetime","","N11dK","bczRO"
"177057932317550_10207570586690352/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_10207570586690352","jOJBm","","","0","lifetime","","lF8Yj","QZSbT"
"177057932317550_10207570586690352/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_10207570586690352","sqajV","","","0","day","2017-04-16T07:00:00+0000","IBjEz","KBIYD"
"177057932317550_10207570586690352/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_10207570586690352","8DKfI","","","0","lifetime","","XO7nH","7E8rP"
"177057932317550_10207570586690352/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_10207570586690352","6SrKn","","","0","lifetime","","iGdaT","y9Euw"
"177057932317550_10207570586690352/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_10207570586690352","ItEay","","","0","lifetime","","9UXSs","LXZ6Z"
"177057932317550_10207570586690352/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_10207570586690352","zmJrQ","","","0","day","2017-04-15T07:00:00+0000","ertd9","PR331"
"177057932317550_1126854757337858/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_1126854757337858","hIeGZ","","","32","lifetime","","Olfnr","ofdEH"
"177057932317550_1126854757337858/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_1126854757337858","GYgF2","","","26","lifetime","","NvnHb","oGCtI"
"177057932317550_1126854757337858/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_1126854757337858","UQrDj","","","0","lifetime","","oemHy","5rFSl"
"177057932317550_1126854757337858/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_1126854757337858","QQv3Q","","","0","day","2017-04-16T07:00:00+0000","3F19Y","GKuXu"
"177057932317550_1126854757337858/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_1126854757337858","nfeOt","","","32","lifetime","","FVsvh","Q4lNc"
"177057932317550_1126854757337858/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_1126854757337858","OMeMw","","","26","lifetime","","r8owb","t4Xhc"
"177057932317550_1126854757337858/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_1126854757337858","0iqhI","","","0","lifetime","","b9fJ1","7Pzgc"
"177057932317550_1126854757337858/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_1126854757337858","kZHQi","","","0","day","2017-04-15T07:00:00+0000","myJJb","yiVfU"
"177057932317550_1379478452075486/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_1379478452075486","QvNlf","","","9","lifetime","","cMjit","qcsvM"
"177057932317550_1379478452075486/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_1379478452075486","5zG26","","","6","lifetime","","DOsJr","vQt76"
"177057932317550_1379478452075486/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_1379478452075486","SRJN7","","","0","lifetime","","3M9Zu","ZFNaO"
"177057932317550_1379478452075486/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_1379478452075486","biRkL","","","0","day","2017-04-16T07:00:00+0000","wiUv0","6MfHk"
"177057932317550_1379478452075486/insights/post_consumptions/lifetime","177057932317550","page_feed_insights","177057932317550_1379478452075486","QLbaP","","","9","lifetime","","DhEVK","Z7geD"
"177057932317550_1379478452075486/insights/post_engaged_fan/lifetime","177057932317550","page_feed_insights","177057932317550_1379478452075486","5v82f","","","6","lifetime","","nDTeP","SwIbk"
"177057932317550_1379478452075486/insights/post_video_view_time/lifetime","177057932317550","page_feed_insights","177057932317550_1379478452075486","J8jSr","","","0","lifetime","","n1pxb","9chZZ"
"177057932317550_1379478452075486/insights/post_video_view_time/day","177057932317550","page_feed_insights","177057932317550_1379478452075486","y2Yrt","","","0","day","2017-04-15T07:00:00+0000","6sW5J","RpQhy"


================================================
File: /test/keboola/snapshots/postsinsights/out/tables/posts_insights.manifest
================================================
{"columns":["id","ex-account-id","fb-graph-node","parent-id","name","key1","key2","value","period","end_time","title","description"],"incremental":true,"primary_key":["parent_id","id","key1","key2","end_time"]}

================================================
File: /test/keboola/snapshots/postsinsights/config.json
================================================
{
  "storage" : { },
  "parameters" : {
    "accounts" : {
      "177057932317550" : {
        "id" : "177057932317550",
        "name" : "keboola",
        "category" : "software"
      }
    },
    "api-version" : "v2.8",
    "queries" : [ {
      "name" : "posts_insights",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "limit" : "40",
        "since" : "24 months ago",
        "until" : "now",
        "path" : "feed",
        "fields" : "insights.since(now).metric(post_video_view_time,post_engaged_fan,post_consumptions)",
        "ids" : null
      }
    } ]
  },
  "authorization" : {
    "oauth_api" : {
      "id" : "keboola.ex-facebook",
      "credentials" : {
        "id" : "main",
        "authorizedFor" : "Myself",
        "creator" : {
          "id" : "1234",
          "description" : "me@keboola.com"
        },
        "created" : "2016-01-31 00:13:30",
        "oauthVersion" : "facebook",
        "appKey" : "xxx",
        "#data" : "{\"token\":\"XXTOKENXX\"}",
        "#appSecret" : "KBC::Encrypted==ENCODEDSTRING=="
      }
    }
  }
}

================================================
File: /test/keboola/snapshots/serializelists/test_serializelists.clj
================================================
(ns keboola.snapshots.serializelists.test-serializelists
  (:require [keboola.snapshots.serializelists.apicalls :as apicalls]
            [clojure.test :as t :refer :all]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.test-utils.core :as test-utils]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            )
  (:use clj-http.fake))

(deftest serializelists-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "serializelists"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "test/keboola/snapshots/serializelists")
    (test-utils/copy-config-tmp "test/keboola/snapshots/serializelists" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "test/keboola/snapshots/serializelists" tmp-dir)
      )))

================================================
File: /test/keboola/snapshots/serializelists/apicalls.clj
================================================
(ns keboola.snapshots.serializelists.apicalls)
(def recorded 
{
{:method :get,
 :address
 "https://graph.facebook.com/v11.0/act_522606278080331/adsets?access_token=XXTOKENXX&fields=id%2Cfrequency_control_specs&since&until&limit=25&after=QVFIUkpnN2hjN2tvdjhPMGVhYVFzWU83a0c2U0d0bHFiSEFhTERHTnAxWEZA6MzBxbWZASN3JCTnVyVnN5ZAHRJeS00RHVGcnh1a1ZAabGdIeVEya0VwbDhmUGFR",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"23844153993410682\"},{\"id\":\"23844148994770682\",\"frequency_control_specs\":[{\"event\":\"IMPRESSIONS\",\"interval_days\":1,\"max_frequency\":6}]},{\"id\":\"23844111320800682\"},{\"id\":\"23844103736930682\"},{\"id\":\"23844103698260682\"},{\"id\":\"23844102808490682\"},{\"id\":\"23844078885000682\"},{\"id\":\"23844028037580682\"},{\"id\":\"23844027913490682\"},{\"id\":\"23843980952820682\"},{\"id\":\"23843980782690682\"},{\"id\":\"23843888426700682\"},{\"id\":\"23843885056100682\"},{\"id\":\"23843840706700682\"},{\"id\":\"23843838944520682\"},{\"id\":\"23843663131530682\"},{\"id\":\"23843343442760682\"},{\"id\":\"23843240933280682\"},{\"id\":\"23843234244100682\"},{\"id\":\"23843222973130682\"},{\"id\":\"23843222967730682\"},{\"id\":\"23843159603400682\"},{\"id\":\"23843159283730682\"},{\"id\":\"23843121097860682\"},{\"id\":\"23843105682230682\"}],\"paging\":{\"cursors\":{\"before\":\"QVFIUl9sNGFhWG52Mi1xX1RxeHVjb05qOElfQl9wZA2dsSXNnZAVl6Q2FSeFlMaEFhYlZAJUE53R0lHM1V0M2cyTjFXS0E5Q1pGclBnNkFnOUJuSl9KNkpTYW53\",\"after\":\"QVFIUmt0VUhCTzlNT0N0XzZAzWmRGNTNMc3RlelVzQ2dUTnJlb0lZASmk1LXdWZAHd0QXBGY2V3emdGUkJLZAmpidG5Hbk1aTXJFNW5rWkhuWFVFeVdGSnpsZAXZA3\"},\"previous\":\"https://graph.facebook.com/v11.0/act_522606278080331/adsets?access_token=XXTOKENXX&fields=id%2Cfrequency_control_specs&since&until&limit=25&before=QVFIUl9sNGFhWG52Mi1xX1RxeHVjb05qOElfQl9wZA2dsSXNnZAVl6Q2FSeFlMaEFhYlZAJUE53R0lHM1V0M2cyTjFXS0E5Q1pGclBnNkFnOUJuSl9KNkpTYW53\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v11.0/act_522606278080331/adsets?access_token=XXTOKENXX&fields=id%2Cfrequency_control_specs&since&until&limit=25&after=QVFIUlV5cDZAQdE1PaklVb1FqeVMyWGpjSXBWeFNpdEZAhZAlFxLWJpRWo1bmNKODFKX1BZAUk1neVlYNXgtRnRYa016N3NqcE9KczQ1NXBLcFRVeEZA2UTJjcDJB",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"23845588576660682\"},{\"id\":\"23845510551760682\"},{\"id\":\"23845497626260682\"},{\"id\":\"23845458881630682\"},{\"id\":\"23845405656220682\"},{\"id\":\"23845271377410682\",\"frequency_control_specs\":[{\"event\":\"IMPRESSIONS\",\"interval_days\":30,\"max_frequency\":6}]},{\"id\":\"23845270930970682\"},{\"id\":\"23845201552990682\"},{\"id\":\"23845136125380682\"},{\"id\":\"23845063067650682\"},{\"id\":\"23845045896650682\"},{\"id\":\"23844890477370682\"},{\"id\":\"23844763735970682\"},{\"id\":\"23844751217210682\"},{\"id\":\"23844613385860682\"},{\"id\":\"23844596483280682\"},{\"id\":\"23844587024020682\"},{\"id\":\"23844582832290682\"},{\"id\":\"23844490747860682\"},{\"id\":\"23844184544430682\"},{\"id\":\"23844180554710682\"},{\"id\":\"23844178585150682\"},{\"id\":\"23844178324920682\"},{\"id\":\"23844167303090682\"},{\"id\":\"23844154012460682\"}],\"paging\":{\"cursors\":{\"before\":\"QVFIUlpHV0xYdzZAkZADYxaTFLSGRiUzN1Y2pyTklwdFo2TW93Ty14YkFtdTFWNGhIWE5WVHNhOE9KeFJQenNLdWh0ZA21yeEk4emxCZAk5CU2U0TjhPMzJHeGZAB\",\"after\":\"QVFIUkpnN2hjN2tvdjhPMGVhYVFzWU83a0c2U0d0bHFiSEFhTERHTnAxWEZA6MzBxbWZASN3JCTnVyVnN5ZAHRJeS00RHVGcnh1a1ZAabGdIeVEya0VwbDhmUGFR\"},\"next\":\"https://graph.facebook.com/v11.0/act_522606278080331/adsets?access_token=XXTOKENXX&fields=id%2Cfrequency_control_specs&since&until&limit=25&after=QVFIUkpnN2hjN2tvdjhPMGVhYVFzWU83a0c2U0d0bHFiSEFhTERHTnAxWEZA6MzBxbWZASN3JCTnVyVnN5ZAHRJeS00RHVGcnh1a1ZAabGdIeVEya0VwbDhmUGFR\",\"previous\":\"https://graph.facebook.com/v11.0/act_522606278080331/adsets?access_token=XXTOKENXX&fields=id%2Cfrequency_control_specs&since&until&limit=25&before=QVFIUlpHV0xYdzZAkZADYxaTFLSGRiUzN1Y2pyTklwdFo2TW93Ty14YkFtdTFWNGhIWE5WVHNhOE9KeFJQenNLdWh0ZA21yeEk4emxCZAk5CU2U0TjhPMzJHeGZAB\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v11.0/act_522606278080331/adsets?access_token=XXTOKENXX&fields=id%2Cfrequency_control_specs&since&until&limit=25&after=QVFIUlZApWmp5OTlIamFiUld2UWx5X2dQYmNVQ1pWNUlmbEJjVEp3c0Vqel9saTg5SHF6a09UUU1yTlBDZAUo5b0ZADek12V2RvTHZAMS0VBQ3hUY29YTkVaeXN3",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"23847204132950682\"},{\"id\":\"23847148043930682\"},{\"id\":\"23847003783650682\"},{\"id\":\"23846895937800682\"},{\"id\":\"23846429372250682\"},{\"id\":\"23846373085740682\"},{\"id\":\"23846365734200682\"},{\"id\":\"23846337921540682\"},{\"id\":\"23846337921510682\"},{\"id\":\"23846337915070682\"},{\"id\":\"23846337857450682\"},{\"id\":\"23846329888800682\"},{\"id\":\"23846329827020682\"},{\"id\":\"23846328800180682\"},{\"id\":\"23846321778770682\"},{\"id\":\"23846296646780682\"},{\"id\":\"23846234243070682\"},{\"id\":\"23846155939880682\"},{\"id\":\"23846098443230682\"},{\"id\":\"23846052816590682\"},{\"id\":\"23846033839020682\"},{\"id\":\"23845984814360682\"},{\"id\":\"23845724849860682\"},{\"id\":\"23845593460530682\"},{\"id\":\"23845588673010682\"}],\"paging\":{\"cursors\":{\"before\":\"QVFIUmV0N3ltYlYtX3lpQnJNT1oxUGsxTmU5NG5VbjVaQmJzclJXWVRxX2lPdS1DZAzJjaExkemQwSWVzanZAjaVc2R2RWb1M4VFo4NTFEeE9tTG5oQVlLWXZAR\",\"after\":\"QVFIUlV5cDZAQdE1PaklVb1FqeVMyWGpjSXBWeFNpdEZAhZAlFxLWJpRWo1bmNKODFKX1BZAUk1neVlYNXgtRnRYa016N3NqcE9KczQ1NXBLcFRVeEZA2UTJjcDJB\"},\"next\":\"https://graph.facebook.com/v11.0/act_522606278080331/adsets?access_token=XXTOKENXX&fields=id%2Cfrequency_control_specs&since&until&limit=25&after=QVFIUlV5cDZAQdE1PaklVb1FqeVMyWGpjSXBWeFNpdEZAhZAlFxLWJpRWo1bmNKODFKX1BZAUk1neVlYNXgtRnRYa016N3NqcE9KczQ1NXBLcFRVeEZA2UTJjcDJB\",\"previous\":\"https://graph.facebook.com/v11.0/act_522606278080331/adsets?access_token=XXTOKENXX&fields=id%2Cfrequency_control_specs&since&until&limit=25&before=QVFIUmV0N3ltYlYtX3lpQnJNT1oxUGsxTmU5NG5VbjVaQmJzclJXWVRxX2lPdS1DZAzJjaExkemQwSWVzanZAjaVc2R2RWb1M4VFo4NTFEeE9tTG5oQVlLWXZAR\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v11.0/adsets",
 :as :json,
 :query-params
 {:path "adsets",
  :fields "id,frequency_control_specs",
  :ids "act_522606278080331",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:status 200,
 :body
 "{\"act_522606278080331\":{\"data\":[{\"id\":\"23849106408410682\"},{\"id\":\"23849103477910682\",\"frequency_control_specs\":[{\"event\":\"IMPRESSIONS\",\"interval_days\":7,\"max_frequency\":1}]},{\"id\":\"23849067903270682\"},{\"id\":\"23849060995620682\"},{\"id\":\"23848962452680682\"},{\"id\":\"23848953603860682\"},{\"id\":\"23848953041860682\"},{\"id\":\"23848952915280682\"},{\"id\":\"23848927728330682\"},{\"id\":\"23848794070540682\"},{\"id\":\"23848686761460682\"},{\"id\":\"23848685259860682\"},{\"id\":\"23848685195570682\"},{\"id\":\"23848141469160682\"},{\"id\":\"23848105082980682\"},{\"id\":\"23848081830050682\"},{\"id\":\"23848056918680682\"},{\"id\":\"23847987759170682\"},{\"id\":\"23847936601890682\"},{\"id\":\"23847873997490682\"},{\"id\":\"23847669609830682\"},{\"id\":\"23847650185210682\"},{\"id\":\"23847602203250682\"},{\"id\":\"23847209514990682\"},{\"id\":\"23847209454990682\"}],\"paging\":{\"cursors\":{\"before\":\"QVFIUmNySG1OQkR0RUFhaWNoX1VIMlVxaVZAQRzNwNXRGaExSOVk0ajJQbXRVWkZA6U3ZAYVmFhRW9IR2MyUHI1eFhUZAGN1N1gwdWd3VFY2VHhKbVVlaTVOSTNR\",\"after\":\"QVFIUlZApWmp5OTlIamFiUld2UWx5X2dQYmNVQ1pWNUlmbEJjVEp3c0Vqel9saTg5SHF6a09UUU1yTlBDZAUo5b0ZADek12V2RvTHZAMS0VBQ3hUY29YTkVaeXN3\"},\"next\":\"https://graph.facebook.com/v11.0/act_522606278080331/adsets?access_token=XXTOKENXX&fields=id%2Cfrequency_control_specs&since&until&limit=25&after=QVFIUlZApWmp5OTlIamFiUld2UWx5X2dQYmNVQ1pWNUlmbEJjVEp3c0Vqel9saTg5SHF6a09UUU1yTlBDZAUo5b0ZADek12V2RvTHZAMS0VBQ3hUY29YTkVaeXN3\"}}}"}
)
})

================================================
File: /test/keboola/snapshots/serializelists/out/tables/adsets.manifest
================================================
{"columns":["id","ex-account-id","fb-graph-node","parent-id","frequency_control_specs"],"incremental":true,"primary_key":["parent_id","id"]}

================================================
File: /test/keboola/snapshots/serializelists/out/tables/adsets/1638290127158
================================================
"23843105682230682","act_522606278080331","page_adsets","act_522606278080331",""
"23843121097860682","act_522606278080331","page_adsets","act_522606278080331",""
"23843159283730682","act_522606278080331","page_adsets","act_522606278080331",""
"23843159603400682","act_522606278080331","page_adsets","act_522606278080331",""
"23843222967730682","act_522606278080331","page_adsets","act_522606278080331",""
"23843222973130682","act_522606278080331","page_adsets","act_522606278080331",""
"23843234244100682","act_522606278080331","page_adsets","act_522606278080331",""
"23843240933280682","act_522606278080331","page_adsets","act_522606278080331",""
"23843343442760682","act_522606278080331","page_adsets","act_522606278080331",""
"23843663131530682","act_522606278080331","page_adsets","act_522606278080331",""
"23843838944520682","act_522606278080331","page_adsets","act_522606278080331",""
"23843840706700682","act_522606278080331","page_adsets","act_522606278080331",""
"23843885056100682","act_522606278080331","page_adsets","act_522606278080331",""
"23843888426700682","act_522606278080331","page_adsets","act_522606278080331",""
"23843980782690682","act_522606278080331","page_adsets","act_522606278080331",""
"23843980952820682","act_522606278080331","page_adsets","act_522606278080331",""
"23844027913490682","act_522606278080331","page_adsets","act_522606278080331",""
"23844028037580682","act_522606278080331","page_adsets","act_522606278080331",""
"23844078885000682","act_522606278080331","page_adsets","act_522606278080331",""
"23844102808490682","act_522606278080331","page_adsets","act_522606278080331",""
"23844103698260682","act_522606278080331","page_adsets","act_522606278080331",""
"23844103736930682","act_522606278080331","page_adsets","act_522606278080331",""
"23844111320800682","act_522606278080331","page_adsets","act_522606278080331",""
"23844148994770682","act_522606278080331","page_adsets","act_522606278080331","[{""event"":""IMPRESSIONS"",""interval_days"":1,""max_frequency"":6}]"
"23844153993410682","act_522606278080331","page_adsets","act_522606278080331",""
"23844154012460682","act_522606278080331","page_adsets","act_522606278080331",""
"23844167303090682","act_522606278080331","page_adsets","act_522606278080331",""
"23844178324920682","act_522606278080331","page_adsets","act_522606278080331",""
"23844178585150682","act_522606278080331","page_adsets","act_522606278080331",""
"23844180554710682","act_522606278080331","page_adsets","act_522606278080331",""
"23844184544430682","act_522606278080331","page_adsets","act_522606278080331",""
"23844490747860682","act_522606278080331","page_adsets","act_522606278080331",""
"23844582832290682","act_522606278080331","page_adsets","act_522606278080331",""
"23844587024020682","act_522606278080331","page_adsets","act_522606278080331",""
"23844596483280682","act_522606278080331","page_adsets","act_522606278080331",""
"23844613385860682","act_522606278080331","page_adsets","act_522606278080331",""
"23844751217210682","act_522606278080331","page_adsets","act_522606278080331",""
"23844763735970682","act_522606278080331","page_adsets","act_522606278080331",""
"23844890477370682","act_522606278080331","page_adsets","act_522606278080331",""
"23845045896650682","act_522606278080331","page_adsets","act_522606278080331",""
"23845063067650682","act_522606278080331","page_adsets","act_522606278080331",""
"23845136125380682","act_522606278080331","page_adsets","act_522606278080331",""
"23845201552990682","act_522606278080331","page_adsets","act_522606278080331",""
"23845270930970682","act_522606278080331","page_adsets","act_522606278080331",""
"23845271377410682","act_522606278080331","page_adsets","act_522606278080331","[{""event"":""IMPRESSIONS"",""interval_days"":30,""max_frequency"":6}]"
"23845405656220682","act_522606278080331","page_adsets","act_522606278080331",""
"23845458881630682","act_522606278080331","page_adsets","act_522606278080331",""
"23845497626260682","act_522606278080331","page_adsets","act_522606278080331",""
"23845510551760682","act_522606278080331","page_adsets","act_522606278080331",""
"23845588576660682","act_522606278080331","page_adsets","act_522606278080331",""
"23845588673010682","act_522606278080331","page_adsets","act_522606278080331",""
"23845593460530682","act_522606278080331","page_adsets","act_522606278080331",""
"23845724849860682","act_522606278080331","page_adsets","act_522606278080331",""
"23845984814360682","act_522606278080331","page_adsets","act_522606278080331",""
"23846033839020682","act_522606278080331","page_adsets","act_522606278080331",""
"23846052816590682","act_522606278080331","page_adsets","act_522606278080331",""
"23846098443230682","act_522606278080331","page_adsets","act_522606278080331",""
"23846155939880682","act_522606278080331","page_adsets","act_522606278080331",""
"23846234243070682","act_522606278080331","page_adsets","act_522606278080331",""
"23846296646780682","act_522606278080331","page_adsets","act_522606278080331",""
"23846321778770682","act_522606278080331","page_adsets","act_522606278080331",""
"23846328800180682","act_522606278080331","page_adsets","act_522606278080331",""
"23846329827020682","act_522606278080331","page_adsets","act_522606278080331",""
"23846329888800682","act_522606278080331","page_adsets","act_522606278080331",""
"23846337857450682","act_522606278080331","page_adsets","act_522606278080331",""
"23846337915070682","act_522606278080331","page_adsets","act_522606278080331",""
"23846337921510682","act_522606278080331","page_adsets","act_522606278080331",""
"23846337921540682","act_522606278080331","page_adsets","act_522606278080331",""
"23846365734200682","act_522606278080331","page_adsets","act_522606278080331",""
"23846373085740682","act_522606278080331","page_adsets","act_522606278080331",""
"23846429372250682","act_522606278080331","page_adsets","act_522606278080331",""
"23846895937800682","act_522606278080331","page_adsets","act_522606278080331",""
"23847003783650682","act_522606278080331","page_adsets","act_522606278080331",""
"23847148043930682","act_522606278080331","page_adsets","act_522606278080331",""
"23847204132950682","act_522606278080331","page_adsets","act_522606278080331",""
"23847209454990682","act_522606278080331","page_adsets","act_522606278080331",""
"23847209514990682","act_522606278080331","page_adsets","act_522606278080331",""
"23847602203250682","act_522606278080331","page_adsets","act_522606278080331",""
"23847650185210682","act_522606278080331","page_adsets","act_522606278080331",""
"23847669609830682","act_522606278080331","page_adsets","act_522606278080331",""
"23847873997490682","act_522606278080331","page_adsets","act_522606278080331",""
"23847936601890682","act_522606278080331","page_adsets","act_522606278080331",""
"23847987759170682","act_522606278080331","page_adsets","act_522606278080331",""
"23848056918680682","act_522606278080331","page_adsets","act_522606278080331",""
"23848081830050682","act_522606278080331","page_adsets","act_522606278080331",""
"23848105082980682","act_522606278080331","page_adsets","act_522606278080331",""
"23848141469160682","act_522606278080331","page_adsets","act_522606278080331",""
"23848685195570682","act_522606278080331","page_adsets","act_522606278080331",""
"23848685259860682","act_522606278080331","page_adsets","act_522606278080331",""
"23848686761460682","act_522606278080331","page_adsets","act_522606278080331",""
"23848794070540682","act_522606278080331","page_adsets","act_522606278080331",""
"23848927728330682","act_522606278080331","page_adsets","act_522606278080331",""
"23848952915280682","act_522606278080331","page_adsets","act_522606278080331",""
"23848953041860682","act_522606278080331","page_adsets","act_522606278080331",""
"23848953603860682","act_522606278080331","page_adsets","act_522606278080331",""
"23848962452680682","act_522606278080331","page_adsets","act_522606278080331",""
"23849060995620682","act_522606278080331","page_adsets","act_522606278080331",""
"23849067903270682","act_522606278080331","page_adsets","act_522606278080331",""
"23849103477910682","act_522606278080331","page_adsets","act_522606278080331","[{""event"":""IMPRESSIONS"",""interval_days"":7,""max_frequency"":1}]"
"23849106408410682","act_522606278080331","page_adsets","act_522606278080331",""


================================================
File: /test/keboola/snapshots/serializelists/out/tables/accounts
================================================
account_id,name,business_name,currency,id
522606278080331,aaa,"aaa.cz, s.r.o.",CZK,act_522606278080331


================================================
File: /test/keboola/snapshots/serializelists/config.json
================================================
{
  "storage" : { },
  "parameters" : {
    "accounts" : {
      "act_522606278080331" : {
        "account_id" : "522606278080331",
        "business_name" : "aaa.cz, s.r.o.",
        "currency" : "CZK",
        "id" : "act_522606278080331",
        "name" : "aaa"
      }
    },
    "api-version" : "v11.0",
    "queries" : [ {
      "name" : "adsets",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "adsets",
        "fields" : "id,frequency_control_specs",
        "ids" : ""
      }
    } ]
  },
  "authorization" : {
    "oauth_api" : {
      "id" : "keboola.ex-facebook-ads",
      "credentials" : {
        "id" : "main",
        "authorizedFor" : "Myself",
        "creator" : {
          "id" : "1234",
          "description" : "me@keboola.com"
        },
        "created" : "2016-01-31 00:13:30",
        "oauthVersion" : "facebook",
        "appKey" : "xxx",
        "#data" : "{\"token\":\"XXTOKENXX\"}",
        "#appSecret" : "KBC::Encrypted==ENCODEDSTRING=="
      }
    }
  }
}

================================================
File: /test/keboola/snapshots/outdirs_check.clj
================================================
(ns keboola.snapshots.outdirs-check
  (:require [clojure.test :as t :refer :all]
            [cheshire.core :refer [parse-string]])
  (:import java.io.File))


(defn list-dir [path]
  (let [dirs (.listFiles (File. path))]
    (zipmap (map #(.getName %) dirs) dirs)))

(defn filter-dirs [dir]
  (filter #(.isDirectory (second %)) dir))

(defn is-same-ls [expected actual]
  (let [expected-names (keys expected)
        actual-names (keys actual)]
    (is (= (set expected-names) (set actual-names)))))

(defn read-file [path]
  (with-open [r (clojure.java.io/reader path)]
    (doall (line-seq r))))

(defn parse-json [path]
  (let [file-content (slurp path)]
    (parse-string file-content true)))

(defn compare-manifests [expected-path actual-path]
  (let [expected (parse-json expected-path)
        actual (parse-json actual-path)
        expected-pk (:primary_key expected)
        actual-pk (:primary_key actual)
        actual-pk-set (set actual-pk)]
        
    (is (:incremental actual))
    (is (=  (:columns expected) (:columns actual)))
    (is (= (count actual-pk) (count actual-pk-set)))
    (is (= expected-pk actual-pk))))

(defn compare-file-content [[f1 f2]]
  (let [f1path (.getAbsolutePath f1)
        f2path (.getAbsolutePath f2)
        f1-lines (set (read-file f1path))
        f2-lines (set (read-file f2path))
        diff (clojure.set/difference f1-lines f2-lines)]
    #_(println "comparing" f1path "vs." f2path)
    (is (empty? diff) (str "files are not same:" f1path " vs " f2path ". Difference:" diff))))

(defn compare-sliced-dir [expected actual]
  (let [a (sort-by #(.getName %) (.listFiles expected))
        b (sort-by #(.getName %) (.listFiles actual))
        pairs-to-compare (zipmap a b)]
    (is (= (count a) (count b)))
    (doseq [pair pairs-to-compare]
      (compare-file-content pair))))

(defn filter-manifests [dir]
  (into {} (filter #(re-matches #".*\.manifest$" (first %)) dir)))

(defn is-equal [expected-dir actual-dir]
  (let
      [exptected-tables-path (str expected-dir "/out/tables")
       actual-tables-path (str actual-dir "/out/tables")
       ls-expected (list-dir exptected-tables-path)
       ls-actual (list-dir actual-tables-path)]
    (is-same-ls ls-expected ls-actual)
    (doseq [manifest-name (keys (filter-manifests ls-expected))]
      (compare-manifests (ls-expected manifest-name) (ls-actual manifest-name)))
    (doseq [dir-name (keys (filter-dirs ls-expected))]
      (compare-sliced-dir (ls-expected dir-name) (ls-actual dir-name)))))


================================================
File: /test/keboola/snapshots/core.clj
================================================
(ns keboola.snapshots.core
  (:require [cheshire.core :refer [generate-stream]]
            [clj-http.fake :refer [with-global-fake-routes-in-isolation]]
            [clojure.test :as t :refer :all]
            clostache.parser
            [keboola.docker.config :refer [load-config user-credentials get-fb-token]]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.http.client :refer [GET]]
            [keboola.http.recording
             :refer
             [recording
              reset-recording
              save-current-recording
              turn-recording-off
              turn-recording-on]]
            [keboola.test-utils.core :as test-utils])
  (:import java.io.File))

(defn create-test-file [dir-path ns-name recording-ns test-name]
  (let [test-file-path (str dir-path "/" "test" "_" test-name ".clj")
        test-ns (str ns-name ".test-" test-name)
        template {:ns-name test-ns
                  :apicalls-ns recording-ns
                  :test-name test-name
                  :dir-path dir-path}
        test-content-template (slurp "test/keboola/snapshots/template.mustache")
        test-file-content (clostache.parser/render test-content-template template)]
    (with-open [w (clojure.java.io/writer test-file-path)]
      (.write w test-file-content))))

(defn clean-test-directory [dirpath]
  (println "cleaning test directory " dirpath)
  (let [files (.listFiles (File. dirpath))
        filtered-files (filter #(not= (.getName %) "config.json") files)]
    (doseq [f filtered-files]
      (if (.isDirectory f)
        (test-utils/delete-recursively f)
        (clojure.java.io/delete-file f)))))

(defn save-token-to-config! [dirpath token]
  (let [config (load-config dirpath)
        oauth-data-path [:authorization :oauth_api :credentials :#data]
        anonymized-oauth-data (str "{\"token\":\"" token "\"}")
        anonymized-config (assoc-in config oauth-data-path anonymized-oauth-data)
        path (str dirpath "/config.json")]
    (println "saving token" (subs token 0 2) " into " dirpath)
    (generate-stream anonymized-config (clojure.java.io/writer path) {:pretty true})))

(defn anonymize-config-token [dirpath]
  (save-token-to-config! dirpath "XXTOKENXX"))

(defn get-token-from-env [component-id]
  (let [env-name
        (get {
          "keboola.ex-facebook" "FB_TOKEN"
          "keboola.ex-facebook-ads" "FB_ADS_TOKEN"
          } component-id)]
    (if env-name (System/getenv env-name))))

(defn save-config-token-from-env [dirpath]
  (let [config (load-config dirpath)
        component-id (get-in config [:authorization :oauth_api :id])
        token (get-token-from-env component-id)]
    (if token
      (do (println "Read token from env for " component-id)
          (save-token-to-config! dirpath token))
      (println "No token read for" component-id))))

(defn generate-test
  ([dirname] (generate-test dirname true))
  ([dirname anonymize-token?]
   (let [clj-compliant-name (clojure.string/replace dirname #"_" "-")
         ns-name (str "keboola.snapshots." clj-compliant-name)
         dir-path (str "test/keboola/snapshots/" dirname)
         recording-path (str "test/keboola/snapshots/" dirname "/apicalls.clj")
         recording-ns (str ns-name ".apicalls")]
     (disable-log-token)
     (turn-recording-on)
     (clean-test-directory dir-path)
     (reset-recording)
     (reset-columns-map)
     (save-config-token-from-env dir-path)
     (prepare-and-run dir-path)
     (println "saving apicalls in " dirname)
     (save-current-recording recording-path recording-ns (get-fb-token (user-credentials dir-path)))
     (println "creating test file " clj-compliant-name)
     (create-test-file dir-path ns-name recording-ns clj-compliant-name)
     (turn-recording-off)
     (if anonymize-token? (anonymize-config-token dir-path)))))

(defn regenerate-all-snapshot-dirs
  ([] (regenerate-all-snapshot-dirs nil))
  ([dirfilter]
   (let [snapshot-dirs (filter #(.isDirectory %) (.listFiles (File. "test/keboola/snapshots")))
         dir-names (map #(.getName %) snapshot-dirs)
         filter-regexp (re-pattern (or dirfilter ""))
         dirs-filtered (filter #(re-find filter-regexp %) dir-names)]

     (println "found snapshot dirs(" dirfilter "):" dirs-filtered)
     (doseq [dname dirs-filtered]
       (generate-test dname)))))


================================================
File: /test/keboola/snapshots/pageinsights/test_pageinsights.clj
================================================
(ns keboola.snapshots.pageinsights.test-pageinsights
  (:require [clj-http.fake :refer :all]
            [clojure.test :as t :refer :all]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.snapshots.pageinsights.apicalls :as apicalls]
            [keboola.test-utils.core :as test-utils]))

(deftest pageinsights-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "pageinsights"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "test/keboola/snapshots/pageinsights")
    (test-utils/copy-config-tmp "test/keboola/snapshots/pageinsights" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "test/keboola/snapshots/pageinsights" tmp-dir)
      )))


================================================
File: /test/keboola/snapshots/pageinsights/apicalls.clj
================================================
(ns keboola.snapshots.pageinsights.apicalls)
(def recorded 
{
{:method :get,
 :address "https://graph.facebook.com/v2.8/",
 :as :json,
 :query-params
 {:path "",
  :fields
  "insights.since(2 days ago).metric(page_views_by_age_gender_logged_in_unique,page_impressions_by_story_type, page_impressions_by_locale_unique, page_views_total, page_fans)",
  :ids "177057932317550",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:request-time 210,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "Content-Length" "44",
  "X-FB-Debug"
  "/TnsS2OJtJYHEFzAosELf8xMKiJjZM+vS5Y9qZqFgkAhGfOqxcLibRr8VY9hwtYGsnePij/HdS/13UNp4DN5Dg==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"c11e4a9eb900828f15b1ae7f0c9aa66af50b3ff9\"",
  "x-fb-trace-id" "DXyqTBool3t",
  "Date" "Fri, 31 Mar 2017 08:11:01 GMT",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length 44,
 :body "{\"177057932317550\":{\"id\":\"177057932317550\"}}",
 :trace-redirects ["https://graph.facebook.com/v2.8/"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBmZCEpy6qDk6tj1rYLio1WD6i6UyX9iSmIVoZBUWSDXzmsZCLVcHP30JZCmeEoSeLJoZBcoE4FxPZCt6kL7iZAiKu3unFebHaxYRfH79qZBgkM7GeaPgZDZD&access_token=XXTOKENXX&until=1293605065",
 :as :json}
(fn [req]{:request-time 225,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "Content-Length" "11",
  "X-FB-Debug"
  "cI0OnVYSS/+hQL0RE+RFBwRt0wrYeluV6Ts35PNT1veIi8gOvsQApoD7FzySF6xlSY6URNSRjWB1I2mZY5dxiw==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"1050253aec7b29caff644806927dabfa81406eee\"",
  "x-fb-trace-id" "BrPS2r4vz66",
  "Date" "Fri, 31 Mar 2017 08:11:00 GMT",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length 11,
 :body "{\"data\":[]}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBmZCEpy6qDk6tj1rYLio1WD6i6UyX9iSmIVoZBUWSDXzmsZCLVcHP30JZCmeEoSeLJoZBcoE4FxPZCt6kL7iZAiKu3unFebHaxYRfH79qZBgkM7GeaPgZDZD&access_token=XXTOKENXX&until=1293605065"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBPHMmoZBciO7OfIFbP3eCQLNgwPVlilLhMJD1um2Rgpqswu0ke29HtCQgz771KYaJW6GA2U8CnC65ByUZB5TB3hfAVi4UD80UwVBVpc9LNGQcAZDZD&access_token=XXTOKENXX&until=1297287056",
 :as :json}
(fn [req]{:request-time 270,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "qyp31q4EDeRccX2hNseFSRdvHUCZcpK/L4WSqxcAqwp5PZsHN8OuIfKJ5IL7LaXMMkdZGbfqTIKmsNbNA4RIag==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"f115a1f03ec69a4912a1ae72e1456bb649db9248\"",
  "x-fb-trace-id" "EoPrEOsmboc",
  "Date" "Fri, 31 Mar 2017 08:11:00 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_185882488101761\",\"created_time\":\"2011-02-01T17:19:10+0000\",\"message\":\"0mgSm\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":6}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":6,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_126067137462604\",\"created_time\":\"2011-01-31T16:18:43+0000\",\"message\":\"UkxEq\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_184322484924428\",\"created_time\":\"2011-01-26T16:57:24+0000\",\"message\":\"QmR9o\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":4,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_180908155265861\",\"created_time\":\"2011-01-13T16:04:23+0000\",\"message\":\"tXlNv\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_134098826650108\",\"created_time\":\"2010-12-29T23:12:41+0000\",\"message\":\"8ZIlG\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_171674186203006\",\"created_time\":\"2010-12-29T06:44:25+0000\",\"message\":\"RH8L7\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdB0U76INIRrvMQZBTPGA2JdpNXLC8ZAZAgzZBM2VWyfI30EjDl1lxYD1OhGlEOjUhouEZBLLRUNamhtAyDsPKBgOe9aTDp5Keyy6bZBSsJxn8zjrdiwZDZD&since=1296580750&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBmZCEpy6qDk6tj1rYLio1WD6i6UyX9iSmIVoZBUWSDXzmsZCLVcHP30JZCmeEoSeLJoZBcoE4FxPZCt6kL7iZAiKu3unFebHaxYRfH79qZBgkM7GeaPgZDZD&access_token=XXTOKENXX&until=1293605065\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBPHMmoZBciO7OfIFbP3eCQLNgwPVlilLhMJD1um2Rgpqswu0ke29HtCQgz771KYaJW6GA2U8CnC65ByUZB5TB3hfAVi4UD80UwVBVpc9LNGQcAZDZD&access_token=XXTOKENXX&until=1297287056"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdB0h00eNynZAMzTn2TZCXrIj3SEyG4y3cO1a3kLQej57f6aOhYCBsDAGw0voetYXEzPu8K8UEMGxvRdqWygXwEx0aY9a9DJZAGXbO1OzYJ4MrKYgZDZD&access_token=XXTOKENXX&until=1308931830",
 :as :json}
(fn [req]{:request-time 300,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "6GaxGI+acEB0O0ECsHiBOwb56l3SLoy0voUV3Y9FX4+XrWne768W/jh6wSpx1iHUrO0H++1kbjdH/PZUt/mVyQ==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"501948ace3b05783716df4c0ef6a2d9cbc89e72a\"",
  "x-fb-trace-id" "D29t4a2udCk",
  "Date" "Fri, 31 Mar 2017 08:11:00 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_218189694871040\",\"created_time\":\"2011-06-20T21:21:53+0000\",\"message\":\"3ds9Z\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":6}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":6,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_216377241726149\",\"created_time\":\"2011-06-13T20:32:24+0000\",\"message\":\"7MHDB\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_209620832394593\",\"created_time\":\"2011-05-14T14:09:31+0000\",\"message\":\"7qR5W\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_215623685128044\",\"created_time\":\"2011-05-06T13:31:17+0000\",\"message\":\"QOeG3\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_196467620396988\",\"created_time\":\"2011-05-03T12:48:16+0000\",\"message\":\"vKOew\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_137582739648143\",\"created_time\":\"2011-04-06T21:19:32+0000\",\"message\":\"2irTt\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_211220768894075\",\"created_time\":\"2011-03-24T08:20:56+0000\",\"message\":\"3VMft\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":10}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":10,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_197403570282986\",\"created_time\":\"2011-03-21T23:27:41+0000\",\"message\":\"LsclF\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":6}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":6,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_192688704088246\",\"created_time\":\"2011-02-11T11:50:25+0000\",\"message\":\"xIUtN\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_199870140026616\",\"created_time\":\"2011-02-09T21:30:56+0000\",\"message\":\"yhGY0\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":4,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDDHy5M7Q6L1ozy5vOgAcuCWwmMGQlQaiuTZBEQgjh38ZA8JEEZAbrqIv3oKSe7ZBPiSNvpnHIlCT1UwoBEe8ijhZApdckV5eS0zYOXC0qWe1xDu5AZDZD&since=1308604913&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBPHMmoZBciO7OfIFbP3eCQLNgwPVlilLhMJD1um2Rgpqswu0ke29HtCQgz771KYaJW6GA2U8CnC65ByUZB5TB3hfAVi4UD80UwVBVpc9LNGQcAZDZD&access_token=XXTOKENXX&until=1297287056\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdB0h00eNynZAMzTn2TZCXrIj3SEyG4y3cO1a3kLQej57f6aOhYCBsDAGw0voetYXEzPu8K8UEMGxvRdqWygXwEx0aY9a9DJZAGXbO1OzYJ4MrKYgZDZD&access_token=XXTOKENXX&until=1308931830"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAND23Vg010Ka2EDl74hwDTvSyJepz1I4hPYrha9WDQ9AYHkwd7DD2CoKUvgdTVTBUw0ZBcW2ecmIPbArJZBShl2aWa4Ijcyzrkux23BRzYl5egZDZD&access_token=XXTOKENXX&until=1318257234",
 :as :json}
(fn [req]{:request-time 430,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "tUzcTBDe+m3+iN5SAEd+OBoWnqgD0Wuh16NdJMgezH9fcHErsl+lCf7eKEuLm2NnUL6ixsMzoC5WKlHMqia+qw==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"8e61f003233294990d3c510c4600353e164094c4\"",
  "x-fb-trace-id" "EKvD7fVJp4K",
  "Date" "Fri, 31 Mar 2017 08:11:00 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_252981534725189\",\"created_time\":\"2011-08-30T20:35:31+0000\",\"message\":\"mhtWr\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":4,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_141088755980548\",\"created_time\":\"2011-08-23T10:08:03+0000\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_158899414188800\",\"created_time\":\"2011-08-22T09:25:21+0000\",\"message\":\"iQ3V5\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_183429435059845\",\"created_time\":\"2011-08-22T09:24:42+0000\",\"message\":\"eyeK1\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_179407758797038\",\"created_time\":\"2011-08-18T18:23:19+0000\",\"message\":\"RJy5Y\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_249145035105683\",\"created_time\":\"2011-08-10T09:13:22+0000\",\"message\":\"QEUP5\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_224521170914631\",\"created_time\":\"2011-07-04T05:34:22+0000\",\"message\":\"vEB8O\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_240014989344643\",\"created_time\":\"2011-06-27T09:16:21+0000\",\"message\":\"1ltWy\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_235614199800401\",\"created_time\":\"2011-06-25T19:40:44+0000\",\"message\":\"sYtKY\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_168333893234364\",\"created_time\":\"2011-06-24T16:10:30+0000\",\"message\":\"mKgeK\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdChU4uMZCEcKTO5Pe1XyZCRVIIPoRCgJiDBsdlAXawYTNNWOL3lyAFGmJ0jQ5Sic0DP3LZBb3JzMWZAhXYD420QMWdc44RKmt4a6uooihsgJRCvHgZDZD&since=1314736531&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdB0h00eNynZAMzTn2TZCXrIj3SEyG4y3cO1a3kLQej57f6aOhYCBsDAGw0voetYXEzPu8K8UEMGxvRdqWygXwEx0aY9a9DJZAGXbO1OzYJ4MrKYgZDZD&access_token=XXTOKENXX&until=1308931830\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAND23Vg010Ka2EDl74hwDTvSyJepz1I4hPYrha9WDQ9AYHkwd7DD2CoKUvgdTVTBUw0ZBcW2ecmIPbArJZBShl2aWa4Ijcyzrkux23BRzYl5egZDZD&access_token=XXTOKENXX&until=1318257234"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAj3i4hAfVAWpcZCBfRL8foL3Oh7hZAIsNCsUuuyGNIBYKzBTQO4UN1KVvGCNOlnB9ZAY8kBbFoISkR6CBM8E7E072zZCBW6ly4ZCdfadbOx5pYhsAZDZD&access_token=XXTOKENXX&until=1323723120",
 :as :json}
(fn [req]{:request-time 312,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "kspdgk3QPoQRwCWfS/odJ5sbKQzgCbKeq1JL9EwNz+bI9PeBSsoiF0Clt+dCIepe3m7PWztTNVtQ0R7VjBeSZQ==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"a53e3613610f91995cb3500c043a4bfde9846aac\"",
  "x-fb-trace-id" "BC2PuX1cQw2",
  "Date" "Fri, 31 Mar 2017 08:10:59 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_285228031514604\",\"created_time\":\"2011-12-09T12:48:35+0000\",\"message\":\"jSrqW\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_269366146445734\",\"created_time\":\"2011-12-05T15:41:46+0000\",\"message\":\"ry4Jk\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_285051821518160\",\"created_time\":\"2011-11-10T21:50:09+0000\",\"message\":\"IncqK\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":6}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":6,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_281387161884626\",\"created_time\":\"2011-11-02T19:50:05+0000\",\"message\":\"9egT3\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_280609595295716\",\"created_time\":\"2011-10-31T23:38:38+0000\",\"message\":\"uSWa1\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_140498742716844\",\"created_time\":\"2011-10-27T17:25:46+0000\",\"message\":\"JWzfH\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_278627468827262\",\"created_time\":\"2011-10-27T09:22:01+0000\",\"message\":\"0BJsy\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_247915598594326\",\"created_time\":\"2011-10-25T21:42:50+0000\",\"message\":\"R5Nur\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_277989612224381\",\"created_time\":\"2011-10-25T21:40:08+0000\",\"message\":\"k9Gbu\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_271057969584212\",\"created_time\":\"2011-10-10T14:33:54+0000\",\"message\":\"HGsYL\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":6}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":6,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBcEq4ZAIZCK1ZBkN23ZCaZA3g6M520JRWCY3XKRoCNz8LX4UKKStkEtOsZBc4gLZBtMkYZCDpVjw8ENINR3mklAwXKJo7wy5ZAYwXFkXFkT5T8YBjETGAZDZD&since=1323434915&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAND23Vg010Ka2EDl74hwDTvSyJepz1I4hPYrha9WDQ9AYHkwd7DD2CoKUvgdTVTBUw0ZBcW2ecmIPbArJZBShl2aWa4Ijcyzrkux23BRzYl5egZDZD&access_token=XXTOKENXX&until=1318257234\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAj3i4hAfVAWpcZCBfRL8foL3Oh7hZAIsNCsUuuyGNIBYKzBTQO4UN1KVvGCNOlnB9ZAY8kBbFoISkR6CBM8E7E072zZCBW6ly4ZCdfadbOx5pYhsAZDZD&access_token=XXTOKENXX&until=1323723120"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBW0sKAA0d3W8VS3vUPD751TcHBjDmApQVyszfZB6ClaeiBZAFIPzAcZBnSgEGYd3MzzQc5Vc70su8PomZCGxIJh7uqdWieB7USPOdCCiyQ4VGMbwZDZD&access_token=XXTOKENXX&until=1343209626",
 :as :json}
(fn [req]{:request-time 303,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "YI+UmvSWqykTbIR+B8ViL36vAixSjWt+/VeNZ8tivpRXJIlPL1qVq2Wq8iu4688zkUAt3XcUMR4duT6hqyK7ZA==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"3998037c3c581591e8de3435b1989bdb04dbc5bf\"",
  "x-fb-trace-id" "GKbE7fGzWll",
  "Date" "Fri, 31 Mar 2017 08:10:59 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_334081216672711\",\"created_time\":\"2012-07-03T07:47:33+0000\",\"message\":\"p4a4P\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":4,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_228383477282117\",\"created_time\":\"2012-06-22T13:12:56+0000\",\"message\":\"cjG6p\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":7}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":7,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_162215200570381\",\"created_time\":\"2012-06-14T13:22:27+0000\",\"message\":\"NNXMz\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_361138837242791\",\"created_time\":\"2012-03-16T20:21:01+0000\",\"message\":\"4PqF6\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_352005758179048\",\"created_time\":\"2012-03-15T20:49:46+0000\",\"message\":\"xi4FS\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_353214921378881\",\"created_time\":\"2012-02-21T22:03:23+0000\",\"message\":\"jDQ4o\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_323610584328950\",\"created_time\":\"2012-01-18T01:00:37+0000\",\"message\":\"tsBZO\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_305498366140172\",\"created_time\":\"2011-12-17T08:38:33+0000\",\"message\":\"1ZYPh\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_305252146164794\",\"created_time\":\"2011-12-16T20:27:59+0000\",\"message\":\"DRdKP\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_302791829744159\",\"created_time\":\"2011-12-12T20:52:00+0000\",\"message\":\"n2krP\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBxAPrZCZCKJBgYzFKv7Vmy8MehG7EaI2rJtOazWzZCVZApn1qAUomPvfceWrW2ee5KVMr5dg7Nm8AUgIVIJVOqMys4UIhhpOdpt4FpPvhbkUxeEQZDZD&since=1341301653&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAj3i4hAfVAWpcZCBfRL8foL3Oh7hZAIsNCsUuuyGNIBYKzBTQO4UN1KVvGCNOlnB9ZAY8kBbFoISkR6CBM8E7E072zZCBW6ly4ZCdfadbOx5pYhsAZDZD&access_token=XXTOKENXX&until=1323723120\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBW0sKAA0d3W8VS3vUPD751TcHBjDmApQVyszfZB6ClaeiBZAFIPzAcZBnSgEGYd3MzzQc5Vc70su8PomZCGxIJh7uqdWieB7USPOdCCiyQ4VGMbwZDZD&access_token=XXTOKENXX&until=1343209626"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdACTfrCcDetaZC65jVNjG4dZA4vGtrLwkUAUZBwzT8igozueIjmWr4JSYgtoGX5cZCZAo9ud3dn86a7RM7foEjSZBmIoIbLMRRZAVViEkaqbfAKLspLAZDZD&access_token=XXTOKENXX&until=1355386805",
 :as :json}
(fn [req]{:request-time 611,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "Lz/+MlxcEBeL24YHIyi8x169wGLFrlAXA4qW1c6IjfNHzKhP4dlMkEuVElnEuQ8Aq9pXk0PuBNV+wbBAgXCz/A==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"9e6459030c5c95de075da321b41fa98ef8f4fc7a\"",
  "x-fb-trace-id" "GKJujVhDK08",
  "Date" "Fri, 31 Mar 2017 08:10:58 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_398123956929427\",\"created_time\":\"2012-12-12T12:15:28+0000\",\"message\":\"ly738\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_403487893058520\",\"created_time\":\"2012-11-01T15:28:03+0000\",\"message\":\"of85Y\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":4,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_294180184015204\",\"created_time\":\"2012-10-30T12:09:25+0000\",\"message\":\"VQFav\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_368159903264593\",\"created_time\":\"2012-10-08T14:32:58+0000\",\"message\":\"vD5bv\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":7}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":7,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_452914554731885\",\"created_time\":\"2012-09-03T14:16:17+0000\",\"message\":\"U33Df\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":14}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":14,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_449064145116926\",\"created_time\":\"2012-08-23T12:36:10+0000\",\"message\":\"CUBFV\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":7}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":7,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_472227856128208\",\"created_time\":\"2012-08-11T04:17:07+0000\",\"message\":\"zXaTW\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_444666632223344\",\"created_time\":\"2012-08-10T10:55:58+0000\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_420838671299530\",\"created_time\":\"2012-08-02T08:26:38+0000\",\"message\":\"E9hcE\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":4,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_206217736172757\",\"created_time\":\"2012-07-25T09:47:06+0000\",\"message\":\"fHmxw\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":6}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":6,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBLUyNIdISwU1CVZBgTZAWnwSKY3GZCtZCYxmlaGnTXH4BwKKBw0EhaCUHZBbVtRyHaB2tBx8syi8Mk46gJcR2nHXqBwfjRxieMdCiyVgvfC98IIVAZDZD&since=1355314528&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBW0sKAA0d3W8VS3vUPD751TcHBjDmApQVyszfZB6ClaeiBZAFIPzAcZBnSgEGYd3MzzQc5Vc70su8PomZCGxIJh7uqdWieB7USPOdCCiyQ4VGMbwZDZD&access_token=XXTOKENXX&until=1343209626\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdACTfrCcDetaZC65jVNjG4dZA4vGtrLwkUAUZBwzT8igozueIjmWr4JSYgtoGX5cZCZAo9ud3dn86a7RM7foEjSZBmIoIbLMRRZAVViEkaqbfAKLspLAZDZD&access_token=XXTOKENXX&until=1355386805"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdCrOkkgA6lYUd0h6nZA7lQwoRALYioDqaSJqfg1ZBnlP3YQHLSGmOB7LgJdOym1GnzvtcJKwFnGVmwl3Vk2rLBHBE3YTMEaYrO1eoELpxCMFZBZBwZDZD&access_token=XXTOKENXX&until=1366706931",
 :as :json}
(fn [req]{:request-time 386,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "KYrnNP1+/bwVt/r1MQACZsjR0PKVXleRTbZeAQ8mpJ+smjjpiOzRCtPzFb7rY/fJ4Y+T4dGXfiSZmvPdp2VqgA==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"215fe348a5975be307dbc41faf0dcea06f2bea53\"",
  "x-fb-trace-id" "F3fw3iTkqQt",
  "Date" "Fri, 31 Mar 2017 08:10:58 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_352096094902637\",\"created_time\":\"2013-04-04T04:44:50+0000\",\"message\":\"vWQgS\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_539121112777895\",\"created_time\":\"2013-03-27T22:09:42+0000\",\"message\":\"VkZnv\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_435813276500215\",\"created_time\":\"2013-03-20T08:47:10+0000\",\"message\":\"kOWrb\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_504556319595892\",\"created_time\":\"2013-02-01T20:55:52+0000\",\"message\":\"2pTB1\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_521257084573804\",\"created_time\":\"2013-01-18T11:18:39+0000\",\"message\":\"jOV4Y\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":10}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":10,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_505184512838222\",\"created_time\":\"2013-01-16T14:26:58+0000\",\"message\":\"GLyoG\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_318695688240580\",\"created_time\":\"2013-01-16T07:06:43+0000\",\"message\":\"lPaVt\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_193778417428982\",\"created_time\":\"2013-01-04T16:52:45+0000\",\"message\":\"rOhqo\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_173834012740815\",\"created_time\":\"2012-12-14T09:27:53+0000\",\"message\":\"dM9m5\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_490073454349328\",\"created_time\":\"2012-12-13T08:20:05+0000\",\"message\":\"cgxoR\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":4,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdA8VgcwyTKeZAYc7KQLsOXKLYbZAEmkjcZBTGhtqxsPCw0Yj8qDI6GfbjYmRd9YBZBbUMf6hrOgV2Ftb19LZAZA9hiE9CCffsRxZBFZA5rQ07L3BZCOQZAgZDZD&since=1365050690&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdACTfrCcDetaZC65jVNjG4dZA4vGtrLwkUAUZBwzT8igozueIjmWr4JSYgtoGX5cZCZAo9ud3dn86a7RM7foEjSZBmIoIbLMRRZAVViEkaqbfAKLspLAZDZD&access_token=XXTOKENXX&until=1355386805\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdCrOkkgA6lYUd0h6nZA7lQwoRALYioDqaSJqfg1ZBnlP3YQHLSGmOB7LgJdOym1GnzvtcJKwFnGVmwl3Vk2rLBHBE3YTMEaYrO1eoELpxCMFZBZBwZDZD&access_token=XXTOKENXX&until=1366706931"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdCJgHpn5Jlfp1xYSz6HGGDxFHgdGZCq7eLrhqldbnrgdKz0tVEa9UZBEZAL8mJ5p9wXSo2OCG0UJxzZCoFZBkoHu0yZBXPlGgKPzanuZAN63HLJ4adFAZDZD&access_token=XXTOKENXX&until=1388793444",
 :as :json}
(fn [req]{:request-time 327,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "hxze83YZg5n61NKNYmSRa+zSMYPmo8JIjZNWh4FpiYaiRqZaJRf60TsSUAMaZukl2yH7Xu5ChSgBsddbi7FVxw==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"9c403f5bc89337b77f224fb240ec5e3cfed92407\"",
  "x-fb-trace-id" "AeBxU/ItEh5",
  "Date" "Fri, 31 Mar 2017 08:10:58 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_605510722805600\",\"created_time\":\"2013-09-04T13:19:52+0000\",\"message\":\"IoP4B\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":19}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":19,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_602382753118397\",\"created_time\":\"2013-08-27T17:22:55+0000\",\"message\":\"bOIZ9\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":28}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":28,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_593958677294138\",\"created_time\":\"2013-08-08T00:58:39+0000\",\"message\":\"j6xKP\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":4,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_587969594559713\",\"created_time\":\"2013-07-25T12:48:30+0000\",\"message\":\"wfCkG\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":8}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":8,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_576225999067406\",\"created_time\":\"2013-06-27T13:27:58+0000\",\"message\":\"n0q6f\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":4,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_556370214386318\",\"created_time\":\"2013-05-13T08:39:33+0000\",\"message\":\"nWtcV\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":13}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":13,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_554128261277180\",\"created_time\":\"2013-05-07T05:56:06+0000\",\"message\":\"8LY8P\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_552180764805263\",\"created_time\":\"2013-05-02T08:16:18+0000\",\"message\":\"lngnz\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_548905048466168\",\"created_time\":\"2013-04-23T19:11:41+0000\",\"message\":\"IZNFN\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":7}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":7,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_548725015150838\",\"created_time\":\"2013-04-23T08:48:51+0000\",\"message\":\"Zw9nU\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdASw7ZCann6sjvGPQ8lh9AUTAZAoIEGlOhRYlK90ohJMpQ8iWvjDcxegZAf6zjIFgmyuAv3lyTFuSpkADuLJgD7oLh5eUQrEAXbYJZBZBsHqCTfm0AZDZD&since=1378300792&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdCrOkkgA6lYUd0h6nZA7lQwoRALYioDqaSJqfg1ZBnlP3YQHLSGmOB7LgJdOym1GnzvtcJKwFnGVmwl3Vk2rLBHBE3YTMEaYrO1eoELpxCMFZBZBwZDZD&access_token=XXTOKENXX&until=1366706931\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdCJgHpn5Jlfp1xYSz6HGGDxFHgdGZCq7eLrhqldbnrgdKz0tVEa9UZBEZAL8mJ5p9wXSo2OCG0UJxzZCoFZBkoHu0yZBXPlGgKPzanuZAN63HLJ4adFAZDZD&access_token=XXTOKENXX&until=1388793444"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdByYFEKfhFPdWfoa2VTzkLWD665rDGcNEQiJZB7BpwLG8yfyEy7qmKKGSMIBQdl2jhLfsyiXzkGGekcAORjrZAYSULsOdjaU2ZBMNCppLdYvwGDgZDZD&access_token=XXTOKENXX&until=1404828395",
 :as :json}
(fn [req]{:request-time 323,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "xLVIgViDf8cAW8v6b/jb4Gz6Kr54omDFjuf8suP0er8hj/366W+ST111+9ZzXi9UjzaPNHQv0WaBhLbLKUHnog==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"c5e2edd3f1eae2ec16902ca723d01ce7f37c4f80\"",
  "x-fb-trace-id" "DJc5hm4ZIWH",
  "Date" "Fri, 31 Mar 2017 08:10:57 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_752430261446978\",\"created_time\":\"2014-07-04T23:13:41+0000\",\"message\":\"953Tm\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_752191708137500\",\"created_time\":\"2014-07-04T12:25:07+0000\",\"message\":\"50fBT\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_743919872298017\",\"created_time\":\"2014-06-17T05:48:34+0000\",\"message\":\"rUw3D\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_728575230499148\",\"created_time\":\"2014-05-16T21:28:35+0000\",\"message\":\"t72u4\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_728575040499167\",\"created_time\":\"2014-05-16T21:28:02+0000\",\"message\":\"wDiDj\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_728259217197416\",\"created_time\":\"2014-05-16T03:13:48+0000\",\"message\":\"1xfuY\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":4}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":4,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_726738767349461\",\"created_time\":\"2014-05-12T22:10:11+0000\",\"message\":\"SGmNb\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_10202220745311669\",\"created_time\":\"2014-01-14T20:19:38+0000\",\"message\":\"6PKty\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":9}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":9,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_10202183243654151\",\"created_time\":\"2014-01-09T04:12:24+0000\",\"message\":\"lEdJZ\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_663940230295982\",\"created_time\":\"2014-01-03T23:57:24+0000\",\"message\":\"9o6Fx\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":17}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":17,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAp7y32sL8K9Y1AvpbXalvgUEvrTGD3SoxiwhTNrYZBesND3H0C8MX6AKYtRr412ciUe6tIOq6dbIq2VZCZA6neEnRSlu6KKRoU0V8FyueJQlD8wZDZD&since=1404515621&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdCJgHpn5Jlfp1xYSz6HGGDxFHgdGZCq7eLrhqldbnrgdKz0tVEa9UZBEZAL8mJ5p9wXSo2OCG0UJxzZCoFZBkoHu0yZBXPlGgKPzanuZAN63HLJ4adFAZDZD&access_token=XXTOKENXX&until=1388793444\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdByYFEKfhFPdWfoa2VTzkLWD665rDGcNEQiJZB7BpwLG8yfyEy7qmKKGSMIBQdl2jhLfsyiXzkGGekcAORjrZAYSULsOdjaU2ZBMNCppLdYvwGDgZDZD&access_token=XXTOKENXX&until=1404828395"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAhUZC5HyriRppt06OqO1v9sv2egaEkHlxJ8RR3VJy00I2FmQxSJXQMNORiGmoI4Cks4BYZCFqIBMIvwDgGhLRuZAHKASz7KnPDF5PaUDae2e9EAZDZD&access_token=XXTOKENXX&until=1408020334",
 :as :json}
(fn [req]{:request-time 408,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "P/2MlgDhC07IzKdfLNQ7ald6a38OOkHsp+N93ZP49xJCcLQOjdZZAZiKIx7OiiY6FIPGORyBQLzY+cCNI4aVgQ==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"83fe83c7f6b2286f8e27c2a8c75a2d628a33a40a\"",
  "x-fb-trace-id" "AjDImB1VjLA",
  "Date" "Fri, 31 Mar 2017 08:10:57 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_769681236388547\",\"created_time\":\"2014-08-11T13:04:32+0000\",\"message\":\"tspwl\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_768031333220204\",\"created_time\":\"2014-08-07T19:20:18+0000\",\"message\":\"MG5gx\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_763436517013019\",\"created_time\":\"2014-07-28T23:08:57+0000\",\"message\":\"LhS77\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_759927937363877\",\"created_time\":\"2014-07-21T07:31:50+0000\",\"message\":\"dYmR0\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_758019590888045\",\"created_time\":\"2014-07-17T14:36:39+0000\",\"message\":\"8iYVQ\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_756609071029097\",\"created_time\":\"2014-07-14T05:40:02+0000\",\"message\":\"hiacx\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_755399434483394\",\"created_time\":\"2014-07-11T15:02:44+0000\",\"message\":\"TyYpR\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_754441377912533\",\"created_time\":\"2014-07-09T10:24:29+0000\",\"message\":\"S5kWa\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_754072867949384\",\"created_time\":\"2014-07-08T14:25:02+0000\",\"message\":\"D8zUT\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":12}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":12,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_754064174616920\",\"created_time\":\"2014-07-08T14:06:35+0000\",\"message\":\"FWRks\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdD9VEgqWj9QF0pEoG3cb5ZAgsQ4Nl8u0tjnwaXoRfBNvNqfktyk7uLDG3f8NuZA2Sh2v7eTa89ZA8rGAmwLcIZC1cuS7QWplA4Rl18RJpYOtzg8lgZDZD&since=1407762272&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdByYFEKfhFPdWfoa2VTzkLWD665rDGcNEQiJZB7BpwLG8yfyEy7qmKKGSMIBQdl2jhLfsyiXzkGGekcAORjrZAYSULsOdjaU2ZBMNCppLdYvwGDgZDZD&access_token=XXTOKENXX&until=1404828395\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAhUZC5HyriRppt06OqO1v9sv2egaEkHlxJ8RR3VJy00I2FmQxSJXQMNORiGmoI4Cks4BYZCFqIBMIvwDgGhLRuZAHKASz7KnPDF5PaUDae2e9EAZDZD&access_token=XXTOKENXX&until=1408020334"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdCOSZBk8Lz7xQNmBdXf7ZBjnHzLUqywqTc9ScPzwRoPqtKrlnKGn0kjNI1OFxWaPy8e8ZAmtZC6xUh28Mei1ZAlKvut3MuQnMm2aTvaiTHIUjZAhV6AZDZD&access_token=XXTOKENXX&until=1411081893",
 :as :json}
(fn [req]{:request-time 307,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "x/6/o65mR1qPEzmdZXu6DieNUbc3ktgjlpYjvSxYVlTQ9+DQyfix1VdF5+8VJhypY7ulyvYFwDWN+sk9QLqINQ==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"5434ca4e4d267b661a66bfbf241fc0bdc9dfd01b\"",
  "x-fb-trace-id" "Ei8msNARi9B",
  "Date" "Fri, 31 Mar 2017 08:10:57 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_790255884331082\",\"created_time\":\"2014-09-16T19:16:16+0000\",\"message\":\"9qn2c\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_790080467681957\",\"created_time\":\"2014-09-16T14:08:28+0000\",\"message\":\"1SJRV\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_788400981183239\",\"created_time\":\"2014-09-13T03:31:18+0000\",\"message\":\"OIQdM\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_787063444650326\",\"created_time\":\"2014-09-09T16:42:59+0000\",\"message\":\"BHO83\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_787058171317520\",\"created_time\":\"2014-09-09T16:32:01+0000\",\"message\":\"mnx1c\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_780460005310670\",\"created_time\":\"2014-08-30T00:00:10+0000\",\"message\":\"CS8B3\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_779709275385743\",\"created_time\":\"2014-08-28T19:14:35+0000\",\"message\":\"tWN2s\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_779023718787632\",\"created_time\":\"2014-08-27T19:43:01+0000\",\"message\":\"aDeLP\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_771704046186266\",\"created_time\":\"2014-08-16T09:28:01+0000\",\"message\":\"XwP4r\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_770954352927902\",\"created_time\":\"2014-08-14T12:45:34+0000\",\"message\":\"oPKlF\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdC2ssLq4DBB9M0ymMZBN0QsBUF6xmTZAj9XPweKZAFdET3BIACZAZCep7o7jDZAJOiqAzw8xV3DvQa9ZBBqZBbeeaY0ivnItYPhLsK3bwvj1TYZCFH4K1gZDZD&since=1410894976&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAhUZC5HyriRppt06OqO1v9sv2egaEkHlxJ8RR3VJy00I2FmQxSJXQMNORiGmoI4Cks4BYZCFqIBMIvwDgGhLRuZAHKASz7KnPDF5PaUDae2e9EAZDZD&access_token=XXTOKENXX&until=1408020334\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdCOSZBk8Lz7xQNmBdXf7ZBjnHzLUqywqTc9ScPzwRoPqtKrlnKGn0kjNI1OFxWaPy8e8ZAmtZC6xUh28Mei1ZAlKvut3MuQnMm2aTvaiTHIUjZAhV6AZDZD&access_token=XXTOKENXX&until=1411081893"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdD5G9YzP2NVZCAhByMUMscMFZCKDi6qa6Yj8B9vbs4RhnW6YBdg49t2Lpyk3UyfKNcvyyEZBIb9A9hoRo7cFGJgem36C2hy39o0LYk9Uzj6ZBCQuwZDZD&access_token=XXTOKENXX&until=1415179768",
 :as :json}
(fn [req]{:request-time 300,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "sU8LDf2RnYqk97UJhOyuXWsHUj6PIoX8ludAiMu2cwOQHOJoMdSvcTANPtjfD3+nqrHlx0xFIIPnf5/yk6bPVg==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"4e237a1d052ba894c0a281531097b225649995ef\"",
  "x-fb-trace-id" "ETtb+5sTp3p",
  "Date" "Fri, 31 Mar 2017 08:10:56 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_815120581844612\",\"created_time\":\"2014-11-04T21:50:56+0000\",\"message\":\"k8rc8\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_812853865404617\",\"created_time\":\"2014-10-31T15:38:03+0000\",\"message\":\"6L36s\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_812344502122220\",\"created_time\":\"2014-10-30T12:15:12+0000\",\"message\":\"NDeR6\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_810959602260710\",\"created_time\":\"2014-10-27T15:33:59+0000\",\"message\":\"nwuD6\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_809469985743005\",\"created_time\":\"2014-10-24T13:37:50+0000\",\"message\":\"STgbs\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_809400435749960\",\"created_time\":\"2014-10-24T09:45:37+0000\",\"message\":\"jqVPc\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_809124919110845\",\"created_time\":\"2014-10-23T16:33:21+0000\",\"message\":\"3kvVl\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_801886059834731\",\"created_time\":\"2014-10-09T20:03:24+0000\",\"message\":\"Q0kik\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_800747633281907\",\"created_time\":\"2014-10-07T20:23:16+0000\",\"message\":\"qk5GQ\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_791379880885349\",\"created_time\":\"2014-09-18T23:11:33+0000\",\"message\":\"Gn80n\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBOr04QdDIzLCDaL407G9xjCYvt7KrTzpsL5CxzTRx2hRYsn2A4xfkAWnaPPdcFgFLZArfrLKBVH0Tj5V7wZA3efNdu3bIZBJyb62FZCrcAoRTQKQZDZD&since=1415137856&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdCOSZBk8Lz7xQNmBdXf7ZBjnHzLUqywqTc9ScPzwRoPqtKrlnKGn0kjNI1OFxWaPy8e8ZAmtZC6xUh28Mei1ZAlKvut3MuQnMm2aTvaiTHIUjZAhV6AZDZD&access_token=XXTOKENXX&until=1411081893\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdD5G9YzP2NVZCAhByMUMscMFZCKDi6qa6Yj8B9vbs4RhnW6YBdg49t2Lpyk3UyfKNcvyyEZBIb9A9hoRo7cFGJgem36C2hy39o0LYk9Uzj6ZBCQuwZDZD&access_token=XXTOKENXX&until=1415179768"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdD90WmLQhhSXl8mz8AQX8C57B36JCkeObsZBJL1oySiBCyEAZCxiOXFpNXMfTZARdROhaL57lx0epMrmN1YjCsqlbNgisrMCN9MXogxC201D3ehwZDZD&access_token=XXTOKENXX&until=1418154326",
 :as :json}
(fn [req]{:request-time 364,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "q1yVkxKbir7QS3qqyGDjKhkZmQHZhZkHvFyuolaL8qg3bqRR/JWo0WPBh/6SCAu+Vq27h+jVcL3DD776VO1pBw==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"ea801d231bd6d1455da4ca901b3908942acf1706\"",
  "x-fb-trace-id" "HAB0Uw5iArD",
  "Date" "Fri, 31 Mar 2017 08:10:56 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_835895269767143\",\"created_time\":\"2014-12-08T09:08:44+0000\",\"message\":\"zSBhv\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_832653096758027\",\"created_time\":\"2014-12-02T15:41:46+0000\",\"message\":\"PVNEI\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_831635373526466\",\"created_time\":\"2014-12-01T13:35:41+0000\",\"message\":\"yUCbw\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_831492690207401\",\"created_time\":\"2014-12-01T08:33:03+0000\",\"message\":\"V4sng\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_829756233714380\",\"created_time\":\"2014-11-28T18:17:24+0000\",\"message\":\"2MOxJ\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_828735377149799\",\"created_time\":\"2014-11-26T23:48:41+0000\",\"message\":\"vYqdJ\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_824196854270318\",\"created_time\":\"2014-11-20T11:32:28+0000\",\"message\":\"B6eOq\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_822018727821464\",\"created_time\":\"2014-11-15T22:06:52+0000\",\"message\":\"4pVHN\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_815860998437237\",\"created_time\":\"2014-11-06T09:15:08+0000\",\"message\":\"kZ0HP\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_815328998490437\",\"created_time\":\"2014-11-05T09:29:28+0000\",\"message\":\"BkiPD\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDQiqzWrllyZClRHZC7LZA0EzxOheYAKZAf86xh6mcmlNZCkRu1kJtUhSZAGA9kvAZCfbw9wnP064iZBRMBZBf3yfJ497w82VPY14dM2DFwEUU9lAG0yzgZDZD&since=1418029724&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdD5G9YzP2NVZCAhByMUMscMFZCKDi6qa6Yj8B9vbs4RhnW6YBdg49t2Lpyk3UyfKNcvyyEZBIb9A9hoRo7cFGJgem36C2hy39o0LYk9Uzj6ZBCQuwZDZD&access_token=XXTOKENXX&until=1415179768\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdD90WmLQhhSXl8mz8AQX8C57B36JCkeObsZBJL1oySiBCyEAZCxiOXFpNXMfTZARdROhaL57lx0epMrmN1YjCsqlbNgisrMCN9MXogxC201D3ehwZDZD&access_token=XXTOKENXX&until=1418154326"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDBrRVdA9RZCh7IlpUFQmTRmkYSYHKRqxoAyWx5vBZBWnmcCapDGF8R8h5WBLUvIZB8aqtO4AJSZBDS4QXe1OT1ZAcOH7LDZCMyRfoxfwbABSh0BmMgZDZD&access_token=XXTOKENXX&until=1421255954",
 :as :json}
(fn [req]{:request-time 319,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "PbnG3B8RfGvlrDq+j9trkQFqpdFiq2SMCam5/TOqdqoeOetZTr6ii7ON+dk/3MNs87dUyJ5wZU9wNeomnW4AEQ==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"7a57382495e012a827368678c8381f4b900003fc\"",
  "x-fb-trace-id" "Et3t7XB6Vna",
  "Date" "Fri, 31 Mar 2017 08:10:56 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_856461684377168\",\"created_time\":\"2015-01-08T22:12:56+0000\",\"message\":\"UWqq2\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_856006187756051\",\"created_time\":\"2015-01-07T22:49:59+0000\",\"message\":\"gZnCp\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_854822971207706\",\"created_time\":\"2015-01-06T20:43:33+0000\",\"message\":\"jvyry\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_843461772343826\",\"created_time\":\"2014-12-22T19:22:12+0000\",\"message\":\"qhuBU\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_843202225703114\",\"created_time\":\"2014-12-22T06:01:43+0000\",\"message\":\"7ZF8v\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_842012709155399\",\"created_time\":\"2014-12-20T00:19:08+0000\",\"message\":\"KV9fD\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_841844912505512\",\"created_time\":\"2014-12-19T15:06:55+0000\",\"message\":\"Z2v98\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_840894219267248\",\"created_time\":\"2014-12-17T10:58:40+0000\",\"message\":\"8qPhI\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_840209139335756\",\"created_time\":\"2014-12-15T17:35:00+0000\",\"message\":\"Yk09u\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_836616029695067\",\"created_time\":\"2014-12-09T19:45:26+0000\",\"message\":\"E7K3u\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDIHNaxmTsmji9N7XGKZC5DABRY6kJp2X0IMgNPGOZCF1vTgfZCbVsIRgtrYC3ZAa0c8JNpmr4RAsLE8wxXYtXqiDiquzh9nR6YflqqqURPmhgpGwZDZD&since=1420755176&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdD90WmLQhhSXl8mz8AQX8C57B36JCkeObsZBJL1oySiBCyEAZCxiOXFpNXMfTZARdROhaL57lx0epMrmN1YjCsqlbNgisrMCN9MXogxC201D3ehwZDZD&access_token=XXTOKENXX&until=1418154326\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDBrRVdA9RZCh7IlpUFQmTRmkYSYHKRqxoAyWx5vBZBWnmcCapDGF8R8h5WBLUvIZB8aqtO4AJSZBDS4QXe1OT1ZAcOH7LDZCMyRfoxfwbABSh0BmMgZDZD&access_token=XXTOKENXX&until=1421255954"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAa5WFQeSa0UnaFVtNkwSpZBBgQ1mWWFi6j4L1ZC9mTwVIgthDil5ve9TorLQwVbdrJCQTMllVSZC4KKeLPYUGpD6PvQf6O3316T4x0PhZA9Wi5agZDZD&access_token=XXTOKENXX&until=1422898206",
 :as :json}
(fn [req]{:request-time 363,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "rAn42BSfGoewNwZxLVG3zgkDJow4n+rtkMO5vU2tdzPlUuwNHweL2j+qx1MtXhEXUKnQi9gIzdbk2ztlstO8Qw==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"1a3d963f8d59f7a05f7987e9670b1522035d0de3\"",
  "x-fb-trace-id" "HT9AkyftH6p",
  "Date" "Fri, 31 Mar 2017 08:10:55 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_867918849898118\",\"created_time\":\"2015-02-02T08:52:14+0000\",\"message\":\"ZeH9s\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_867662119923791\",\"created_time\":\"2015-02-01T22:50:49+0000\",\"message\":\"mqs7g\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_863179447038725\",\"created_time\":\"2015-01-22T16:06:00+0000\",\"message\":\"ZHDyj\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_862432097113460\",\"created_time\":\"2015-01-20T16:26:14+0000\",\"message\":\"YJatg\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_860860447270625\",\"created_time\":\"2015-01-17T21:11:18+0000\",\"message\":\"TVsVK\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_860597873963549\",\"created_time\":\"2015-01-17T14:05:26+0000\",\"message\":\"cjzz3\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_860049017351768\",\"created_time\":\"2015-01-16T10:43:32+0000\",\"message\":\"uSKrR\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_859987434024593\",\"created_time\":\"2015-01-16T05:53:30+0000\",\"message\":\"7ZyXH\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_859677620722241\",\"created_time\":\"2015-01-15T11:42:12+0000\",\"message\":\"sWtgM\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_859192114104125\",\"created_time\":\"2015-01-14T17:19:14+0000\",\"message\":\"WrjzK\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAZBaOrZAMyw1p7W14oVALh4DrwcPP6toCZA24uy6Epl3E1H4h05OZCSQTKlkJIiidGaJkCYblVCLznCHDHpRX9NW9iSyLovKX2QqdWNMEzxW3E8QZDZD&since=1422867134&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDBrRVdA9RZCh7IlpUFQmTRmkYSYHKRqxoAyWx5vBZBWnmcCapDGF8R8h5WBLUvIZB8aqtO4AJSZBDS4QXe1OT1ZAcOH7LDZCMyRfoxfwbABSh0BmMgZDZD&access_token=XXTOKENXX&until=1421255954\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAa5WFQeSa0UnaFVtNkwSpZBBgQ1mWWFi6j4L1ZC9mTwVIgthDil5ve9TorLQwVbdrJCQTMllVSZC4KKeLPYUGpD6PvQf6O3316T4x0PhZA9Wi5agZDZD&access_token=XXTOKENXX&until=1422898206"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDZBfSRabvZBm9pBUcapV5eLLB2r4qhLADHQ6PvvXVZBCCdo2ZAdXQbSZBfkyAzlljBZCMrYxGwSiUDcIQDCqrN6FYzta8MeGMlkNq6at2ZBGDTAmzLgZDZD&access_token=XXTOKENXX&until=1424774985",
 :as :json}
(fn [req]{:request-time 426,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "3SbI0/QZNFA8Jxa5D1x0YAnB3HWMzuYJJfUGPWOObAgisZdVybrF8S5Yx8soe7vAtf74qB8vYjhmK8DFOeQBaw==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"3965feadb73ebdbd0a965e74b4b63c4f35e277eb\"",
  "x-fb-trace-id" "BPZGjr105Pj",
  "Date" "Fri, 31 Mar 2017 08:10:55 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_876759985680671\",\"created_time\":\"2015-02-20T19:01:57+0000\",\"message\":\"oOhJ2\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":3}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":3,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_876391385717531\",\"created_time\":\"2015-02-19T22:57:01+0000\",\"message\":\"10m7l\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_876365615720108\",\"created_time\":\"2015-02-19T21:42:46+0000\",\"message\":\"ngNjJ\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_871770149512988\",\"created_time\":\"2015-02-11T12:46:47+0000\",\"message\":\"5i70s\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_871542359535767\",\"created_time\":\"2015-02-10T23:04:55+0000\",\"message\":\"0CVfN\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_871299946226675\",\"created_time\":\"2015-02-10T09:06:05+0000\",\"message\":\"rL4O1\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_868726169817386\",\"created_time\":\"2015-02-04T08:47:55+0000\",\"message\":\"3raE9\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_868721253151211\",\"created_time\":\"2015-02-04T08:19:07+0000\",\"message\":\"GwkTg\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_868201209869882\",\"created_time\":\"2015-02-03T01:03:20+0000\",\"message\":\"IFYlv\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_868084153214921\",\"created_time\":\"2015-02-02T17:30:06+0000\",\"message\":\"EBLpH\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDi7iM5Hq856eSv5a9TRqdU3sYVsxrQbtlV2vs99RO1iHmcTsH1RxDI7DE5zFyGfFG4ApHzP4HZBM7pjLkrYQcAtrNpPPKMklgHpfT1KppyDrAZDZD&since=1424458917&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAa5WFQeSa0UnaFVtNkwSpZBBgQ1mWWFi6j4L1ZC9mTwVIgthDil5ve9TorLQwVbdrJCQTMllVSZC4KKeLPYUGpD6PvQf6O3316T4x0PhZA9Wi5agZDZD&access_token=XXTOKENXX&until=1422898206\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDZBfSRabvZBm9pBUcapV5eLLB2r4qhLADHQ6PvvXVZBCCdo2ZAdXQbSZBfkyAzlljBZCMrYxGwSiUDcIQDCqrN6FYzta8MeGMlkNq6at2ZBGDTAmzLgZDZD&access_token=XXTOKENXX&until=1424774985"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBbhK6AkHaIdkUaTHGDy2E8EWaNpTlGtKOCPxwMZBTjIX0vOA4dm6WJQzjUyW4UW6KrDijzGVvMK0inzQdwtJYYrUvJ3FmuCRJ1R5GkgXP9S7wZDZD&access_token=XXTOKENXX&until=1427470272",
 :as :json}
(fn [req]{:request-time 337,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "J6u+rsCn7Lr4/NS8VyY91ZBhrwWfj84Bbo5m7Fo2kogPTnjmeUkz+8A1esfRGJV/gXXqYyb8++3GTQHt8Lou+A==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"75cccbf2cc0b532d7e27839d4fc5d4d4e542da69\"",
  "x-fb-trace-id" "A3Q3eXSRMpE",
  "Date" "Fri, 31 Mar 2017 08:10:54 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_895638570459479\",\"created_time\":\"2015-03-27T13:59:19+0000\",\"message\":\"904gH\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_895172080506128\",\"created_time\":\"2015-03-26T19:54:02+0000\",\"message\":\"WRKwQ\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_895159487174054\",\"created_time\":\"2015-03-26T19:20:42+0000\",\"message\":\"KDvuU\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_894908463865823\",\"created_time\":\"2015-03-26T09:38:34+0000\",\"message\":\"yCq6E\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_894591280564208\",\"created_time\":\"2015-03-25T18:39:57+0000\",\"message\":\"ZigGX\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_890214517668551\",\"created_time\":\"2015-03-19T02:27:18+0000\",\"message\":\"vmgzg\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":10}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":10,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_882565748433428\",\"created_time\":\"2015-03-05T14:15:36+0000\",\"message\":\"RIIBQ\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_880197812003555\",\"created_time\":\"2015-02-27T18:53:14+0000\",\"message\":\"devYB\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_878834132139923\",\"created_time\":\"2015-02-24T16:55:24+0000\",\"message\":\"z6sHM\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":2}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":2,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_878717075484962\",\"created_time\":\"2015-02-24T10:49:45+0000\",\"message\":\"kqGL2\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdAswsxKZB7gQeUmZCCTzy9kXNc85Vyt2kRXbJOZBKGQdNDTmAhAXhi73ht0riXxgNvFE8f7uEzRaUnRWL5XmmEoh6sOpfM0YCdb1tymqZB9z853HQZDZD&since=1427464759&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDZBfSRabvZBm9pBUcapV5eLLB2r4qhLADHQ6PvvXVZBCCdo2ZAdXQbSZBfkyAzlljBZCMrYxGwSiUDcIQDCqrN6FYzta8MeGMlkNq6at2ZBGDTAmzLgZDZD&access_token=XXTOKENXX&until=1424774985\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBbhK6AkHaIdkUaTHGDy2E8EWaNpTlGtKOCPxwMZBTjIX0vOA4dm6WJQzjUyW4UW6KrDijzGVvMK0inzQdwtJYYrUvJ3FmuCRJ1R5GkgXP9S7wZDZD&access_token=XXTOKENXX&until=1427470272"]}
){:method :get,
 :address
 "https://graph.facebook.com/v2.8/177057932317550/posts?limit=10&fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&access_token=XXTOKENXX&until=1429527326&__paging_token=enc_AdCkfZCiZCLvMIdp6vcizPkrZB7RWrfMhxUHjgFYE5Lxgi81F9spZAUKWQiAyu42y88RcGYFrPfKeVqzoCPJ1UfAvkZB120HZAj5xTVBMHMock9O754QZDZD",
 :as :json}
(fn [req]{:request-time 297,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "XJE/I5WbmEnptTFAzqxT/z6VmStA+RdhCw2STJ21pJYuxKDe4JBz/jfIIqFfFLIixGvLGpV+zjRYZeuNVF4tnA==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"814cc8f91cd7004d05561cbf1cf03e4c31c1a076\"",
  "x-fb-trace-id" "E6WFFUsrH87",
  "Date" "Fri, 31 Mar 2017 08:10:54 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"data\":[{\"id\":\"177057932317550_905758402780829\",\"created_time\":\"2015-04-15T17:48:02+0000\",\"message\":\"Xqw98\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_903010183055651\",\"created_time\":\"2015-04-10T09:20:52+0000\",\"message\":\"8TwUq\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_902157386474264\",\"created_time\":\"2015-04-08T06:32:14+0000\",\"message\":\"juJi8\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_899507860072550\",\"created_time\":\"2015-04-03T10:05:14+0000\",\"message\":\"erCk3\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_899104843446185\",\"created_time\":\"2015-04-02T17:53:54+0000\",\"message\":\"eDnWg\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_898705676819435\",\"created_time\":\"2015-04-01T23:26:00+0000\",\"message\":\"nv1uR\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_898322620191074\",\"created_time\":\"2015-04-01T04:52:15+0000\",\"message\":\"TkBcy\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_898249010198435\",\"created_time\":\"2015-04-01T01:22:18+0000\",\"message\":\"Qt207\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_897828396907163\",\"created_time\":\"2015-03-31T08:56:02+0000\",\"message\":\"BIk91\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_895669693789700\",\"created_time\":\"2015-03-27T15:31:12+0000\",\"message\":\"y9aQa\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdDGclYLPsRkhL2l7rZAcPvGgeDZAqL4Uzp4tIj2yC8F70EFI5XejQNMJKFMQ1QiXPDdRaYC1GveBkcIRv46L9Hiw49eyeQ6Fc7eF9fuHBtZAnBCQZDZD&since=1429120082&access_token=XXTOKENXX&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&limit=10&__paging_token=enc_AdBbhK6AkHaIdkUaTHGDy2E8EWaNpTlGtKOCPxwMZBTjIX0vOA4dm6WJQzjUyW4UW6KrDijzGVvMK0inzQdwtJYYrUvJ3FmuCRJ1R5GkgXP9S7wZDZD&access_token=XXTOKENXX&until=1427470272\"}}",
 :trace-redirects
 ["https://graph.facebook.com/v2.8/177057932317550/posts?limit=10&fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&access_token=XXTOKENXX&until=1429527326&__paging_token=enc_AdCkfZCiZCLvMIdp6vcizPkrZB7RWrfMhxUHjgFYE5Lxgi81F9spZAUKWQiAyu42y88RcGYFrPfKeVqzoCPJ1UfAvkZB120HZAj5xTVBMHMock9O754QZDZD"]}
){:method :get,
 :address "https://graph.facebook.com/v2.8/",
 :as :json,
 :query-params
 {:path "",
  :fields
  "posts.limit(10){id,created_time,message,likes.summary(true).limit(0),reactions.summary(total_count).limit(0)}",
  :ids "177057932317550",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:request-time 1365,
 :repeatable? false,
 :protocol-version {:name "HTTP", :major 1, :minor 1},
 :streaming? true,
 :chunked? false,
 :reason-phrase "OK",
 :headers
 {"Content-Type" "text/javascript; charset=UTF-8",
  "Access-Control-Allow-Origin" "*",
  "X-FB-Debug"
  "xE/4WzuCCo+U9QY3XewaaX6d8PV7wqJ1OCpeuoizeXIETPBPVYngGNCIoSA9HFcbR54pJ5v6oIioqrWdPMzg/Q==",
  "facebook-api-version" "v2.8",
  "Connection" "close",
  "Pragma" "no-cache",
  "Expires" "Sat, 01 Jan 2000 00:00:00 GMT",
  "x-fb-rev" "2927011",
  "ETag" "\"2d88495d381f6290e34fb6337d13484a8ac525dd\"",
  "x-fb-trace-id" "CBkDkhiNhq6",
  "Date" "Fri, 31 Mar 2017 08:10:54 GMT",
  "Vary" "Accept-Encoding",
  "Cache-Control" "private, no-cache, no-store, must-revalidate"},
 :orig-content-encoding nil,
 :status 200,
 :length -1,
 :body
 "{\"177057932317550\":{\"posts\":{\"data\":[{\"id\":\"177057932317550_1126854757337858\",\"created_time\":\"2016-06-22T06:23:24+0000\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_990386480984687\",\"created_time\":\"2015-10-14T05:03:09+0000\",\"message\":\"B1Fkm\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":10}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":10,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_940984532591549\",\"created_time\":\"2015-06-25T02:16:30+0000\",\"message\":\"JTFv8\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_932914176731918\",\"created_time\":\"2015-06-08T11:10:56+0000\",\"message\":\"SVeRg\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":85}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":85,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_921776914512311\",\"created_time\":\"2015-05-16T08:15:15+0000\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":1}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":1,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_921759597847376\",\"created_time\":\"2015-05-16T06:54:46+0000\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":5}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":5,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_913890861967583\",\"created_time\":\"2015-04-29T05:09:50+0000\",\"message\":\"08viB\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_913371222019547\",\"created_time\":\"2015-04-28T09:40:20+0000\",\"message\":\"TWMm9\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_910073965682606\",\"created_time\":\"2015-04-23T08:10:30+0000\",\"message\":\"n7mgu\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}},{\"id\":\"177057932317550_908277042528965\",\"created_time\":\"2015-04-20T10:55:26+0000\",\"message\":\"0NM7O\",\"reactions\":{\"data\":[],\"summary\":{\"total_count\":0}},\"likes\":{\"data\":[],\"summary\":{\"total_count\":0,\"can_like\":true,\"has_liked\":false}}}],\"paging\":{\"previous\":\"https://graph.facebook.com/v2.8/177057932317550/posts?limit=10&fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&since=1466576604&access_token=XXTOKENXX&__paging_token=enc_AdC0lJfU5VlMRqurJI1z8dI7GZAHRy5ZBelI1hob1L37lLij2V79i1ZAtQMJyh8artu00t6O2A5N1N2V1GrpkqS4g1nnKWMEz47rrubYBNbz2BwZCAZDZD&__previous=1\",\"next\":\"https://graph.facebook.com/v2.8/177057932317550/posts?limit=10&fields=id,created_time,message,likes.summary%28true%29.limit%280%29,reactions.summary%28total_count%29.limit%280%29&access_token=XXTOKENXX&until=1429527326&__paging_token=enc_AdCkfZCiZCLvMIdp6vcizPkrZB7RWrfMhxUHjgFYE5Lxgi81F9spZAUKWQiAyu42y88RcGYFrPfKeVqzoCPJ1UfAvkZB120HZAj5xTVBMHMock9O754QZDZD\"}},\"id\":\"177057932317550\"}}",
 :trace-redirects ["https://graph.facebook.com/v2.8/"]}
)
})

================================================
File: /test/keboola/snapshots/pageinsights/out/tables/summarytest_summary.manifest
================================================
{"columns":["ex-account-id","fb-graph-node","parent-id","can_like","has_liked","total_count"],"incremental":true,"primary_key":["parent_id"]}

================================================
File: /test/keboola/snapshots/pageinsights/out/tables/summarytest_summary/1490947862466
================================================
"177057932317550","page_posts_likes","177057932317550_302791829744159","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_302791829744159","","","5"
"177057932317550","page_posts_likes","177057932317550_305252146164794","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_305252146164794","","","1"
"177057932317550","page_posts_likes","177057932317550_305498366140172","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_305498366140172","","","2"
"177057932317550","page_posts_likes","177057932317550_323610584328950","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_323610584328950","","","0"
"177057932317550","page_posts_likes","177057932317550_353214921378881","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_353214921378881","","","1"
"177057932317550","page_posts_likes","177057932317550_352005758179048","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_352005758179048","","","0"
"177057932317550","page_posts_likes","177057932317550_361138837242791","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_361138837242791","","","3"
"177057932317550","page_posts_likes","177057932317550_162215200570381","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_162215200570381","","","3"
"177057932317550","page_posts_likes","177057932317550_228383477282117","true","false","7"
"177057932317550","page_posts_reactions","177057932317550_228383477282117","","","7"
"177057932317550","page_posts_likes","177057932317550_334081216672711","true","false","4"
"177057932317550","page_posts_reactions","177057932317550_334081216672711","","","4"
"177057932317550","page_posts_likes","177057932317550_206217736172757","true","false","6"
"177057932317550","page_posts_reactions","177057932317550_206217736172757","","","6"
"177057932317550","page_posts_likes","177057932317550_420838671299530","true","false","4"
"177057932317550","page_posts_reactions","177057932317550_420838671299530","","","4"
"177057932317550","page_posts_likes","177057932317550_444666632223344","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_444666632223344","","","5"
"177057932317550","page_posts_likes","177057932317550_472227856128208","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_472227856128208","","","1"
"177057932317550","page_posts_likes","177057932317550_449064145116926","true","false","7"
"177057932317550","page_posts_reactions","177057932317550_449064145116926","","","7"
"177057932317550","page_posts_likes","177057932317550_452914554731885","true","false","14"
"177057932317550","page_posts_reactions","177057932317550_452914554731885","","","14"
"177057932317550","page_posts_likes","177057932317550_368159903264593","true","false","7"
"177057932317550","page_posts_reactions","177057932317550_368159903264593","","","7"
"177057932317550","page_posts_likes","177057932317550_294180184015204","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_294180184015204","","","3"
"177057932317550","page_posts_likes","177057932317550_403487893058520","true","false","4"
"177057932317550","page_posts_reactions","177057932317550_403487893058520","","","4"
"177057932317550","page_posts_likes","177057932317550_398123956929427","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_398123956929427","","","5"
"177057932317550","page_posts_likes","177057932317550_490073454349328","true","false","4"
"177057932317550","page_posts_reactions","177057932317550_490073454349328","","","4"
"177057932317550","page_posts_likes","177057932317550_173834012740815","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_173834012740815","","","0"
"177057932317550","page_posts_likes","177057932317550_193778417428982","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_193778417428982","","","3"
"177057932317550","page_posts_likes","177057932317550_318695688240580","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_318695688240580","","","0"
"177057932317550","page_posts_likes","177057932317550_505184512838222","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_505184512838222","","","3"
"177057932317550","page_posts_likes","177057932317550_521257084573804","true","false","10"
"177057932317550","page_posts_reactions","177057932317550_521257084573804","","","10"
"177057932317550","page_posts_likes","177057932317550_504556319595892","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_504556319595892","","","2"
"177057932317550","page_posts_likes","177057932317550_435813276500215","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_435813276500215","","","3"
"177057932317550","page_posts_likes","177057932317550_539121112777895","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_539121112777895","","","0"
"177057932317550","page_posts_likes","177057932317550_352096094902637","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_352096094902637","","","3"
"177057932317550","page_posts_likes","177057932317550_548725015150838","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_548725015150838","","","3"
"177057932317550","page_posts_likes","177057932317550_548905048466168","true","false","7"
"177057932317550","page_posts_reactions","177057932317550_548905048466168","","","7"
"177057932317550","page_posts_likes","177057932317550_552180764805263","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_552180764805263","","","1"
"177057932317550","page_posts_likes","177057932317550_554128261277180","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_554128261277180","","","5"
"177057932317550","page_posts_likes","177057932317550_556370214386318","true","false","13"
"177057932317550","page_posts_reactions","177057932317550_556370214386318","","","13"
"177057932317550","page_posts_likes","177057932317550_576225999067406","true","false","4"
"177057932317550","page_posts_reactions","177057932317550_576225999067406","","","4"
"177057932317550","page_posts_likes","177057932317550_587969594559713","true","false","8"
"177057932317550","page_posts_reactions","177057932317550_587969594559713","","","8"
"177057932317550","page_posts_likes","177057932317550_593958677294138","true","false","4"
"177057932317550","page_posts_reactions","177057932317550_593958677294138","","","4"
"177057932317550","page_posts_likes","177057932317550_602382753118397","true","false","28"
"177057932317550","page_posts_reactions","177057932317550_602382753118397","","","28"
"177057932317550","page_posts_likes","177057932317550_605510722805600","true","false","19"
"177057932317550","page_posts_reactions","177057932317550_605510722805600","","","19"
"177057932317550","page_posts_likes","177057932317550_663940230295982","true","false","17"
"177057932317550","page_posts_reactions","177057932317550_663940230295982","","","17"
"177057932317550","page_posts_likes","177057932317550_10202183243654151","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_10202183243654151","","","2"
"177057932317550","page_posts_likes","177057932317550_10202220745311669","true","false","9"
"177057932317550","page_posts_reactions","177057932317550_10202220745311669","","","9"
"177057932317550","page_posts_likes","177057932317550_726738767349461","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_726738767349461","","","2"
"177057932317550","page_posts_likes","177057932317550_728259217197416","true","false","4"
"177057932317550","page_posts_reactions","177057932317550_728259217197416","","","4"
"177057932317550","page_posts_likes","177057932317550_728575040499167","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_728575040499167","","","1"
"177057932317550","page_posts_likes","177057932317550_728575230499148","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_728575230499148","","","1"
"177057932317550","page_posts_likes","177057932317550_743919872298017","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_743919872298017","","","5"
"177057932317550","page_posts_likes","177057932317550_752191708137500","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_752191708137500","","","1"
"177057932317550","page_posts_likes","177057932317550_752430261446978","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_752430261446978","","","0"
"177057932317550","page_posts_likes","177057932317550_754064174616920","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_754064174616920","","","0"
"177057932317550","page_posts_likes","177057932317550_754072867949384","true","false","12"
"177057932317550","page_posts_reactions","177057932317550_754072867949384","","","12"
"177057932317550","page_posts_likes","177057932317550_754441377912533","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_754441377912533","","","1"
"177057932317550","page_posts_likes","177057932317550_755399434483394","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_755399434483394","","","5"
"177057932317550","page_posts_likes","177057932317550_756609071029097","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_756609071029097","","","0"
"177057932317550","page_posts_likes","177057932317550_758019590888045","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_758019590888045","","","0"
"177057932317550","page_posts_likes","177057932317550_759927937363877","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_759927937363877","","","0"
"177057932317550","page_posts_likes","177057932317550_763436517013019","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_763436517013019","","","2"
"177057932317550","page_posts_likes","177057932317550_768031333220204","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_768031333220204","","","0"
"177057932317550","page_posts_likes","177057932317550_769681236388547","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_769681236388547","","","0"
"177057932317550","page_posts_likes","177057932317550_770954352927902","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_770954352927902","","","1"
"177057932317550","page_posts_likes","177057932317550_771704046186266","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_771704046186266","","","0"
"177057932317550","page_posts_likes","177057932317550_779023718787632","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_779023718787632","","","0"
"177057932317550","page_posts_likes","177057932317550_779709275385743","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_779709275385743","","","1"
"177057932317550","page_posts_likes","177057932317550_780460005310670","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_780460005310670","","","5"
"177057932317550","page_posts_likes","177057932317550_787058171317520","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_787058171317520","","","0"
"177057932317550","page_posts_likes","177057932317550_787063444650326","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_787063444650326","","","0"
"177057932317550","page_posts_likes","177057932317550_788400981183239","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_788400981183239","","","0"
"177057932317550","page_posts_likes","177057932317550_790080467681957","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_790080467681957","","","0"
"177057932317550","page_posts_likes","177057932317550_790255884331082","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_790255884331082","","","0"
"177057932317550","page_posts_likes","177057932317550_791379880885349","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_791379880885349","","","0"
"177057932317550","page_posts_likes","177057932317550_800747633281907","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_800747633281907","","","0"
"177057932317550","page_posts_likes","177057932317550_801886059834731","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_801886059834731","","","1"
"177057932317550","page_posts_likes","177057932317550_809124919110845","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_809124919110845","","","0"
"177057932317550","page_posts_likes","177057932317550_809400435749960","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_809400435749960","","","0"
"177057932317550","page_posts_likes","177057932317550_809469985743005","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_809469985743005","","","0"
"177057932317550","page_posts_likes","177057932317550_810959602260710","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_810959602260710","","","0"
"177057932317550","page_posts_likes","177057932317550_812344502122220","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_812344502122220","","","0"
"177057932317550","page_posts_likes","177057932317550_812853865404617","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_812853865404617","","","3"
"177057932317550","page_posts_likes","177057932317550_815120581844612","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_815120581844612","","","1"
"177057932317550","page_posts_likes","177057932317550_815328998490437","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_815328998490437","","","0"
"177057932317550","page_posts_likes","177057932317550_815860998437237","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_815860998437237","","","0"
"177057932317550","page_posts_likes","177057932317550_822018727821464","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_822018727821464","","","1"
"177057932317550","page_posts_likes","177057932317550_824196854270318","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_824196854270318","","","0"
"177057932317550","page_posts_likes","177057932317550_828735377149799","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_828735377149799","","","1"
"177057932317550","page_posts_likes","177057932317550_829756233714380","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_829756233714380","","","1"
"177057932317550","page_posts_likes","177057932317550_831492690207401","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_831492690207401","","","0"
"177057932317550","page_posts_likes","177057932317550_831635373526466","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_831635373526466","","","1"
"177057932317550","page_posts_likes","177057932317550_832653096758027","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_832653096758027","","","2"
"177057932317550","page_posts_likes","177057932317550_835895269767143","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_835895269767143","","","1"
"177057932317550","page_posts_likes","177057932317550_836616029695067","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_836616029695067","","","0"
"177057932317550","page_posts_likes","177057932317550_840209139335756","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_840209139335756","","","0"
"177057932317550","page_posts_likes","177057932317550_840894219267248","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_840894219267248","","","0"
"177057932317550","page_posts_likes","177057932317550_841844912505512","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_841844912505512","","","0"
"177057932317550","page_posts_likes","177057932317550_842012709155399","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_842012709155399","","","0"
"177057932317550","page_posts_likes","177057932317550_843202225703114","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_843202225703114","","","0"
"177057932317550","page_posts_likes","177057932317550_843461772343826","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_843461772343826","","","0"
"177057932317550","page_posts_likes","177057932317550_854822971207706","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_854822971207706","","","2"
"177057932317550","page_posts_likes","177057932317550_856006187756051","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_856006187756051","","","0"
"177057932317550","page_posts_likes","177057932317550_856461684377168","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_856461684377168","","","2"
"177057932317550","page_posts_likes","177057932317550_859192114104125","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_859192114104125","","","0"
"177057932317550","page_posts_likes","177057932317550_859677620722241","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_859677620722241","","","0"
"177057932317550","page_posts_likes","177057932317550_859987434024593","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_859987434024593","","","0"
"177057932317550","page_posts_likes","177057932317550_860049017351768","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_860049017351768","","","1"
"177057932317550","page_posts_likes","177057932317550_860597873963549","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_860597873963549","","","0"
"177057932317550","page_posts_likes","177057932317550_860860447270625","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_860860447270625","","","0"
"177057932317550","page_posts_likes","177057932317550_862432097113460","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_862432097113460","","","0"
"177057932317550","page_posts_likes","177057932317550_863179447038725","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_863179447038725","","","0"
"177057932317550","page_posts_likes","177057932317550_867662119923791","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_867662119923791","","","2"
"177057932317550","page_posts_likes","177057932317550_867918849898118","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_867918849898118","","","0"
"177057932317550","page_posts_likes","177057932317550_868084153214921","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_868084153214921","","","1"
"177057932317550","page_posts_likes","177057932317550_868201209869882","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_868201209869882","","","0"
"177057932317550","page_posts_likes","177057932317550_868721253151211","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_868721253151211","","","0"
"177057932317550","page_posts_likes","177057932317550_868726169817386","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_868726169817386","","","0"
"177057932317550","page_posts_likes","177057932317550_871299946226675","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_871299946226675","","","0"
"177057932317550","page_posts_likes","177057932317550_871542359535767","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_871542359535767","","","0"
"177057932317550","page_posts_likes","177057932317550_871770149512988","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_871770149512988","","","0"
"177057932317550","page_posts_likes","177057932317550_876365615720108","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_876365615720108","","","0"
"177057932317550","page_posts_likes","177057932317550_876391385717531","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_876391385717531","","","0"
"177057932317550","page_posts_likes","177057932317550_876759985680671","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_876759985680671","","","3"
"177057932317550","page_posts_likes","177057932317550_878717075484962","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_878717075484962","","","0"
"177057932317550","page_posts_likes","177057932317550_878834132139923","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_878834132139923","","","2"
"177057932317550","page_posts_likes","177057932317550_880197812003555","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_880197812003555","","","0"
"177057932317550","page_posts_likes","177057932317550_882565748433428","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_882565748433428","","","0"
"177057932317550","page_posts_likes","177057932317550_890214517668551","true","false","10"
"177057932317550","page_posts_reactions","177057932317550_890214517668551","","","10"
"177057932317550","page_posts_likes","177057932317550_894591280564208","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_894591280564208","","","0"
"177057932317550","page_posts_likes","177057932317550_894908463865823","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_894908463865823","","","0"
"177057932317550","page_posts_likes","177057932317550_895159487174054","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_895159487174054","","","0"
"177057932317550","page_posts_likes","177057932317550_895172080506128","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_895172080506128","","","0"
"177057932317550","page_posts_likes","177057932317550_895638570459479","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_895638570459479","","","0"
"177057932317550","page_posts_likes","177057932317550_895669693789700","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_895669693789700","","","0"
"177057932317550","page_posts_likes","177057932317550_897828396907163","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_897828396907163","","","0"
"177057932317550","page_posts_likes","177057932317550_898249010198435","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_898249010198435","","","0"
"177057932317550","page_posts_likes","177057932317550_898322620191074","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_898322620191074","","","0"
"177057932317550","page_posts_likes","177057932317550_898705676819435","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_898705676819435","","","0"
"177057932317550","page_posts_likes","177057932317550_899104843446185","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_899104843446185","","","0"
"177057932317550","page_posts_likes","177057932317550_899507860072550","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_899507860072550","","","0"
"177057932317550","page_posts_likes","177057932317550_902157386474264","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_902157386474264","","","0"
"177057932317550","page_posts_likes","177057932317550_903010183055651","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_903010183055651","","","0"
"177057932317550","page_posts_likes","177057932317550_905758402780829","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_905758402780829","","","0"
"177057932317550","page_posts_likes","177057932317550_908277042528965","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_908277042528965","","","0"
"177057932317550","page_posts_likes","177057932317550_910073965682606","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_910073965682606","","","0"
"177057932317550","page_posts_likes","177057932317550_913371222019547","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_913371222019547","","","0"
"177057932317550","page_posts_likes","177057932317550_913890861967583","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_913890861967583","","","0"
"177057932317550","page_posts_likes","177057932317550_921759597847376","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_921759597847376","","","5"
"177057932317550","page_posts_likes","177057932317550_921776914512311","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_921776914512311","","","1"
"177057932317550","page_posts_likes","177057932317550_932914176731918","true","false","85"
"177057932317550","page_posts_reactions","177057932317550_932914176731918","","","85"
"177057932317550","page_posts_likes","177057932317550_940984532591549","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_940984532591549","","","1"
"177057932317550","page_posts_likes","177057932317550_990386480984687","true","false","10"
"177057932317550","page_posts_reactions","177057932317550_990386480984687","","","10"
"177057932317550","page_posts_likes","177057932317550_1126854757337858","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_1126854757337858","","","1"
"177057932317550","page_posts_likes","177057932317550_171674186203006","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_171674186203006","","","0"
"177057932317550","page_posts_likes","177057932317550_134098826650108","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_134098826650108","","","2"
"177057932317550","page_posts_likes","177057932317550_180908155265861","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_180908155265861","","","1"
"177057932317550","page_posts_likes","177057932317550_184322484924428","true","false","4"
"177057932317550","page_posts_reactions","177057932317550_184322484924428","","","4"
"177057932317550","page_posts_likes","177057932317550_126067137462604","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_126067137462604","","","2"
"177057932317550","page_posts_likes","177057932317550_185882488101761","true","false","6"
"177057932317550","page_posts_reactions","177057932317550_185882488101761","","","6"
"177057932317550","page_posts_likes","177057932317550_199870140026616","true","false","4"
"177057932317550","page_posts_reactions","177057932317550_199870140026616","","","4"
"177057932317550","page_posts_likes","177057932317550_192688704088246","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_192688704088246","","","2"
"177057932317550","page_posts_likes","177057932317550_197403570282986","true","false","6"
"177057932317550","page_posts_reactions","177057932317550_197403570282986","","","6"
"177057932317550","page_posts_likes","177057932317550_211220768894075","true","false","10"
"177057932317550","page_posts_reactions","177057932317550_211220768894075","","","10"
"177057932317550","page_posts_likes","177057932317550_137582739648143","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_137582739648143","","","1"
"177057932317550","page_posts_likes","177057932317550_196467620396988","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_196467620396988","","","3"
"177057932317550","page_posts_likes","177057932317550_215623685128044","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_215623685128044","","","3"
"177057932317550","page_posts_likes","177057932317550_209620832394593","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_209620832394593","","","0"
"177057932317550","page_posts_likes","177057932317550_216377241726149","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_216377241726149","","","1"
"177057932317550","page_posts_likes","177057932317550_218189694871040","true","false","6"
"177057932317550","page_posts_reactions","177057932317550_218189694871040","","","6"
"177057932317550","page_posts_likes","177057932317550_168333893234364","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_168333893234364","","","3"
"177057932317550","page_posts_likes","177057932317550_235614199800401","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_235614199800401","","","0"
"177057932317550","page_posts_likes","177057932317550_240014989344643","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_240014989344643","","","0"
"177057932317550","page_posts_likes","177057932317550_224521170914631","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_224521170914631","","","5"
"177057932317550","page_posts_likes","177057932317550_249145035105683","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_249145035105683","","","1"
"177057932317550","page_posts_likes","177057932317550_179407758797038","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_179407758797038","","","3"
"177057932317550","page_posts_likes","177057932317550_183429435059845","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_183429435059845","","","2"
"177057932317550","page_posts_likes","177057932317550_158899414188800","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_158899414188800","","","3"
"177057932317550","page_posts_likes","177057932317550_141088755980548","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_141088755980548","","","0"
"177057932317550","page_posts_likes","177057932317550_252981534725189","true","false","4"
"177057932317550","page_posts_reactions","177057932317550_252981534725189","","","4"
"177057932317550","page_posts_likes","177057932317550_271057969584212","true","false","6"
"177057932317550","page_posts_reactions","177057932317550_271057969584212","","","6"
"177057932317550","page_posts_likes","177057932317550_277989612224381","true","false","2"
"177057932317550","page_posts_reactions","177057932317550_277989612224381","","","2"
"177057932317550","page_posts_likes","177057932317550_247915598594326","true","false","1"
"177057932317550","page_posts_reactions","177057932317550_247915598594326","","","1"
"177057932317550","page_posts_likes","177057932317550_278627468827262","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_278627468827262","","","0"
"177057932317550","page_posts_likes","177057932317550_140498742716844","true","false","0"
"177057932317550","page_posts_reactions","177057932317550_140498742716844","","","0"
"177057932317550","page_posts_likes","177057932317550_280609595295716","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_280609595295716","","","5"
"177057932317550","page_posts_likes","177057932317550_281387161884626","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_281387161884626","","","5"
"177057932317550","page_posts_likes","177057932317550_285051821518160","true","false","6"
"177057932317550","page_posts_reactions","177057932317550_285051821518160","","","6"
"177057932317550","page_posts_likes","177057932317550_269366146445734","true","false","5"
"177057932317550","page_posts_reactions","177057932317550_269366146445734","","","5"
"177057932317550","page_posts_likes","177057932317550_285228031514604","true","false","3"
"177057932317550","page_posts_reactions","177057932317550_285228031514604","","","3"


================================================
File: /test/keboola/snapshots/pageinsights/out/tables/accounts
================================================
category,name,id
software,keboola,177057932317550


================================================
File: /test/keboola/snapshots/pageinsights/out/tables/summarytest_posts/1490947862466
================================================
"177057932317550_171674186203006","177057932317550","page_posts","177057932317550","2010-12-29T06:44:25+0000","RH8L7"
"177057932317550_134098826650108","177057932317550","page_posts","177057932317550","2010-12-29T23:12:41+0000","8ZIlG"
"177057932317550_180908155265861","177057932317550","page_posts","177057932317550","2011-01-13T16:04:23+0000","tXlNv"
"177057932317550_184322484924428","177057932317550","page_posts","177057932317550","2011-01-26T16:57:24+0000","QmR9o"
"177057932317550_126067137462604","177057932317550","page_posts","177057932317550","2011-01-31T16:18:43+0000","UkxEq"
"177057932317550_185882488101761","177057932317550","page_posts","177057932317550","2011-02-01T17:19:10+0000","0mgSm"
"177057932317550_199870140026616","177057932317550","page_posts","177057932317550","2011-02-09T21:30:56+0000","yhGY0"
"177057932317550_192688704088246","177057932317550","page_posts","177057932317550","2011-02-11T11:50:25+0000","xIUtN"
"177057932317550_197403570282986","177057932317550","page_posts","177057932317550","2011-03-21T23:27:41+0000","LsclF"
"177057932317550_211220768894075","177057932317550","page_posts","177057932317550","2011-03-24T08:20:56+0000","3VMft"
"177057932317550_137582739648143","177057932317550","page_posts","177057932317550","2011-04-06T21:19:32+0000","2irTt"
"177057932317550_196467620396988","177057932317550","page_posts","177057932317550","2011-05-03T12:48:16+0000","vKOew"
"177057932317550_215623685128044","177057932317550","page_posts","177057932317550","2011-05-06T13:31:17+0000","QOeG3"
"177057932317550_209620832394593","177057932317550","page_posts","177057932317550","2011-05-14T14:09:31+0000","7qR5W"
"177057932317550_216377241726149","177057932317550","page_posts","177057932317550","2011-06-13T20:32:24+0000","7MHDB"
"177057932317550_218189694871040","177057932317550","page_posts","177057932317550","2011-06-20T21:21:53+0000","3ds9Z"
"177057932317550_168333893234364","177057932317550","page_posts","177057932317550","2011-06-24T16:10:30+0000","mKgeK"
"177057932317550_235614199800401","177057932317550","page_posts","177057932317550","2011-06-25T19:40:44+0000","sYtKY"
"177057932317550_240014989344643","177057932317550","page_posts","177057932317550","2011-06-27T09:16:21+0000","1ltWy"
"177057932317550_224521170914631","177057932317550","page_posts","177057932317550","2011-07-04T05:34:22+0000","vEB8O"
"177057932317550_249145035105683","177057932317550","page_posts","177057932317550","2011-08-10T09:13:22+0000","QEUP5"
"177057932317550_179407758797038","177057932317550","page_posts","177057932317550","2011-08-18T18:23:19+0000","RJy5Y"
"177057932317550_183429435059845","177057932317550","page_posts","177057932317550","2011-08-22T09:24:42+0000","eyeK1"
"177057932317550_158899414188800","177057932317550","page_posts","177057932317550","2011-08-22T09:25:21+0000","iQ3V5"
"177057932317550_141088755980548","177057932317550","page_posts","177057932317550","2011-08-23T10:08:03+0000",""
"177057932317550_252981534725189","177057932317550","page_posts","177057932317550","2011-08-30T20:35:31+0000","mhtWr"
"177057932317550_271057969584212","177057932317550","page_posts","177057932317550","2011-10-10T14:33:54+0000","HGsYL"
"177057932317550_277989612224381","177057932317550","page_posts","177057932317550","2011-10-25T21:40:08+0000","k9Gbu"
"177057932317550_247915598594326","177057932317550","page_posts","177057932317550","2011-10-25T21:42:50+0000","R5Nur"
"177057932317550_278627468827262","177057932317550","page_posts","177057932317550","2011-10-27T09:22:01+0000","0BJsy"
"177057932317550_140498742716844","177057932317550","page_posts","177057932317550","2011-10-27T17:25:46+0000","JWzfH"
"177057932317550_280609595295716","177057932317550","page_posts","177057932317550","2011-10-31T23:38:38+0000","uSWa1"
"177057932317550_281387161884626","177057932317550","page_posts","177057932317550","2011-11-02T19:50:05+0000","9egT3"
"177057932317550_285051821518160","177057932317550","page_posts","177057932317550","2011-11-10T21:50:09+0000","IncqK"
"177057932317550_269366146445734","177057932317550","page_posts","177057932317550","2011-12-05T15:41:46+0000","ry4Jk"
"177057932317550_285228031514604","177057932317550","page_posts","177057932317550","2011-12-09T12:48:35+0000","jSrqW"
"177057932317550_302791829744159","177057932317550","page_posts","177057932317550","2011-12-12T20:52:00+0000","n2krP"
"177057932317550_305252146164794","177057932317550","page_posts","177057932317550","2011-12-16T20:27:59+0000","DRdKP"
"177057932317550_305498366140172","177057932317550","page_posts","177057932317550","2011-12-17T08:38:33+0000","1ZYPh"
"177057932317550_323610584328950","177057932317550","page_posts","177057932317550","2012-01-18T01:00:37+0000","tsBZO"
"177057932317550_353214921378881","177057932317550","page_posts","177057932317550","2012-02-21T22:03:23+0000","jDQ4o"
"177057932317550_352005758179048","177057932317550","page_posts","177057932317550","2012-03-15T20:49:46+0000","xi4FS"
"177057932317550_361138837242791","177057932317550","page_posts","177057932317550","2012-03-16T20:21:01+0000","4PqF6"
"177057932317550_162215200570381","177057932317550","page_posts","177057932317550","2012-06-14T13:22:27+0000","NNXMz"
"177057932317550_228383477282117","177057932317550","page_posts","177057932317550","2012-06-22T13:12:56+0000","cjG6p"
"177057932317550_334081216672711","177057932317550","page_posts","177057932317550","2012-07-03T07:47:33+0000","p4a4P"
"177057932317550_206217736172757","177057932317550","page_posts","177057932317550","2012-07-25T09:47:06+0000","fHmxw"
"177057932317550_420838671299530","177057932317550","page_posts","177057932317550","2012-08-02T08:26:38+0000","E9hcE"
"177057932317550_444666632223344","177057932317550","page_posts","177057932317550","2012-08-10T10:55:58+0000",""
"177057932317550_472227856128208","177057932317550","page_posts","177057932317550","2012-08-11T04:17:07+0000","zXaTW"
"177057932317550_449064145116926","177057932317550","page_posts","177057932317550","2012-08-23T12:36:10+0000","CUBFV"
"177057932317550_452914554731885","177057932317550","page_posts","177057932317550","2012-09-03T14:16:17+0000","U33Df"
"177057932317550_368159903264593","177057932317550","page_posts","177057932317550","2012-10-08T14:32:58+0000","vD5bv"
"177057932317550_294180184015204","177057932317550","page_posts","177057932317550","2012-10-30T12:09:25+0000","VQFav"
"177057932317550_403487893058520","177057932317550","page_posts","177057932317550","2012-11-01T15:28:03+0000","of85Y"
"177057932317550_398123956929427","177057932317550","page_posts","177057932317550","2012-12-12T12:15:28+0000","ly738"
"177057932317550_490073454349328","177057932317550","page_posts","177057932317550","2012-12-13T08:20:05+0000","cgxoR"
"177057932317550_173834012740815","177057932317550","page_posts","177057932317550","2012-12-14T09:27:53+0000","dM9m5"
"177057932317550_193778417428982","177057932317550","page_posts","177057932317550","2013-01-04T16:52:45+0000","rOhqo"
"177057932317550_318695688240580","177057932317550","page_posts","177057932317550","2013-01-16T07:06:43+0000","lPaVt"
"177057932317550_505184512838222","177057932317550","page_posts","177057932317550","2013-01-16T14:26:58+0000","GLyoG"
"177057932317550_521257084573804","177057932317550","page_posts","177057932317550","2013-01-18T11:18:39+0000","jOV4Y"
"177057932317550_504556319595892","177057932317550","page_posts","177057932317550","2013-02-01T20:55:52+0000","2pTB1"
"177057932317550_435813276500215","177057932317550","page_posts","177057932317550","2013-03-20T08:47:10+0000","kOWrb"
"177057932317550_539121112777895","177057932317550","page_posts","177057932317550","2013-03-27T22:09:42+0000","VkZnv"
"177057932317550_352096094902637","177057932317550","page_posts","177057932317550","2013-04-04T04:44:50+0000","vWQgS"
"177057932317550_548725015150838","177057932317550","page_posts","177057932317550","2013-04-23T08:48:51+0000","Zw9nU"
"177057932317550_548905048466168","177057932317550","page_posts","177057932317550","2013-04-23T19:11:41+0000","IZNFN"
"177057932317550_552180764805263","177057932317550","page_posts","177057932317550","2013-05-02T08:16:18+0000","lngnz"
"177057932317550_554128261277180","177057932317550","page_posts","177057932317550","2013-05-07T05:56:06+0000","8LY8P"
"177057932317550_556370214386318","177057932317550","page_posts","177057932317550","2013-05-13T08:39:33+0000","nWtcV"
"177057932317550_576225999067406","177057932317550","page_posts","177057932317550","2013-06-27T13:27:58+0000","n0q6f"
"177057932317550_587969594559713","177057932317550","page_posts","177057932317550","2013-07-25T12:48:30+0000","wfCkG"
"177057932317550_593958677294138","177057932317550","page_posts","177057932317550","2013-08-08T00:58:39+0000","j6xKP"
"177057932317550_602382753118397","177057932317550","page_posts","177057932317550","2013-08-27T17:22:55+0000","bOIZ9"
"177057932317550_605510722805600","177057932317550","page_posts","177057932317550","2013-09-04T13:19:52+0000","IoP4B"
"177057932317550_663940230295982","177057932317550","page_posts","177057932317550","2014-01-03T23:57:24+0000","9o6Fx"
"177057932317550_10202183243654151","177057932317550","page_posts","177057932317550","2014-01-09T04:12:24+0000","lEdJZ"
"177057932317550_10202220745311669","177057932317550","page_posts","177057932317550","2014-01-14T20:19:38+0000","6PKty"
"177057932317550_726738767349461","177057932317550","page_posts","177057932317550","2014-05-12T22:10:11+0000","SGmNb"
"177057932317550_728259217197416","177057932317550","page_posts","177057932317550","2014-05-16T03:13:48+0000","1xfuY"
"177057932317550_728575040499167","177057932317550","page_posts","177057932317550","2014-05-16T21:28:02+0000","wDiDj"
"177057932317550_728575230499148","177057932317550","page_posts","177057932317550","2014-05-16T21:28:35+0000","t72u4"
"177057932317550_743919872298017","177057932317550","page_posts","177057932317550","2014-06-17T05:48:34+0000","rUw3D"
"177057932317550_752191708137500","177057932317550","page_posts","177057932317550","2014-07-04T12:25:07+0000","50fBT"
"177057932317550_752430261446978","177057932317550","page_posts","177057932317550","2014-07-04T23:13:41+0000","953Tm"
"177057932317550_754064174616920","177057932317550","page_posts","177057932317550","2014-07-08T14:06:35+0000","FWRks"
"177057932317550_754072867949384","177057932317550","page_posts","177057932317550","2014-07-08T14:25:02+0000","D8zUT"
"177057932317550_754441377912533","177057932317550","page_posts","177057932317550","2014-07-09T10:24:29+0000","S5kWa"
"177057932317550_755399434483394","177057932317550","page_posts","177057932317550","2014-07-11T15:02:44+0000","TyYpR"
"177057932317550_756609071029097","177057932317550","page_posts","177057932317550","2014-07-14T05:40:02+0000","hiacx"
"177057932317550_758019590888045","177057932317550","page_posts","177057932317550","2014-07-17T14:36:39+0000","8iYVQ"
"177057932317550_759927937363877","177057932317550","page_posts","177057932317550","2014-07-21T07:31:50+0000","dYmR0"
"177057932317550_763436517013019","177057932317550","page_posts","177057932317550","2014-07-28T23:08:57+0000","LhS77"
"177057932317550_768031333220204","177057932317550","page_posts","177057932317550","2014-08-07T19:20:18+0000","MG5gx"
"177057932317550_769681236388547","177057932317550","page_posts","177057932317550","2014-08-11T13:04:32+0000","tspwl"
"177057932317550_770954352927902","177057932317550","page_posts","177057932317550","2014-08-14T12:45:34+0000","oPKlF"
"177057932317550_771704046186266","177057932317550","page_posts","177057932317550","2014-08-16T09:28:01+0000","XwP4r"
"177057932317550_779023718787632","177057932317550","page_posts","177057932317550","2014-08-27T19:43:01+0000","aDeLP"
"177057932317550_779709275385743","177057932317550","page_posts","177057932317550","2014-08-28T19:14:35+0000","tWN2s"
"177057932317550_780460005310670","177057932317550","page_posts","177057932317550","2014-08-30T00:00:10+0000","CS8B3"
"177057932317550_787058171317520","177057932317550","page_posts","177057932317550","2014-09-09T16:32:01+0000","mnx1c"
"177057932317550_787063444650326","177057932317550","page_posts","177057932317550","2014-09-09T16:42:59+0000","BHO83"
"177057932317550_788400981183239","177057932317550","page_posts","177057932317550","2014-09-13T03:31:18+0000","OIQdM"
"177057932317550_790080467681957","177057932317550","page_posts","177057932317550","2014-09-16T14:08:28+0000","1SJRV"
"177057932317550_790255884331082","177057932317550","page_posts","177057932317550","2014-09-16T19:16:16+0000","9qn2c"
"177057932317550_791379880885349","177057932317550","page_posts","177057932317550","2014-09-18T23:11:33+0000","Gn80n"
"177057932317550_800747633281907","177057932317550","page_posts","177057932317550","2014-10-07T20:23:16+0000","qk5GQ"
"177057932317550_801886059834731","177057932317550","page_posts","177057932317550","2014-10-09T20:03:24+0000","Q0kik"
"177057932317550_809124919110845","177057932317550","page_posts","177057932317550","2014-10-23T16:33:21+0000","3kvVl"
"177057932317550_809400435749960","177057932317550","page_posts","177057932317550","2014-10-24T09:45:37+0000","jqVPc"
"177057932317550_809469985743005","177057932317550","page_posts","177057932317550","2014-10-24T13:37:50+0000","STgbs"
"177057932317550_810959602260710","177057932317550","page_posts","177057932317550","2014-10-27T15:33:59+0000","nwuD6"
"177057932317550_812344502122220","177057932317550","page_posts","177057932317550","2014-10-30T12:15:12+0000","NDeR6"
"177057932317550_812853865404617","177057932317550","page_posts","177057932317550","2014-10-31T15:38:03+0000","6L36s"
"177057932317550_815120581844612","177057932317550","page_posts","177057932317550","2014-11-04T21:50:56+0000","k8rc8"
"177057932317550_815328998490437","177057932317550","page_posts","177057932317550","2014-11-05T09:29:28+0000","BkiPD"
"177057932317550_815860998437237","177057932317550","page_posts","177057932317550","2014-11-06T09:15:08+0000","kZ0HP"
"177057932317550_822018727821464","177057932317550","page_posts","177057932317550","2014-11-15T22:06:52+0000","4pVHN"
"177057932317550_824196854270318","177057932317550","page_posts","177057932317550","2014-11-20T11:32:28+0000","B6eOq"
"177057932317550_828735377149799","177057932317550","page_posts","177057932317550","2014-11-26T23:48:41+0000","vYqdJ"
"177057932317550_829756233714380","177057932317550","page_posts","177057932317550","2014-11-28T18:17:24+0000","2MOxJ"
"177057932317550_831492690207401","177057932317550","page_posts","177057932317550","2014-12-01T08:33:03+0000","V4sng"
"177057932317550_831635373526466","177057932317550","page_posts","177057932317550","2014-12-01T13:35:41+0000","yUCbw"
"177057932317550_832653096758027","177057932317550","page_posts","177057932317550","2014-12-02T15:41:46+0000","PVNEI"
"177057932317550_835895269767143","177057932317550","page_posts","177057932317550","2014-12-08T09:08:44+0000","zSBhv"
"177057932317550_836616029695067","177057932317550","page_posts","177057932317550","2014-12-09T19:45:26+0000","E7K3u"
"177057932317550_840209139335756","177057932317550","page_posts","177057932317550","2014-12-15T17:35:00+0000","Yk09u"
"177057932317550_840894219267248","177057932317550","page_posts","177057932317550","2014-12-17T10:58:40+0000","8qPhI"
"177057932317550_841844912505512","177057932317550","page_posts","177057932317550","2014-12-19T15:06:55+0000","Z2v98"
"177057932317550_842012709155399","177057932317550","page_posts","177057932317550","2014-12-20T00:19:08+0000","KV9fD"
"177057932317550_843202225703114","177057932317550","page_posts","177057932317550","2014-12-22T06:01:43+0000","7ZF8v"
"177057932317550_843461772343826","177057932317550","page_posts","177057932317550","2014-12-22T19:22:12+0000","qhuBU"
"177057932317550_854822971207706","177057932317550","page_posts","177057932317550","2015-01-06T20:43:33+0000","jvyry"
"177057932317550_856006187756051","177057932317550","page_posts","177057932317550","2015-01-07T22:49:59+0000","gZnCp"
"177057932317550_856461684377168","177057932317550","page_posts","177057932317550","2015-01-08T22:12:56+0000","UWqq2"
"177057932317550_859192114104125","177057932317550","page_posts","177057932317550","2015-01-14T17:19:14+0000","WrjzK"
"177057932317550_859677620722241","177057932317550","page_posts","177057932317550","2015-01-15T11:42:12+0000","sWtgM"
"177057932317550_859987434024593","177057932317550","page_posts","177057932317550","2015-01-16T05:53:30+0000","7ZyXH"
"177057932317550_860049017351768","177057932317550","page_posts","177057932317550","2015-01-16T10:43:32+0000","uSKrR"
"177057932317550_860597873963549","177057932317550","page_posts","177057932317550","2015-01-17T14:05:26+0000","cjzz3"
"177057932317550_860860447270625","177057932317550","page_posts","177057932317550","2015-01-17T21:11:18+0000","TVsVK"
"177057932317550_862432097113460","177057932317550","page_posts","177057932317550","2015-01-20T16:26:14+0000","YJatg"
"177057932317550_863179447038725","177057932317550","page_posts","177057932317550","2015-01-22T16:06:00+0000","ZHDyj"
"177057932317550_867662119923791","177057932317550","page_posts","177057932317550","2015-02-01T22:50:49+0000","mqs7g"
"177057932317550_867918849898118","177057932317550","page_posts","177057932317550","2015-02-02T08:52:14+0000","ZeH9s"
"177057932317550_868084153214921","177057932317550","page_posts","177057932317550","2015-02-02T17:30:06+0000","EBLpH"
"177057932317550_868201209869882","177057932317550","page_posts","177057932317550","2015-02-03T01:03:20+0000","IFYlv"
"177057932317550_868721253151211","177057932317550","page_posts","177057932317550","2015-02-04T08:19:07+0000","GwkTg"
"177057932317550_868726169817386","177057932317550","page_posts","177057932317550","2015-02-04T08:47:55+0000","3raE9"
"177057932317550_871299946226675","177057932317550","page_posts","177057932317550","2015-02-10T09:06:05+0000","rL4O1"
"177057932317550_871542359535767","177057932317550","page_posts","177057932317550","2015-02-10T23:04:55+0000","0CVfN"
"177057932317550_871770149512988","177057932317550","page_posts","177057932317550","2015-02-11T12:46:47+0000","5i70s"
"177057932317550_876365615720108","177057932317550","page_posts","177057932317550","2015-02-19T21:42:46+0000","ngNjJ"
"177057932317550_876391385717531","177057932317550","page_posts","177057932317550","2015-02-19T22:57:01+0000","10m7l"
"177057932317550_876759985680671","177057932317550","page_posts","177057932317550","2015-02-20T19:01:57+0000","oOhJ2"
"177057932317550_878717075484962","177057932317550","page_posts","177057932317550","2015-02-24T10:49:45+0000","kqGL2"
"177057932317550_878834132139923","177057932317550","page_posts","177057932317550","2015-02-24T16:55:24+0000","z6sHM"
"177057932317550_880197812003555","177057932317550","page_posts","177057932317550","2015-02-27T18:53:14+0000","devYB"
"177057932317550_882565748433428","177057932317550","page_posts","177057932317550","2015-03-05T14:15:36+0000","RIIBQ"
"177057932317550_890214517668551","177057932317550","page_posts","177057932317550","2015-03-19T02:27:18+0000","vmgzg"
"177057932317550_894591280564208","177057932317550","page_posts","177057932317550","2015-03-25T18:39:57+0000","ZigGX"
"177057932317550_894908463865823","177057932317550","page_posts","177057932317550","2015-03-26T09:38:34+0000","yCq6E"
"177057932317550_895159487174054","177057932317550","page_posts","177057932317550","2015-03-26T19:20:42+0000","KDvuU"
"177057932317550_895172080506128","177057932317550","page_posts","177057932317550","2015-03-26T19:54:02+0000","WRKwQ"
"177057932317550_895638570459479","177057932317550","page_posts","177057932317550","2015-03-27T13:59:19+0000","904gH"
"177057932317550_895669693789700","177057932317550","page_posts","177057932317550","2015-03-27T15:31:12+0000","y9aQa"
"177057932317550_897828396907163","177057932317550","page_posts","177057932317550","2015-03-31T08:56:02+0000","BIk91"
"177057932317550_898249010198435","177057932317550","page_posts","177057932317550","2015-04-01T01:22:18+0000","Qt207"
"177057932317550_898322620191074","177057932317550","page_posts","177057932317550","2015-04-01T04:52:15+0000","TkBcy"
"177057932317550_898705676819435","177057932317550","page_posts","177057932317550","2015-04-01T23:26:00+0000","nv1uR"
"177057932317550_899104843446185","177057932317550","page_posts","177057932317550","2015-04-02T17:53:54+0000","eDnWg"
"177057932317550_899507860072550","177057932317550","page_posts","177057932317550","2015-04-03T10:05:14+0000","erCk3"
"177057932317550_902157386474264","177057932317550","page_posts","177057932317550","2015-04-08T06:32:14+0000","juJi8"
"177057932317550_903010183055651","177057932317550","page_posts","177057932317550","2015-04-10T09:20:52+0000","8TwUq"
"177057932317550_905758402780829","177057932317550","page_posts","177057932317550","2015-04-15T17:48:02+0000","Xqw98"
"177057932317550_908277042528965","177057932317550","page_posts","177057932317550","2015-04-20T10:55:26+0000","0NM7O"
"177057932317550_910073965682606","177057932317550","page_posts","177057932317550","2015-04-23T08:10:30+0000","n7mgu"
"177057932317550_913371222019547","177057932317550","page_posts","177057932317550","2015-04-28T09:40:20+0000","TWMm9"
"177057932317550_913890861967583","177057932317550","page_posts","177057932317550","2015-04-29T05:09:50+0000","08viB"
"177057932317550_921759597847376","177057932317550","page_posts","177057932317550","2015-05-16T06:54:46+0000",""
"177057932317550_921776914512311","177057932317550","page_posts","177057932317550","2015-05-16T08:15:15+0000",""
"177057932317550_932914176731918","177057932317550","page_posts","177057932317550","2015-06-08T11:10:56+0000","SVeRg"
"177057932317550_940984532591549","177057932317550","page_posts","177057932317550","2015-06-25T02:16:30+0000","JTFv8"
"177057932317550_990386480984687","177057932317550","page_posts","177057932317550","2015-10-14T05:03:09+0000","B1Fkm"
"177057932317550_1126854757337858","177057932317550","page_posts","177057932317550","2016-06-22T06:23:24+0000",""


================================================
File: /test/keboola/snapshots/pageinsights/out/tables/summarytest_posts.manifest
================================================
{"columns":["id","ex-account-id","fb-graph-node","parent-id","created_time","message"],"incremental":true,"primary_key":["parent_id","id"]}

================================================
File: /test/keboola/snapshots/pageinsights/config.json
================================================
{
  "storage" : { },
  "parameters" : {
    "accounts" : {
      "177057932317550" : {
        "id" : "177057932317550",
        "name" : "keboola",
        "category" : "software"
      }
    },
    "api-version" : "v2.8",
    "queries" : [ {
      "name" : "feed",
      "type" : "nested-query",
      "disabled" : true,
      "query" : {
        "path" : "feed",
        "fields" : "caption,message,created_time,type,description,likes{name,username},comments{message,created_time,from,likes{name,username},comments{message,created_time,from,likes{name,username}}}",
        "ids" : "177057932317550"
      }
    }, {
      "name" : "summarytest",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "",
        "fields" : "posts.limit(10){id,created_time,message,likes.summary(true).limit(0),reactions.summary(total_count).limit(0)}",
        "ids" : "177057932317550"
      }
    }, {
      "name" : "page",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "",
        "fields" : "insights.since(2 days ago).metric(page_views_by_age_gender_logged_in_unique,page_impressions_by_story_type, page_impressions_by_locale_unique, page_views_total, page_fans)",
        "ids" : null
      }
    }, {
      "name" : "",
      "type" : "nested-query",
      "disabled" : true,
      "query" : {
        "path" : "feed",
        "fields" : "insights.since(now).metric(post_negative_feedback, post_engaged_users, post_consumptions, post_impressions)",
        "ids" : "222838661196260"
      }
    } ]
  },
  "authorization" : {
    "oauth_api" : {
      "id" : "keboola.ex-facebook",
      "credentials" : {
        "id" : "main",
        "authorizedFor" : "Myself",
        "creator" : {
          "id" : "1234",
          "description" : "me@keboola.com"
        },
        "created" : "2016-01-31 00:13:30",
        "oauthVersion" : "facebook",
        "appKey" : "xxx",
        "#data" : "{\"token\":\"XXTOKENXX\"}",
        "#appSecret" : "KBC::Encrypted==ENCODEDSTRING=="
      }
    }
  }
}

================================================
File: /test/keboola/snapshots/runbyid/apicalls.clj
================================================
(ns keboola.snapshots.runbyid.apicalls)
(def recorded 
{
{:method :get,
 :address "https://graph.facebook.com/v4.0/",
 :as :json,
 :query-params
 {:path "",
  :fields
  "insights.time_range({\"since\":\"2019-09-29\",\"until\":\"2019-09-30\"}).level(ad).time_increment(1){account_id,account_name,ad_name,ad_id,impressions}",
  :ids "act_1146726535372240",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:status 200,
 :body
 "{\"act_1146726535372240\":{\"insights\":{\"data\":[{\"account_id\":\"1146726535372240\",\"account_name\":\"Rn4f8\",\"ad_name\":\"p84kw\",\"ad_id\":\"6164363071480\",\"impressions\":\"hLbV2\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"bepJ8\",\"ad_name\":\"WKjha\",\"ad_id\":\"6164363071680\",\"impressions\":\"pHulH\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"xTlvB\",\"ad_name\":\"5xRHT\",\"ad_id\":\"6164363072080\",\"impressions\":\"loLpz\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"oUxmM\",\"ad_name\":\"3VhKN\",\"ad_id\":\"6164363072280\",\"impressions\":\"cMF7L\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"qEb8h\",\"ad_name\":\"UyTj0\",\"ad_id\":\"6164363072880\",\"impressions\":\"Mh4jx\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"RiDsp\",\"ad_name\":\"k3L8Z\",\"ad_id\":\"6164363073280\",\"impressions\":\"i6URx\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"3gaaK\",\"ad_name\":\"7SbGa\",\"ad_id\":\"6164363071480\",\"impressions\":\"lQ5Cp\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"eJNaw\",\"ad_name\":\"5M1Bg\",\"ad_id\":\"6164363071680\",\"impressions\":\"Mx0hJ\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"KLzUd\",\"ad_name\":\"RLycB\",\"ad_id\":\"6164363072080\",\"impressions\":\"03zWv\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"bVMN4\",\"ad_name\":\"4hyrr\",\"ad_id\":\"6164363072280\",\"impressions\":\"mYTK4\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"Dyzf7\",\"ad_name\":\"I8lef\",\"ad_id\":\"6164363072880\",\"impressions\":\"RBPma\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"},{\"account_id\":\"1146726535372240\",\"account_name\":\"viIso\",\"ad_name\":\"rqbRY\",\"ad_id\":\"6164363073280\",\"impressions\":\"RhNJN\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MTEZD\"}}},\"id\":\"act_1146726535372240\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v4.0/",
 :as :json,
 :query-params
 {:path "",
  :fields
  "insights.time_range({\"since\":\"2019-09-29\",\"until\":\"2019-09-30\"}).level(ad).time_increment(1){account_id,account_name,ad_name,ad_id,impressions}",
  :ids "act_108176966036258",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:status 200,
 :body
 "{\"act_108176966036258\":{\"insights\":{\"data\":[{\"account_id\":\"108176966036258\",\"account_name\":\"9OJDi\",\"ad_name\":\"cJ2fD\",\"ad_id\":\"6134702917855\",\"impressions\":\"801nU\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"108176966036258\",\"account_name\":\"QTiTQ\",\"ad_name\":\"Oq3jX\",\"ad_id\":\"6134760720255\",\"impressions\":\"Yp7Wh\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"108176966036258\",\"account_name\":\"ejkr5\",\"ad_name\":\"9Oh5V\",\"ad_id\":\"6134760720655\",\"impressions\":\"5UmnU\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"108176966036258\",\"account_name\":\"GCygF\",\"ad_name\":\"j7oPW\",\"ad_id\":\"6134760721055\",\"impressions\":\"k1Ila\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"108176966036258\",\"account_name\":\"xvb11\",\"ad_name\":\"ItqGO\",\"ad_id\":\"6134760721255\",\"impressions\":\"Ftcom\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"108176966036258\",\"account_name\":\"8e32I\",\"ad_name\":\"yHrYg\",\"ad_id\":\"6134760721455\",\"impressions\":\"oQSrN\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"108176966036258\",\"account_name\":\"KDsFR\",\"ad_name\":\"bJZaK\",\"ad_id\":\"6134760721655\",\"impressions\":\"PiS1l\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"108176966036258\",\"account_name\":\"UGHhF\",\"ad_name\":\"MCkrb\",\"ad_id\":\"6134760721855\",\"impressions\":\"ST4rD\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"108176966036258\",\"account_name\":\"1itYW\",\"ad_name\":\"V8pJn\",\"ad_id\":\"6134760722255\",\"impressions\":\"LFpYk\",\"date_start\":\"2019-09-29\",\"date_stop\":\"2019-09-29\"},{\"account_id\":\"108176966036258\",\"account_name\":\"8uHUi\",\"ad_name\":\"6Cgyi\",\"ad_id\":\"6134702917855\",\"impressions\":\"a5czK\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"},{\"account_id\":\"108176966036258\",\"account_name\":\"1MXgy\",\"ad_name\":\"p2qRE\",\"ad_id\":\"6134760721255\",\"impressions\":\"g2Ude\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"},{\"account_id\":\"108176966036258\",\"account_name\":\"OQ4HK\",\"ad_name\":\"G6SZI\",\"ad_id\":\"6134760721455\",\"impressions\":\"gZYka\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"},{\"account_id\":\"108176966036258\",\"account_name\":\"dwBfc\",\"ad_name\":\"zYoRl\",\"ad_id\":\"6134760721655\",\"impressions\":\"RjeTM\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"},{\"account_id\":\"108176966036258\",\"account_name\":\"rjTMp\",\"ad_name\":\"CIP6S\",\"ad_id\":\"6134760722255\",\"impressions\":\"U7dqW\",\"date_start\":\"2019-09-30\",\"date_stop\":\"2019-09-30\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MTMZD\"}}},\"id\":\"act_108176966036258\"}}"}
)
})

================================================
File: /test/keboola/snapshots/runbyid/out/tables/ads_insights.manifest
================================================
{"columns":["ex-account-id","fb-graph-node","parent-id","account_id","account_name","ad_id","ad_name","date_start","date_stop","impressions"],"incremental":true,"primary_key":["parent_id","account_id","date_start","date_stop","ad_id"]}

================================================
File: /test/keboola/snapshots/runbyid/out/tables/accounts
================================================
account_id,name,business_name,currency,id
108176966036258,account 2,account 2,GBP,act_108176966036258
1146726535372240,account 3,,GBP,act_1146726535372240


================================================
File: /test/keboola/snapshots/runbyid/out/tables/ads_insights/1570782087866
================================================
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","viIso","6164363073280","rqbRY","2019-09-30","2019-09-30","RhNJN"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","Dyzf7","6164363072880","I8lef","2019-09-30","2019-09-30","RBPma"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","bVMN4","6164363072280","4hyrr","2019-09-30","2019-09-30","mYTK4"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","KLzUd","6164363072080","RLycB","2019-09-30","2019-09-30","03zWv"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","eJNaw","6164363071680","5M1Bg","2019-09-30","2019-09-30","Mx0hJ"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","3gaaK","6164363071480","7SbGa","2019-09-30","2019-09-30","lQ5Cp"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","RiDsp","6164363073280","k3L8Z","2019-09-29","2019-09-29","i6URx"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","qEb8h","6164363072880","UyTj0","2019-09-29","2019-09-29","Mh4jx"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","oUxmM","6164363072280","3VhKN","2019-09-29","2019-09-29","cMF7L"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","xTlvB","6164363072080","5xRHT","2019-09-29","2019-09-29","loLpz"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","bepJ8","6164363071680","WKjha","2019-09-29","2019-09-29","pHulH"
"act_1146726535372240","page_insights","act_1146726535372240","1146726535372240","Rn4f8","6164363071480","p84kw","2019-09-29","2019-09-29","hLbV2"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","rjTMp","6134760722255","CIP6S","2019-09-30","2019-09-30","U7dqW"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","dwBfc","6134760721655","zYoRl","2019-09-30","2019-09-30","RjeTM"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","OQ4HK","6134760721455","G6SZI","2019-09-30","2019-09-30","gZYka"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","1MXgy","6134760721255","p2qRE","2019-09-30","2019-09-30","g2Ude"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","8uHUi","6134702917855","6Cgyi","2019-09-30","2019-09-30","a5czK"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","1itYW","6134760722255","V8pJn","2019-09-29","2019-09-29","LFpYk"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","UGHhF","6134760721855","MCkrb","2019-09-29","2019-09-29","ST4rD"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","KDsFR","6134760721655","bJZaK","2019-09-29","2019-09-29","PiS1l"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","8e32I","6134760721455","yHrYg","2019-09-29","2019-09-29","oQSrN"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","xvb11","6134760721255","ItqGO","2019-09-29","2019-09-29","Ftcom"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","GCygF","6134760721055","j7oPW","2019-09-29","2019-09-29","k1Ila"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","ejkr5","6134760720655","9Oh5V","2019-09-29","2019-09-29","5UmnU"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","QTiTQ","6134760720255","Oq3jX","2019-09-29","2019-09-29","Yp7Wh"
"act_108176966036258","page_insights","act_108176966036258","108176966036258","9OJDi","6134702917855","cJ2fD","2019-09-29","2019-09-29","801nU"


================================================
File: /test/keboola/snapshots/runbyid/test_runbyid.clj
================================================
(ns keboola.snapshots.runbyid.test-runbyid
  (:require [keboola.snapshots.runbyid.apicalls :as apicalls]
            [clojure.test :as t :refer :all]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.test-utils.core :as test-utils]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            )
  (:use clj-http.fake))

(deftest runbyid-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "runbyid"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "test/keboola/snapshots/runbyid")
    (test-utils/copy-config-tmp "test/keboola/snapshots/runbyid" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "test/keboola/snapshots/runbyid" tmp-dir)
      )))

================================================
File: /test/keboola/snapshots/runbyid/config.json
================================================
{
  "storage" : { },
  "parameters" : {
    "accounts" : {
      "act_108176966036258" : {
        "account_id" : "108176966036258",
        "business_name" : "account 2",
        "currency" : "GBP",
        "id" : "act_108176966036258",
        "name" : "account 2"
      },
      "act_1146726535372240" : {
        "account_id" : "1146726535372240",
        "business_name" : "",
        "currency" : "GBP",
        "id" : "act_1146726535372240",
        "name" : "account 3"
      }
    },
    "api-version" : "v4.0",
    "queries" : [ {
      "name" : "ads",
      "type" : "nested-query",
      "run-by-id" : true,
      "disabled" : false,
      "query" : {
        "path" : "",
        "fields" : "insights.time_range({\"since\":\"2019-09-29\",\"until\":\"2019-09-30\"}).level(ad).time_increment(1){account_id,account_name,ad_name,ad_id,impressions}",
        "ids" : ""
      }
    } ]
  },
  "authorization" : {
    "oauth_api" : {
      "id" : "{OAUTH_API_ID}",
      "credentials" : {
        "id" : "main",
        "authorizedFor" : "Myself",
        "creator" : {
          "id" : "1234",
          "description" : "me@keboola.com"
        },
        "created" : "2016-01-31 00:13:30",
        "oauthVersion" : "facebook",
        "appKey" : "",
        "#data" : "{\"token\":\"XXTOKENXX\"}",
        "#appSecret" : ""
      }
    }
  }
}

================================================
File: /test/keboola/snapshots/adsinsights/apicalls.clj
================================================
(ns keboola.snapshots.adsinsights.apicalls)
(def recorded 
{
{:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAxOTY4MTA4NzY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6019661556070\"},{\"id\":\"6019661555870\"},{\"id\":\"6019661555670\"},{\"id\":\"6019644192270\"},{\"id\":\"6019644191870\"},{\"id\":\"6019644192070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAxOTY2MTU1NjA3MAZDZD\",\"after\":\"NjAxOTY0NDE5MjA3MAZDZD\"},\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAxOTY2MTU1NjA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDEwNjQyMTQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020106415470\"},{\"id\":\"6019995145670\"},{\"id\":\"6019995145470\"},{\"id\":\"6019995145270\"},{\"id\":\"6019973185670\"},{\"id\":\"6019973185470\"},{\"id\":\"6019973185870\"},{\"id\":\"6019815143870\"},{\"id\":\"6019815143670\"},{\"id\":\"6019815142870\"},{\"id\":\"6019815144470\"},{\"id\":\"6019815144270\"},{\"id\":\"6019815144670\"},{\"id\":\"6019815143070\"},{\"id\":\"6019815145470\"},{\"id\":\"6019815142470\"},{\"id\":\"6019815144070\"},{\"id\":\"6019815143470\"},{\"id\":\"6019815142670\"},{\"id\":\"6019751996470\"},{\"id\":\"6019751996270\"},{\"id\":\"6019751996670\"},{\"id\":\"6019681087470\"},{\"id\":\"6019681087270\"},{\"id\":\"6019681087670\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDEwNjQxNTQ3MAZDZD\",\"after\":\"NjAxOTY4MTA4NzY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAxOTY4MTA4NzY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMDEwNjQxNTQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDQxNjAzNTg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020416035670\"},{\"id\":\"6020411668870\"},{\"id\":\"6020411671070\"},{\"id\":\"6020411668670\"},{\"id\":\"6020411668470\"},{\"id\":\"6020354735670\"},{\"id\":\"6020354735470\"},{\"id\":\"6020354735870\"},{\"id\":\"6020293049270\"},{\"id\":\"6020293049070\"},{\"id\":\"6020293048670\"},{\"id\":\"6020293048870\"},{\"id\":\"6020293048470\"},{\"id\":\"6020293049470\"},{\"id\":\"6020269544670\"},{\"id\":\"6020269544470\"},{\"id\":\"6020269544270\"},{\"id\":\"6020106421070\"},{\"id\":\"6020106420870\"},{\"id\":\"6020106420670\"},{\"id\":\"6020106415670\"},{\"id\":\"6020106432470\"},{\"id\":\"6020106415270\"},{\"id\":\"6020106422270\"},{\"id\":\"6020106421470\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDQxNjAzNTY3MAZDZD\",\"after\":\"NjAyMDEwNjQyMTQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDEwNjQyMTQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMDQxNjAzNTY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDU5MDMxMjA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020590295270\"},{\"id\":\"6020590284870\"},{\"id\":\"6020590308070\"},{\"id\":\"6020590276870\"},{\"id\":\"6020492548070\"},{\"id\":\"6020492547870\"},{\"id\":\"6020492548270\"},{\"id\":\"6020492547670\"},{\"id\":\"6020492547470\"},{\"id\":\"6020492547270\"},{\"id\":\"6020469213270\"},{\"id\":\"6020469213470\"},{\"id\":\"6020469213070\"},{\"id\":\"6020445631670\"},{\"id\":\"6020445632070\"},{\"id\":\"6020416035070\"},{\"id\":\"6020416035270\"},{\"id\":\"6020416034870\"},{\"id\":\"6020445636270\"},{\"id\":\"6020445636470\"},{\"id\":\"6020445639470\"},{\"id\":\"6020445632870\"},{\"id\":\"6020445631870\"},{\"id\":\"6020416035470\"},{\"id\":\"6020416035870\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDU5MDI5NTI3MAZDZD\",\"after\":\"NjAyMDQxNjAzNTg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDQxNjAzNTg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMDU5MDI5NTI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDY2NDc0MjI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020663871670\"},{\"id\":\"6020663879070\"},{\"id\":\"6020663873270\"},{\"id\":\"6020606316070\"},{\"id\":\"6020606318470\"},{\"id\":\"6020606318070\"},{\"id\":\"6020606318270\"},{\"id\":\"6020606315270\"},{\"id\":\"6020606315470\"},{\"id\":\"6020590296870\"},{\"id\":\"6020590284670\"},{\"id\":\"6020590288070\"},{\"id\":\"6020590294070\"},{\"id\":\"6020590276670\"},{\"id\":\"6020590316870\"},{\"id\":\"6020590286470\"},{\"id\":\"6020590294870\"},{\"id\":\"6020590311670\"},{\"id\":\"6020590312270\"},{\"id\":\"6020590295070\"},{\"id\":\"6020590280470\"},{\"id\":\"6020590326070\"},{\"id\":\"6020590282270\"},{\"id\":\"6020590292870\"},{\"id\":\"6020590312070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDY2Mzg3MTY3MAZDZD\",\"after\":\"NjAyMDU5MDMxMjA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDU5MDMxMjA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMDY2Mzg3MTY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDkxNzQ0MzI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020917544670\"},{\"id\":\"6020916793070\"},{\"id\":\"6020916736070\"},{\"id\":\"6020916762670\"},{\"id\":\"6020916763470\"},{\"id\":\"6020916748270\"},{\"id\":\"6020698693070\"},{\"id\":\"6020698693670\"},{\"id\":\"6020698694470\"},{\"id\":\"6020663872470\"},{\"id\":\"6020470086870\"},{\"id\":\"6020470086470\"},{\"id\":\"6020470086270\"},{\"id\":\"6020470074870\"},{\"id\":\"6020470076270\"},{\"id\":\"6020470086670\"},{\"id\":\"6020470074470\"},{\"id\":\"6020470074070\"},{\"id\":\"6020470074670\"},{\"id\":\"6020470069270\"},{\"id\":\"6020470069070\"},{\"id\":\"6020470070670\"},{\"id\":\"6020664743670\"},{\"id\":\"6020664741270\"},{\"id\":\"6020664742270\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDkxNzU0NDY3MAZDZD\",\"after\":\"NjAyMDY2NDc0MjI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDY2NDc0MjI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMDkxNzU0NDY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDkxNjc0NDg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020916732870\"},{\"id\":\"6020916799270\"},{\"id\":\"6020917471070\"},{\"id\":\"6020916771270\"},{\"id\":\"6020917480870\"},{\"id\":\"6020917478270\"},{\"id\":\"6020917551870\"},{\"id\":\"6020916763870\"},{\"id\":\"6020917511870\"},{\"id\":\"6020917507670\"},{\"id\":\"6020917474470\"},{\"id\":\"6020917538670\"},{\"id\":\"6020917508270\"},{\"id\":\"6020917556870\"},{\"id\":\"6020917519270\"},{\"id\":\"6020917447670\"},{\"id\":\"6020917470070\"},{\"id\":\"6020917459070\"},{\"id\":\"6020917507870\"},{\"id\":\"6020917539870\"},{\"id\":\"6020917514670\"},{\"id\":\"6020917508070\"},{\"id\":\"6020917461070\"},{\"id\":\"6020917532070\"},{\"id\":\"6020917443270\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDkxNjczMjg3MAZDZD\",\"after\":\"NjAyMDkxNzQ0MzI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDkxNzQ0MzI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMDkxNjczMjg3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDkxNzUxNTg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020917550670\"},{\"id\":\"6020917470270\"},{\"id\":\"6020917464870\"},{\"id\":\"6020917465670\"},{\"id\":\"6020917514070\"},{\"id\":\"6020916748470\"},{\"id\":\"6020917443070\"},{\"id\":\"6020917510070\"},{\"id\":\"6020917538070\"},{\"id\":\"6020917507270\"},{\"id\":\"6020917470470\"},{\"id\":\"6020917475670\"},{\"id\":\"6020917458270\"},{\"id\":\"6020917550470\"},{\"id\":\"6020917441670\"},{\"id\":\"6020916759670\"},{\"id\":\"6020916778870\"},{\"id\":\"6020916767870\"},{\"id\":\"6020916788670\"},{\"id\":\"6020916777270\"},{\"id\":\"6020916744470\"},{\"id\":\"6020916794870\"},{\"id\":\"6020916784070\"},{\"id\":\"6020916730270\"},{\"id\":\"6020916744870\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDkxNzU1MDY3MAZDZD\",\"after\":\"NjAyMDkxNjc0NDg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDkxNjc0NDg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMDkxNzU1MDY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMTc4NjEyMDI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6021786119870\"},{\"id\":\"6021786130270\"},{\"id\":\"6021786122670\"},{\"id\":\"6021786129870\"},{\"id\":\"6021786130070\"},{\"id\":\"6021785986070\"},{\"id\":\"6021785985870\"},{\"id\":\"6021785986270\"},{\"id\":\"6021785982670\"},{\"id\":\"6021754743470\"},{\"id\":\"6021754739870\"},{\"id\":\"6021754743670\"},{\"id\":\"6021754743870\"},{\"id\":\"6021127967070\"},{\"id\":\"6021127964070\"},{\"id\":\"6021127970470\"},{\"id\":\"6021127971670\"},{\"id\":\"6020917461670\"},{\"id\":\"6020917465870\"},{\"id\":\"6020917462470\"},{\"id\":\"6020916786270\"},{\"id\":\"6020916759070\"},{\"id\":\"6020916746470\"},{\"id\":\"6020916734870\"},{\"id\":\"6020917515870\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMTc4NjExOTg3MAZDZD\",\"after\":\"NjAyMDkxNzUxNTg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMDkxNzUxNTg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMTc4NjExOTg3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMjA5MDY2NDY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6022090667470\"},{\"id\":\"6022090667270\"},{\"id\":\"6022044703470\"},{\"id\":\"6022044706270\"},{\"id\":\"6022044706470\"},{\"id\":\"6021988125070\"},{\"id\":\"6021988127870\"},{\"id\":\"6021988127670\"},{\"id\":\"6021974131470\"},{\"id\":\"6021974131670\"},{\"id\":\"6021974128670\"},{\"id\":\"6021965226870\"},{\"id\":\"6021965229670\"},{\"id\":\"6021965229470\"},{\"id\":\"6021839677870\"},{\"id\":\"6021839668470\"},{\"id\":\"6021839677670\"},{\"id\":\"6021839670270\"},{\"id\":\"6021839678070\"},{\"id\":\"6021839663870\"},{\"id\":\"6021839668270\"},{\"id\":\"6021839668070\"},{\"id\":\"6021786120070\"},{\"id\":\"6021786115070\"},{\"id\":\"6021786120270\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMjA5MDY2NzQ3MAZDZD\",\"after\":\"NjAyMTc4NjEyMDI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMTc4NjEyMDI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMjA5MDY2NzQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMjMwNjcwNTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6022315662470\"},{\"id\":\"6022315659070\"},{\"id\":\"6022315662270\"},{\"id\":\"6022306711470\"},{\"id\":\"6022306711670\"},{\"id\":\"6022306708670\"},{\"id\":\"6022238025470\"},{\"id\":\"6022238022870\"},{\"id\":\"6022238025670\"},{\"id\":\"6022234026070\"},{\"id\":\"6022234023470\"},{\"id\":\"6022234026270\"},{\"id\":\"6022151369470\"},{\"id\":\"6022151372070\"},{\"id\":\"6022151372270\"},{\"id\":\"6022121100470\"},{\"id\":\"6022121114270\"},{\"id\":\"6022121107270\"},{\"id\":\"6022121107470\"},{\"id\":\"6022121100870\"},{\"id\":\"6022121110070\"},{\"id\":\"6022121092270\"},{\"id\":\"6022121091070\"},{\"id\":\"6022121096470\"},{\"id\":\"6022090664670\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMjMxNTY2MjQ3MAZDZD\",\"after\":\"NjAyMjA5MDY2NDY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMjA5MDY2NDY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMjMxNTY2MjQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMjgxOTkwMDQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6022819903870\"},{\"id\":\"6022819903670\"},{\"id\":\"6022818801270\"},{\"id\":\"6022818803670\"},{\"id\":\"6022818802470\"},{\"id\":\"6022818804270\"},{\"id\":\"6022736698270\"},{\"id\":\"6022736702070\"},{\"id\":\"6022736701470\"},{\"id\":\"6022736701670\"},{\"id\":\"6022694262270\"},{\"id\":\"6022694262470\"},{\"id\":\"6022694258270\"},{\"id\":\"6022694262670\"},{\"id\":\"6022569067870\"},{\"id\":\"6022569067670\"},{\"id\":\"6022569068070\"},{\"id\":\"6022569064070\"},{\"id\":\"6022421562870\"},{\"id\":\"6022421563270\"},{\"id\":\"6022421563070\"},{\"id\":\"6022421559470\"},{\"id\":\"6022306704870\"},{\"id\":\"6022306701470\"},{\"id\":\"6022306705070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMjgxOTkwMzg3MAZDZD\",\"after\":\"NjAyMjMwNjcwNTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMjMwNjcwNTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMjgxOTkwMzg3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMjg2MTE5MDI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6022861193470\"},{\"id\":\"6022861193670\"},{\"id\":\"6022819904070\"},{\"id\":\"6022819877070\"},{\"id\":\"6022819896470\"},{\"id\":\"6022820164670\"},{\"id\":\"6022820164470\"},{\"id\":\"6022820164270\"},{\"id\":\"6022820160870\"},{\"id\":\"6022819873870\"},{\"id\":\"6022819898070\"},{\"id\":\"6022819873670\"},{\"id\":\"6022819867470\"},{\"id\":\"6022819871070\"},{\"id\":\"6022819901470\"},{\"id\":\"6022819871270\"},{\"id\":\"6022819864870\"},{\"id\":\"6022819896870\"},{\"id\":\"6022819897070\"},{\"id\":\"6022819868270\"},{\"id\":\"6022819875870\"},{\"id\":\"6022819870670\"},{\"id\":\"6022819878270\"},{\"id\":\"6022819871670\"},{\"id\":\"6022819900470\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMjg2MTE5MzQ3MAZDZD\",\"after\":\"NjAyMjgxOTkwMDQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMjgxOTkwMDQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMjg2MTE5MzQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMzE4ODI2MzY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6023188274070\"},{\"id\":\"6023188266070\"},{\"id\":\"6023188264870\"},{\"id\":\"6023187854070\"},{\"id\":\"6023187853670\"},{\"id\":\"6023187835270\"},{\"id\":\"6023187831870\"},{\"id\":\"6023187855270\"},{\"id\":\"6023187834270\"},{\"id\":\"6023044218070\"},{\"id\":\"6023044218470\"},{\"id\":\"6023044218270\"},{\"id\":\"6023044214670\"},{\"id\":\"6023001089470\"},{\"id\":\"6023011201470\"},{\"id\":\"6022922612870\"},{\"id\":\"6022922612470\"},{\"id\":\"6022922612670\"},{\"id\":\"6022922608870\"},{\"id\":\"6022893603070\"},{\"id\":\"6022893599270\"},{\"id\":\"6022893602670\"},{\"id\":\"6022893602470\"},{\"id\":\"6022861193870\"},{\"id\":\"6022861190270\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMzE4ODI3NDA3MAZDZD\",\"after\":\"NjAyMjg2MTE5MDI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMjg2MTE5MDI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMzE4ODI3NDA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNDE0OTc0Nzg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6024149750670\"},{\"id\":\"6024149741670\"},{\"id\":\"6024149742870\"},{\"id\":\"6023826964070\"},{\"id\":\"6023826963470\"},{\"id\":\"6023826963870\"},{\"id\":\"6023826963670\"},{\"id\":\"6023497850270\"},{\"id\":\"6023497849870\"},{\"id\":\"6023497850070\"},{\"id\":\"6023497846470\"},{\"id\":\"6023321647470\"},{\"id\":\"6023321651670\"},{\"id\":\"6023321652070\"},{\"id\":\"6023321651870\"},{\"id\":\"6023221134070\"},{\"id\":\"6023221134270\"},{\"id\":\"6023221134470\"},{\"id\":\"6023221130870\"},{\"id\":\"6023187836670\"},{\"id\":\"6023187836270\"},{\"id\":\"6023187832270\"},{\"id\":\"6023188264670\"},{\"id\":\"6023188276670\"},{\"id\":\"6023188263670\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNDE0OTc1MDY3MAZDZD\",\"after\":\"NjAyMzE4ODI2MzY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMzE4ODI2MzY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyNDE0OTc1MDY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNTU2Mjk4OTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6025562994870\"},{\"id\":\"6025563004070\"},{\"id\":\"6025562965270\"},{\"id\":\"6025562964470\"},{\"id\":\"6025200481470\"},{\"id\":\"6025200479070\"},{\"id\":\"6025200480070\"},{\"id\":\"6025200481870\"},{\"id\":\"6025161662470\"},{\"id\":\"6025161662070\"},{\"id\":\"6025161662270\"},{\"id\":\"6025161663070\"},{\"id\":\"6024565489070\"},{\"id\":\"6024565480070\"},{\"id\":\"6024565479270\"},{\"id\":\"6024565478670\"},{\"id\":\"6024565476670\"},{\"id\":\"6024565475670\"},{\"id\":\"6024565475870\"},{\"id\":\"6024565478470\"},{\"id\":\"6024149749070\"},{\"id\":\"6024149745870\"},{\"id\":\"6024149746070\"},{\"id\":\"6024149745670\"},{\"id\":\"6024149747870\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNTU2Mjk5NDg3MAZDZD\",\"after\":\"NjAyNDE0OTc0Nzg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNDE0OTc0Nzg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyNTU2Mjk5NDg3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNTU4OTk3MTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6025589968870\"},{\"id\":\"6025589969670\"},{\"id\":\"6025589971470\"},{\"id\":\"6025592518070\"},{\"id\":\"6025592523270\"},{\"id\":\"6025589981270\"},{\"id\":\"6025589979870\"},{\"id\":\"6025589980070\"},{\"id\":\"6025589980270\"},{\"id\":\"6025562962670\"},{\"id\":\"6025563003870\"},{\"id\":\"6025562969470\"},{\"id\":\"6025562963670\"},{\"id\":\"6025563001470\"},{\"id\":\"6025562962270\"},{\"id\":\"6025562971870\"},{\"id\":\"6025562988470\"},{\"id\":\"6025562979070\"},{\"id\":\"6025562977270\"},{\"id\":\"6025562964670\"},{\"id\":\"6025562958270\"},{\"id\":\"6025562989270\"},{\"id\":\"6025562988670\"},{\"id\":\"6025562963070\"},{\"id\":\"6025562989070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNTU4OTk2ODg3MAZDZD\",\"after\":\"NjAyNTU2Mjk4OTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNTU2Mjk4OTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyNTU4OTk2ODg3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNjM5MjA4ODA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6026356625070\"},{\"id\":\"6026356627070\"},{\"id\":\"6026356625870\"},{\"id\":\"6026313661670\"},{\"id\":\"6025592516870\"},{\"id\":\"6025592516670\"},{\"id\":\"6026226382670\"},{\"id\":\"6026226381470\"},{\"id\":\"6026226380870\"},{\"id\":\"6026182837670\"},{\"id\":\"6026182837270\"},{\"id\":\"6026182836470\"},{\"id\":\"6025978796270\"},{\"id\":\"6025978795870\"},{\"id\":\"6025978796870\"},{\"id\":\"6025695657270\"},{\"id\":\"6025695656870\"},{\"id\":\"6025695657470\"},{\"id\":\"6025695657070\"},{\"id\":\"6025695664270\"},{\"id\":\"6025695662070\"},{\"id\":\"6025695665870\"},{\"id\":\"6025695664470\"},{\"id\":\"6025695513270\"},{\"id\":\"6025589971070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNjM1NjYyNTA3MAZDZD\",\"after\":\"NjAyNTU4OTk3MTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNTU4OTk3MTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyNjM1NjYyNTA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNjc5ODk2NDA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6026798963070\"},{\"id\":\"6026798963670\"},{\"id\":\"6026798963870\"},{\"id\":\"6026721259670\"},{\"id\":\"6026721259870\"},{\"id\":\"6026567475070\"},{\"id\":\"6026567467270\"},{\"id\":\"6026567474070\"},{\"id\":\"6026567468070\"},{\"id\":\"6026567466870\"},{\"id\":\"6026567467670\"},{\"id\":\"6026567183070\"},{\"id\":\"6026542988670\"},{\"id\":\"6026542987870\"},{\"id\":\"6026542990870\"},{\"id\":\"6026505665470\"},{\"id\":\"6026505671470\"},{\"id\":\"6026505665870\"},{\"id\":\"6026505665070\"},{\"id\":\"6026505664670\"},{\"id\":\"6026505671270\"},{\"id\":\"6026392088670\"},{\"id\":\"6026392090270\"},{\"id\":\"6026392091070\"},{\"id\":\"6026392088070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNjc5ODk2MzA3MAZDZD\",\"after\":\"NjAyNjM5MjA4ODA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNjM5MjA4ODA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyNjc5ODk2MzA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNzM3ODI1NzY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6027378256870\"},{\"id\":\"6027371321670\"},{\"id\":\"6027243204670\"},{\"id\":\"6027205133670\"},{\"id\":\"6027205134670\"},{\"id\":\"6027205133870\"},{\"id\":\"6027159833670\"},{\"id\":\"6027159832070\"},{\"id\":\"6027159831870\"},{\"id\":\"6027036884870\"},{\"id\":\"6027036890670\"},{\"id\":\"6027036891670\"},{\"id\":\"6027036881870\"},{\"id\":\"6027036884270\"},{\"id\":\"6027036883670\"},{\"id\":\"6026976899070\"},{\"id\":\"6026976898670\"},{\"id\":\"6026976896870\"},{\"id\":\"6026904330870\"},{\"id\":\"6026904331670\"},{\"id\":\"6026904330070\"},{\"id\":\"6026891425270\"},{\"id\":\"6026891424070\"},{\"id\":\"6026891425070\"},{\"id\":\"6026798964070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNzM3ODI1Njg3MAZDZD\",\"after\":\"NjAyNjc5ODk2NDA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNjc5ODk2NDA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyNzM3ODI1Njg3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyODIzNjQ5NDA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6028236493870\"},{\"id\":\"6028236494870\"},{\"id\":\"6028084226270\"},{\"id\":\"6028084226870\"},{\"id\":\"6028084225070\"},{\"id\":\"6027882166670\"},{\"id\":\"6027882167270\"},{\"id\":\"6027882165870\"},{\"id\":\"6027882168070\"},{\"id\":\"6027882164270\"},{\"id\":\"6027882164470\"},{\"id\":\"6027678421870\"},{\"id\":\"6027678420670\"},{\"id\":\"6027678420470\"},{\"id\":\"6027570750670\"},{\"id\":\"6027570765270\"},{\"id\":\"6027570763670\"},{\"id\":\"6027570764670\"},{\"id\":\"6027570762870\"},{\"id\":\"6027570748670\"},{\"id\":\"6027570748870\"},{\"id\":\"6027570769670\"},{\"id\":\"6027570768470\"},{\"id\":\"6027378256070\"},{\"id\":\"6027378257670\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyODIzNjQ5Mzg3MAZDZD\",\"after\":\"NjAyNzM3ODI1NzY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyNzM3ODI1NzY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyODIzNjQ5Mzg3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyODQ3MTg3NDg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6028471872070\"},{\"id\":\"6028471873270\"},{\"id\":\"6028471875270\"},{\"id\":\"6028471872470\"},{\"id\":\"6028471867470\"},{\"id\":\"6026011252470\"},{\"id\":\"6026011243470\"},{\"id\":\"6028432646270\"},{\"id\":\"6028381975870\"},{\"id\":\"6028381986270\"},{\"id\":\"6028381979270\"},{\"id\":\"6028381982870\"},{\"id\":\"6028346492270\"},{\"id\":\"6028345830470\"},{\"id\":\"6028345834270\"},{\"id\":\"6028345835270\"},{\"id\":\"6028346492070\"},{\"id\":\"6028343841270\"},{\"id\":\"6028343841470\"},{\"id\":\"6028343841070\"},{\"id\":\"6028270941270\"},{\"id\":\"6028270977870\"},{\"id\":\"6028270981270\"},{\"id\":\"6028270969670\"},{\"id\":\"6028236494070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyODQ3MTg3MjA3MAZDZD\",\"after\":\"NjAyODIzNjQ5NDA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyODIzNjQ5NDA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyODQ3MTg3MjA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyOTA1ODMxOTI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6029058318470\"},{\"id\":\"6029058319070\"},{\"id\":\"6028994842070\"},{\"id\":\"6028994851070\"},{\"id\":\"6028994852470\"},{\"id\":\"6028994841870\"},{\"id\":\"6028994845070\"},{\"id\":\"6028994843270\"},{\"id\":\"6028621724270\"},{\"id\":\"6028621725670\"},{\"id\":\"6028621724070\"},{\"id\":\"6028621721670\"},{\"id\":\"6028504433670\"},{\"id\":\"6028504432670\"},{\"id\":\"6028504426470\"},{\"id\":\"6028504432070\"},{\"id\":\"6028504431870\"},{\"id\":\"6028504423470\"},{\"id\":\"6028504426670\"},{\"id\":\"6028504424670\"},{\"id\":\"6028432871870\"},{\"id\":\"6028471868470\"},{\"id\":\"6028471866670\"},{\"id\":\"6028471867670\"},{\"id\":\"6028471874870\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyOTA1ODMxODQ3MAZDZD\",\"after\":\"NjAyODQ3MTg3NDg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyODQ3MTg3NDg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyOTA1ODMxODQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyOTg1NTgwNTQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6029855806270\"},{\"id\":\"6029855805270\"},{\"id\":\"6029798211270\"},{\"id\":\"6029798209270\"},{\"id\":\"6029798219070\"},{\"id\":\"6029798212670\"},{\"id\":\"6029750530070\"},{\"id\":\"6028432641270\"},{\"id\":\"6029552277270\"},{\"id\":\"6029552278470\"},{\"id\":\"6029552278270\"},{\"id\":\"6029552276870\"},{\"id\":\"6029405815670\"},{\"id\":\"6029405815870\"},{\"id\":\"6029405815470\"},{\"id\":\"6029405816070\"},{\"id\":\"6029351166870\"},{\"id\":\"6029351166270\"},{\"id\":\"6029351166070\"},{\"id\":\"6029351165070\"},{\"id\":\"6029341877670\"},{\"id\":\"6029341877470\"},{\"id\":\"6029341877270\"},{\"id\":\"6029058319470\"},{\"id\":\"6029058319270\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyOTg1NTgwNjI3MAZDZD\",\"after\":\"NjAyOTA1ODMxOTI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyOTA1ODMxOTI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyOTg1NTgwNjI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzMDYwNjY5NzQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6030606697270\"},{\"id\":\"6030460709870\"},{\"id\":\"6030460710070\"},{\"id\":\"6030460709470\"},{\"id\":\"6030460709670\"},{\"id\":\"6030197295470\"},{\"id\":\"6030197296270\"},{\"id\":\"6030197296070\"},{\"id\":\"6030197296470\"},{\"id\":\"6030077617270\"},{\"id\":\"6030077616870\"},{\"id\":\"6030077616670\"},{\"id\":\"6030077616270\"},{\"id\":\"6030029673670\"},{\"id\":\"6030029673470\"},{\"id\":\"6029784111470\"},{\"id\":\"6029750541470\"},{\"id\":\"6029750534470\"},{\"id\":\"6029750532870\"},{\"id\":\"6029842978070\"},{\"id\":\"6029842978470\"},{\"id\":\"6029896997070\"},{\"id\":\"6029855094670\"},{\"id\":\"6029896996870\"},{\"id\":\"6029855805470\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzMDYwNjY5NzI3MAZDZD\",\"after\":\"NjAyOTg1NTgwNTQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyOTg1NTgwNTQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAzMDYwNjY5NzI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzMTU5NjYwMDQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6031489848070\"},{\"id\":\"6031489847870\"},{\"id\":\"6031534458470\"},{\"id\":\"6031534458270\"},{\"id\":\"6031534458070\"},{\"id\":\"6031490827870\"},{\"id\":\"6031490828270\"},{\"id\":\"6031490828070\"},{\"id\":\"6031475895070\"},{\"id\":\"6031475894870\"},{\"id\":\"6031475894470\"},{\"id\":\"6031245704870\"},{\"id\":\"6031245704070\"},{\"id\":\"6031245703670\"},{\"id\":\"6030926475470\"},{\"id\":\"6030926475670\"},{\"id\":\"6030926475270\"},{\"id\":\"6030926475870\"},{\"id\":\"6030926470070\"},{\"id\":\"6030926470670\"},{\"id\":\"6030926470470\"},{\"id\":\"6030926470270\"},{\"id\":\"6030606696870\"},{\"id\":\"6030606697070\"},{\"id\":\"6030606697470\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzMTQ4OTg0ODA3MAZDZD\",\"after\":\"NjAzMDYwNjY5NzQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzMDYwNjY5NzQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAzMTQ4OTg0ODA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzMTcxNzg1MDQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6031718568270\"},{\"id\":\"6031718568070\"},{\"id\":\"6031718567470\"},{\"id\":\"6031717863270\"},{\"id\":\"6031717857270\"},{\"id\":\"6031717856270\"},{\"id\":\"6031717854070\"},{\"id\":\"6031717852270\"},{\"id\":\"6031717847070\"},{\"id\":\"6031717845870\"},{\"id\":\"6031717841270\"},{\"id\":\"6031717839870\"},{\"id\":\"6031717836270\"},{\"id\":\"6031717831670\"},{\"id\":\"6031717829670\"},{\"id\":\"6031717829070\"},{\"id\":\"6031717824070\"},{\"id\":\"6031717821470\"},{\"id\":\"6031717821270\"},{\"id\":\"6031672132270\"},{\"id\":\"6031672131870\"},{\"id\":\"6031672132070\"},{\"id\":\"6031596599870\"},{\"id\":\"6031596600670\"},{\"id\":\"6031596600470\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzMTcxODU2ODI3MAZDZD\",\"after\":\"NjAzMTU5NjYwMDQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzMTU5NjYwMDQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAzMTcxODU2ODI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzMjkwODUxMjY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6032908498070\"},{\"id\":\"6032908498270\"},{\"id\":\"6032906772670\"},{\"id\":\"6032906772870\"},{\"id\":\"6032906773670\"},{\"id\":\"6032906771870\"},{\"id\":\"6032861629270\"},{\"id\":\"6032867208270\"},{\"id\":\"6032867209670\"},{\"id\":\"6032867212270\"},{\"id\":\"6032749488470\"},{\"id\":\"6032749091270\"},{\"id\":\"6032749486670\"},{\"id\":\"6032749492070\"},{\"id\":\"6032749087070\"},{\"id\":\"6032749089870\"},{\"id\":\"6031491152470\"},{\"id\":\"6031491152070\"},{\"id\":\"6031491152270\"},{\"id\":\"6032439998670\"},{\"id\":\"6032439998470\"},{\"id\":\"6031717849870\"},{\"id\":\"6031717822470\"},{\"id\":\"6031717859470\"},{\"id\":\"6031717850470\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzMjkwODQ5ODA3MAZDZD\",\"after\":\"NjAzMTcxNzg1MDQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzMTcxNzg1MDQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAzMjkwODQ5ODA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzNDc4NTU1MDQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6034785558070\"},{\"id\":\"6034423935670\"},{\"id\":\"6034423935470\"},{\"id\":\"6034300750870\"},{\"id\":\"6034300750670\"},{\"id\":\"6034265622670\"},{\"id\":\"6034265621870\"},{\"id\":\"6034265617270\"},{\"id\":\"6034265617070\"},{\"id\":\"6034265616870\"},{\"id\":\"6034265616670\"},{\"id\":\"6034265622870\"},{\"id\":\"6034265622270\"},{\"id\":\"6034264594270\"},{\"id\":\"6034264594070\"},{\"id\":\"6032911049470\"},{\"id\":\"6032911047470\"},{\"id\":\"6032911053070\"},{\"id\":\"6032908501070\"},{\"id\":\"6032908497870\"},{\"id\":\"6032908500070\"},{\"id\":\"6032908499470\"},{\"id\":\"6032908502870\"},{\"id\":\"6032908496470\"},{\"id\":\"6032908512670\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNDc4NTU1ODA3MAZDZD\",\"after\":\"NjAzMjkwODUxMjY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzMjkwODUxMjY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAzNDc4NTU1ODA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzNTU5NDkwMTg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6035594882270\"},{\"id\":\"6035594924470\"},{\"id\":\"6035594890270\"},{\"id\":\"6035594899470\"},{\"id\":\"6035594885870\"},{\"id\":\"6035594922870\"},{\"id\":\"6035594895270\"},{\"id\":\"6035594923070\"},{\"id\":\"6035594895470\"},{\"id\":\"6035594893270\"},{\"id\":\"6035594926470\"},{\"id\":\"6035594908670\"},{\"id\":\"6035594896270\"},{\"id\":\"6035594893470\"},{\"id\":\"6034785548070\"},{\"id\":\"6034785566270\"},{\"id\":\"6034785561470\"},{\"id\":\"6034785559270\"},{\"id\":\"6034785559070\"},{\"id\":\"6034785564270\"},{\"id\":\"6034785555670\"},{\"id\":\"6034785551870\"},{\"id\":\"6034785547870\"},{\"id\":\"6034785544070\"},{\"id\":\"6034785550470\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNTU5NDg4MjI3MAZDZD\",\"after\":\"NjAzNDc4NTU1MDQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzNDc4NTU1MDQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAzNTU5NDg4MjI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzNTc4NzcyODA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6035561746270\"},{\"id\":\"6035562093270\"},{\"id\":\"6035561745270\"},{\"id\":\"6035562068270\"},{\"id\":\"6035562078270\"},{\"id\":\"6035561880870\"},{\"id\":\"6035562081670\"},{\"id\":\"6035562070270\"},{\"id\":\"6035562095870\"},{\"id\":\"6035562095470\"},{\"id\":\"6035562070070\"},{\"id\":\"6035562082870\"},{\"id\":\"6035562066670\"},{\"id\":\"6035562088270\"},{\"id\":\"6035561747670\"},{\"id\":\"6035562081870\"},{\"id\":\"6035562091670\"},{\"id\":\"6035560901270\"},{\"id\":\"6035560900870\"},{\"id\":\"6035560902270\"},{\"id\":\"6035560898270\"},{\"id\":\"6035594888270\"},{\"id\":\"6035594889270\"},{\"id\":\"6035594888470\"},{\"id\":\"6035594901870\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNTU2MTc0NjI3MAZDZD\",\"after\":\"NjAzNTU5NDkwMTg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzNTU5NDkwMTg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAzNTU2MTc0NjI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzODcwMTQzMjY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6038701420070\"},{\"id\":\"6038701432270\"},{\"id\":\"6038701416270\"},{\"id\":\"6038701411070\"},{\"id\":\"6038701410470\"},{\"id\":\"6038414907070\"},{\"id\":\"6038414906270\"},{\"id\":\"6038388609270\"},{\"id\":\"6038414906070\"},{\"id\":\"6038414917470\"},{\"id\":\"6038414977270\"},{\"id\":\"6038388609470\"},{\"id\":\"6038388610270\"},{\"id\":\"6038414926470\"},{\"id\":\"6038414915470\"},{\"id\":\"6038414915270\"},{\"id\":\"6038388611870\"},{\"id\":\"6032111477070\"},{\"id\":\"6032111475870\"},{\"id\":\"6032111477870\"},{\"id\":\"6032111475270\"},{\"id\":\"6032232625870\"},{\"id\":\"6032232626870\"},{\"id\":\"6032232625670\"},{\"id\":\"6035787728070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzODcwMTQyMDA3MAZDZD\",\"after\":\"NjAzNTc4NzcyODA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzNTc4NzcyODA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAzODcwMTQyMDA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0MTAwNDk4OTQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6041004989270\"},{\"id\":\"6041004989070\"},{\"id\":\"6041004989670\"},{\"id\":\"6041002151470\"},{\"id\":\"6041002150870\"},{\"id\":\"6041002150270\"},{\"id\":\"6040759513470\"},{\"id\":\"6041003751270\"},{\"id\":\"6041003751070\"},{\"id\":\"6041003750870\"},{\"id\":\"6041003750670\"},{\"id\":\"6040026097870\"},{\"id\":\"6040025879670\"},{\"id\":\"6040025401870\"},{\"id\":\"6039120692670\"},{\"id\":\"6039120692470\"},{\"id\":\"6039120693070\"},{\"id\":\"6039120692870\"},{\"id\":\"6038701432470\"},{\"id\":\"6038701428870\"},{\"id\":\"6038701419670\"},{\"id\":\"6038701411270\"},{\"id\":\"6038701415070\"},{\"id\":\"6038701411470\"},{\"id\":\"6038701432670\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0MTAwNDk4OTI3MAZDZD\",\"after\":\"NjAzODcwMTQzMjY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAzODcwMTQzMjY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0MTAwNDk4OTI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0MzM4MzgxMTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6043266617070\"},{\"id\":\"6043374839670\"},{\"id\":\"6042973702870\"},{\"id\":\"6042912142470\"},{\"id\":\"6042911288670\"},{\"id\":\"6042911836670\"},{\"id\":\"6042912252470\"},{\"id\":\"6042063981870\"},{\"id\":\"6042150078670\"},{\"id\":\"6042063982070\"},{\"id\":\"6042063981670\"},{\"id\":\"6029842978870\"},{\"id\":\"6041832079070\"},{\"id\":\"6041831673470\"},{\"id\":\"6041825298270\"},{\"id\":\"6041825298070\"},{\"id\":\"6041825298670\"},{\"id\":\"6041825298470\"},{\"id\":\"6041622476270\"},{\"id\":\"6039832220270\"},{\"id\":\"6041242068070\"},{\"id\":\"6041242068270\"},{\"id\":\"6041242067670\"},{\"id\":\"6041002149470\"},{\"id\":\"6041004989470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0MzI2NjYxNzA3MAZDZD\",\"after\":\"NjA0MTAwNDk4OTQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0MTAwNDk4OTQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0MzI2NjYxNzA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0NDE5ODgzNDI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6044198598070\"},{\"id\":\"6044124960870\"},{\"id\":\"6044198360470\"},{\"id\":\"6044198250870\"},{\"id\":\"6043579602870\"},{\"id\":\"6043579602670\"},{\"id\":\"6043918197270\"},{\"id\":\"6043918197470\"},{\"id\":\"6042985583670\"},{\"id\":\"6043742721470\"},{\"id\":\"6043743158870\"},{\"id\":\"6043743031470\"},{\"id\":\"6043743159470\"},{\"id\":\"6043742939470\"},{\"id\":\"6043743158670\"},{\"id\":\"6043743058070\"},{\"id\":\"6043743159270\"},{\"id\":\"6043743159070\"},{\"id\":\"6043742993870\"},{\"id\":\"6043634284670\"},{\"id\":\"6043634294670\"},{\"id\":\"6043634292470\"},{\"id\":\"6043633783870\"},{\"id\":\"6042976582870\"},{\"id\":\"6043383811070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NDE5ODU5ODA3MAZDZD\",\"after\":\"NjA0MzM4MzgxMTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0MzM4MzgxMTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0NDE5ODU5ODA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0NDY3Nzc2MjA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6044285811870\"},{\"id\":\"6044285812070\"},{\"id\":\"6044441666870\"},{\"id\":\"6044440409470\"},{\"id\":\"6044356602670\"},{\"id\":\"6044355848470\"},{\"id\":\"6044403883070\"},{\"id\":\"6044403883470\"},{\"id\":\"6044403883270\"},{\"id\":\"6044402742070\"},{\"id\":\"6044402809670\"},{\"id\":\"6044126008070\"},{\"id\":\"6044125342070\"},{\"id\":\"6044199224670\"},{\"id\":\"6044125593070\"},{\"id\":\"6044193412870\"},{\"id\":\"6044124556070\"},{\"id\":\"6044217378270\"},{\"id\":\"6044217484670\"},{\"id\":\"6044199442870\"},{\"id\":\"6044199442670\"},{\"id\":\"6044199376670\"},{\"id\":\"6044199376870\"},{\"id\":\"6044198834070\"},{\"id\":\"6044198834270\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NDI4NTgxMTg3MAZDZD\",\"after\":\"NjA0NDE5ODgzNDI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0NDE5ODgzNDI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0NDI4NTgxMTg3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0NTEzNjc0MzI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6044796982670\"},{\"id\":\"6045057503670\"},{\"id\":\"6045056840470\"},{\"id\":\"6045057503870\"},{\"id\":\"6045056840670\"},{\"id\":\"6044902378670\"},{\"id\":\"6044876930670\"},{\"id\":\"6044865190670\"},{\"id\":\"6044865224270\"},{\"id\":\"6044864399270\"},{\"id\":\"6044802526270\"},{\"id\":\"6044803088270\"},{\"id\":\"6044796650670\"},{\"id\":\"6044796077870\"},{\"id\":\"6044796078070\"},{\"id\":\"6044795597870\"},{\"id\":\"6044795358670\"},{\"id\":\"6044795358470\"},{\"id\":\"6043579322470\"},{\"id\":\"6044679889870\"},{\"id\":\"6044674202870\"},{\"id\":\"6044673905870\"},{\"id\":\"6044674186070\"},{\"id\":\"6044674142470\"},{\"id\":\"6044677762070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NDc5Njk4MjY3MAZDZD\",\"after\":\"NjA0NDY3Nzc2MjA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0NDY3Nzc2MjA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0NDc5Njk4MjY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0NTY4MDE3MDA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6045679833070\"},{\"id\":\"6045209959070\"},{\"id\":\"6045209282470\"},{\"id\":\"6045545880470\"},{\"id\":\"6045545949270\"},{\"id\":\"6045546000070\"},{\"id\":\"6045545943870\"},{\"id\":\"6045135613470\"},{\"id\":\"6045136083670\"},{\"id\":\"6045135613070\"},{\"id\":\"6045135612870\"},{\"id\":\"6045521578270\"},{\"id\":\"6045521578070\"},{\"id\":\"6045349735870\"},{\"id\":\"6044801305870\"},{\"id\":\"6045383943070\"},{\"id\":\"6045383767670\"},{\"id\":\"6045383767470\"},{\"id\":\"6045058565670\"},{\"id\":\"6045058966870\"},{\"id\":\"6045291087270\"},{\"id\":\"6045135614070\"},{\"id\":\"6045136809270\"},{\"id\":\"6045135613870\"},{\"id\":\"6045136743270\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NTY3OTgzMzA3MAZDZD\",\"after\":\"NjA0NTEzNjc0MzI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0NTEzNjc0MzI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0NTY3OTgzMzA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0Njg0MDE1NzI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6046839888470\"},{\"id\":\"6046759447470\"},{\"id\":\"6046759075270\"},{\"id\":\"6046747845470\"},{\"id\":\"6046747845670\"},{\"id\":\"6046475506070\"},{\"id\":\"6046313892270\"},{\"id\":\"6046313930270\"},{\"id\":\"6046313957270\"},{\"id\":\"6045680514470\"},{\"id\":\"6045680514670\"},{\"id\":\"6045842878270\"},{\"id\":\"6045746798270\"},{\"id\":\"6045746777270\"},{\"id\":\"6045210420270\"},{\"id\":\"6045771928870\"},{\"id\":\"6045767050270\"},{\"id\":\"6045751859670\"},{\"id\":\"6045747389670\"},{\"id\":\"6045747383070\"},{\"id\":\"6045747374870\"},{\"id\":\"6045681325470\"},{\"id\":\"6045681337270\"},{\"id\":\"6045681332070\"},{\"id\":\"6045680170070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NjgzOTg4ODQ3MAZDZD\",\"after\":\"NjA0NTY4MDE3MDA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0NTY4MDE3MDA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0NjgzOTg4ODQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0ODEzMTU5OTI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6047851034670\"},{\"id\":\"6047779613670\"},{\"id\":\"6047396789270\"},{\"id\":\"6047396789070\"},{\"id\":\"6047396787870\"},{\"id\":\"6047396788870\"},{\"id\":\"6047312221070\"},{\"id\":\"6047312221270\"},{\"id\":\"6046839961070\"},{\"id\":\"6046839804070\"},{\"id\":\"6047309002670\"},{\"id\":\"6047306968270\"},{\"id\":\"6047307064870\"},{\"id\":\"6046855572270\"},{\"id\":\"6046855086270\"},{\"id\":\"6046855100870\"},{\"id\":\"6046853487670\"},{\"id\":\"6046853488070\"},{\"id\":\"6046851850470\"},{\"id\":\"6046851820270\"},{\"id\":\"6046851320270\"},{\"id\":\"6046851320070\"},{\"id\":\"6046850967870\"},{\"id\":\"6046850729070\"},{\"id\":\"6046840157270\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0Nzg1MTAzNDY3MAZDZD\",\"after\":\"NjA0Njg0MDE1NzI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0Njg0MDE1NzI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0Nzg1MTAzNDY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0ODY3NzgzODg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6048677815070\"},{\"id\":\"6048949326270\"},{\"id\":\"6048677375070\"},{\"id\":\"6048677814870\"},{\"id\":\"6048677838470\"},{\"id\":\"6048949326070\"},{\"id\":\"6048677421270\"},{\"id\":\"6048677374870\"},{\"id\":\"6049020070470\"},{\"id\":\"6048738787070\"},{\"id\":\"6048738598270\"},{\"id\":\"6048570468270\"},{\"id\":\"6048570468070\"},{\"id\":\"6048570467670\"},{\"id\":\"6048570367870\"},{\"id\":\"6048570392470\"},{\"id\":\"6048570306670\"},{\"id\":\"6048464931270\"},{\"id\":\"6048274915470\"},{\"id\":\"6048274571270\"},{\"id\":\"6048274821470\"},{\"id\":\"6048274593070\"},{\"id\":\"6048274373270\"},{\"id\":\"6048274938870\"},{\"id\":\"6048131599270\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0ODY3NzgxNTA3MAZDZD\",\"after\":\"NjA0ODEzMTU5OTI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0ODEzMTU5OTI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0ODY3NzgxNTA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0OTQyMDkyNDA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6049242128870\"},{\"id\":\"6049463476070\"},{\"id\":\"6048738030870\"},{\"id\":\"6048737937870\"},{\"id\":\"6048737963870\"},{\"id\":\"6048737819670\"},{\"id\":\"6048736771270\"},{\"id\":\"6048738086070\"},{\"id\":\"6048737449870\"},{\"id\":\"6048948496470\"},{\"id\":\"6048948473670\"},{\"id\":\"6048948529070\"},{\"id\":\"6048948528870\"},{\"id\":\"6048948522670\"},{\"id\":\"6048948496270\"},{\"id\":\"6048948522870\"},{\"id\":\"6048948473470\"},{\"id\":\"6048949325070\"},{\"id\":\"6048949325870\"},{\"id\":\"6048949325670\"},{\"id\":\"6048677459070\"},{\"id\":\"6048949325470\"},{\"id\":\"6048949324070\"},{\"id\":\"6048949325270\"},{\"id\":\"6048677838870\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0OTI0MjEyODg3MAZDZD\",\"after\":\"NjA0ODY3NzgzODg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0ODY3NzgzODg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0OTI0MjEyODg3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1MDAxODI4NzI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6049481812870\"},{\"id\":\"6049481812470\"},{\"id\":\"6049481812670\"},{\"id\":\"6049481811470\"},{\"id\":\"6050016085270\"},{\"id\":\"6050016215270\"},{\"id\":\"6050015454870\"},{\"id\":\"6049954409670\"},{\"id\":\"6049667878470\"},{\"id\":\"6049023794670\"},{\"id\":\"6049023797270\"},{\"id\":\"6049022800470\"},{\"id\":\"6049541695470\"},{\"id\":\"6049477921270\"},{\"id\":\"6049477922270\"},{\"id\":\"6049477922670\"},{\"id\":\"6049477922470\"},{\"id\":\"6049477244070\"},{\"id\":\"6049477243870\"},{\"id\":\"6048739393270\"},{\"id\":\"6048737663870\"},{\"id\":\"6049463476470\"},{\"id\":\"6048737663670\"},{\"id\":\"6049242129470\"},{\"id\":\"6049420924070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0OTQ4MTgxMjg3MAZDZD\",\"after\":\"NjA0OTQyMDkyNDA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0OTQyMDkyNDA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0OTQ4MTgxMjg3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1MjQ5NjY3NjQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6051325163070\"},{\"id\":\"6051325162870\"},{\"id\":\"6052346706070\"},{\"id\":\"6052346705470\"},{\"id\":\"6052346705670\"},{\"id\":\"6052284957070\"},{\"id\":\"6052285441270\"},{\"id\":\"6052285440670\"},{\"id\":\"6052284860270\"},{\"id\":\"6051782093270\"},{\"id\":\"6051782092870\"},{\"id\":\"6051207195870\"},{\"id\":\"6051207040070\"},{\"id\":\"6051206503470\"},{\"id\":\"6051207195670\"},{\"id\":\"6051207040270\"},{\"id\":\"6051207008070\"},{\"id\":\"6050849592270\"},{\"id\":\"6050791945670\"},{\"id\":\"6050584104270\"},{\"id\":\"6049537139070\"},{\"id\":\"6049537138870\"},{\"id\":\"6050387155670\"},{\"id\":\"6050018287870\"},{\"id\":\"6050018287270\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1MTMyNTE2MzA3MAZDZD\",\"after\":\"NjA1MDAxODI4NzI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1MDAxODI4NzI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA1MTMyNTE2MzA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1MTM5MjY3NDI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6051392455470\"},{\"id\":\"6051391057870\"},{\"id\":\"6051392674670\"},{\"id\":\"6051392456470\"},{\"id\":\"6051392456070\"},{\"id\":\"6051392455870\"},{\"id\":\"6051391058070\"},{\"id\":\"6051391057670\"},{\"id\":\"6051389722870\"},{\"id\":\"6051392456670\"},{\"id\":\"6051392674070\"},{\"id\":\"6051391057470\"},{\"id\":\"6051392673270\"},{\"id\":\"6051390585870\"},{\"id\":\"6051392456870\"},{\"id\":\"6051392673470\"},{\"id\":\"6051392673870\"},{\"id\":\"6051391009070\"},{\"id\":\"6051392455270\"},{\"id\":\"6051392673670\"},{\"id\":\"6051390950070\"},{\"id\":\"6052496614870\"},{\"id\":\"6052496615270\"},{\"id\":\"6052496766270\"},{\"id\":\"6052496676470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1MTM5MjQ1NTQ3MAZDZD\",\"after\":\"NjA1MjQ5NjY3NjQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1MjQ5NjY3NjQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA1MTM5MjQ1NTQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0ODI3NTM3MDY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6048275370470\"},{\"id\":\"6048275370270\"},{\"id\":\"6047082516470\"},{\"id\":\"6047081497270\"},{\"id\":\"6047080643670\"},{\"id\":\"6047079964470\"},{\"id\":\"6047042437470\"},{\"id\":\"6047042425670\"},{\"id\":\"6047042411870\"},{\"id\":\"6047042402070\"},{\"id\":\"6047042298070\"},{\"id\":\"6046828167870\"},{\"id\":\"6046827381670\"},{\"id\":\"6046827044070\"},{\"id\":\"6046656329470\"},{\"id\":\"6046558738270\"},{\"id\":\"6045818999870\"},{\"id\":\"6045754927470\"},{\"id\":\"6045754913470\"},{\"id\":\"6045749880670\"},{\"id\":\"6045749798870\"},{\"id\":\"6045749555070\"},{\"id\":\"6051392455670\"},{\"id\":\"6051392674470\"},{\"id\":\"6051392674270\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0ODI3NTM3MDQ3MAZDZD\",\"after\":\"NjA1MTM5MjY3NDI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1MTM5MjY3NDI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA0ODI3NTM3MDQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1MjI4NTQ5NjQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6052285497270\"},{\"id\":\"6046656329270\"},{\"id\":\"6046560393470\"},{\"id\":\"6051275530870\"},{\"id\":\"6051273690670\"},{\"id\":\"6051273690270\"},{\"id\":\"6051273689870\"},{\"id\":\"6050186058470\"},{\"id\":\"6050051897270\"},{\"id\":\"6050051897070\"},{\"id\":\"6050051896670\"},{\"id\":\"6050051733670\"},{\"id\":\"6050051733070\"},{\"id\":\"6050051732870\"},{\"id\":\"6050020916670\"},{\"id\":\"6050020902670\"},{\"id\":\"6050020787070\"},{\"id\":\"6049677489070\"},{\"id\":\"6048780594870\"},{\"id\":\"6048779959870\"},{\"id\":\"6048770169270\"},{\"id\":\"6048770168870\"},{\"id\":\"6048275371070\"},{\"id\":\"6048275370870\"},{\"id\":\"6048275370670\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1MjI4NTQ5NzI3MAZDZD\",\"after\":\"NjA0ODI3NTM3MDY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA0ODI3NTM3MDY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA1MjI4NTQ5NzI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NDQyNDEzNDg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6054417560070\"},{\"id\":\"6054418543270\"},{\"id\":\"6054101193470\"},{\"id\":\"6054101193870\"},{\"id\":\"6054101193670\"},{\"id\":\"6054156232070\"},{\"id\":\"6054156232270\"},{\"id\":\"6054101969270\"},{\"id\":\"6054101968870\"},{\"id\":\"6054101969470\"},{\"id\":\"6054100443270\"},{\"id\":\"6054100443070\"},{\"id\":\"6054100442870\"},{\"id\":\"6053819490270\"},{\"id\":\"6053776996870\"},{\"id\":\"6053776996670\"},{\"id\":\"6053776996470\"},{\"id\":\"6053506211470\"},{\"id\":\"6053506040670\"},{\"id\":\"6053506215470\"},{\"id\":\"6053438655870\"},{\"id\":\"6053526258670\"},{\"id\":\"6053526257670\"},{\"id\":\"6053526341670\"},{\"id\":\"6052285496470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1NDQxNzU2MDA3MAZDZD\",\"after\":\"NjA1MjI4NTQ5NjQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1MjI4NTQ5NjQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA1NDQxNzU2MDA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NTMxOTA2NTY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6055319064670\"},{\"id\":\"6055319065070\"},{\"id\":\"6055264272070\"},{\"id\":\"6055264271670\"},{\"id\":\"6054824863070\"},{\"id\":\"6055103762870\"},{\"id\":\"6055103839070\"},{\"id\":\"6055052845070\"},{\"id\":\"6055052401070\"},{\"id\":\"6055052845670\"},{\"id\":\"6055052844670\"},{\"id\":\"6055052401470\"},{\"id\":\"6055052400670\"},{\"id\":\"6054977942470\"},{\"id\":\"6054977014270\"},{\"id\":\"6053440199270\"},{\"id\":\"6054492606870\"},{\"id\":\"6054492607070\"},{\"id\":\"6054420205870\"},{\"id\":\"6054424136870\"},{\"id\":\"6054424134670\"},{\"id\":\"6054424137070\"},{\"id\":\"6054424134070\"},{\"id\":\"6054424137870\"},{\"id\":\"6054424134870\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1NTMxOTA2NDY3MAZDZD\",\"after\":\"NjA1NDQyNDEzNDg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NDQyNDEzNDg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA1NTMxOTA2NDY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NTM5Mjk0NDA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6055392997670\"},{\"id\":\"6055392958270\"},{\"id\":\"6055392943870\"},{\"id\":\"6055385073470\"},{\"id\":\"6055384774470\"},{\"id\":\"6055384819070\"},{\"id\":\"6055384750870\"},{\"id\":\"6055384252870\"},{\"id\":\"6051393101870\"},{\"id\":\"6051393101670\"},{\"id\":\"6051393101470\"},{\"id\":\"6051393101270\"},{\"id\":\"6051393100870\"},{\"id\":\"6051393100670\"},{\"id\":\"6051393100470\"},{\"id\":\"6051393100270\"},{\"id\":\"6051391686870\"},{\"id\":\"6051391687070\"},{\"id\":\"6051391686670\"},{\"id\":\"6051391686470\"},{\"id\":\"6051391686270\"},{\"id\":\"6051391686070\"},{\"id\":\"6051391685670\"},{\"id\":\"6051391685470\"},{\"id\":\"6055319065670\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1NTM5Mjk5NzY3MAZDZD\",\"after\":\"NjA1NTMxOTA2NTY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NTMxOTA2NTY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA1NTM5Mjk5NzY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NDAyMjg1Nzg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6054021367470\"},{\"id\":\"6055519601070\"},{\"id\":\"6055520637870\"},{\"id\":\"6055393324070\"},{\"id\":\"6055393325670\"},{\"id\":\"6055393324270\"},{\"id\":\"6055393323870\"},{\"id\":\"6055393325870\"},{\"id\":\"6055393324470\"},{\"id\":\"6055393323270\"},{\"id\":\"6055393325470\"},{\"id\":\"6055393324670\"},{\"id\":\"6055393323670\"},{\"id\":\"6055393322870\"},{\"id\":\"6055393322670\"},{\"id\":\"6055393323070\"},{\"id\":\"6055393328470\"},{\"id\":\"6055393323470\"},{\"id\":\"6055392958070\"},{\"id\":\"6055392997070\"},{\"id\":\"6055392971270\"},{\"id\":\"6055392970870\"},{\"id\":\"6055392924670\"},{\"id\":\"6055392924870\"},{\"id\":\"6055392944070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1NDAyMTM2NzQ3MAZDZD\",\"after\":\"NjA1NTM5Mjk0NDA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NTM5Mjk0NDA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA1NDAyMTM2NzQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NTkyODkyMDY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6055928921070\"},{\"id\":\"6055928918470\"},{\"id\":\"6055928920870\"},{\"id\":\"6055928920470\"},{\"id\":\"6055928835070\"},{\"id\":\"6055928836270\"},{\"id\":\"6055928836070\"},{\"id\":\"6055928474070\"},{\"id\":\"6055928472870\"},{\"id\":\"6055928475270\"},{\"id\":\"6055928216070\"},{\"id\":\"6055928216470\"},{\"id\":\"6055928215470\"},{\"id\":\"6055927696470\"},{\"id\":\"6055927694870\"},{\"id\":\"6055927989270\"},{\"id\":\"6055920196670\"},{\"id\":\"6055920196470\"},{\"id\":\"6055920195870\"},{\"id\":\"6054543737470\"},{\"id\":\"6054543738870\"},{\"id\":\"6054543738070\"},{\"id\":\"6054420782470\"},{\"id\":\"6054023008870\"},{\"id\":\"6054022857870\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1NTkyODkyMTA3MAZDZD\",\"after\":\"NjA1NDAyMjg1Nzg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NDAyMjg1Nzg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA1NTkyODkyMTA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NzU2NzYzNzA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6057567636270\"},{\"id\":\"6056675984870\"},{\"id\":\"6056335430470\"},{\"id\":\"6056334732270\"},{\"id\":\"6056279878670\"},{\"id\":\"6056278813270\"},{\"id\":\"6056277427070\"},{\"id\":\"6057511513070\"},{\"id\":\"6057281079870\"},{\"id\":\"6056822049670\"},{\"id\":\"6056083071270\"},{\"id\":\"6056082644670\"},{\"id\":\"6056085997870\"},{\"id\":\"6056085998270\"},{\"id\":\"6055928216270\"},{\"id\":\"6055928921670\"},{\"id\":\"6055928835670\"},{\"id\":\"6055929169070\"},{\"id\":\"6055928473270\"},{\"id\":\"6055928919870\"},{\"id\":\"6055927695870\"},{\"id\":\"6055929168870\"},{\"id\":\"6055929167870\"},{\"id\":\"6055928920070\"},{\"id\":\"6055928920670\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1NzU2NzYzNjI3MAZDZD\",\"after\":\"NjA1NTkyODkyMDY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NTkyODkyMDY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA1NzU2NzYzNjI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1ODI0MjQxOTI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6058246860670\"},{\"id\":\"6058246860270\"},{\"id\":\"6058246859870\"},{\"id\":\"6058246859470\"},{\"id\":\"6058242864670\"},{\"id\":\"6058242864470\"},{\"id\":\"6058242863670\"},{\"id\":\"6058242863470\"},{\"id\":\"6058242657270\"},{\"id\":\"6058242656670\"},{\"id\":\"6058242656470\"},{\"id\":\"6058242656270\"},{\"id\":\"6058242458070\"},{\"id\":\"6058242457870\"},{\"id\":\"6058242457070\"},{\"id\":\"6058241003870\"},{\"id\":\"6057691861670\"},{\"id\":\"6058242457670\"},{\"id\":\"6057567637870\"},{\"id\":\"6057567636870\"},{\"id\":\"6056816812470\"},{\"id\":\"6056675011670\"},{\"id\":\"6057567637670\"},{\"id\":\"6057567637470\"},{\"id\":\"6057567637070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1ODI0Njg2MDY3MAZDZD\",\"after\":\"NjA1NzU2NzYzNzA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1NzU2NzYzNzA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA1ODI0Njg2MDY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2MzM0NTIwOTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6063345208470\"},{\"id\":\"6063304978870\"},{\"id\":\"6063304979070\"},{\"id\":\"6063304978670\"},{\"id\":\"6062984301270\"},{\"id\":\"6062980783070\"},{\"id\":\"6062980783670\"},{\"id\":\"6062511599270\"},{\"id\":\"6062511593070\"},{\"id\":\"6062511554470\"},{\"id\":\"6062511575270\"},{\"id\":\"6062511161070\"},{\"id\":\"6059554223670\"},{\"id\":\"6059553655870\"},{\"id\":\"6058727885270\"},{\"id\":\"6058582359870\"},{\"id\":\"6058582361670\"},{\"id\":\"6058582361070\"},{\"id\":\"6058442678270\"},{\"id\":\"6058442681870\"},{\"id\":\"6058442678870\"},{\"id\":\"6058442681070\"},{\"id\":\"6058442675870\"},{\"id\":\"6058242418870\"},{\"id\":\"6058242419270\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2MzM0NTIwODQ3MAZDZD\",\"after\":\"NjA1ODI0MjQxOTI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA1ODI0MjQxOTI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA2MzM0NTIwODQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2NTU0NjA0NjY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6065546811270\"},{\"id\":\"6064628003270\"},{\"id\":\"6064532442070\"},{\"id\":\"6064532445670\"},{\"id\":\"6064628442870\"},{\"id\":\"6064535746470\"},{\"id\":\"6064534430870\"},{\"id\":\"6064535747070\"},{\"id\":\"6064534432070\"},{\"id\":\"6064628443070\"},{\"id\":\"6064535747270\"},{\"id\":\"6064534430470\"},{\"id\":\"6064535746870\"},{\"id\":\"6064535746670\"},{\"id\":\"6064534431270\"},{\"id\":\"6064534430670\"},{\"id\":\"6064532445070\"},{\"id\":\"6064532440070\"},{\"id\":\"6064532444670\"},{\"id\":\"6064447878470\"},{\"id\":\"6064447826070\"},{\"id\":\"6064432518470\"},{\"id\":\"6064431746670\"},{\"id\":\"6063345208270\"},{\"id\":\"6063345209070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2NTU0NjgxMTI3MAZDZD\",\"after\":\"NjA2MzM0NTIwOTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2MzM0NTIwOTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA2NTU0NjgxMTI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2ODU4Mzc4ODY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6068583643270\"},{\"id\":\"6068583811070\"},{\"id\":\"6068582610870\"},{\"id\":\"6068471216670\"},{\"id\":\"6067819033670\"},{\"id\":\"6068087423870\"},{\"id\":\"6068071529870\"},{\"id\":\"6067544135670\"},{\"id\":\"6067543259070\"},{\"id\":\"6067952284470\"},{\"id\":\"6067951897470\"},{\"id\":\"6067951897870\"},{\"id\":\"6067950377270\"},{\"id\":\"6067951599870\"},{\"id\":\"6067951330470\"},{\"id\":\"6067951539470\"},{\"id\":\"6066677361270\"},{\"id\":\"6066677360870\"},{\"id\":\"6066502205870\"},{\"id\":\"6066502011270\"},{\"id\":\"6066502727070\"},{\"id\":\"6066502612670\"},{\"id\":\"6065546811470\"},{\"id\":\"6065546047470\"},{\"id\":\"6065546046670\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2ODU4MzY0MzI3MAZDZD\",\"after\":\"NjA2NTU0NjA0NjY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2NTU0NjA0NjY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA2ODU4MzY0MzI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2OTU1OTQzMzQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6069558919270\"},{\"id\":\"6069555247470\"},{\"id\":\"6069559433870\"},{\"id\":\"6069558918270\"},{\"id\":\"6069555654070\"},{\"id\":\"6069217028870\"},{\"id\":\"6068653242870\"},{\"id\":\"6068653242670\"},{\"id\":\"6068660105670\"},{\"id\":\"6068588733270\"},{\"id\":\"6068652581670\"},{\"id\":\"6068652496670\"},{\"id\":\"6068652496070\"},{\"id\":\"6068652581270\"},{\"id\":\"6068652940670\"},{\"id\":\"6068652479270\"},{\"id\":\"6068652940470\"},{\"id\":\"6068652335470\"},{\"id\":\"6068582924870\"},{\"id\":\"6068583451670\"},{\"id\":\"6068587305670\"},{\"id\":\"6068587306070\"},{\"id\":\"6068649406670\"},{\"id\":\"6068589342870\"},{\"id\":\"6068583788670\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2OTU1ODkxOTI3MAZDZD\",\"after\":\"NjA2ODU4Mzc4ODY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2ODU4Mzc4ODY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA2OTU1ODkxOTI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2ODcwODU5OTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6069205384470\"},{\"id\":\"6069205382870\"},{\"id\":\"6069205382270\"},{\"id\":\"6068709899670\"},{\"id\":\"6068709678870\"},{\"id\":\"6068709592670\"},{\"id\":\"6068709444670\"},{\"id\":\"6068709373070\"},{\"id\":\"6068709278670\"},{\"id\":\"6068709206670\"},{\"id\":\"6068709028070\"},{\"id\":\"6069205396670\"},{\"id\":\"6068708147070\"},{\"id\":\"6068707967670\"},{\"id\":\"6068708068870\"},{\"id\":\"6068707925070\"},{\"id\":\"6068707380070\"},{\"id\":\"6068707892870\"},{\"id\":\"6069556927470\"},{\"id\":\"6069558918870\"},{\"id\":\"6069560482270\"},{\"id\":\"6069556927270\"},{\"id\":\"6069560482070\"},{\"id\":\"6069560006870\"},{\"id\":\"6069559433470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2OTIwNTM4NDQ3MAZDZD\",\"after\":\"NjA2OTU1OTQzMzQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2OTU1OTQzMzQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA2OTIwNTM4NDQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2OTIwNTM4Njg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6069205386670\"},{\"id\":\"6069205386270\"},{\"id\":\"6069205388670\"},{\"id\":\"6069205388470\"},{\"id\":\"6069205388070\"},{\"id\":\"6069205387470\"},{\"id\":\"6069205387070\"},{\"id\":\"6069205386470\"},{\"id\":\"6069205385870\"},{\"id\":\"6069205386070\"},{\"id\":\"6069205384670\"},{\"id\":\"6069205385670\"},{\"id\":\"6069205385470\"},{\"id\":\"6069205385270\"},{\"id\":\"6069205385070\"},{\"id\":\"6069205384070\"},{\"id\":\"6069205383870\"},{\"id\":\"6069205383670\"},{\"id\":\"6069205383470\"},{\"id\":\"6068707991270\"},{\"id\":\"6068708083470\"},{\"id\":\"6068708466070\"},{\"id\":\"6068708176670\"},{\"id\":\"6068708154270\"},{\"id\":\"6068708599070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2OTIwNTM4NjY3MAZDZD\",\"after\":\"NjA2ODcwODU5OTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2ODcwODU5OTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA2OTIwNTM4NjY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2OTIwNTM5MjI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6069205392470\"},{\"id\":\"6069205391870\"},{\"id\":\"6069205391470\"},{\"id\":\"6069205390270\"},{\"id\":\"6069205390670\"},{\"id\":\"6069205390470\"},{\"id\":\"6069205393070\"},{\"id\":\"6069205392870\"},{\"id\":\"6069205392070\"},{\"id\":\"6069205391670\"},{\"id\":\"6069205391270\"},{\"id\":\"6069205391070\"},{\"id\":\"6069205390870\"},{\"id\":\"6069205389670\"},{\"id\":\"6069205389070\"},{\"id\":\"6069205390070\"},{\"id\":\"6069205389870\"},{\"id\":\"6069205389470\"},{\"id\":\"6069205389270\"},{\"id\":\"6069205388870\"},{\"id\":\"6069205388270\"},{\"id\":\"6069205387870\"},{\"id\":\"6069205387670\"},{\"id\":\"6069205387270\"},{\"id\":\"6069205386870\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2OTIwNTM5MjQ3MAZDZD\",\"after\":\"NjA2OTIwNTM4Njg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2OTIwNTM4Njg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA2OTIwNTM5MjQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA3NDY4OTU1NzI3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6074689558070\"},{\"id\":\"6074689736670\"},{\"id\":\"6074689830670\"},{\"id\":\"6074689737070\"},{\"id\":\"6074689820070\"},{\"id\":\"6074689820470\"},{\"id\":\"6069205396070\"},{\"id\":\"6069205395670\"},{\"id\":\"6069205395870\"},{\"id\":\"6069205395070\"},{\"id\":\"6069205395270\"},{\"id\":\"6069205396470\"},{\"id\":\"6069205396270\"},{\"id\":\"6069205395470\"},{\"id\":\"6069205394870\"},{\"id\":\"6069205394670\"},{\"id\":\"6069205394070\"},{\"id\":\"6069205394270\"},{\"id\":\"6069205393870\"},{\"id\":\"6069205393470\"},{\"id\":\"6069205394470\"},{\"id\":\"6069205393670\"},{\"id\":\"6069205393270\"},{\"id\":\"6069205392670\"},{\"id\":\"6069205392270\"}],\"paging\":{\"cursors\":{\"before\":\"NjA3NDY4OTU1ODA3MAZDZD\",\"after\":\"NjA2OTIwNTM5MjI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA2OTIwNTM5MjI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjA3NDY4OTU1ODA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMTkxOTI1MjQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6021919250470\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"266\"}],\"impressions\":\"3613\",\"clicks\":\"10\",\"reach\":\"3606\",\"spend\":\"11.97\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"10\"},{\"action_type\":\"video_view\",\"value\":\"741\"},{\"action_type\":\"page_engagement\",\"value\":\"751\"},{\"action_type\":\"post_engagement\",\"value\":\"751\"}],\"ad_id\":\"6077418770070\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"267\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"245\"}],\"impressions\":\"3858\",\"clicks\":\"12\",\"reach\":\"3850\",\"spend\":\"11.92\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"8\"},{\"action_type\":\"video_view\",\"value\":\"736\"},{\"action_type\":\"page_engagement\",\"value\":\"744\"},{\"action_type\":\"post_engagement\",\"value\":\"744\"}],\"ad_id\":\"6077418770070\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"249\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"206\"}],\"impressions\":\"4107\",\"clicks\":\"21\",\"reach\":\"4103\",\"spend\":\"11.86\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"19\"},{\"action_type\":\"video_view\",\"value\":\"686\"},{\"action_type\":\"page_engagement\",\"value\":\"705\"},{\"action_type\":\"post_engagement\",\"value\":\"705\"}],\"ad_id\":\"6077418770070\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"208\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077418770070\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"807\"}],\"impressions\":\"21100\",\"clicks\":\"61\",\"reach\":\"20969\",\"spend\":\"28.92\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"58\"},{\"action_type\":\"video_view\",\"value\":\"2242\"},{\"action_type\":\"page_engagement\",\"value\":\"2300\"},{\"action_type\":\"post_engagement\",\"value\":\"2300\"}],\"ad_id\":\"6077417493270\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"814\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"901\"}],\"impressions\":\"26209\",\"clicks\":\"81\",\"reach\":\"26209\",\"spend\":\"30.25\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"71\"},{\"action_type\":\"video_view\",\"value\":\"2589\"},{\"action_type\":\"page_engagement\",\"value\":\"2660\"},{\"action_type\":\"post_engagement\",\"value\":\"2660\"}],\"ad_id\":\"6077417493270\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"926\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"877\"}],\"impressions\":\"29254\",\"clicks\":\"88\",\"reach\":\"29254\",\"spend\":\"30.68\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"77\"},{\"action_type\":\"video_view\",\"value\":\"2666\"},{\"action_type\":\"page_engagement\",\"value\":\"2743\"},{\"action_type\":\"post_engagement\",\"value\":\"2743\"}],\"ad_id\":\"6077417493270\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"896\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077417493270\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"42\"}],\"impressions\":\"591\",\"clicks\":\"5\",\"reach\":\"590\",\"spend\":\"3.72\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"5\"},{\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"video_view\",\"value\":\"169\"},{\"action_type\":\"page_engagement\",\"value\":\"175\"},{\"action_type\":\"post_engagement\",\"value\":\"175\"}],\"ad_id\":\"6077416800270\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"43\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"47\"}],\"impressions\":\"800\",\"clicks\":\"2\",\"reach\":\"800\",\"spend\":\"3.96\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"1\"},{\"action_type\":\"post_reaction\",\"value\":\"9\"},{\"action_type\":\"video_view\",\"value\":\"251\"},{\"action_type\":\"page_engagement\",\"value\":\"261\"},{\"action_type\":\"post_engagement\",\"value\":\"261\"}],\"ad_id\":\"6077416800270\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"48\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"42\"}],\"impressions\":\"707\",\"clicks\":\"1\",\"reach\":\"707\",\"spend\":\"3.21\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"1\"},{\"action_type\":\"post\",\"value\":\"1\"},{\"action_type\":\"post_reaction\",\"value\":\"3\"},{\"action_type\":\"video_view\",\"value\":\"188\"},{\"action_type\":\"page_engagement\",\"value\":\"193\"},{\"action_type\":\"post_engagement\",\"value\":\"193\"}],\"ad_id\":\"6077416800270\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"44\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077416800270\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"147\"}],\"impressions\":\"2506\",\"clicks\":\"11\",\"reach\":\"2503\",\"spend\":\"9.46\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"5\"},{\"action_type\":\"post_reaction\",\"value\":\"12\"},{\"action_type\":\"video_view\",\"value\":\"544\"},{\"action_type\":\"page_engagement\",\"value\":\"561\"},{\"action_type\":\"post_engagement\",\"value\":\"561\"}],\"ad_id\":\"6077416174670\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"149\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"138\"}],\"impressions\":\"2891\",\"clicks\":\"11\",\"reach\":\"2889\",\"spend\":\"10.1\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"4\"},{\"action_type\":\"post_reaction\",\"value\":\"17\"},{\"action_type\":\"video_view\",\"value\":\"562\"},{\"action_type\":\"page_engagement\",\"value\":\"583\"},{\"action_type\":\"post_engagement\",\"value\":\"583\"}],\"ad_id\":\"6077416174670\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"139\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"104\"}],\"impressions\":\"1924\",\"clicks\":\"9\",\"reach\":\"1922\",\"spend\":\"7.57\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"5\"},{\"action_type\":\"post_reaction\",\"value\":\"4\"},{\"action_type\":\"video_view\",\"value\":\"391\"},{\"action_type\":\"page_engagement\",\"value\":\"400\"},{\"action_type\":\"post_engagement\",\"value\":\"400\"}],\"ad_id\":\"6077416174670\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"107\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077416174670\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"40\"}],\"impressions\":\"1520\",\"clicks\":\"4\",\"reach\":\"1520\",\"spend\":\"3.95\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"4\"},{\"action_type\":\"post_reaction\",\"value\":\"16\"},{\"action_type\":\"video_view\",\"value\":\"205\"},{\"action_type\":\"page_engagement\",\"value\":\"225\"},{\"action_type\":\"post_engagement\",\"value\":\"225\"}],\"ad_id\":\"6077416174870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"40\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"54\"}],\"impressions\":\"1248\",\"clicks\":\"5\",\"reach\":\"1248\",\"spend\":\"2.76\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"1\"},{\"action_type\":\"post_reaction\",\"value\":\"11\"},{\"action_type\":\"video_view\",\"value\":\"193\"},{\"action_type\":\"page_engagement\",\"value\":\"205\"},{\"action_type\":\"post_engagement\",\"value\":\"205\"}],\"ad_id\":\"6077416174870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"54\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"67\"}],\"impressions\":\"1965\",\"clicks\":\"6\",\"reach\":\"1965\",\"spend\":\"4.22\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"2\"},{\"action_type\":\"post_reaction\",\"value\":\"11\"},{\"action_type\":\"video_view\",\"value\":\"305\"},{\"action_type\":\"page_engagement\",\"value\":\"318\"},{\"action_type\":\"post_engagement\",\"value\":\"318\"}],\"ad_id\":\"6077416174870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"70\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077416174870\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"16\"}],\"impressions\":\"323\",\"clicks\":\"0\",\"reach\":\"323\",\"spend\":\"2.01\",\"actions\":[{\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"video_view\",\"value\":\"83\"},{\"action_type\":\"page_engagement\",\"value\":\"84\"},{\"action_type\":\"post_engagement\",\"value\":\"84\"}],\"ad_id\":\"6077416799870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"17\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"11\"}],\"impressions\":\"321\",\"clicks\":\"1\",\"reach\":\"321\",\"spend\":\"1.52\",\"actions\":[{\"action_type\":\"post_reaction\",\"value\":\"3\"},{\"action_type\":\"video_view\",\"value\":\"79\"},{\"action_type\":\"page_engagement\",\"value\":\"82\"},{\"action_type\":\"post_engagement\",\"value\":\"82\"}],\"ad_id\":\"6077416799870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"11\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"21\"}],\"impressions\":\"400\",\"clicks\":\"2\",\"reach\":\"400\",\"spend\":\"2.09\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"2\"},{\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"video_view\",\"value\":\"108\"},{\"action_type\":\"page_engagement\",\"value\":\"111\"},{\"action_type\":\"post_engagement\",\"value\":\"111\"}],\"ad_id\":\"6077416799870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"21\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077416799870\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"67\"}],\"impressions\":\"4162\",\"clicks\":\"98\",\"reach\":\"3940\",\"spend\":\"23.35\",\"actions\":[{\"action_type\":\"like\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"62\"},{\"action_type\":\"post_reaction\",\"value\":\"4\"},{\"action_type\":\"video_view\",\"value\":\"456\"},{\"action_type\":\"page_engagement\",\"value\":\"523\"},{\"action_type\":\"post_engagement\",\"value\":\"522\"}],\"ad_id\":\"6077413251670\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"77\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"120\"}],\"impressions\":\"5230\",\"clicks\":\"120\",\"reach\":\"5045\",\"spend\":\"20.8\",\"actions\":[{\"action_type\":\"like\",\"value\":\"2\"},{\"action_type\":\"link_click\",\"value\":\"78\"},{\"action_type\":\"post_reaction\",\"value\":\"3\"},{\"action_type\":\"video_view\",\"value\":\"728\"},{\"action_type\":\"page_engagement\",\"value\":\"811\"},{\"action_type\":\"post_engagement\",\"value\":\"809\"}],\"ad_id\":\"6077413251670\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"132\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"98\"}],\"impressions\":\"4955\",\"clicks\":\"81\",\"reach\":\"4768\",\"spend\":\"19.5\",\"actions\":[{\"action_type\":\"like\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"55\"},{\"action_type\":\"post_reaction\",\"value\":\"4\"},{\"action_type\":\"video_view\",\"value\":\"587\"},{\"action_type\":\"page_engagement\",\"value\":\"647\"},{\"action_type\":\"post_engagement\",\"value\":\"646\"}],\"ad_id\":\"6077413251670\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"101\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077413251670\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"38\"}],\"impressions\":\"824\",\"clicks\":\"17\",\"reach\":\"813\",\"spend\":\"5.47\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"13\"},{\"action_type\":\"video_view\",\"value\":\"250\"},{\"action_type\":\"page_engagement\",\"value\":\"263\"},{\"action_type\":\"post_engagement\",\"value\":\"263\"}],\"ad_id\":\"6077416553070\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"40\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"43\"}],\"impressions\":\"1032\",\"clicks\":\"24\",\"reach\":\"1004\",\"spend\":\"5.41\",\"actions\":[{\"action_type\":\"like\",\"value\":\"2\"},{\"action_type\":\"link_click\",\"value\":\"19\"},{\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"video_view\",\"value\":\"298\"},{\"action_type\":\"page_engagement\",\"value\":\"320\"},{\"action_type\":\"post_engagement\",\"value\":\"318\"}],\"ad_id\":\"6077416553070\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"44\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"52\"}],\"impressions\":\"1224\",\"clicks\":\"28\",\"reach\":\"1204\",\"spend\":\"6.11\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"24\"},{\"action_type\":\"video_view\",\"value\":\"350\"},{\"action_type\":\"page_engagement\",\"value\":\"374\"},{\"action_type\":\"post_engagement\",\"value\":\"374\"}],\"ad_id\":\"6077416553070\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"54\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077416553070\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"25\"}],\"impressions\":\"1267\",\"clicks\":\"29\",\"reach\":\"1246\",\"spend\":\"7.01\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"17\"},{\"action_type\":\"post_reaction\",\"value\":\"2\"},{\"action_type\":\"video_view\",\"value\":\"161\"},{\"action_type\":\"page_engagement\",\"value\":\"180\"},{\"action_type\":\"post_engagement\",\"value\":\"180\"}],\"ad_id\":\"6077415699870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"29\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"26\"}],\"impressions\":\"2163\",\"clicks\":\"39\",\"reach\":\"2087\",\"spend\":\"9.01\",\"actions\":[{\"action_type\":\"like\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"24\"},{\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"video_view\",\"value\":\"227\"},{\"action_type\":\"page_engagement\",\"value\":\"253\"},{\"action_type\":\"post_engagement\",\"value\":\"252\"}],\"ad_id\":\"6077415699870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"32\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"36\"}],\"impressions\":\"2174\",\"clicks\":\"39\",\"reach\":\"2116\",\"spend\":\"8.3\",\"actions\":[{\"action_type\":\"like\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"27\"},{\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"video_view\",\"value\":\"227\"},{\"action_type\":\"page_engagement\",\"value\":\"256\"},{\"action_type\":\"post_engagement\",\"value\":\"255\"}],\"ad_id\":\"6077415699870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"40\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077415699870\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"24\"}],\"impressions\":\"914\",\"clicks\":\"26\",\"reach\":\"887\",\"spend\":\"7.66\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"12\"},{\"action_type\":\"video_view\",\"value\":\"154\"},{\"action_type\":\"page_engagement\",\"value\":\"166\"},{\"action_type\":\"post_engagement\",\"value\":\"166\"}],\"ad_id\":\"6077416552870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"24\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"25\"}],\"impressions\":\"1196\",\"clicks\":\"30\",\"reach\":\"1147\",\"spend\":\"7.42\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"22\"},{\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"video_view\",\"value\":\"209\"},{\"action_type\":\"page_engagement\",\"value\":\"232\"},{\"action_type\":\"post_engagement\",\"value\":\"232\"}],\"ad_id\":\"6077416552870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"28\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"23\"}],\"impressions\":\"894\",\"clicks\":\"28\",\"reach\":\"847\",\"spend\":\"6.06\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"18\"},{\"action_type\":\"video_view\",\"value\":\"142\"},{\"action_type\":\"page_engagement\",\"value\":\"160\"},{\"action_type\":\"post_engagement\",\"value\":\"160\"}],\"ad_id\":\"6077416552870\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"26\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077416552870\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"1137\"}],\"impressions\":\"3556\",\"clicks\":\"19\",\"reach\":\"3328\",\"spend\":\"14.53\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"5\"},{\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"video_view\",\"value\":\"2214\"},{\"action_type\":\"page_engagement\",\"value\":\"2220\"},{\"action_type\":\"post_engagement\",\"value\":\"2220\"}],\"ad_id\":\"6074759988070\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"1173\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6074759988070\"},{\"id\":\"6074759920670\"},{\"id\":\"6074759922870\"},{\"id\":\"6074759871270\"},{\"id\":\"6074690395070\"},{\"id\":\"6074690394670\"},{\"id\":\"6074690380470\"},{\"id\":\"6074690380270\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"349\"}],\"impressions\":\"5201\",\"clicks\":\"19\",\"reach\":\"4727\",\"spend\":\"16.2\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"3\"},{\"action_type\":\"post\",\"value\":\"1\"},{\"action_type\":\"video_view\",\"value\":\"2577\"},{\"action_type\":\"page_engagement\",\"value\":\"2581\"},{\"action_type\":\"post_engagement\",\"value\":\"2581\"}],\"ad_id\":\"6074690353470\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"168\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6074690353470\"},{\"insights\":{\"data\":[{\"video_30_sec_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"429\"}],\"impressions\":\"5812\",\"clicks\":\"42\",\"reach\":\"5331\",\"spend\":\"16.32\",\"actions\":[{\"action_type\":\"comment\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"14\"},{\"action_type\":\"post\",\"value\":\"1\"},{\"action_type\":\"post_reaction\",\"value\":\"2\"},{\"action_type\":\"video_view\",\"value\":\"2684\"},{\"action_type\":\"page_engagement\",\"value\":\"2702\"},{\"action_type\":\"post_engagement\",\"value\":\"2702\"}],\"ad_id\":\"6074690353270\",\"video_p95_watched_actions\":[{\"action_type\":\"video_view\",\"value\":\"176\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6074690353270\"},{\"id\":\"6074690268270\"},{\"id\":\"6074690268870\"},{\"id\":\"6074689830070\"},{\"id\":\"6074689557270\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMTkxOTI1MDQ3MAZDZD\",\"after\":\"NjA3NDY4OTU1NzI3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjA3NDY4OTU1NzI3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&before=NjAyMTkxOTI1MDQ3MAZDZD\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v2.9/ads",
 :as :json,
 :query-params
 {:path "ads",
  :fields
  "insights.action_breakdowns(action_type).date_preset(last_3d).time_increment(1){ad_id,impressions,reach,clicks,spend,video_30_sec_watched_actions,video_p95_watched_actions,actions}",
  :ids "act_10152437784203995",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:status 200,
 :body
 "{\"act_10152437784203995\":{\"data\":[{\"insights\":{\"data\":[{\"ad_id\":\"6077982445070\",\"impressions\":\"4819\",\"reach\":\"4772\",\"clicks\":\"219\",\"spend\":\"9.39\",\"actions\":[{\"action_type\":\"comment\",\"value\":\"6\"},{\"action_type\":\"like\",\"value\":\"5\"},{\"action_type\":\"link_click\",\"value\":\"116\"},{\"action_type\":\"post\",\"value\":\"2\"},{\"action_type\":\"post_reaction\",\"value\":\"23\"},{\"action_type\":\"page_engagement\",\"value\":\"152\"},{\"action_type\":\"post_engagement\",\"value\":\"147\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6077982445070\"},{\"insights\":{\"data\":[{\"ad_id\":\"6077982498070\",\"impressions\":\"4376\",\"reach\":\"4301\",\"clicks\":\"190\",\"spend\":\"14.15\",\"actions\":[{\"action_type\":\"comment\",\"value\":\"5\"},{\"action_type\":\"like\",\"value\":\"3\"},{\"action_type\":\"link_click\",\"value\":\"53\"},{\"action_type\":\"post\",\"value\":\"3\"},{\"action_type\":\"post_reaction\",\"value\":\"20\"},{\"action_type\":\"page_engagement\",\"value\":\"84\"},{\"action_type\":\"post_engagement\",\"value\":\"81\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6077982498070\"},{\"insights\":{\"data\":[{\"ad_id\":\"6077980758070\",\"impressions\":\"2701\",\"reach\":\"2685\",\"clicks\":\"140\",\"spend\":\"7.37\",\"actions\":[{\"action_type\":\"comment\",\"value\":\"1\"},{\"action_type\":\"like\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"46\"},{\"action_type\":\"post\",\"value\":\"1\"},{\"action_type\":\"post_reaction\",\"value\":\"15\"},{\"action_type\":\"page_engagement\",\"value\":\"64\"},{\"action_type\":\"post_engagement\",\"value\":\"63\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6077980758070\"},{\"id\":\"6046769881270\"},{\"id\":\"6046769880870\"},{\"id\":\"6046740679870\"},{\"id\":\"6046739954670\"},{\"id\":\"6026011249870\"},{\"id\":\"6026011247070\"},{\"id\":\"6026011243870\"},{\"id\":\"6026011243670\"},{\"id\":\"6025560452870\"},{\"id\":\"6025560452670\"},{\"id\":\"6025560451270\"},{\"id\":\"6025560445270\"},{\"id\":\"6025560444470\"},{\"id\":\"6025560444270\"},{\"id\":\"6021919267670\"},{\"id\":\"6021919267270\"},{\"id\":\"6021919258870\"},{\"id\":\"6021919257270\"},{\"id\":\"6021919257070\"},{\"id\":\"6021919256470\"},{\"id\":\"6021919255470\"},{\"id\":\"6021919252470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA3Nzk4MjQ0NTA3MAZDZD\",\"after\":\"NjAyMTkxOTI1MjQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/ads?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_type%29.date_preset%28last_3d%29.time_increment%281%29%7Bad_id%2Cimpressions%2Creach%2Cclicks%2Cspend%2Cvideo_30_sec_watched_actions%2Cvideo_p95_watched_actions%2Cactions%7D&since&until&limit=25&after=NjAyMTkxOTI1MjQ3MAZDZD\"}}}"}
)
})

================================================
File: /test/keboola/snapshots/adsinsights/out/tables/ads_insights.manifest
================================================
{"columns":["ex-account-id","fb-graph-node","parent-id","ads_action_name","action_type","value","ad_id","clicks","date_start","date_stop","impressions","reach","spend"],"incremental":true,"primary_key":["parent_id","date_start","date_stop","ads_action_name","action_type"]}

================================================
File: /test/keboola/snapshots/adsinsights/out/tables/accounts
================================================
account_id,name,business_name,currency,id
10152562141153995,blabla,,EUR,act_10152562141153995


================================================
File: /test/keboola/snapshots/adsinsights/out/tables/ads_insights/1507033655209
================================================
"act_10152437784203995","page_ads_insights","6074690353270","video_p95_watched_actions","video_view","176","6074690353270","42","2017-10-02","2017-10-02","5812","5331","16.32"
"act_10152437784203995","page_ads_insights","6074690353270","actions","post_engagement","2702","6074690353270","42","2017-10-02","2017-10-02","5812","5331","16.32"
"act_10152437784203995","page_ads_insights","6074690353270","actions","page_engagement","2702","6074690353270","42","2017-10-02","2017-10-02","5812","5331","16.32"
"act_10152437784203995","page_ads_insights","6074690353270","actions","video_view","2684","6074690353270","42","2017-10-02","2017-10-02","5812","5331","16.32"
"act_10152437784203995","page_ads_insights","6074690353270","actions","post_reaction","2","6074690353270","42","2017-10-02","2017-10-02","5812","5331","16.32"
"act_10152437784203995","page_ads_insights","6074690353270","actions","post","1","6074690353270","42","2017-10-02","2017-10-02","5812","5331","16.32"
"act_10152437784203995","page_ads_insights","6074690353270","actions","link_click","14","6074690353270","42","2017-10-02","2017-10-02","5812","5331","16.32"
"act_10152437784203995","page_ads_insights","6074690353270","actions","comment","1","6074690353270","42","2017-10-02","2017-10-02","5812","5331","16.32"
"act_10152437784203995","page_ads_insights","6074690353270","video_30_sec_watched_actions","video_view","429","6074690353270","42","2017-10-02","2017-10-02","5812","5331","16.32"
"act_10152437784203995","page_ads_insights","6074690353470","video_p95_watched_actions","video_view","168","6074690353470","19","2017-10-02","2017-10-02","5201","4727","16.2"
"act_10152437784203995","page_ads_insights","6074690353470","actions","post_engagement","2581","6074690353470","19","2017-10-02","2017-10-02","5201","4727","16.2"
"act_10152437784203995","page_ads_insights","6074690353470","actions","page_engagement","2581","6074690353470","19","2017-10-02","2017-10-02","5201","4727","16.2"
"act_10152437784203995","page_ads_insights","6074690353470","actions","video_view","2577","6074690353470","19","2017-10-02","2017-10-02","5201","4727","16.2"
"act_10152437784203995","page_ads_insights","6074690353470","actions","post","1","6074690353470","19","2017-10-02","2017-10-02","5201","4727","16.2"
"act_10152437784203995","page_ads_insights","6074690353470","actions","link_click","3","6074690353470","19","2017-10-02","2017-10-02","5201","4727","16.2"
"act_10152437784203995","page_ads_insights","6074690353470","video_30_sec_watched_actions","video_view","349","6074690353470","19","2017-10-02","2017-10-02","5201","4727","16.2"
"act_10152437784203995","page_ads_insights","6074759988070","video_p95_watched_actions","video_view","1173","6074759988070","19","2017-10-02","2017-10-02","3556","3328","14.53"
"act_10152437784203995","page_ads_insights","6074759988070","actions","post_engagement","2220","6074759988070","19","2017-10-02","2017-10-02","3556","3328","14.53"
"act_10152437784203995","page_ads_insights","6074759988070","actions","page_engagement","2220","6074759988070","19","2017-10-02","2017-10-02","3556","3328","14.53"
"act_10152437784203995","page_ads_insights","6074759988070","actions","video_view","2214","6074759988070","19","2017-10-02","2017-10-02","3556","3328","14.53"
"act_10152437784203995","page_ads_insights","6074759988070","actions","post_reaction","1","6074759988070","19","2017-10-02","2017-10-02","3556","3328","14.53"
"act_10152437784203995","page_ads_insights","6074759988070","actions","link_click","5","6074759988070","19","2017-10-02","2017-10-02","3556","3328","14.53"
"act_10152437784203995","page_ads_insights","6074759988070","video_30_sec_watched_actions","video_view","1137","6074759988070","19","2017-10-02","2017-10-02","3556","3328","14.53"
"act_10152437784203995","page_ads_insights","6077416552870","video_p95_watched_actions","video_view","26","6077416552870","28","2017-10-02","2017-10-02","894","847","6.06"
"act_10152437784203995","page_ads_insights","6077416552870","actions","post_engagement","160","6077416552870","28","2017-10-02","2017-10-02","894","847","6.06"
"act_10152437784203995","page_ads_insights","6077416552870","actions","page_engagement","160","6077416552870","28","2017-10-02","2017-10-02","894","847","6.06"
"act_10152437784203995","page_ads_insights","6077416552870","actions","video_view","142","6077416552870","28","2017-10-02","2017-10-02","894","847","6.06"
"act_10152437784203995","page_ads_insights","6077416552870","actions","link_click","18","6077416552870","28","2017-10-02","2017-10-02","894","847","6.06"
"act_10152437784203995","page_ads_insights","6077416552870","video_30_sec_watched_actions","video_view","23","6077416552870","28","2017-10-02","2017-10-02","894","847","6.06"
"act_10152437784203995","page_ads_insights","6077416552870","video_p95_watched_actions","video_view","28","6077416552870","30","2017-10-01","2017-10-01","1196","1147","7.42"
"act_10152437784203995","page_ads_insights","6077416552870","actions","post_engagement","232","6077416552870","30","2017-10-01","2017-10-01","1196","1147","7.42"
"act_10152437784203995","page_ads_insights","6077416552870","actions","page_engagement","232","6077416552870","30","2017-10-01","2017-10-01","1196","1147","7.42"
"act_10152437784203995","page_ads_insights","6077416552870","actions","video_view","209","6077416552870","30","2017-10-01","2017-10-01","1196","1147","7.42"
"act_10152437784203995","page_ads_insights","6077416552870","actions","post_reaction","1","6077416552870","30","2017-10-01","2017-10-01","1196","1147","7.42"
"act_10152437784203995","page_ads_insights","6077416552870","actions","link_click","22","6077416552870","30","2017-10-01","2017-10-01","1196","1147","7.42"
"act_10152437784203995","page_ads_insights","6077416552870","video_30_sec_watched_actions","video_view","25","6077416552870","30","2017-10-01","2017-10-01","1196","1147","7.42"
"act_10152437784203995","page_ads_insights","6077416552870","video_p95_watched_actions","video_view","24","6077416552870","26","2017-09-30","2017-09-30","914","887","7.66"
"act_10152437784203995","page_ads_insights","6077416552870","actions","post_engagement","166","6077416552870","26","2017-09-30","2017-09-30","914","887","7.66"
"act_10152437784203995","page_ads_insights","6077416552870","actions","page_engagement","166","6077416552870","26","2017-09-30","2017-09-30","914","887","7.66"
"act_10152437784203995","page_ads_insights","6077416552870","actions","video_view","154","6077416552870","26","2017-09-30","2017-09-30","914","887","7.66"
"act_10152437784203995","page_ads_insights","6077416552870","actions","link_click","12","6077416552870","26","2017-09-30","2017-09-30","914","887","7.66"
"act_10152437784203995","page_ads_insights","6077416552870","video_30_sec_watched_actions","video_view","24","6077416552870","26","2017-09-30","2017-09-30","914","887","7.66"
"act_10152437784203995","page_ads_insights","6077415699870","video_p95_watched_actions","video_view","40","6077415699870","39","2017-10-02","2017-10-02","2174","2116","8.3"
"act_10152437784203995","page_ads_insights","6077415699870","actions","post_engagement","255","6077415699870","39","2017-10-02","2017-10-02","2174","2116","8.3"
"act_10152437784203995","page_ads_insights","6077415699870","actions","page_engagement","256","6077415699870","39","2017-10-02","2017-10-02","2174","2116","8.3"
"act_10152437784203995","page_ads_insights","6077415699870","actions","video_view","227","6077415699870","39","2017-10-02","2017-10-02","2174","2116","8.3"
"act_10152437784203995","page_ads_insights","6077415699870","actions","post_reaction","1","6077415699870","39","2017-10-02","2017-10-02","2174","2116","8.3"
"act_10152437784203995","page_ads_insights","6077415699870","actions","link_click","27","6077415699870","39","2017-10-02","2017-10-02","2174","2116","8.3"
"act_10152437784203995","page_ads_insights","6077415699870","actions","like","1","6077415699870","39","2017-10-02","2017-10-02","2174","2116","8.3"
"act_10152437784203995","page_ads_insights","6077415699870","video_30_sec_watched_actions","video_view","36","6077415699870","39","2017-10-02","2017-10-02","2174","2116","8.3"
"act_10152437784203995","page_ads_insights","6077415699870","video_p95_watched_actions","video_view","32","6077415699870","39","2017-10-01","2017-10-01","2163","2087","9.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","post_engagement","252","6077415699870","39","2017-10-01","2017-10-01","2163","2087","9.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","page_engagement","253","6077415699870","39","2017-10-01","2017-10-01","2163","2087","9.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","video_view","227","6077415699870","39","2017-10-01","2017-10-01","2163","2087","9.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","post_reaction","1","6077415699870","39","2017-10-01","2017-10-01","2163","2087","9.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","link_click","24","6077415699870","39","2017-10-01","2017-10-01","2163","2087","9.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","like","1","6077415699870","39","2017-10-01","2017-10-01","2163","2087","9.01"
"act_10152437784203995","page_ads_insights","6077415699870","video_30_sec_watched_actions","video_view","26","6077415699870","39","2017-10-01","2017-10-01","2163","2087","9.01"
"act_10152437784203995","page_ads_insights","6077415699870","video_p95_watched_actions","video_view","29","6077415699870","29","2017-09-30","2017-09-30","1267","1246","7.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","post_engagement","180","6077415699870","29","2017-09-30","2017-09-30","1267","1246","7.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","page_engagement","180","6077415699870","29","2017-09-30","2017-09-30","1267","1246","7.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","video_view","161","6077415699870","29","2017-09-30","2017-09-30","1267","1246","7.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","post_reaction","2","6077415699870","29","2017-09-30","2017-09-30","1267","1246","7.01"
"act_10152437784203995","page_ads_insights","6077415699870","actions","link_click","17","6077415699870","29","2017-09-30","2017-09-30","1267","1246","7.01"
"act_10152437784203995","page_ads_insights","6077415699870","video_30_sec_watched_actions","video_view","25","6077415699870","29","2017-09-30","2017-09-30","1267","1246","7.01"
"act_10152437784203995","page_ads_insights","6077416553070","video_p95_watched_actions","video_view","54","6077416553070","28","2017-10-02","2017-10-02","1224","1204","6.11"
"act_10152437784203995","page_ads_insights","6077416553070","actions","post_engagement","374","6077416553070","28","2017-10-02","2017-10-02","1224","1204","6.11"
"act_10152437784203995","page_ads_insights","6077416553070","actions","page_engagement","374","6077416553070","28","2017-10-02","2017-10-02","1224","1204","6.11"
"act_10152437784203995","page_ads_insights","6077416553070","actions","video_view","350","6077416553070","28","2017-10-02","2017-10-02","1224","1204","6.11"
"act_10152437784203995","page_ads_insights","6077416553070","actions","link_click","24","6077416553070","28","2017-10-02","2017-10-02","1224","1204","6.11"
"act_10152437784203995","page_ads_insights","6077416553070","video_30_sec_watched_actions","video_view","52","6077416553070","28","2017-10-02","2017-10-02","1224","1204","6.11"
"act_10152437784203995","page_ads_insights","6077416553070","video_p95_watched_actions","video_view","44","6077416553070","24","2017-10-01","2017-10-01","1032","1004","5.41"
"act_10152437784203995","page_ads_insights","6077416553070","actions","post_engagement","318","6077416553070","24","2017-10-01","2017-10-01","1032","1004","5.41"
"act_10152437784203995","page_ads_insights","6077416553070","actions","page_engagement","320","6077416553070","24","2017-10-01","2017-10-01","1032","1004","5.41"
"act_10152437784203995","page_ads_insights","6077416553070","actions","video_view","298","6077416553070","24","2017-10-01","2017-10-01","1032","1004","5.41"
"act_10152437784203995","page_ads_insights","6077416553070","actions","post_reaction","1","6077416553070","24","2017-10-01","2017-10-01","1032","1004","5.41"
"act_10152437784203995","page_ads_insights","6077416553070","actions","link_click","19","6077416553070","24","2017-10-01","2017-10-01","1032","1004","5.41"
"act_10152437784203995","page_ads_insights","6077416553070","actions","like","2","6077416553070","24","2017-10-01","2017-10-01","1032","1004","5.41"
"act_10152437784203995","page_ads_insights","6077416553070","video_30_sec_watched_actions","video_view","43","6077416553070","24","2017-10-01","2017-10-01","1032","1004","5.41"
"act_10152437784203995","page_ads_insights","6077416553070","video_p95_watched_actions","video_view","40","6077416553070","17","2017-09-30","2017-09-30","824","813","5.47"
"act_10152437784203995","page_ads_insights","6077416553070","actions","post_engagement","263","6077416553070","17","2017-09-30","2017-09-30","824","813","5.47"
"act_10152437784203995","page_ads_insights","6077416553070","actions","page_engagement","263","6077416553070","17","2017-09-30","2017-09-30","824","813","5.47"
"act_10152437784203995","page_ads_insights","6077416553070","actions","video_view","250","6077416553070","17","2017-09-30","2017-09-30","824","813","5.47"
"act_10152437784203995","page_ads_insights","6077416553070","actions","link_click","13","6077416553070","17","2017-09-30","2017-09-30","824","813","5.47"
"act_10152437784203995","page_ads_insights","6077416553070","video_30_sec_watched_actions","video_view","38","6077416553070","17","2017-09-30","2017-09-30","824","813","5.47"
"act_10152437784203995","page_ads_insights","6077413251670","video_p95_watched_actions","video_view","101","6077413251670","81","2017-10-02","2017-10-02","4955","4768","19.5"
"act_10152437784203995","page_ads_insights","6077413251670","actions","post_engagement","646","6077413251670","81","2017-10-02","2017-10-02","4955","4768","19.5"
"act_10152437784203995","page_ads_insights","6077413251670","actions","page_engagement","647","6077413251670","81","2017-10-02","2017-10-02","4955","4768","19.5"
"act_10152437784203995","page_ads_insights","6077413251670","actions","video_view","587","6077413251670","81","2017-10-02","2017-10-02","4955","4768","19.5"
"act_10152437784203995","page_ads_insights","6077413251670","actions","post_reaction","4","6077413251670","81","2017-10-02","2017-10-02","4955","4768","19.5"
"act_10152437784203995","page_ads_insights","6077413251670","actions","link_click","55","6077413251670","81","2017-10-02","2017-10-02","4955","4768","19.5"
"act_10152437784203995","page_ads_insights","6077413251670","actions","like","1","6077413251670","81","2017-10-02","2017-10-02","4955","4768","19.5"
"act_10152437784203995","page_ads_insights","6077413251670","video_30_sec_watched_actions","video_view","98","6077413251670","81","2017-10-02","2017-10-02","4955","4768","19.5"
"act_10152437784203995","page_ads_insights","6077413251670","video_p95_watched_actions","video_view","132","6077413251670","120","2017-10-01","2017-10-01","5230","5045","20.8"
"act_10152437784203995","page_ads_insights","6077413251670","actions","post_engagement","809","6077413251670","120","2017-10-01","2017-10-01","5230","5045","20.8"
"act_10152437784203995","page_ads_insights","6077413251670","actions","page_engagement","811","6077413251670","120","2017-10-01","2017-10-01","5230","5045","20.8"
"act_10152437784203995","page_ads_insights","6077413251670","actions","video_view","728","6077413251670","120","2017-10-01","2017-10-01","5230","5045","20.8"
"act_10152437784203995","page_ads_insights","6077413251670","actions","post_reaction","3","6077413251670","120","2017-10-01","2017-10-01","5230","5045","20.8"
"act_10152437784203995","page_ads_insights","6077413251670","actions","link_click","78","6077413251670","120","2017-10-01","2017-10-01","5230","5045","20.8"
"act_10152437784203995","page_ads_insights","6077413251670","actions","like","2","6077413251670","120","2017-10-01","2017-10-01","5230","5045","20.8"
"act_10152437784203995","page_ads_insights","6077413251670","video_30_sec_watched_actions","video_view","120","6077413251670","120","2017-10-01","2017-10-01","5230","5045","20.8"
"act_10152437784203995","page_ads_insights","6077413251670","video_p95_watched_actions","video_view","77","6077413251670","98","2017-09-30","2017-09-30","4162","3940","23.35"
"act_10152437784203995","page_ads_insights","6077413251670","actions","post_engagement","522","6077413251670","98","2017-09-30","2017-09-30","4162","3940","23.35"
"act_10152437784203995","page_ads_insights","6077413251670","actions","page_engagement","523","6077413251670","98","2017-09-30","2017-09-30","4162","3940","23.35"
"act_10152437784203995","page_ads_insights","6077413251670","actions","video_view","456","6077413251670","98","2017-09-30","2017-09-30","4162","3940","23.35"
"act_10152437784203995","page_ads_insights","6077413251670","actions","post_reaction","4","6077413251670","98","2017-09-30","2017-09-30","4162","3940","23.35"
"act_10152437784203995","page_ads_insights","6077413251670","actions","link_click","62","6077413251670","98","2017-09-30","2017-09-30","4162","3940","23.35"
"act_10152437784203995","page_ads_insights","6077413251670","actions","like","1","6077413251670","98","2017-09-30","2017-09-30","4162","3940","23.35"
"act_10152437784203995","page_ads_insights","6077413251670","video_30_sec_watched_actions","video_view","67","6077413251670","98","2017-09-30","2017-09-30","4162","3940","23.35"
"act_10152437784203995","page_ads_insights","6077416799870","video_p95_watched_actions","video_view","21","6077416799870","2","2017-10-02","2017-10-02","400","400","2.09"
"act_10152437784203995","page_ads_insights","6077416799870","actions","post_engagement","111","6077416799870","2","2017-10-02","2017-10-02","400","400","2.09"
"act_10152437784203995","page_ads_insights","6077416799870","actions","page_engagement","111","6077416799870","2","2017-10-02","2017-10-02","400","400","2.09"
"act_10152437784203995","page_ads_insights","6077416799870","actions","video_view","108","6077416799870","2","2017-10-02","2017-10-02","400","400","2.09"
"act_10152437784203995","page_ads_insights","6077416799870","actions","post_reaction","1","6077416799870","2","2017-10-02","2017-10-02","400","400","2.09"
"act_10152437784203995","page_ads_insights","6077416799870","actions","link_click","2","6077416799870","2","2017-10-02","2017-10-02","400","400","2.09"
"act_10152437784203995","page_ads_insights","6077416799870","video_30_sec_watched_actions","video_view","21","6077416799870","2","2017-10-02","2017-10-02","400","400","2.09"
"act_10152437784203995","page_ads_insights","6077416799870","video_p95_watched_actions","video_view","11","6077416799870","1","2017-10-01","2017-10-01","321","321","1.52"
"act_10152437784203995","page_ads_insights","6077416799870","actions","post_engagement","82","6077416799870","1","2017-10-01","2017-10-01","321","321","1.52"
"act_10152437784203995","page_ads_insights","6077416799870","actions","page_engagement","82","6077416799870","1","2017-10-01","2017-10-01","321","321","1.52"
"act_10152437784203995","page_ads_insights","6077416799870","actions","video_view","79","6077416799870","1","2017-10-01","2017-10-01","321","321","1.52"
"act_10152437784203995","page_ads_insights","6077416799870","actions","post_reaction","3","6077416799870","1","2017-10-01","2017-10-01","321","321","1.52"
"act_10152437784203995","page_ads_insights","6077416799870","video_30_sec_watched_actions","video_view","11","6077416799870","1","2017-10-01","2017-10-01","321","321","1.52"
"act_10152437784203995","page_ads_insights","6077416799870","video_p95_watched_actions","video_view","17","6077416799870","0","2017-09-30","2017-09-30","323","323","2.01"
"act_10152437784203995","page_ads_insights","6077416799870","actions","post_engagement","84","6077416799870","0","2017-09-30","2017-09-30","323","323","2.01"
"act_10152437784203995","page_ads_insights","6077416799870","actions","page_engagement","84","6077416799870","0","2017-09-30","2017-09-30","323","323","2.01"
"act_10152437784203995","page_ads_insights","6077416799870","actions","video_view","83","6077416799870","0","2017-09-30","2017-09-30","323","323","2.01"
"act_10152437784203995","page_ads_insights","6077416799870","actions","post_reaction","1","6077416799870","0","2017-09-30","2017-09-30","323","323","2.01"
"act_10152437784203995","page_ads_insights","6077416799870","video_30_sec_watched_actions","video_view","16","6077416799870","0","2017-09-30","2017-09-30","323","323","2.01"
"act_10152437784203995","page_ads_insights","6077416174870","video_p95_watched_actions","video_view","70","6077416174870","6","2017-10-02","2017-10-02","1965","1965","4.22"
"act_10152437784203995","page_ads_insights","6077416174870","actions","post_engagement","318","6077416174870","6","2017-10-02","2017-10-02","1965","1965","4.22"
"act_10152437784203995","page_ads_insights","6077416174870","actions","page_engagement","318","6077416174870","6","2017-10-02","2017-10-02","1965","1965","4.22"
"act_10152437784203995","page_ads_insights","6077416174870","actions","video_view","305","6077416174870","6","2017-10-02","2017-10-02","1965","1965","4.22"
"act_10152437784203995","page_ads_insights","6077416174870","actions","post_reaction","11","6077416174870","6","2017-10-02","2017-10-02","1965","1965","4.22"
"act_10152437784203995","page_ads_insights","6077416174870","actions","link_click","2","6077416174870","6","2017-10-02","2017-10-02","1965","1965","4.22"
"act_10152437784203995","page_ads_insights","6077416174870","video_30_sec_watched_actions","video_view","67","6077416174870","6","2017-10-02","2017-10-02","1965","1965","4.22"
"act_10152437784203995","page_ads_insights","6077416174870","video_p95_watched_actions","video_view","54","6077416174870","5","2017-10-01","2017-10-01","1248","1248","2.76"
"act_10152437784203995","page_ads_insights","6077416174870","actions","post_engagement","205","6077416174870","5","2017-10-01","2017-10-01","1248","1248","2.76"
"act_10152437784203995","page_ads_insights","6077416174870","actions","page_engagement","205","6077416174870","5","2017-10-01","2017-10-01","1248","1248","2.76"
"act_10152437784203995","page_ads_insights","6077416174870","actions","video_view","193","6077416174870","5","2017-10-01","2017-10-01","1248","1248","2.76"
"act_10152437784203995","page_ads_insights","6077416174870","actions","post_reaction","11","6077416174870","5","2017-10-01","2017-10-01","1248","1248","2.76"
"act_10152437784203995","page_ads_insights","6077416174870","actions","link_click","1","6077416174870","5","2017-10-01","2017-10-01","1248","1248","2.76"
"act_10152437784203995","page_ads_insights","6077416174870","video_30_sec_watched_actions","video_view","54","6077416174870","5","2017-10-01","2017-10-01","1248","1248","2.76"
"act_10152437784203995","page_ads_insights","6077416174870","video_p95_watched_actions","video_view","40","6077416174870","4","2017-09-30","2017-09-30","1520","1520","3.95"
"act_10152437784203995","page_ads_insights","6077416174870","actions","post_engagement","225","6077416174870","4","2017-09-30","2017-09-30","1520","1520","3.95"
"act_10152437784203995","page_ads_insights","6077416174870","actions","page_engagement","225","6077416174870","4","2017-09-30","2017-09-30","1520","1520","3.95"
"act_10152437784203995","page_ads_insights","6077416174870","actions","video_view","205","6077416174870","4","2017-09-30","2017-09-30","1520","1520","3.95"
"act_10152437784203995","page_ads_insights","6077416174870","actions","post_reaction","16","6077416174870","4","2017-09-30","2017-09-30","1520","1520","3.95"
"act_10152437784203995","page_ads_insights","6077416174870","actions","link_click","4","6077416174870","4","2017-09-30","2017-09-30","1520","1520","3.95"
"act_10152437784203995","page_ads_insights","6077416174870","video_30_sec_watched_actions","video_view","40","6077416174870","4","2017-09-30","2017-09-30","1520","1520","3.95"
"act_10152437784203995","page_ads_insights","6077416174670","video_p95_watched_actions","video_view","107","6077416174670","9","2017-10-02","2017-10-02","1924","1922","7.57"
"act_10152437784203995","page_ads_insights","6077416174670","actions","post_engagement","400","6077416174670","9","2017-10-02","2017-10-02","1924","1922","7.57"
"act_10152437784203995","page_ads_insights","6077416174670","actions","page_engagement","400","6077416174670","9","2017-10-02","2017-10-02","1924","1922","7.57"
"act_10152437784203995","page_ads_insights","6077416174670","actions","video_view","391","6077416174670","9","2017-10-02","2017-10-02","1924","1922","7.57"
"act_10152437784203995","page_ads_insights","6077416174670","actions","post_reaction","4","6077416174670","9","2017-10-02","2017-10-02","1924","1922","7.57"
"act_10152437784203995","page_ads_insights","6077416174670","actions","link_click","5","6077416174670","9","2017-10-02","2017-10-02","1924","1922","7.57"
"act_10152437784203995","page_ads_insights","6077416174670","video_30_sec_watched_actions","video_view","104","6077416174670","9","2017-10-02","2017-10-02","1924","1922","7.57"
"act_10152437784203995","page_ads_insights","6077416174670","video_p95_watched_actions","video_view","139","6077416174670","11","2017-10-01","2017-10-01","2891","2889","10.1"
"act_10152437784203995","page_ads_insights","6077416174670","actions","post_engagement","583","6077416174670","11","2017-10-01","2017-10-01","2891","2889","10.1"
"act_10152437784203995","page_ads_insights","6077416174670","actions","page_engagement","583","6077416174670","11","2017-10-01","2017-10-01","2891","2889","10.1"
"act_10152437784203995","page_ads_insights","6077416174670","actions","video_view","562","6077416174670","11","2017-10-01","2017-10-01","2891","2889","10.1"
"act_10152437784203995","page_ads_insights","6077416174670","actions","post_reaction","17","6077416174670","11","2017-10-01","2017-10-01","2891","2889","10.1"
"act_10152437784203995","page_ads_insights","6077416174670","actions","link_click","4","6077416174670","11","2017-10-01","2017-10-01","2891","2889","10.1"
"act_10152437784203995","page_ads_insights","6077416174670","video_30_sec_watched_actions","video_view","138","6077416174670","11","2017-10-01","2017-10-01","2891","2889","10.1"
"act_10152437784203995","page_ads_insights","6077416174670","video_p95_watched_actions","video_view","149","6077416174670","11","2017-09-30","2017-09-30","2506","2503","9.46"
"act_10152437784203995","page_ads_insights","6077416174670","actions","post_engagement","561","6077416174670","11","2017-09-30","2017-09-30","2506","2503","9.46"
"act_10152437784203995","page_ads_insights","6077416174670","actions","page_engagement","561","6077416174670","11","2017-09-30","2017-09-30","2506","2503","9.46"
"act_10152437784203995","page_ads_insights","6077416174670","actions","video_view","544","6077416174670","11","2017-09-30","2017-09-30","2506","2503","9.46"
"act_10152437784203995","page_ads_insights","6077416174670","actions","post_reaction","12","6077416174670","11","2017-09-30","2017-09-30","2506","2503","9.46"
"act_10152437784203995","page_ads_insights","6077416174670","actions","link_click","5","6077416174670","11","2017-09-30","2017-09-30","2506","2503","9.46"
"act_10152437784203995","page_ads_insights","6077416174670","video_30_sec_watched_actions","video_view","147","6077416174670","11","2017-09-30","2017-09-30","2506","2503","9.46"
"act_10152437784203995","page_ads_insights","6077416800270","video_p95_watched_actions","video_view","44","6077416800270","1","2017-10-02","2017-10-02","707","707","3.21"
"act_10152437784203995","page_ads_insights","6077416800270","actions","post_engagement","193","6077416800270","1","2017-10-02","2017-10-02","707","707","3.21"
"act_10152437784203995","page_ads_insights","6077416800270","actions","page_engagement","193","6077416800270","1","2017-10-02","2017-10-02","707","707","3.21"
"act_10152437784203995","page_ads_insights","6077416800270","actions","video_view","188","6077416800270","1","2017-10-02","2017-10-02","707","707","3.21"
"act_10152437784203995","page_ads_insights","6077416800270","actions","post_reaction","3","6077416800270","1","2017-10-02","2017-10-02","707","707","3.21"
"act_10152437784203995","page_ads_insights","6077416800270","actions","post","1","6077416800270","1","2017-10-02","2017-10-02","707","707","3.21"
"act_10152437784203995","page_ads_insights","6077416800270","actions","link_click","1","6077416800270","1","2017-10-02","2017-10-02","707","707","3.21"
"act_10152437784203995","page_ads_insights","6077416800270","video_30_sec_watched_actions","video_view","42","6077416800270","1","2017-10-02","2017-10-02","707","707","3.21"
"act_10152437784203995","page_ads_insights","6077416800270","video_p95_watched_actions","video_view","48","6077416800270","2","2017-10-01","2017-10-01","800","800","3.96"
"act_10152437784203995","page_ads_insights","6077416800270","actions","post_engagement","261","6077416800270","2","2017-10-01","2017-10-01","800","800","3.96"
"act_10152437784203995","page_ads_insights","6077416800270","actions","page_engagement","261","6077416800270","2","2017-10-01","2017-10-01","800","800","3.96"
"act_10152437784203995","page_ads_insights","6077416800270","actions","video_view","251","6077416800270","2","2017-10-01","2017-10-01","800","800","3.96"
"act_10152437784203995","page_ads_insights","6077416800270","actions","post_reaction","9","6077416800270","2","2017-10-01","2017-10-01","800","800","3.96"
"act_10152437784203995","page_ads_insights","6077416800270","actions","link_click","1","6077416800270","2","2017-10-01","2017-10-01","800","800","3.96"
"act_10152437784203995","page_ads_insights","6077416800270","video_30_sec_watched_actions","video_view","47","6077416800270","2","2017-10-01","2017-10-01","800","800","3.96"
"act_10152437784203995","page_ads_insights","6077416800270","video_p95_watched_actions","video_view","43","6077416800270","5","2017-09-30","2017-09-30","591","590","3.72"
"act_10152437784203995","page_ads_insights","6077416800270","actions","post_engagement","175","6077416800270","5","2017-09-30","2017-09-30","591","590","3.72"
"act_10152437784203995","page_ads_insights","6077416800270","actions","page_engagement","175","6077416800270","5","2017-09-30","2017-09-30","591","590","3.72"
"act_10152437784203995","page_ads_insights","6077416800270","actions","video_view","169","6077416800270","5","2017-09-30","2017-09-30","591","590","3.72"
"act_10152437784203995","page_ads_insights","6077416800270","actions","post_reaction","1","6077416800270","5","2017-09-30","2017-09-30","591","590","3.72"
"act_10152437784203995","page_ads_insights","6077416800270","actions","link_click","5","6077416800270","5","2017-09-30","2017-09-30","591","590","3.72"
"act_10152437784203995","page_ads_insights","6077416800270","video_30_sec_watched_actions","video_view","42","6077416800270","5","2017-09-30","2017-09-30","591","590","3.72"
"act_10152437784203995","page_ads_insights","6077417493270","video_p95_watched_actions","video_view","896","6077417493270","88","2017-10-02","2017-10-02","29254","29254","30.68"
"act_10152437784203995","page_ads_insights","6077417493270","actions","post_engagement","2743","6077417493270","88","2017-10-02","2017-10-02","29254","29254","30.68"
"act_10152437784203995","page_ads_insights","6077417493270","actions","page_engagement","2743","6077417493270","88","2017-10-02","2017-10-02","29254","29254","30.68"
"act_10152437784203995","page_ads_insights","6077417493270","actions","video_view","2666","6077417493270","88","2017-10-02","2017-10-02","29254","29254","30.68"
"act_10152437784203995","page_ads_insights","6077417493270","actions","link_click","77","6077417493270","88","2017-10-02","2017-10-02","29254","29254","30.68"
"act_10152437784203995","page_ads_insights","6077417493270","video_30_sec_watched_actions","video_view","877","6077417493270","88","2017-10-02","2017-10-02","29254","29254","30.68"
"act_10152437784203995","page_ads_insights","6077417493270","video_p95_watched_actions","video_view","926","6077417493270","81","2017-10-01","2017-10-01","26209","26209","30.25"
"act_10152437784203995","page_ads_insights","6077417493270","actions","post_engagement","2660","6077417493270","81","2017-10-01","2017-10-01","26209","26209","30.25"
"act_10152437784203995","page_ads_insights","6077417493270","actions","page_engagement","2660","6077417493270","81","2017-10-01","2017-10-01","26209","26209","30.25"
"act_10152437784203995","page_ads_insights","6077417493270","actions","video_view","2589","6077417493270","81","2017-10-01","2017-10-01","26209","26209","30.25"
"act_10152437784203995","page_ads_insights","6077417493270","actions","link_click","71","6077417493270","81","2017-10-01","2017-10-01","26209","26209","30.25"
"act_10152437784203995","page_ads_insights","6077417493270","video_30_sec_watched_actions","video_view","901","6077417493270","81","2017-10-01","2017-10-01","26209","26209","30.25"
"act_10152437784203995","page_ads_insights","6077417493270","video_p95_watched_actions","video_view","814","6077417493270","61","2017-09-30","2017-09-30","21100","20969","28.92"
"act_10152437784203995","page_ads_insights","6077417493270","actions","post_engagement","2300","6077417493270","61","2017-09-30","2017-09-30","21100","20969","28.92"
"act_10152437784203995","page_ads_insights","6077417493270","actions","page_engagement","2300","6077417493270","61","2017-09-30","2017-09-30","21100","20969","28.92"
"act_10152437784203995","page_ads_insights","6077417493270","actions","video_view","2242","6077417493270","61","2017-09-30","2017-09-30","21100","20969","28.92"
"act_10152437784203995","page_ads_insights","6077417493270","actions","link_click","58","6077417493270","61","2017-09-30","2017-09-30","21100","20969","28.92"
"act_10152437784203995","page_ads_insights","6077417493270","video_30_sec_watched_actions","video_view","807","6077417493270","61","2017-09-30","2017-09-30","21100","20969","28.92"
"act_10152437784203995","page_ads_insights","6077418770070","video_p95_watched_actions","video_view","208","6077418770070","21","2017-10-02","2017-10-02","4107","4103","11.86"
"act_10152437784203995","page_ads_insights","6077418770070","actions","post_engagement","705","6077418770070","21","2017-10-02","2017-10-02","4107","4103","11.86"
"act_10152437784203995","page_ads_insights","6077418770070","actions","page_engagement","705","6077418770070","21","2017-10-02","2017-10-02","4107","4103","11.86"
"act_10152437784203995","page_ads_insights","6077418770070","actions","video_view","686","6077418770070","21","2017-10-02","2017-10-02","4107","4103","11.86"
"act_10152437784203995","page_ads_insights","6077418770070","actions","link_click","19","6077418770070","21","2017-10-02","2017-10-02","4107","4103","11.86"
"act_10152437784203995","page_ads_insights","6077418770070","video_30_sec_watched_actions","video_view","206","6077418770070","21","2017-10-02","2017-10-02","4107","4103","11.86"
"act_10152437784203995","page_ads_insights","6077418770070","video_p95_watched_actions","video_view","249","6077418770070","12","2017-10-01","2017-10-01","3858","3850","11.92"
"act_10152437784203995","page_ads_insights","6077418770070","actions","post_engagement","744","6077418770070","12","2017-10-01","2017-10-01","3858","3850","11.92"
"act_10152437784203995","page_ads_insights","6077418770070","actions","page_engagement","744","6077418770070","12","2017-10-01","2017-10-01","3858","3850","11.92"
"act_10152437784203995","page_ads_insights","6077418770070","actions","video_view","736","6077418770070","12","2017-10-01","2017-10-01","3858","3850","11.92"
"act_10152437784203995","page_ads_insights","6077418770070","actions","link_click","8","6077418770070","12","2017-10-01","2017-10-01","3858","3850","11.92"
"act_10152437784203995","page_ads_insights","6077418770070","video_30_sec_watched_actions","video_view","245","6077418770070","12","2017-10-01","2017-10-01","3858","3850","11.92"
"act_10152437784203995","page_ads_insights","6077418770070","video_p95_watched_actions","video_view","267","6077418770070","10","2017-09-30","2017-09-30","3613","3606","11.97"
"act_10152437784203995","page_ads_insights","6077418770070","actions","post_engagement","751","6077418770070","10","2017-09-30","2017-09-30","3613","3606","11.97"
"act_10152437784203995","page_ads_insights","6077418770070","actions","page_engagement","751","6077418770070","10","2017-09-30","2017-09-30","3613","3606","11.97"
"act_10152437784203995","page_ads_insights","6077418770070","actions","video_view","741","6077418770070","10","2017-09-30","2017-09-30","3613","3606","11.97"
"act_10152437784203995","page_ads_insights","6077418770070","actions","link_click","10","6077418770070","10","2017-09-30","2017-09-30","3613","3606","11.97"
"act_10152437784203995","page_ads_insights","6077418770070","video_30_sec_watched_actions","video_view","266","6077418770070","10","2017-09-30","2017-09-30","3613","3606","11.97"
"act_10152437784203995","page_ads_insights","6077980758070","actions","post_engagement","63","6077980758070","140","2017-10-02","2017-10-02","2701","2685","7.37"
"act_10152437784203995","page_ads_insights","6077980758070","actions","page_engagement","64","6077980758070","140","2017-10-02","2017-10-02","2701","2685","7.37"
"act_10152437784203995","page_ads_insights","6077980758070","actions","post_reaction","15","6077980758070","140","2017-10-02","2017-10-02","2701","2685","7.37"
"act_10152437784203995","page_ads_insights","6077980758070","actions","post","1","6077980758070","140","2017-10-02","2017-10-02","2701","2685","7.37"
"act_10152437784203995","page_ads_insights","6077980758070","actions","link_click","46","6077980758070","140","2017-10-02","2017-10-02","2701","2685","7.37"
"act_10152437784203995","page_ads_insights","6077980758070","actions","like","1","6077980758070","140","2017-10-02","2017-10-02","2701","2685","7.37"
"act_10152437784203995","page_ads_insights","6077980758070","actions","comment","1","6077980758070","140","2017-10-02","2017-10-02","2701","2685","7.37"
"act_10152437784203995","page_ads_insights","6077982498070","actions","post_engagement","81","6077982498070","190","2017-10-02","2017-10-02","4376","4301","14.15"
"act_10152437784203995","page_ads_insights","6077982498070","actions","page_engagement","84","6077982498070","190","2017-10-02","2017-10-02","4376","4301","14.15"
"act_10152437784203995","page_ads_insights","6077982498070","actions","post_reaction","20","6077982498070","190","2017-10-02","2017-10-02","4376","4301","14.15"
"act_10152437784203995","page_ads_insights","6077982498070","actions","post","3","6077982498070","190","2017-10-02","2017-10-02","4376","4301","14.15"
"act_10152437784203995","page_ads_insights","6077982498070","actions","link_click","53","6077982498070","190","2017-10-02","2017-10-02","4376","4301","14.15"
"act_10152437784203995","page_ads_insights","6077982498070","actions","like","3","6077982498070","190","2017-10-02","2017-10-02","4376","4301","14.15"
"act_10152437784203995","page_ads_insights","6077982498070","actions","comment","5","6077982498070","190","2017-10-02","2017-10-02","4376","4301","14.15"
"act_10152437784203995","page_ads_insights","6077982445070","actions","post_engagement","147","6077982445070","219","2017-10-02","2017-10-02","4819","4772","9.39"
"act_10152437784203995","page_ads_insights","6077982445070","actions","page_engagement","152","6077982445070","219","2017-10-02","2017-10-02","4819","4772","9.39"
"act_10152437784203995","page_ads_insights","6077982445070","actions","post_reaction","23","6077982445070","219","2017-10-02","2017-10-02","4819","4772","9.39"
"act_10152437784203995","page_ads_insights","6077982445070","actions","post","2","6077982445070","219","2017-10-02","2017-10-02","4819","4772","9.39"
"act_10152437784203995","page_ads_insights","6077982445070","actions","link_click","116","6077982445070","219","2017-10-02","2017-10-02","4819","4772","9.39"
"act_10152437784203995","page_ads_insights","6077982445070","actions","like","5","6077982445070","219","2017-10-02","2017-10-02","4819","4772","9.39"
"act_10152437784203995","page_ads_insights","6077982445070","actions","comment","6","6077982445070","219","2017-10-02","2017-10-02","4819","4772","9.39"


================================================
File: /test/keboola/snapshots/adsinsights/test_adsinsights.clj
================================================
(ns keboola.snapshots.adsinsights.test-adsinsights
  (:require [keboola.snapshots.adsinsights.apicalls :as apicalls]
            [clojure.test :as t :refer :all]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.test-utils.core :as test-utils]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            )
  (:use clj-http.fake))

(deftest adsinsights-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "adsinsights"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "test/keboola/snapshots/adsinsights")
    (test-utils/copy-config-tmp "test/keboola/snapshots/adsinsights" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "test/keboola/snapshots/adsinsights" tmp-dir)
      )))

================================================
File: /test/keboola/snapshots/adsinsights/config.json
================================================
{
  "storage" : { },
  "parameters" : {
    "accounts" : {
      "act_10152562141153995" : {
        "account_id" : "10152562141153995",
        "business_name" : "",
        "currency" : "EUR",
        "id" : "act_10152562141153995",
        "name" : "blabla"
      }
    },
    "api-version" : "v2.9",
    "queries" : [ {
      "name" : "ads_insights",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "ads",
        "fields" : "insights.action_breakdowns(action_type).date_preset(last_3d).time_increment(1){ad_id,impressions,reach,clicks,spend,video_30_sec_watched_actions,video_p95_watched_actions,actions}",
        "ids" : "act_10152437784203995"
      }
    } ]
  },
  "authorization" : {
    "oauth_api" : {
      "id" : "keboola.ex-facebook-ads",
      "credentials" : {
        "id" : "main",
        "authorizedFor" : "Myself",
        "creator" : {
          "id" : "1234",
          "description" : "me@keboola.com"
        },
        "created" : "2016-01-31 00:13:30",
        "oauthVersion" : "facebook",
        "appKey" : "xxx",
        "#data" : "{\"token\":\"XXTOKENXX\"}",
        "#appSecret" : "KBC::Encrypted==ENCODEDSTRING=="
      }
    }
  }
}

================================================
File: /test/keboola/snapshots/ads/apicalls.clj
================================================
(ns keboola.snapshots.ads.apicalls)
(def recorded 
{
{:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAxOTM2Mzk4NDcwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6019173396908\",\"name\":\"EClvd\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019173396708\",\"name\":\"pPTM6\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019173396508\",\"name\":\"Nkbbf\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019173394508\",\"name\":\"2UWlJ\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018869673308\",\"name\":\"qqluK\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018869673108\",\"name\":\"NcXrs\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018869672908\",\"name\":\"CGHke\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018869672708\",\"name\":\"KcN05\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018869670908\",\"name\":\"uHWMW\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018869670708\",\"name\":\"lCyY1\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018395907908\",\"name\":\"fpYZr\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018395907708\",\"name\":\"agFU1\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018395907508\",\"name\":\"X8Mo8\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018300893308\",\"name\":\"qyMDy\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018300893108\",\"name\":\"ieBZ3\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018300892908\",\"name\":\"5kTWc\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018300891508\",\"name\":\"cFn51\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018300845708\",\"name\":\"rFf3N\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018300845508\",\"name\":\"X9EZs\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018300845308\",\"name\":\"rjWck\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018062856708\",\"name\":\"CTPI9\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018062856508\",\"name\":\"TzMRV\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018062856308\",\"name\":\"gu9YE\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018062856108\",\"name\":\"fSj3D\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjAxOTE3MzM5NjkwOAZDZD\",\"after\":\"NjAxODA2Mjg1NjEwOAZDZD\"},\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&before=NjAxOTE3MzM5NjkwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAyMDA4NDc0NzMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020084746508\",\"name\":\"eTybH\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020084745308\",\"name\":\"foUTW\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019982775308\",\"name\":\"TCDfs\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019982775108\",\"name\":\"qriC4\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019982774908\",\"name\":\"rcCqg\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019982772908\",\"name\":\"OtOE9\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019982602508\",\"name\":\"EOxGL\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019833859308\",\"name\":\"ufLPL\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019833858908\",\"name\":\"7ucru\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019833857708\",\"name\":\"3JdjR\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019739765108\",\"name\":\"2XKXy\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019739764908\",\"name\":\"mO1fT\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019739763908\",\"name\":\"6Mcng\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019736571908\",\"name\":\"WvMfI\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019736571708\",\"name\":\"4d99C\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019736570308\",\"name\":\"r6MJb\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019650564908\",\"name\":\"iyq4U\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019650564708\",\"name\":\"YHR6l\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019650563308\",\"name\":\"IKQO3\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019363988508\",\"name\":\"BKNCL\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019363988308\",\"name\":\"DCVWn\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019363988108\",\"name\":\"piJWY\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019363987908\",\"name\":\"7nFaT\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019363986108\",\"name\":\"68fUg\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019363984708\",\"name\":\"5oXqZ\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDA4NDc0NjUwOAZDZD\",\"after\":\"NjAxOTM2Mzk4NDcwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAxOTM2Mzk4NDcwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&before=NjAyMDA4NDc0NjUwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAyMjQ5NzQ3NTMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6022384455308\",\"name\":\"74Ylr\",\"account_id\":\"10152412627713995\"},{\"id\":\"6022227533708\",\"name\":\"uwWe5\",\"account_id\":\"10152412627713995\"},{\"id\":\"6022099353908\",\"name\":\"5G2p4\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021862044508\",\"name\":\"XrXsP\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021704239908\",\"name\":\"syj1X\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021704239708\",\"name\":\"R6NxU\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021704238908\",\"name\":\"96Kcm\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021703482308\",\"name\":\"rSsoN\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021618800308\",\"name\":\"2nSMV\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021618800108\",\"name\":\"dPCXb\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021618799108\",\"name\":\"Q99az\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021617811308\",\"name\":\"6Ctn6\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021527352708\",\"name\":\"RZqtz\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021430991108\",\"name\":\"d4l1m\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021065595108\",\"name\":\"ThZMv\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020834987908\",\"name\":\"djnER\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020779953708\",\"name\":\"htiai\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020764680708\",\"name\":\"HWM3q\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020525769508\",\"name\":\"cnBp5\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020525094508\",\"name\":\"MXuSh\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020374960908\",\"name\":\"rNGhx\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020304748108\",\"name\":\"PiVmF\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020176077508\",\"name\":\"8xP4H\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020118445108\",\"name\":\"reipM\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020084747308\",\"name\":\"EUkNO\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMjM4NDQ1NTMwOAZDZD\",\"after\":\"NjAyMDA4NDc0NzMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAyMDA4NDc0NzMwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&before=NjAyMjM4NDQ1NTMwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAyNjI4NzQwODUwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6026287408308\",\"name\":\"6we19\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026287408108\",\"name\":\"6iEyx\",\"account_id\":\"10152412627713995\"},{\"id\":\"6025523612708\",\"name\":\"oVMW8\",\"account_id\":\"10152412627713995\"},{\"id\":\"6025523612308\",\"name\":\"DKHJb\",\"account_id\":\"10152412627713995\"},{\"id\":\"6025523611508\",\"name\":\"eyYJF\",\"account_id\":\"10152412627713995\"},{\"id\":\"6025523611108\",\"name\":\"MGbVx\",\"account_id\":\"10152412627713995\"},{\"id\":\"6025342743708\",\"name\":\"yunVF\",\"account_id\":\"10152412627713995\"},{\"id\":\"6025342743108\",\"name\":\"FWtlt\",\"account_id\":\"10152412627713995\"},{\"id\":\"6025342742908\",\"name\":\"Zb3BC\",\"account_id\":\"10152412627713995\"},{\"id\":\"6025342742708\",\"name\":\"M6qHK\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023987412508\",\"name\":\"KXBue\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023987412108\",\"name\":\"qfY05\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023987411908\",\"name\":\"cKj18\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023987410108\",\"name\":\"04Z3o\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023987409308\",\"name\":\"1428D\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023987409108\",\"name\":\"b2WWN\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023987408908\",\"name\":\"P9ZtI\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023987408708\",\"name\":\"Ttplp\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023170891308\",\"name\":\"Ml5cG\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023170890708\",\"name\":\"GMu6O\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023110052708\",\"name\":\"VjDuT\",\"account_id\":\"10152412627713995\"},{\"id\":\"6022769056708\",\"name\":\"dLxCH\",\"account_id\":\"10152412627713995\"},{\"id\":\"6022769056108\",\"name\":\"0a67n\",\"account_id\":\"10152412627713995\"},{\"id\":\"6022769055908\",\"name\":\"nFPPU\",\"account_id\":\"10152412627713995\"},{\"id\":\"6022497475308\",\"name\":\"9TbI4\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNjI4NzQwODMwOAZDZD\",\"after\":\"NjAyMjQ5NzQ3NTMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAyMjQ5NzQ3NTMwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&before=NjAyNjI4NzQwODMwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAzMDg5OTg1MDkwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6030899850708\",\"name\":\"bejzM\",\"account_id\":\"10152412627713995\"},{\"id\":\"6030899850508\",\"name\":\"Xt4Nc\",\"account_id\":\"10152412627713995\"},{\"id\":\"6030899849708\",\"name\":\"bMV3J\",\"account_id\":\"10152412627713995\"},{\"id\":\"6029050666708\",\"name\":\"rYBJD\",\"account_id\":\"10152412627713995\"},{\"id\":\"6029050665908\",\"name\":\"qBKPn\",\"account_id\":\"10152412627713995\"},{\"id\":\"6029050665708\",\"name\":\"tnOKC\",\"account_id\":\"10152412627713995\"},{\"id\":\"6029050665508\",\"name\":\"yEDhs\",\"account_id\":\"10152412627713995\"},{\"id\":\"6028106062908\",\"name\":\"5ah7R\",\"account_id\":\"10152412627713995\"},{\"id\":\"6028106062708\",\"name\":\"W0qHK\",\"account_id\":\"10152412627713995\"},{\"id\":\"6028106062508\",\"name\":\"o0nqs\",\"account_id\":\"10152412627713995\"},{\"id\":\"6028106062308\",\"name\":\"U7w6l\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026999962908\",\"name\":\"4Jfb4\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026999962108\",\"name\":\"rpTpb\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026992784308\",\"name\":\"gIFm5\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026992783708\",\"name\":\"uyDye\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026992783508\",\"name\":\"uc5pd\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026992781908\",\"name\":\"e5crn\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026992781308\",\"name\":\"lfHIc\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026992781108\",\"name\":\"3CNCq\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026287412308\",\"name\":\"yOnXI\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026287411908\",\"name\":\"vkIbP\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026287411108\",\"name\":\"M06Gq\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026287409908\",\"name\":\"Rsyee\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026287409108\",\"name\":\"ZToHw\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026287408508\",\"name\":\"iSb9l\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzMDg5OTg1MDcwOAZDZD\",\"after\":\"NjAyNjI4NzQwODUwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAyNjI4NzQwODUwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&before=NjAzMDg5OTg1MDcwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAzNjMxMDE5NTEwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6036310194508\",\"name\":\"mUbmY\",\"account_id\":\"10152412627713995\"},{\"id\":\"6036310193308\",\"name\":\"phsNS\",\"account_id\":\"10152412627713995\"},{\"id\":\"6036310192508\",\"name\":\"Rx41z\",\"account_id\":\"10152412627713995\"},{\"id\":\"6035030430708\",\"name\":\"M8kmP\",\"account_id\":\"10152412627713995\"},{\"id\":\"6035030428908\",\"name\":\"vpE52\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034803787508\",\"name\":\"YsCCj\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034803786708\",\"name\":\"grFez\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034803645708\",\"name\":\"D7GGJ\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034803645508\",\"name\":\"ESHoi\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034087418908\",\"name\":\"FTJNg\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034087417908\",\"name\":\"rmriT\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034087416908\",\"name\":\"dYTYM\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034087416708\",\"name\":\"PsSPS\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034087416508\",\"name\":\"MxHLP\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034087416108\",\"name\":\"YtetE\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032883803308\",\"name\":\"yvvJM\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032597925508\",\"name\":\"YhPQI\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032597924508\",\"name\":\"vF6ly\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032597923708\",\"name\":\"FDnrv\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032597923508\",\"name\":\"Cd3wz\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032597923108\",\"name\":\"YOrpl\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032597922908\",\"name\":\"SDPZG\",\"account_id\":\"10152412627713995\"},{\"id\":\"6031426193508\",\"name\":\"qC0LY\",\"account_id\":\"10152412627713995\"},{\"id\":\"6031426192908\",\"name\":\"aO1ge\",\"account_id\":\"10152412627713995\"},{\"id\":\"6030899850908\",\"name\":\"7ihmO\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNjMxMDE5NDUwOAZDZD\",\"after\":\"NjAzMDg5OTg1MDkwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAzMDg5OTg1MDkwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&before=NjAzNjMxMDE5NDUwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjA0MDc0MDI3ODcwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6040739719108\",\"name\":\"DsqTH\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040739718908\",\"name\":\"me1vb\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040739718708\",\"name\":\"IXE5p\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040739717108\",\"name\":\"1sel3\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040739381508\",\"name\":\"Ul6aL\",\"account_id\":\"10152412627713995\"},{\"id\":\"6039331673508\",\"name\":\"ulP4n\",\"account_id\":\"10152412627713995\"},{\"id\":\"6039331672708\",\"name\":\"I4rRE\",\"account_id\":\"10152412627713995\"},{\"id\":\"6039331671908\",\"name\":\"GUnv7\",\"account_id\":\"10152412627713995\"},{\"id\":\"6039331671708\",\"name\":\"OI5RE\",\"account_id\":\"10152412627713995\"},{\"id\":\"6039331670308\",\"name\":\"iptIa\",\"account_id\":\"10152412627713995\"},{\"id\":\"6039331669708\",\"name\":\"jFlux\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037797572108\",\"name\":\"8inzZ\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037797571708\",\"name\":\"6cHYb\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037797043108\",\"name\":\"iszhE\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037797042908\",\"name\":\"wd4cC\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037795800308\",\"name\":\"yGJ36\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037764907508\",\"name\":\"8QPKq\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037764906508\",\"name\":\"6jtrF\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037764905708\",\"name\":\"vtLs7\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037764905508\",\"name\":\"cTCMK\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037764903508\",\"name\":\"tbxmF\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037764902908\",\"name\":\"Q7pHX\",\"account_id\":\"10152412627713995\"},{\"id\":\"6036310196908\",\"name\":\"PhkE9\",\"account_id\":\"10152412627713995\"},{\"id\":\"6036310195708\",\"name\":\"k0vWt\",\"account_id\":\"10152412627713995\"},{\"id\":\"6036310195108\",\"name\":\"yvG7p\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0MDczOTcxOTEwOAZDZD\",\"after\":\"NjAzNjMxMDE5NTEwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAzNjMxMDE5NTEwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&before=NjA0MDczOTcxOTEwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjA0NDMxNTczMjMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6044315732108\",\"name\":\"EviP5\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315731908\",\"name\":\"cMTHD\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315731708\",\"name\":\"or6q8\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315731508\",\"name\":\"XUpxQ\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315731308\",\"name\":\"sOWHu\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315731108\",\"name\":\"7Xh0z\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315730908\",\"name\":\"dI2Yb\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315730708\",\"name\":\"VpIDv\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042601725908\",\"name\":\"cbkEf\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042601725708\",\"name\":\"2Ut4v\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042601725508\",\"name\":\"ldYff\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042601725308\",\"name\":\"je10L\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042213730708\",\"name\":\"OQjcX\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042213730508\",\"name\":\"F8rMm\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042191852508\",\"name\":\"bGff0\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042191852308\",\"name\":\"o59zn\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042191852108\",\"name\":\"J7Siw\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042191851908\",\"name\":\"zuCHX\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042191851708\",\"name\":\"LPGnt\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042191851508\",\"name\":\"IWGS6\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042191851308\",\"name\":\"fh1cO\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042191851108\",\"name\":\"7jbcZ\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040740929908\",\"name\":\"HitQt\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040740278908\",\"name\":\"2lmFI\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040740278708\",\"name\":\"fpmQy\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NDMxNTczMjEwOAZDZD\",\"after\":\"NjA0MDc0MDI3ODcwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjA0MDc0MDI3ODcwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&before=NjA0NDMxNTczMjEwOAZDZD\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v2.9/adsets",
 :as :json,
 :query-params
 {:path "adsets",
  :fields "id,name,account_id",
  :ids "act_10152412627713995",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:status 200,
 :body
 "{\"act_10152412627713995\":{\"data\":[{\"id\":\"6052149268508\",\"name\":\"vh9XX\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130291708\",\"name\":\"ft6Sb\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130291508\",\"name\":\"9pyEN\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130291308\",\"name\":\"dsCBW\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130291108\",\"name\":\"9QxN4\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130290908\",\"name\":\"HQsPO\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130290708\",\"name\":\"4uyo3\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130290508\",\"name\":\"hN0IN\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130284508\",\"name\":\"tGmrx\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130283908\",\"name\":\"qaayr\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816616908\",\"name\":\"SH7jM\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816616708\",\"name\":\"NbiRB\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816616508\",\"name\":\"sLLr1\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816616308\",\"name\":\"g0ZJS\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816616108\",\"name\":\"e5IK3\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816615908\",\"name\":\"eekc8\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816615708\",\"name\":\"TUBEg\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816615508\",\"name\":\"MBykG\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816615308\",\"name\":\"SVjUv\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315733308\",\"name\":\"PoRwx\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315733108\",\"name\":\"T4zyT\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315732908\",\"name\":\"fRyxl\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315732708\",\"name\":\"hekty\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315732508\",\"name\":\"OkDEe\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315732308\",\"name\":\"fjOP8\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1MjE0OTI2ODUwOAZDZD\",\"after\":\"NjA0NDMxNTczMjMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/adsets?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjA0NDMxNTczMjMwOAZDZD\"}}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/campaigns?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAyMzExMDA1MDkwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6022227532708\",\"name\":\"nC8pw\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021704237308\",\"name\":\"rw0TB\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021618797908\",\"name\":\"eiMuF\",\"account_id\":\"10152412627713995\"},{\"id\":\"6021430990308\",\"name\":\"pay1H\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020764641508\",\"name\":\"Xw0YP\",\"account_id\":\"10152412627713995\"},{\"id\":\"6020012167508\",\"name\":\"TuLKl\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019982771708\",\"name\":\"RqiZ8\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019982601108\",\"name\":\"covB4\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019363983508\",\"name\":\"QELGH\",\"account_id\":\"10152412627713995\"},{\"id\":\"6019173393708\",\"name\":\"oGkEu\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018300843908\",\"name\":\"XwYPZ\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018300843708\",\"name\":\"hvWzD\",\"account_id\":\"10152412627713995\"},{\"id\":\"6018062854308\",\"name\":\"8Gj7i\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMjIyNzUzMjcwOAZDZD\",\"after\":\"NjAxODA2Mjg1NDMwOAZDZD\"},\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/campaigns?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&before=NjAyMjIyNzUzMjcwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/campaigns?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAzNDA4NzQwNjcwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6034087406508\",\"name\":\"auoGJ\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034087406308\",\"name\":\"cXdGL\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034087406108\",\"name\":\"vT2Kf\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032883801708\",\"name\":\"PV01o\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032597916508\",\"name\":\"ntQVj\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032597916308\",\"name\":\"3ynst\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032597916108\",\"name\":\"PKp9t\",\"account_id\":\"10152412627713995\"},{\"id\":\"6032597915908\",\"name\":\"nczg6\",\"account_id\":\"10152412627713995\"},{\"id\":\"6031426189108\",\"name\":\"QhtfU\",\"account_id\":\"10152412627713995\"},{\"id\":\"6031426188908\",\"name\":\"uOYg4\",\"account_id\":\"10152412627713995\"},{\"id\":\"6030899843708\",\"name\":\"jU043\",\"account_id\":\"10152412627713995\"},{\"id\":\"6030899843508\",\"name\":\"9CmVC\",\"account_id\":\"10152412627713995\"},{\"id\":\"6029050661908\",\"name\":\"LpEbN\",\"account_id\":\"10152412627713995\"},{\"id\":\"6029050661508\",\"name\":\"YKB5o\",\"account_id\":\"10152412627713995\"},{\"id\":\"6028106058108\",\"name\":\"9ISyt\",\"account_id\":\"10152412627713995\"},{\"id\":\"6028106057908\",\"name\":\"XbNoo\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026992779108\",\"name\":\"OoLHu\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026992252308\",\"name\":\"McnqL\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026287405508\",\"name\":\"Wh6jH\",\"account_id\":\"10152412627713995\"},{\"id\":\"6026287405308\",\"name\":\"WCR5z\",\"account_id\":\"10152412627713995\"},{\"id\":\"6025523608508\",\"name\":\"blxHI\",\"account_id\":\"10152412627713995\"},{\"id\":\"6025342736908\",\"name\":\"5mHlc\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023987405708\",\"name\":\"fDNUQ\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023987405508\",\"name\":\"DvoMQ\",\"account_id\":\"10152412627713995\"},{\"id\":\"6023110050908\",\"name\":\"T0CUW\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNDA4NzQwNjUwOAZDZD\",\"after\":\"NjAyMzExMDA1MDkwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/campaigns?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAyMzExMDA1MDkwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/campaigns?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&before=NjAzNDA4NzQwNjUwOAZDZD\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v2.9/campaigns",
 :as :json,
 :query-params
 {:path "campaigns",
  :fields "id,name,account_id",
  :ids "act_10152412627713995",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:status 200,
 :body
 "{\"act_10152412627713995\":{\"data\":[{\"id\":\"6052149267708\",\"name\":\"zpZri\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130283708\",\"name\":\"6EUEL\",\"account_id\":\"10152412627713995\"},{\"id\":\"6049130283508\",\"name\":\"wRoPk\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816614508\",\"name\":\"OvvPv\",\"account_id\":\"10152412627713995\"},{\"id\":\"6046816614308\",\"name\":\"CKsXC\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315729508\",\"name\":\"oex08\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315729308\",\"name\":\"ZrlnR\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315729108\",\"name\":\"JWsNS\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315728908\",\"name\":\"YsQpP\",\"account_id\":\"10152412627713995\"},{\"id\":\"6044315728708\",\"name\":\"jOwZ2\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042601724708\",\"name\":\"S5kYi\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042601724508\",\"name\":\"yHEZ7\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042213729908\",\"name\":\"In4VK\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042213729708\",\"name\":\"poKK7\",\"account_id\":\"10152412627713995\"},{\"id\":\"6042191850708\",\"name\":\"cyHKO\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040740278108\",\"name\":\"VsXdg\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040740277908\",\"name\":\"xikYt\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040739716108\",\"name\":\"t2d96\",\"account_id\":\"10152412627713995\"},{\"id\":\"6040739715908\",\"name\":\"pLL8f\",\"account_id\":\"10152412627713995\"},{\"id\":\"6039331667708\",\"name\":\"v6PMg\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037795175108\",\"name\":\"pMeRv\",\"account_id\":\"10152412627713995\"},{\"id\":\"6037764899108\",\"name\":\"21ctp\",\"account_id\":\"10152412627713995\"},{\"id\":\"6036310188308\",\"name\":\"o5rDt\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034803642708\",\"name\":\"83URP\",\"account_id\":\"10152412627713995\"},{\"id\":\"6034087406708\",\"name\":\"3wNMU\",\"account_id\":\"10152412627713995\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1MjE0OTI2NzcwOAZDZD\",\"after\":\"NjAzNDA4NzQwNjcwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/campaigns?access_token=XXTOKENXX&fields=id%2Cname%2Caccount_id&since&until&limit=25&after=NjAzNDA4NzQwNjcwOAZDZD\"}}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAxODA2Mjg5NDEwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6018062889108\",\"name\":\"dbQzH\",\"adset_id\":\"6018062856708\"},{\"id\":\"6018062893108\",\"name\":\"7Lbos\",\"adset_id\":\"6018062856108\"},{\"id\":\"6018062892908\",\"name\":\"gSBRw\",\"adset_id\":\"6018062856108\"},{\"id\":\"6018062871708\",\"name\":\"f36Pu\",\"adset_id\":\"6018062856708\"},{\"id\":\"6018062892708\",\"name\":\"6J30o\",\"adset_id\":\"6018062856508\"},{\"id\":\"6018062872108\",\"name\":\"awcDg\",\"adset_id\":\"6018062856308\"},{\"id\":\"6018062870908\",\"name\":\"L3oE1\",\"adset_id\":\"6018062856108\"},{\"id\":\"6018062888908\",\"name\":\"tVdpz\",\"adset_id\":\"6018062856708\"},{\"id\":\"6018062869108\",\"name\":\"8Bant\",\"adset_id\":\"6018062856508\"},{\"id\":\"6018062870708\",\"name\":\"JHPrt\",\"adset_id\":\"6018062856708\"},{\"id\":\"6018062871108\",\"name\":\"GXntd\",\"adset_id\":\"6018062856308\"},{\"id\":\"6018062889508\",\"name\":\"ne5Xv\",\"adset_id\":\"6018062856308\"},{\"id\":\"6018062871308\",\"name\":\"tjmOO\",\"adset_id\":\"6018062856508\"}],\"paging\":{\"cursors\":{\"before\":\"NjAxODA2Mjg4OTEwOAZDZD\",\"after\":\"NjAxODA2Mjg3MTMwOAZDZD\"},\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAxODA2Mjg4OTEwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAxOTE3MzQwOTcwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6019173408108\",\"name\":\"I8P3d\",\"adset_id\":\"6019173396508\"},{\"id\":\"6019173405108\",\"name\":\"wN5wz\",\"adset_id\":\"6019173396508\"},{\"id\":\"6019173404908\",\"name\":\"KosJT\",\"adset_id\":\"6019173396508\"},{\"id\":\"6019173409508\",\"name\":\"QPWFl\",\"adset_id\":\"6019173396908\"},{\"id\":\"6019173421508\",\"name\":\"B7ZxJ\",\"adset_id\":\"6019173394508\"},{\"id\":\"6019173407508\",\"name\":\"zv9qj\",\"adset_id\":\"6019173396908\"},{\"id\":\"6019173428708\",\"name\":\"THPuu\",\"adset_id\":\"6019173396708\"},{\"id\":\"6019173428908\",\"name\":\"YiIF4\",\"adset_id\":\"6019173396708\"},{\"id\":\"6019173407708\",\"name\":\"klwJ2\",\"adset_id\":\"6019173396908\"},{\"id\":\"6019173405308\",\"name\":\"esl6P\",\"adset_id\":\"6019173396508\"},{\"id\":\"6018869680108\",\"name\":\"pCfLX\",\"adset_id\":\"6018869672908\"},{\"id\":\"6018869683908\",\"name\":\"noV49\",\"adset_id\":\"6018869670708\"},{\"id\":\"6018869680508\",\"name\":\"2BLdq\",\"adset_id\":\"6018869673308\"},{\"id\":\"6018869682708\",\"name\":\"y3wsl\",\"adset_id\":\"6018869670908\"},{\"id\":\"6018869679508\",\"name\":\"LdBZr\",\"adset_id\":\"6018869672708\"},{\"id\":\"6018869679308\",\"name\":\"sh0Cn\",\"adset_id\":\"6018869673108\"},{\"id\":\"6018395910908\",\"name\":\"Vq2CN\",\"adset_id\":\"6018395907908\"},{\"id\":\"6018395910508\",\"name\":\"6SPvR\",\"adset_id\":\"6018395907708\"},{\"id\":\"6018395909508\",\"name\":\"kaeui\",\"adset_id\":\"6018395907508\"},{\"id\":\"6018300848308\",\"name\":\"oED95\",\"adset_id\":\"6018300845508\"},{\"id\":\"6018300849108\",\"name\":\"vQqzn\",\"adset_id\":\"6018300845708\"},{\"id\":\"6018300848508\",\"name\":\"W8F50\",\"adset_id\":\"6018300845308\"},{\"id\":\"6018062871908\",\"name\":\"LnL9S\",\"adset_id\":\"6018062856308\"},{\"id\":\"6018062889708\",\"name\":\"42c7e\",\"adset_id\":\"6018062856508\"},{\"id\":\"6018062894108\",\"name\":\"vG0i3\",\"adset_id\":\"6018062856108\"}],\"paging\":{\"cursors\":{\"before\":\"NjAxOTE3MzQwODEwOAZDZD\",\"after\":\"NjAxODA2Mjg5NDEwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAxODA2Mjg5NDEwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAxOTE3MzQwODEwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAxOTM2Mzk5MjkwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6019363992508\",\"name\":\"1BmKI\",\"adset_id\":\"6019363988308\"},{\"id\":\"6019363993108\",\"name\":\"q4JBg\",\"adset_id\":\"6019363988508\"},{\"id\":\"6019363993308\",\"name\":\"Fzau0\",\"adset_id\":\"6019363986108\"},{\"id\":\"6018300903508\",\"name\":\"HKRhL\",\"adset_id\":\"6018300891508\"},{\"id\":\"6018300895508\",\"name\":\"tlsRw\",\"adset_id\":\"6018300893108\"},{\"id\":\"6018300914708\",\"name\":\"joES9\",\"adset_id\":\"6018300893308\"},{\"id\":\"6018300916508\",\"name\":\"cUPRP\",\"adset_id\":\"6018300893308\"},{\"id\":\"6018300895108\",\"name\":\"9kXiQ\",\"adset_id\":\"6018300893108\"},{\"id\":\"6018300904308\",\"name\":\"Z4en3\",\"adset_id\":\"6018300891508\"},{\"id\":\"6018300914108\",\"name\":\"LHTal\",\"adset_id\":\"6018300893308\"},{\"id\":\"6018300903708\",\"name\":\"CL0LB\",\"adset_id\":\"6018300891508\"},{\"id\":\"6018300894108\",\"name\":\"zfK6v\",\"adset_id\":\"6018300893108\"},{\"id\":\"6018300913908\",\"name\":\"WX8fk\",\"adset_id\":\"6018300893308\"},{\"id\":\"6018300915108\",\"name\":\"XMjco\",\"adset_id\":\"6018300892908\"},{\"id\":\"6018300903908\",\"name\":\"rRBfL\",\"adset_id\":\"6018300891508\"},{\"id\":\"6018300916308\",\"name\":\"2CSY5\",\"adset_id\":\"6018300892908\"},{\"id\":\"6018300894708\",\"name\":\"pawbI\",\"adset_id\":\"6018300893108\"},{\"id\":\"6018300916108\",\"name\":\"sbUdx\",\"adset_id\":\"6018300892908\"},{\"id\":\"6018300914908\",\"name\":\"kzre5\",\"adset_id\":\"6018300892908\"},{\"id\":\"6019173407108\",\"name\":\"g3cOp\",\"adset_id\":\"6019173394508\"},{\"id\":\"6019173422108\",\"name\":\"uNTTx\",\"adset_id\":\"6019173394508\"},{\"id\":\"6019173417308\",\"name\":\"sbCQu\",\"adset_id\":\"6019173396708\"},{\"id\":\"6019173421708\",\"name\":\"d9HW3\",\"adset_id\":\"6019173394508\"},{\"id\":\"6019173417508\",\"name\":\"IbK6j\",\"adset_id\":\"6019173396708\"},{\"id\":\"6019173409708\",\"name\":\"3e5YP\",\"adset_id\":\"6019173396908\"}],\"paging\":{\"cursors\":{\"before\":\"NjAxOTM2Mzk5MjUwOAZDZD\",\"after\":\"NjAxOTE3MzQwOTcwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAxOTE3MzQwOTcwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAxOTM2Mzk5MjUwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAxOTk4Mjc3NzMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6019982803108\",\"name\":\"uKiUw\",\"adset_id\":\"6019982775308\"},{\"id\":\"6019982603508\",\"name\":\"qqdi3\",\"adset_id\":\"6019982602508\"},{\"id\":\"6019982803308\",\"name\":\"KrRva\",\"adset_id\":\"6019982775308\"},{\"id\":\"6019982776508\",\"name\":\"htud6\",\"adset_id\":\"6019982772908\"},{\"id\":\"6019982789708\",\"name\":\"a0wI8\",\"adset_id\":\"6019982774908\"},{\"id\":\"6019982795308\",\"name\":\"OmQfI\",\"adset_id\":\"6019982775308\"},{\"id\":\"6019982787308\",\"name\":\"rEmQh\",\"adset_id\":\"6019982774908\"},{\"id\":\"6019982778508\",\"name\":\"QRnYD\",\"adset_id\":\"6019982772908\"},{\"id\":\"6019982776908\",\"name\":\"02Q02\",\"adset_id\":\"6019982775108\"},{\"id\":\"6019982788508\",\"name\":\"N1DN3\",\"adset_id\":\"6019982775108\"},{\"id\":\"6019833860908\",\"name\":\"mFCTP\",\"adset_id\":\"6019833858908\"},{\"id\":\"6019833860708\",\"name\":\"VxyEw\",\"adset_id\":\"6019833857708\"},{\"id\":\"6019833861108\",\"name\":\"LlgIQ\",\"adset_id\":\"6019833859308\"},{\"id\":\"6019739767508\",\"name\":\"nlWqo\",\"adset_id\":\"6019739763908\"},{\"id\":\"6019739768708\",\"name\":\"OKdg8\",\"adset_id\":\"6019739764908\"},{\"id\":\"6019739767708\",\"name\":\"vG6yo\",\"adset_id\":\"6019739765108\"},{\"id\":\"6019736574108\",\"name\":\"t4tmk\",\"adset_id\":\"6019736570308\"},{\"id\":\"6019736573908\",\"name\":\"G6el9\",\"adset_id\":\"6019736571908\"},{\"id\":\"6019736574308\",\"name\":\"nLlIC\",\"adset_id\":\"6019736571708\"},{\"id\":\"6019650567908\",\"name\":\"b2otM\",\"adset_id\":\"6019650564708\"},{\"id\":\"6019650567508\",\"name\":\"eEZ5P\",\"adset_id\":\"6019650564908\"},{\"id\":\"6019650567708\",\"name\":\"7FZuG\",\"adset_id\":\"6019650563308\"},{\"id\":\"6019363992308\",\"name\":\"cppJg\",\"adset_id\":\"6019363987908\"},{\"id\":\"6019363992708\",\"name\":\"wBXJ6\",\"adset_id\":\"6019363988108\"},{\"id\":\"6019363992908\",\"name\":\"iZe0C\",\"adset_id\":\"6019363984708\"}],\"paging\":{\"cursors\":{\"before\":\"NjAxOTk4MjgwMzEwOAZDZD\",\"after\":\"NjAxOTM2Mzk5MjkwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAxOTM2Mzk5MjkwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAxOTk4MjgwMzEwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyMTY0MjEyMTEwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6021642116108\",\"name\":\"FiZVH\",\"adset_id\":\"6021618800108\"},{\"id\":\"6021642133308\",\"name\":\"pPdJB\",\"adset_id\":\"6021618800308\"},{\"id\":\"6021617813108\",\"name\":\"gPLse\",\"adset_id\":\"6021617811308\"},{\"id\":\"6021527357508\",\"name\":\"Dzfc9\",\"adset_id\":\"6021527352708\"},{\"id\":\"6021430992908\",\"name\":\"U8O5F\",\"adset_id\":\"6021430991108\"},{\"id\":\"6021065596708\",\"name\":\"L7jdp\",\"adset_id\":\"6021065595108\"},{\"id\":\"6020834991508\",\"name\":\"Sajrp\",\"adset_id\":\"6020834987908\"},{\"id\":\"6020779955508\",\"name\":\"5yGHt\",\"adset_id\":\"6020779953708\"},{\"id\":\"6020764695508\",\"name\":\"UUJaf\",\"adset_id\":\"6020764680708\"},{\"id\":\"6020525096108\",\"name\":\"TYNLc\",\"adset_id\":\"6020525094508\"},{\"id\":\"6020525771108\",\"name\":\"vDy7I\",\"adset_id\":\"6020525769508\"},{\"id\":\"6020374962708\",\"name\":\"3PfUC\",\"adset_id\":\"6020374960908\"},{\"id\":\"6020304750308\",\"name\":\"zUW0D\",\"adset_id\":\"6020304748108\"},{\"id\":\"6020176079708\",\"name\":\"jjQLg\",\"adset_id\":\"6020176077508\"},{\"id\":\"6020084753108\",\"name\":\"n9KPK\",\"adset_id\":\"6020084747308\"},{\"id\":\"6020084753308\",\"name\":\"T1kGZ\",\"adset_id\":\"6020084745308\"},{\"id\":\"6020084752908\",\"name\":\"tUqgY\",\"adset_id\":\"6020084746508\"},{\"id\":\"6020118446708\",\"name\":\"wqUv8\",\"adset_id\":\"6020118445108\"},{\"id\":\"6019982776308\",\"name\":\"o10Pr\",\"adset_id\":\"6019982772908\"},{\"id\":\"6019982776108\",\"name\":\"Qbct7\",\"adset_id\":\"6019982772908\"},{\"id\":\"6019982783908\",\"name\":\"eBILq\",\"adset_id\":\"6019982775308\"},{\"id\":\"6019982788308\",\"name\":\"voTBD\",\"adset_id\":\"6019982775108\"},{\"id\":\"6019982777108\",\"name\":\"7OulW\",\"adset_id\":\"6019982775108\"},{\"id\":\"6019982776708\",\"name\":\"gmfu5\",\"adset_id\":\"6019982774908\"},{\"id\":\"6019982777308\",\"name\":\"mniXg\",\"adset_id\":\"6019982774908\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMTY0MjExNjEwOAZDZD\",\"after\":\"NjAxOTk4Mjc3NzMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAxOTk4Mjc3NzMwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyMTY0MjExNjEwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyMTg2MjA0NjcwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6021703484108\",\"name\":\"BtfV1\",\"adset_id\":\"6021703482308\"},{\"id\":\"6021723127108\",\"name\":\"dLdZr\",\"adset_id\":\"6021704239708\"},{\"id\":\"6021723124708\",\"name\":\"f7Zw3\",\"adset_id\":\"6021704239708\"},{\"id\":\"6021704697708\",\"name\":\"0cpPE\",\"adset_id\":\"6021704239708\"},{\"id\":\"6021704697108\",\"name\":\"HBvrs\",\"adset_id\":\"6021704239708\"},{\"id\":\"6021704696908\",\"name\":\"eplPj\",\"adset_id\":\"6021704239708\"},{\"id\":\"6021704689508\",\"name\":\"cZzmh\",\"adset_id\":\"6021704239708\"},{\"id\":\"6021704687708\",\"name\":\"umlRG\",\"adset_id\":\"6021704238908\"},{\"id\":\"6021704679708\",\"name\":\"i9RmL\",\"adset_id\":\"6021704238908\"},{\"id\":\"6021704677708\",\"name\":\"SPdQX\",\"adset_id\":\"6021704238908\"},{\"id\":\"6021704692108\",\"name\":\"dUit2\",\"adset_id\":\"6021704239908\"},{\"id\":\"6021704678708\",\"name\":\"hBK5s\",\"adset_id\":\"6021704238908\"},{\"id\":\"6021704693308\",\"name\":\"d158E\",\"adset_id\":\"6021704239908\"},{\"id\":\"6021704702508\",\"name\":\"Iarhf\",\"adset_id\":\"6021704239908\"},{\"id\":\"6021704702108\",\"name\":\"K9QRq\",\"adset_id\":\"6021704239908\"},{\"id\":\"6021642126308\",\"name\":\"JiR9J\",\"adset_id\":\"6021618800308\"},{\"id\":\"6021642118508\",\"name\":\"GvD6M\",\"adset_id\":\"6021618799108\"},{\"id\":\"6021642116508\",\"name\":\"WcE2B\",\"adset_id\":\"6021618800108\"},{\"id\":\"6021642106908\",\"name\":\"9NNHs\",\"adset_id\":\"6021618799108\"},{\"id\":\"6021642106108\",\"name\":\"Wd5aO\",\"adset_id\":\"6021618799108\"},{\"id\":\"6021642115308\",\"name\":\"52cMv\",\"adset_id\":\"6021618800108\"},{\"id\":\"6021642123508\",\"name\":\"9NdKu\",\"adset_id\":\"6021618800308\"},{\"id\":\"6021642106508\",\"name\":\"g6j3z\",\"adset_id\":\"6021618799108\"},{\"id\":\"6021642116908\",\"name\":\"jdIpQ\",\"adset_id\":\"6021618800108\"},{\"id\":\"6021642121108\",\"name\":\"qvsWk\",\"adset_id\":\"6021618800308\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMTcwMzQ4NDEwOAZDZD\",\"after\":\"NjAyMTY0MjEyMTEwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyMTY0MjEyMTEwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyMTcwMzQ4NDEwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyMzk4NzUyMTkwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6023987520908\",\"name\":\"ep7Fe\",\"adset_id\":\"6023987412508\"},{\"id\":\"6023987486908\",\"name\":\"jYMpU\",\"adset_id\":\"6023987412108\"},{\"id\":\"6023987518708\",\"name\":\"P1O2r\",\"adset_id\":\"6023987412508\"},{\"id\":\"6023987458508\",\"name\":\"PDjQR\",\"adset_id\":\"6023987409308\"},{\"id\":\"6023987493508\",\"name\":\"UBV8p\",\"adset_id\":\"6023987410108\"},{\"id\":\"6023987429308\",\"name\":\"Cfl16\",\"adset_id\":\"6023987408708\"},{\"id\":\"6023987419508\",\"name\":\"hqjQH\",\"adset_id\":\"6023987408708\"},{\"id\":\"6023987533708\",\"name\":\"8FuX0\",\"adset_id\":\"6023987411908\"},{\"id\":\"6023987418708\",\"name\":\"gsqzO\",\"adset_id\":\"6023987408708\"},{\"id\":\"6023987510508\",\"name\":\"UWDKO\",\"adset_id\":\"6023987412108\"},{\"id\":\"6023987429508\",\"name\":\"CdU7X\",\"adset_id\":\"6023987408908\"},{\"id\":\"6023987493908\",\"name\":\"UopYK\",\"adset_id\":\"6023987410108\"},{\"id\":\"6023987429908\",\"name\":\"d7XN5\",\"adset_id\":\"6023987408708\"},{\"id\":\"6023987425908\",\"name\":\"fKihc\",\"adset_id\":\"6023987408708\"},{\"id\":\"6023170901908\",\"name\":\"PzcNQ\",\"adset_id\":\"6023170891308\"},{\"id\":\"6023170899108\",\"name\":\"ixQsz\",\"adset_id\":\"6023170890708\"},{\"id\":\"6023110054708\",\"name\":\"6pNyZ\",\"adset_id\":\"6023110052708\"},{\"id\":\"6022769067708\",\"name\":\"gNsdT\",\"adset_id\":\"6022769055908\"},{\"id\":\"6022769062508\",\"name\":\"BX9H2\",\"adset_id\":\"6022769056108\"},{\"id\":\"6022769071908\",\"name\":\"Z0KXX\",\"adset_id\":\"6022769056708\"},{\"id\":\"6022497476908\",\"name\":\"yUdiZ\",\"adset_id\":\"6022497475308\"},{\"id\":\"6022384461308\",\"name\":\"mir8c\",\"adset_id\":\"6022384455308\"},{\"id\":\"6022227539308\",\"name\":\"kGWLE\",\"adset_id\":\"6022227533708\"},{\"id\":\"6022099356108\",\"name\":\"EC1gZ\",\"adset_id\":\"6022099353908\"},{\"id\":\"6021862046708\",\"name\":\"XfIup\",\"adset_id\":\"6021862044508\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMzk4NzUyMDkwOAZDZD\",\"after\":\"NjAyMTg2MjA0NjcwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyMTg2MjA0NjcwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyMzk4NzUyMDkwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyMzk4NzQ0MzEwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6023987441308\",\"name\":\"aYSjh\",\"adset_id\":\"6023987408908\"},{\"id\":\"6023987454908\",\"name\":\"fRvtr\",\"adset_id\":\"6023987409308\"},{\"id\":\"6023987472908\",\"name\":\"cCq5C\",\"adset_id\":\"6023987409108\"},{\"id\":\"6023987488708\",\"name\":\"KNyaZ\",\"adset_id\":\"6023987412108\"},{\"id\":\"6023987458708\",\"name\":\"vfrzS\",\"adset_id\":\"6023987409108\"},{\"id\":\"6023987441108\",\"name\":\"Jz2f7\",\"adset_id\":\"6023987408908\"},{\"id\":\"6023987472508\",\"name\":\"dbZRs\",\"adset_id\":\"6023987409108\"},{\"id\":\"6023987472308\",\"name\":\"xst89\",\"adset_id\":\"6023987409108\"},{\"id\":\"6023987493708\",\"name\":\"1CZe7\",\"adset_id\":\"6023987410108\"},{\"id\":\"6023987461908\",\"name\":\"IoRS9\",\"adset_id\":\"6023987409108\"},{\"id\":\"6023987494108\",\"name\":\"nKy2s\",\"adset_id\":\"6023987410108\"},{\"id\":\"6023987441508\",\"name\":\"k75Lt\",\"adset_id\":\"6023987408908\"},{\"id\":\"6023987470308\",\"name\":\"jaZEC\",\"adset_id\":\"6023987409308\"},{\"id\":\"6023987470108\",\"name\":\"PHtIT\",\"adset_id\":\"6023987409308\"},{\"id\":\"6023987454108\",\"name\":\"nWaam\",\"adset_id\":\"6023987409308\"},{\"id\":\"6023987485508\",\"name\":\"8W15M\",\"adset_id\":\"6023987410108\"},{\"id\":\"6023987538508\",\"name\":\"8T1VS\",\"adset_id\":\"6023987412508\"},{\"id\":\"6023987518308\",\"name\":\"1omLU\",\"adset_id\":\"6023987412508\"},{\"id\":\"6023987510308\",\"name\":\"Pm1tj\",\"adset_id\":\"6023987412108\"},{\"id\":\"6023987538908\",\"name\":\"SPOPE\",\"adset_id\":\"6023987411908\"},{\"id\":\"6023987510108\",\"name\":\"4rZtv\",\"adset_id\":\"6023987412108\"},{\"id\":\"6023987538708\",\"name\":\"8mU61\",\"adset_id\":\"6023987411908\"},{\"id\":\"6023987537308\",\"name\":\"JB9pp\",\"adset_id\":\"6023987411908\"},{\"id\":\"6023987533908\",\"name\":\"2sLqX\",\"adset_id\":\"6023987411908\"},{\"id\":\"6023987521908\",\"name\":\"j1kEj\",\"adset_id\":\"6023987412508\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMzk4NzQ0MTMwOAZDZD\",\"after\":\"NjAyMzk4NzUyMTkwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyMzk4NzUyMTkwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyMzk4NzQ0MTMwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNTM0Mjc3NjcwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6025342788108\",\"name\":\"lDxd6\",\"adset_id\":\"6025342742908\"},{\"id\":\"6025342774108\",\"name\":\"vb4Zh\",\"adset_id\":\"6025342742708\"},{\"id\":\"6025342762908\",\"name\":\"BdLpO\",\"adset_id\":\"6025342742708\"},{\"id\":\"6025342789108\",\"name\":\"7OEs8\",\"adset_id\":\"6025342743708\"},{\"id\":\"6025342762308\",\"name\":\"NyYmK\",\"adset_id\":\"6025342742708\"},{\"id\":\"6025342800908\",\"name\":\"T7beL\",\"adset_id\":\"6025342742908\"},{\"id\":\"6025342777908\",\"name\":\"BUuil\",\"adset_id\":\"6025342742908\"},{\"id\":\"6025342768708\",\"name\":\"FKMGc\",\"adset_id\":\"6025342742908\"},{\"id\":\"6025342778908\",\"name\":\"x7dG9\",\"adset_id\":\"6025342743708\"},{\"id\":\"6025342768108\",\"name\":\"GMJkz\",\"adset_id\":\"6025342742708\"},{\"id\":\"6025342767108\",\"name\":\"885co\",\"adset_id\":\"6025342742708\"},{\"id\":\"6025342761508\",\"name\":\"wiyIc\",\"adset_id\":\"6025342743108\"},{\"id\":\"6025342783308\",\"name\":\"lKC3N\",\"adset_id\":\"6025342743108\"},{\"id\":\"6025342805908\",\"name\":\"x7Tsf\",\"adset_id\":\"6025342743708\"},{\"id\":\"6025342779108\",\"name\":\"Tuzky\",\"adset_id\":\"6025342742908\"},{\"id\":\"6025342775308\",\"name\":\"7114e\",\"adset_id\":\"6025342743108\"},{\"id\":\"6023987489308\",\"name\":\"96ysG\",\"adset_id\":\"6023987410108\"},{\"id\":\"6023987511508\",\"name\":\"dlTNg\",\"adset_id\":\"6023987412108\"},{\"id\":\"6023987429708\",\"name\":\"pvgBy\",\"adset_id\":\"6023987408708\"},{\"id\":\"6023987420308\",\"name\":\"XOlbx\",\"adset_id\":\"6023987408908\"},{\"id\":\"6023987538308\",\"name\":\"pGKum\",\"adset_id\":\"6023987412508\"},{\"id\":\"6023987533508\",\"name\":\"BHebB\",\"adset_id\":\"6023987411908\"},{\"id\":\"6023987458908\",\"name\":\"yn0JB\",\"adset_id\":\"6023987409308\"},{\"id\":\"6023987456508\",\"name\":\"FpDMV\",\"adset_id\":\"6023987409108\"},{\"id\":\"6023987443108\",\"name\":\"xcVW2\",\"adset_id\":\"6023987408908\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNTM0Mjc4ODEwOAZDZD\",\"after\":\"NjAyMzk4NzQ0MzEwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyMzk4NzQ0MzEwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyNTM0Mjc4ODEwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNTUyMzYxODMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6025523677308\",\"name\":\"1dOee\",\"adset_id\":\"6025523612708\"},{\"id\":\"6025523650508\",\"name\":\"pGDL5\",\"adset_id\":\"6025523611508\"},{\"id\":\"6025523660308\",\"name\":\"Pjpfr\",\"adset_id\":\"6025523612708\"},{\"id\":\"6025523667108\",\"name\":\"bddh2\",\"adset_id\":\"6025523612708\"},{\"id\":\"6025523656508\",\"name\":\"FJwMw\",\"adset_id\":\"6025523612708\"},{\"id\":\"6025523642708\",\"name\":\"Yjvl5\",\"adset_id\":\"6025523611508\"},{\"id\":\"6025523668708\",\"name\":\"7GIY6\",\"adset_id\":\"6025523611108\"},{\"id\":\"6025523648108\",\"name\":\"2KsUM\",\"adset_id\":\"6025523611508\"},{\"id\":\"6025523631908\",\"name\":\"WJdw0\",\"adset_id\":\"6025523612308\"},{\"id\":\"6025523620108\",\"name\":\"LyQ4T\",\"adset_id\":\"6025523611108\"},{\"id\":\"6025523627708\",\"name\":\"ELtk3\",\"adset_id\":\"6025523612308\"},{\"id\":\"6025523616908\",\"name\":\"2dtZJ\",\"adset_id\":\"6025523611108\"},{\"id\":\"6025523653508\",\"name\":\"6pUk4\",\"adset_id\":\"6025523611508\"},{\"id\":\"6025523639108\",\"name\":\"JMLPN\",\"adset_id\":\"6025523612308\"},{\"id\":\"6025523653308\",\"name\":\"S8hZa\",\"adset_id\":\"6025523612708\"},{\"id\":\"6025523647108\",\"name\":\"2jaPz\",\"adset_id\":\"6025523611508\"},{\"id\":\"6025523634308\",\"name\":\"QVNo2\",\"adset_id\":\"6025523612308\"},{\"id\":\"6025342800708\",\"name\":\"YBoTq\",\"adset_id\":\"6025342742908\"},{\"id\":\"6025342765708\",\"name\":\"ulVJY\",\"adset_id\":\"6025342743108\"},{\"id\":\"6025342794908\",\"name\":\"5hl0e\",\"adset_id\":\"6025342743708\"},{\"id\":\"6025342784908\",\"name\":\"wz4UX\",\"adset_id\":\"6025342743108\"},{\"id\":\"6025342784108\",\"name\":\"s3xJX\",\"adset_id\":\"6025342742708\"},{\"id\":\"6025342811108\",\"name\":\"ucNxD\",\"adset_id\":\"6025342743708\"},{\"id\":\"6025342786308\",\"name\":\"r5n52\",\"adset_id\":\"6025342743708\"},{\"id\":\"6025342776708\",\"name\":\"liV2F\",\"adset_id\":\"6025342743108\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNTUyMzY3NzMwOAZDZD\",\"after\":\"NjAyNTM0Mjc3NjcwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNTM0Mjc3NjcwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyNTUyMzY3NzMwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNjI4NzUxNTUwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6026287499708\",\"name\":\"31v0S\",\"adset_id\":\"6026287408108\"},{\"id\":\"6026287469908\",\"name\":\"rKI5s\",\"adset_id\":\"6026287408508\"},{\"id\":\"6026287549908\",\"name\":\"GXWjq\",\"adset_id\":\"6026287411908\"},{\"id\":\"6026287473908\",\"name\":\"78lyD\",\"adset_id\":\"6026287408508\"},{\"id\":\"6026287546308\",\"name\":\"4gjkK\",\"adset_id\":\"6026287411908\"},{\"id\":\"6026287505908\",\"name\":\"zYe4L\",\"adset_id\":\"6026287411108\"},{\"id\":\"6026287550308\",\"name\":\"Td958\",\"adset_id\":\"6026287411908\"},{\"id\":\"6026287494908\",\"name\":\"19u8x\",\"adset_id\":\"6026287408108\"},{\"id\":\"6026287426708\",\"name\":\"4f0X2\",\"adset_id\":\"6026287409908\"},{\"id\":\"6026287525308\",\"name\":\"HDlc2\",\"adset_id\":\"6026287412308\"},{\"id\":\"6026287435908\",\"name\":\"IaX92\",\"adset_id\":\"6026287409108\"},{\"id\":\"6026287421308\",\"name\":\"KSvqW\",\"adset_id\":\"6026287408308\"},{\"id\":\"6026287447108\",\"name\":\"TY7XM\",\"adset_id\":\"6026287408308\"},{\"id\":\"6026287531508\",\"name\":\"qm7dK\",\"adset_id\":\"6026287412308\"},{\"id\":\"6026287435708\",\"name\":\"ksY0g\",\"adset_id\":\"6026287409108\"},{\"id\":\"6026287495108\",\"name\":\"Dba35\",\"adset_id\":\"6026287408108\"},{\"id\":\"6026287514508\",\"name\":\"6rq3s\",\"adset_id\":\"6026287411108\"},{\"id\":\"6026287437508\",\"name\":\"mNrPZ\",\"adset_id\":\"6026287408308\"},{\"id\":\"6025523677508\",\"name\":\"1cnxj\",\"adset_id\":\"6025523612708\"},{\"id\":\"6025523654508\",\"name\":\"zn3KU\",\"adset_id\":\"6025523611508\"},{\"id\":\"6025523634908\",\"name\":\"88Euw\",\"adset_id\":\"6025523612308\"},{\"id\":\"6025523617308\",\"name\":\"YRLXP\",\"adset_id\":\"6025523612308\"},{\"id\":\"6025523659708\",\"name\":\"gWQWN\",\"adset_id\":\"6025523611108\"},{\"id\":\"6025523620308\",\"name\":\"3hMRY\",\"adset_id\":\"6025523611108\"},{\"id\":\"6025523618308\",\"name\":\"iY32T\",\"adset_id\":\"6025523611108\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNjI4NzQ5OTcwOAZDZD\",\"after\":\"NjAyNTUyMzYxODMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNTUyMzYxODMwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyNjI4NzQ5OTcwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNjI4NzUyNTUwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6026287472308\",\"name\":\"lg3uD\",\"adset_id\":\"6026287408508\"},{\"id\":\"6026287480308\",\"name\":\"aTEit\",\"adset_id\":\"6026287408508\"},{\"id\":\"6026287461908\",\"name\":\"kErHO\",\"adset_id\":\"6026287409908\"},{\"id\":\"6026287460908\",\"name\":\"Xl9Eq\",\"adset_id\":\"6026287409908\"},{\"id\":\"6026287477508\",\"name\":\"08abp\",\"adset_id\":\"6026287408508\"},{\"id\":\"6026287515708\",\"name\":\"aQwWU\",\"adset_id\":\"6026287411108\"},{\"id\":\"6026287539908\",\"name\":\"8s2XL\",\"adset_id\":\"6026287411908\"},{\"id\":\"6026287431108\",\"name\":\"OQEI6\",\"adset_id\":\"6026287408308\"},{\"id\":\"6026287513908\",\"name\":\"GxM6Q\",\"adset_id\":\"6026287411108\"},{\"id\":\"6026287422508\",\"name\":\"s54mJ\",\"adset_id\":\"6026287408308\"},{\"id\":\"6026287550108\",\"name\":\"L7uhW\",\"adset_id\":\"6026287411908\"},{\"id\":\"6026287438708\",\"name\":\"UwI1G\",\"adset_id\":\"6026287409108\"},{\"id\":\"6026287458308\",\"name\":\"aBqL2\",\"adset_id\":\"6026287409908\"},{\"id\":\"6026287473308\",\"name\":\"aM0wK\",\"adset_id\":\"6026287408508\"},{\"id\":\"6026287490108\",\"name\":\"m2kQq\",\"adset_id\":\"6026287408108\"},{\"id\":\"6026287502108\",\"name\":\"F0dkT\",\"adset_id\":\"6026287408108\"},{\"id\":\"6026287474708\",\"name\":\"jFCOT\",\"adset_id\":\"6026287409908\"},{\"id\":\"6026287540908\",\"name\":\"GhKdL\",\"adset_id\":\"6026287411908\"},{\"id\":\"6026287536708\",\"name\":\"Raq7g\",\"adset_id\":\"6026287412308\"},{\"id\":\"6026287453508\",\"name\":\"o6yhl\",\"adset_id\":\"6026287408308\"},{\"id\":\"6026287532708\",\"name\":\"9rWUn\",\"adset_id\":\"6026287412308\"},{\"id\":\"6026287460708\",\"name\":\"63fjj\",\"adset_id\":\"6026287409908\"},{\"id\":\"6026287436108\",\"name\":\"CLaBF\",\"adset_id\":\"6026287409108\"},{\"id\":\"6026287449508\",\"name\":\"Vj6m3\",\"adset_id\":\"6026287409108\"},{\"id\":\"6026287515508\",\"name\":\"8PHFX\",\"adset_id\":\"6026287411108\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNjI4NzQ3MjMwOAZDZD\",\"after\":\"NjAyNjI4NzUxNTUwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNjI4NzUxNTUwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyNjI4NzQ3MjMwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNjk5Mjk0OTUwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6026992925508\",\"name\":\"qPJqk\",\"adset_id\":\"6026992783508\"},{\"id\":\"6026992883708\",\"name\":\"lWlEc\",\"adset_id\":\"6026992783508\"},{\"id\":\"6026992939908\",\"name\":\"wkRV4\",\"adset_id\":\"6026992784308\"},{\"id\":\"6026992924108\",\"name\":\"PppHB\",\"adset_id\":\"6026992783508\"},{\"id\":\"6026992934908\",\"name\":\"q7oZC\",\"adset_id\":\"6026992784308\"},{\"id\":\"6026992957508\",\"name\":\"Z4PYM\",\"adset_id\":\"6026992783708\"},{\"id\":\"6026992923908\",\"name\":\"h95y2\",\"adset_id\":\"6026992783508\"},{\"id\":\"6026992878908\",\"name\":\"ENtw5\",\"adset_id\":\"6026992781108\"},{\"id\":\"6026992929308\",\"name\":\"OhkcL\",\"adset_id\":\"6026992783508\"},{\"id\":\"6026992934108\",\"name\":\"Xn0dZ\",\"adset_id\":\"6026992784308\"},{\"id\":\"6026992884708\",\"name\":\"XJPpC\",\"adset_id\":\"6026992781108\"},{\"id\":\"6026992874908\",\"name\":\"q9Mu0\",\"adset_id\":\"6026992781108\"},{\"id\":\"6026992951108\",\"name\":\"lH8sR\",\"adset_id\":\"6026992783708\"},{\"id\":\"6026992891708\",\"name\":\"tZsuY\",\"adset_id\":\"6026992781108\"},{\"id\":\"6026992955908\",\"name\":\"30xsz\",\"adset_id\":\"6026992783708\"},{\"id\":\"6026992949908\",\"name\":\"fMXBx\",\"adset_id\":\"6026992783708\"},{\"id\":\"6026992954708\",\"name\":\"qMHYm\",\"adset_id\":\"6026992783708\"},{\"id\":\"6026992875508\",\"name\":\"iaIzq\",\"adset_id\":\"6026992783508\"},{\"id\":\"6026992936308\",\"name\":\"jXQcy\",\"adset_id\":\"6026992784308\"},{\"id\":\"6026992894508\",\"name\":\"SUTP1\",\"adset_id\":\"6026992781108\"},{\"id\":\"6026287489508\",\"name\":\"L7peY\",\"adset_id\":\"6026287408108\"},{\"id\":\"6026287508508\",\"name\":\"LNtHp\",\"adset_id\":\"6026287411108\"},{\"id\":\"6026287525708\",\"name\":\"cYFQb\",\"adset_id\":\"6026287412308\"},{\"id\":\"6026287438508\",\"name\":\"FH3Nh\",\"adset_id\":\"6026287409108\"},{\"id\":\"6026287525508\",\"name\":\"lbpRt\",\"adset_id\":\"6026287412308\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNjk5MjkyNTUwOAZDZD\",\"after\":\"NjAyNjI4NzUyNTUwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNjI4NzUyNTUwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyNjk5MjkyNTUwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNjk5Mjg3OTUwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6026992873908\",\"name\":\"LComl\",\"adset_id\":\"6026992781308\"},{\"id\":\"6026992873708\",\"name\":\"TDn8L\",\"adset_id\":\"6026992781308\"},{\"id\":\"6026992869108\",\"name\":\"gxTqD\",\"adset_id\":\"6026992781308\"},{\"id\":\"6026992906108\",\"name\":\"paDxV\",\"adset_id\":\"6026992781908\"},{\"id\":\"6026992895708\",\"name\":\"ilpEZ\",\"adset_id\":\"6026992781908\"},{\"id\":\"6026992887708\",\"name\":\"yLbJi\",\"adset_id\":\"6026992781908\"},{\"id\":\"6026992887508\",\"name\":\"QY7zF\",\"adset_id\":\"6026992781908\"},{\"id\":\"6026992886908\",\"name\":\"YKjW8\",\"adset_id\":\"6026992781908\"},{\"id\":\"6026992873508\",\"name\":\"5mOKc\",\"adset_id\":\"6026992781908\"},{\"id\":\"6026999969308\",\"name\":\"VSo8k\",\"adset_id\":\"6026999962908\"},{\"id\":\"6026999972308\",\"name\":\"T4bsC\",\"adset_id\":\"6026999962908\"},{\"id\":\"6026999965508\",\"name\":\"7tObP\",\"adset_id\":\"6026999962908\"},{\"id\":\"6026999994708\",\"name\":\"miv4k\",\"adset_id\":\"6026999962108\"},{\"id\":\"6026999968108\",\"name\":\"DVIHt\",\"adset_id\":\"6026999962908\"},{\"id\":\"6026999984108\",\"name\":\"6PhCe\",\"adset_id\":\"6026999962108\"},{\"id\":\"6026999982108\",\"name\":\"7GPG4\",\"adset_id\":\"6026999962108\"},{\"id\":\"6026999967908\",\"name\":\"ToSV5\",\"adset_id\":\"6026999962908\"},{\"id\":\"6026999975908\",\"name\":\"U5PWs\",\"adset_id\":\"6026999962908\"},{\"id\":\"6026999989708\",\"name\":\"jKiJr\",\"adset_id\":\"6026999962108\"},{\"id\":\"6026999980308\",\"name\":\"2gafU\",\"adset_id\":\"6026999962108\"},{\"id\":\"6026999983508\",\"name\":\"7ufil\",\"adset_id\":\"6026999962108\"},{\"id\":\"6026992948708\",\"name\":\"o7WZ0\",\"adset_id\":\"6026992784308\"},{\"id\":\"6026992883308\",\"name\":\"UVDC7\",\"adset_id\":\"6026992781108\"},{\"id\":\"6026992948508\",\"name\":\"SR4nw\",\"adset_id\":\"6026992783708\"},{\"id\":\"6026992949508\",\"name\":\"csY61\",\"adset_id\":\"6026992784308\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNjk5Mjg3MzkwOAZDZD\",\"after\":\"NjAyNjk5Mjk0OTUwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNjk5Mjk0OTUwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyNjk5Mjg3MzkwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyODEwNjEwMjEwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6028106087908\",\"name\":\"ZYnbV\",\"adset_id\":\"6028106062908\"},{\"id\":\"6028106082108\",\"name\":\"S7yW2\",\"adset_id\":\"6028106062908\"},{\"id\":\"6028106081708\",\"name\":\"Lnznq\",\"adset_id\":\"6028106062908\"},{\"id\":\"6028106081108\",\"name\":\"h1pWc\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028106071308\",\"name\":\"P3Jpx\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028106069308\",\"name\":\"G6I0x\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028106069108\",\"name\":\"X9BzH\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028106094108\",\"name\":\"6LqaV\",\"adset_id\":\"6028106062908\"},{\"id\":\"6028106079708\",\"name\":\"1KDgq\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028106071108\",\"name\":\"KFKl4\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028106124708\",\"name\":\"4tr87\",\"adset_id\":\"6028106062708\"},{\"id\":\"6028106095108\",\"name\":\"bUkBF\",\"adset_id\":\"6028106062308\"},{\"id\":\"6028106089308\",\"name\":\"5NTnp\",\"adset_id\":\"6028106062708\"},{\"id\":\"6028106114508\",\"name\":\"6Qhd3\",\"adset_id\":\"6028106062308\"},{\"id\":\"6028106124508\",\"name\":\"OCd7V\",\"adset_id\":\"6028106062708\"},{\"id\":\"6028106124108\",\"name\":\"9vVYr\",\"adset_id\":\"6028106062708\"},{\"id\":\"6028106120308\",\"name\":\"JxNMf\",\"adset_id\":\"6028106062708\"},{\"id\":\"6028106118508\",\"name\":\"qoBUl\",\"adset_id\":\"6028106062308\"},{\"id\":\"6028106116108\",\"name\":\"xc0wj\",\"adset_id\":\"6028106062308\"},{\"id\":\"6028106098708\",\"name\":\"P9zIu\",\"adset_id\":\"6028106062308\"},{\"id\":\"6028106084708\",\"name\":\"zKUxi\",\"adset_id\":\"6028106062708\"},{\"id\":\"6028106084508\",\"name\":\"i770s\",\"adset_id\":\"6028106062308\"},{\"id\":\"6026992898708\",\"name\":\"PK7I8\",\"adset_id\":\"6026992781308\"},{\"id\":\"6026992879908\",\"name\":\"MIl8h\",\"adset_id\":\"6026992781308\"},{\"id\":\"6026992879508\",\"name\":\"VCJiQ\",\"adset_id\":\"6026992781308\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyODEwNjA4NzkwOAZDZD\",\"after\":\"NjAyNjk5Mjg3OTUwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyNjk5Mjg3OTUwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyODEwNjA4NzkwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyOTA1MDY5MDkwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6029050670908\",\"name\":\"nrDvT\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050761308\",\"name\":\"6B0wB\",\"adset_id\":\"6029050666708\"},{\"id\":\"6029050705108\",\"name\":\"0HhVp\",\"adset_id\":\"6029050665708\"},{\"id\":\"6029050721108\",\"name\":\"cSL65\",\"adset_id\":\"6029050665508\"},{\"id\":\"6029050692908\",\"name\":\"FEzTy\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050676708\",\"name\":\"v00bx\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050748708\",\"name\":\"7Z6w6\",\"adset_id\":\"6029050666708\"},{\"id\":\"6029050701308\",\"name\":\"Pfvuj\",\"adset_id\":\"6029050665708\"},{\"id\":\"6029050681108\",\"name\":\"EIb74\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050709508\",\"name\":\"0Hunb\",\"adset_id\":\"6029050665508\"},{\"id\":\"6029050688508\",\"name\":\"JVeVE\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050691108\",\"name\":\"o5SIw\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050737908\",\"name\":\"yVPaH\",\"adset_id\":\"6029050666708\"},{\"id\":\"6029050702508\",\"name\":\"1539L\",\"adset_id\":\"6029050665708\"},{\"id\":\"6028898642308\",\"name\":\"YLBmL\",\"adset_id\":\"6028106062908\"},{\"id\":\"6028898634708\",\"name\":\"zQMSn\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028898631308\",\"name\":\"Cixhi\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028898642108\",\"name\":\"9z8LL\",\"adset_id\":\"6028106062908\"},{\"id\":\"6028898636308\",\"name\":\"3CsHN\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028898638308\",\"name\":\"89HTq\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028898633108\",\"name\":\"vRZv3\",\"adset_id\":\"6028106062508\"},{\"id\":\"6028898635708\",\"name\":\"FOVOI\",\"adset_id\":\"6028106062908\"},{\"id\":\"6028898641508\",\"name\":\"m0Rnd\",\"adset_id\":\"6028106062908\"},{\"id\":\"6028106103908\",\"name\":\"0n4EY\",\"adset_id\":\"6028106062908\"},{\"id\":\"6028106102108\",\"name\":\"U4M5s\",\"adset_id\":\"6028106062908\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyOTA1MDY3MDkwOAZDZD\",\"after\":\"NjAyODEwNjEwMjEwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyODEwNjEwMjEwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAyOTA1MDY3MDkwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzMDg5OTkyNTkwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6030899880908\",\"name\":\"4afLo\",\"adset_id\":\"6030899850708\"},{\"id\":\"6030899916708\",\"name\":\"erbEE\",\"adset_id\":\"6030899849708\"},{\"id\":\"6030899864908\",\"name\":\"faa4v\",\"adset_id\":\"6030899850508\"},{\"id\":\"6030899938508\",\"name\":\"bCQY1\",\"adset_id\":\"6030899850908\"},{\"id\":\"6030899879908\",\"name\":\"Pd7so\",\"adset_id\":\"6030899850508\"},{\"id\":\"6030899860908\",\"name\":\"cvreS\",\"adset_id\":\"6030899849708\"},{\"id\":\"6029050673508\",\"name\":\"txNLx\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050722708\",\"name\":\"qY2E6\",\"adset_id\":\"6029050665508\"},{\"id\":\"6029050673308\",\"name\":\"DeWSB\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050671108\",\"name\":\"fJ0fp\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050705508\",\"name\":\"XSCnU\",\"adset_id\":\"6029050665708\"},{\"id\":\"6029050720908\",\"name\":\"cZrEL\",\"adset_id\":\"6029050665508\"},{\"id\":\"6029050691508\",\"name\":\"63ZG5\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050749708\",\"name\":\"Q2Pqb\",\"adset_id\":\"6029050666708\"},{\"id\":\"6029050721308\",\"name\":\"BPq3D\",\"adset_id\":\"6029050665508\"},{\"id\":\"6029050710708\",\"name\":\"ZiqVY\",\"adset_id\":\"6029050665708\"},{\"id\":\"6029050707308\",\"name\":\"r5JkM\",\"adset_id\":\"6029050665708\"},{\"id\":\"6029050753708\",\"name\":\"vo5IC\",\"adset_id\":\"6029050666708\"},{\"id\":\"6029050737108\",\"name\":\"WwtHS\",\"adset_id\":\"6029050666708\"},{\"id\":\"6029050741108\",\"name\":\"VQnIt\",\"adset_id\":\"6029050666708\"},{\"id\":\"6029050739908\",\"name\":\"nMBp8\",\"adset_id\":\"6029050666708\"},{\"id\":\"6029050723708\",\"name\":\"iJ9mF\",\"adset_id\":\"6029050665508\"},{\"id\":\"6029050748508\",\"name\":\"IPwhY\",\"adset_id\":\"6029050666708\"},{\"id\":\"6029050677508\",\"name\":\"5ydUL\",\"adset_id\":\"6029050665908\"},{\"id\":\"6029050690908\",\"name\":\"9lOmE\",\"adset_id\":\"6029050666708\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzMDg5OTg4MDkwOAZDZD\",\"after\":\"NjAyOTA1MDY5MDkwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAyOTA1MDY5MDkwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAzMDg5OTg4MDkwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzMDg5OTkwOTUwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6030899913508\",\"name\":\"Pyak8\",\"adset_id\":\"6030899850708\"},{\"id\":\"6030899883908\",\"name\":\"mWzwF\",\"adset_id\":\"6030899850508\"},{\"id\":\"6030899884508\",\"name\":\"UIIpp\",\"adset_id\":\"6030899850508\"},{\"id\":\"6030899860708\",\"name\":\"uQvFf\",\"adset_id\":\"6030899849708\"},{\"id\":\"6030899937308\",\"name\":\"TmJpR\",\"adset_id\":\"6030899850908\"},{\"id\":\"6030899862908\",\"name\":\"xVTN6\",\"adset_id\":\"6030899849708\"},{\"id\":\"6030899876308\",\"name\":\"ctDgy\",\"adset_id\":\"6030899849708\"},{\"id\":\"6030899876908\",\"name\":\"7Wn6t\",\"adset_id\":\"6030899850708\"},{\"id\":\"6030899877108\",\"name\":\"3CoOr\",\"adset_id\":\"6030899850508\"},{\"id\":\"6030899913708\",\"name\":\"K1fRa\",\"adset_id\":\"6030899849708\"},{\"id\":\"6030899936108\",\"name\":\"i11sg\",\"adset_id\":\"6030899850908\"},{\"id\":\"6030899881108\",\"name\":\"sSTsn\",\"adset_id\":\"6030899850708\"},{\"id\":\"6030899889908\",\"name\":\"92keU\",\"adset_id\":\"6030899849708\"},{\"id\":\"6030899872708\",\"name\":\"ltLog\",\"adset_id\":\"6030899850708\"},{\"id\":\"6030899927108\",\"name\":\"BZowK\",\"adset_id\":\"6030899850908\"},{\"id\":\"6030899940108\",\"name\":\"gYT55\",\"adset_id\":\"6030899850908\"},{\"id\":\"6030899925508\",\"name\":\"T2Y0u\",\"adset_id\":\"6030899850908\"},{\"id\":\"6030899932708\",\"name\":\"H4t2v\",\"adset_id\":\"6030899850908\"},{\"id\":\"6030899868708\",\"name\":\"4G3hR\",\"adset_id\":\"6030899849708\"},{\"id\":\"6030899949908\",\"name\":\"Da5Yj\",\"adset_id\":\"6030899850908\"},{\"id\":\"6030899859908\",\"name\":\"E0RxO\",\"adset_id\":\"6030899850908\"},{\"id\":\"6030899863308\",\"name\":\"duZpW\",\"adset_id\":\"6030899849708\"},{\"id\":\"6030899891708\",\"name\":\"WB39d\",\"adset_id\":\"6030899849708\"},{\"id\":\"6030899885708\",\"name\":\"roE6F\",\"adset_id\":\"6030899850508\"},{\"id\":\"6030899925908\",\"name\":\"wyzjZ\",\"adset_id\":\"6030899850908\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzMDg5OTkxMzUwOAZDZD\",\"after\":\"NjAzMDg5OTkyNTkwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzMDg5OTkyNTkwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAzMDg5OTkxMzUwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzMjU5Nzk1NzMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6032597956108\",\"name\":\"dNIna\",\"adset_id\":\"6032597925508\"},{\"id\":\"6032597952308\",\"name\":\"kjvnZ\",\"adset_id\":\"6032597925508\"},{\"id\":\"6032597940308\",\"name\":\"aNxmO\",\"adset_id\":\"6032597922908\"},{\"id\":\"6032597935308\",\"name\":\"Xw0Bs\",\"adset_id\":\"6032597922908\"},{\"id\":\"6032597934908\",\"name\":\"J8QwI\",\"adset_id\":\"6032597922908\"},{\"id\":\"6032597931508\",\"name\":\"ChELm\",\"adset_id\":\"6032597922908\"},{\"id\":\"6032597940108\",\"name\":\"borpm\",\"adset_id\":\"6032597924508\"},{\"id\":\"6032597960108\",\"name\":\"mgmrz\",\"adset_id\":\"6032597923108\"},{\"id\":\"6032597932708\",\"name\":\"kRps0\",\"adset_id\":\"6032597924508\"},{\"id\":\"6032597942708\",\"name\":\"yqFUl\",\"adset_id\":\"6032597924508\"},{\"id\":\"6032597936708\",\"name\":\"6vVfm\",\"adset_id\":\"6032597924508\"},{\"id\":\"6031427639708\",\"name\":\"CoUGp\",\"adset_id\":\"6030899850708\"},{\"id\":\"6031426201908\",\"name\":\"8TYh9\",\"adset_id\":\"6031426192908\"},{\"id\":\"6031426204508\",\"name\":\"JpbO8\",\"adset_id\":\"6031426193508\"},{\"id\":\"6031426209508\",\"name\":\"4Nb9Y\",\"adset_id\":\"6031426193508\"},{\"id\":\"6031426210708\",\"name\":\"WwbVh\",\"adset_id\":\"6031426192908\"},{\"id\":\"6031427405308\",\"name\":\"HEKml\",\"adset_id\":\"6030899849708\"},{\"id\":\"6031427638508\",\"name\":\"XWCHB\",\"adset_id\":\"6030899850708\"},{\"id\":\"6031427640908\",\"name\":\"BuYhC\",\"adset_id\":\"6030899850708\"},{\"id\":\"6031427637708\",\"name\":\"ZiXoN\",\"adset_id\":\"6030899850708\"},{\"id\":\"6030899869708\",\"name\":\"SBnbS\",\"adset_id\":\"6030899850708\"},{\"id\":\"6031427406108\",\"name\":\"7Ndde\",\"adset_id\":\"6030899849708\"},{\"id\":\"6031427410508\",\"name\":\"kSRNL\",\"adset_id\":\"6030899849708\"},{\"id\":\"6031427408308\",\"name\":\"PjOUS\",\"adset_id\":\"6030899849708\"},{\"id\":\"6030899909508\",\"name\":\"5KBCn\",\"adset_id\":\"6030899849708\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzMjU5Nzk1NjEwOAZDZD\",\"after\":\"NjAzMDg5OTkwOTUwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzMDg5OTkwOTUwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAzMjU5Nzk1NjEwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzNDgwMzgwNTUwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6034803656708\",\"name\":\"CGmVr\",\"adset_id\":\"6034803645508\"},{\"id\":\"6034803804908\",\"name\":\"xfPU7\",\"adset_id\":\"6034803786708\"},{\"id\":\"6034803797708\",\"name\":\"DZ5Y2\",\"adset_id\":\"6034803786708\"},{\"id\":\"6034803650708\",\"name\":\"cajPO\",\"adset_id\":\"6034803645708\"},{\"id\":\"6034803649308\",\"name\":\"qJ7iX\",\"adset_id\":\"6034803645708\"},{\"id\":\"6034803653108\",\"name\":\"nxLGj\",\"adset_id\":\"6034803645708\"},{\"id\":\"6034803656508\",\"name\":\"ZZ8NT\",\"adset_id\":\"6034803645508\"},{\"id\":\"6034803801908\",\"name\":\"fShM7\",\"adset_id\":\"6034803787508\"},{\"id\":\"6034803796708\",\"name\":\"ocfUp\",\"adset_id\":\"6034803787508\"},{\"id\":\"6034803654708\",\"name\":\"kd9T5\",\"adset_id\":\"6034803645708\"},{\"id\":\"6034087442908\",\"name\":\"Bu2L6\",\"adset_id\":\"6034087417908\"},{\"id\":\"6034087450708\",\"name\":\"kCfyS\",\"adset_id\":\"6034087416708\"},{\"id\":\"6034087439108\",\"name\":\"q7POe\",\"adset_id\":\"6034087417908\"},{\"id\":\"6034087432908\",\"name\":\"j0YTL\",\"adset_id\":\"6034087417908\"},{\"id\":\"6034087439908\",\"name\":\"ozBYb\",\"adset_id\":\"6034087417908\"},{\"id\":\"6032883805508\",\"name\":\"vBiXT\",\"adset_id\":\"6032883803308\"},{\"id\":\"6033395290508\",\"name\":\"9hww7\",\"adset_id\":\"6032597923708\"},{\"id\":\"6033395290308\",\"name\":\"uGIOy\",\"adset_id\":\"6032597923508\"},{\"id\":\"6033395285908\",\"name\":\"TTmod\",\"adset_id\":\"6032597925508\"},{\"id\":\"6033395283108\",\"name\":\"M1Rvc\",\"adset_id\":\"6032597922908\"},{\"id\":\"6032597974108\",\"name\":\"Td1Hj\",\"adset_id\":\"6032597923508\"},{\"id\":\"6032597970908\",\"name\":\"8gZgV\",\"adset_id\":\"6032597923708\"},{\"id\":\"6032597968508\",\"name\":\"dgxzJ\",\"adset_id\":\"6032597923508\"},{\"id\":\"6032597965508\",\"name\":\"MWxq1\",\"adset_id\":\"6032597923708\"},{\"id\":\"6032597957308\",\"name\":\"Vhcx6\",\"adset_id\":\"6032597925508\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNDgwMzY1NjcwOAZDZD\",\"after\":\"NjAzMjU5Nzk1NzMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzMjU5Nzk1NzMwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAzNDgwMzY1NjcwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzNTAzMDUxNzcwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6035030511908\",\"name\":\"NzaWY\",\"adset_id\":\"6035030430708\"},{\"id\":\"6035030516508\",\"name\":\"9YNZG\",\"adset_id\":\"6035030428908\"},{\"id\":\"6035030512708\",\"name\":\"PQDmJ\",\"adset_id\":\"6035030430708\"},{\"id\":\"6035030513308\",\"name\":\"jeapl\",\"adset_id\":\"6035030428908\"},{\"id\":\"6034087450308\",\"name\":\"CZgrQ\",\"adset_id\":\"6034087418908\"},{\"id\":\"6034087471108\",\"name\":\"uNd6v\",\"adset_id\":\"6034087416108\"},{\"id\":\"6034087474708\",\"name\":\"OIgv3\",\"adset_id\":\"6034087416508\"},{\"id\":\"6034087472508\",\"name\":\"Djzar\",\"adset_id\":\"6034087416108\"},{\"id\":\"6034087446508\",\"name\":\"ezFzc\",\"adset_id\":\"6034087418908\"},{\"id\":\"6034087463708\",\"name\":\"SmZN7\",\"adset_id\":\"6034087416108\"},{\"id\":\"6034087426108\",\"name\":\"hzJJT\",\"adset_id\":\"6034087416908\"},{\"id\":\"6034087428508\",\"name\":\"VQIQF\",\"adset_id\":\"6034087416908\"},{\"id\":\"6034087465708\",\"name\":\"H3rIb\",\"adset_id\":\"6034087416508\"},{\"id\":\"6034087450108\",\"name\":\"oeEWt\",\"adset_id\":\"6034087418908\"},{\"id\":\"6034087426308\",\"name\":\"p0O1E\",\"adset_id\":\"6034087416908\"},{\"id\":\"6034087456308\",\"name\":\"8kffL\",\"adset_id\":\"6034087418908\"},{\"id\":\"6034087432708\",\"name\":\"QEP4T\",\"adset_id\":\"6034087416908\"},{\"id\":\"6034087476108\",\"name\":\"CbGKy\",\"adset_id\":\"6034087416508\"},{\"id\":\"6034087426908\",\"name\":\"cNPfx\",\"adset_id\":\"6034087416908\"},{\"id\":\"6034803800508\",\"name\":\"kSbpk\",\"adset_id\":\"6034803787508\"},{\"id\":\"6034803804708\",\"name\":\"5hOGa\",\"adset_id\":\"6034803786708\"},{\"id\":\"6034803657508\",\"name\":\"PLLct\",\"adset_id\":\"6034803645508\"},{\"id\":\"6034803800308\",\"name\":\"ihOiV\",\"adset_id\":\"6034803787508\"},{\"id\":\"6034803651908\",\"name\":\"DdBBg\",\"adset_id\":\"6034803645508\"},{\"id\":\"6034803805508\",\"name\":\"WGUGP\",\"adset_id\":\"6034803786708\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNTAzMDUxMTkwOAZDZD\",\"after\":\"NjAzNDgwMzgwNTUwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzNDgwMzgwNTUwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAzNTAzMDUxMTkwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzNjMxMDIyOTcwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6036310228908\",\"name\":\"pgr9R\",\"adset_id\":\"6036310194508\"},{\"id\":\"6036310216508\",\"name\":\"wCfIR\",\"adset_id\":\"6036310193308\"},{\"id\":\"6036310235508\",\"name\":\"u3jUy\",\"adset_id\":\"6036310192508\"},{\"id\":\"6036310266508\",\"name\":\"SbeyC\",\"adset_id\":\"6036310196908\"},{\"id\":\"6036310265308\",\"name\":\"DsLtQ\",\"adset_id\":\"6036310196908\"},{\"id\":\"6036310264508\",\"name\":\"t12XV\",\"adset_id\":\"6036310196908\"},{\"id\":\"6036310223708\",\"name\":\"e5bnO\",\"adset_id\":\"6036310195708\"},{\"id\":\"6036310239508\",\"name\":\"wh5Gu\",\"adset_id\":\"6036310192508\"},{\"id\":\"6036310238108\",\"name\":\"mgOim\",\"adset_id\":\"6036310192508\"},{\"id\":\"6036310232908\",\"name\":\"PgkFP\",\"adset_id\":\"6036310193308\"},{\"id\":\"6036310232708\",\"name\":\"VvTFE\",\"adset_id\":\"6036310195708\"},{\"id\":\"6036310232308\",\"name\":\"sgC1H\",\"adset_id\":\"6036310195708\"},{\"id\":\"6036310223908\",\"name\":\"OKL4K\",\"adset_id\":\"6036310193308\"},{\"id\":\"6036310216708\",\"name\":\"jWuMq\",\"adset_id\":\"6036310193308\"},{\"id\":\"6036310235908\",\"name\":\"gUC2K\",\"adset_id\":\"6036310194508\"},{\"id\":\"6036310231908\",\"name\":\"sO4hr\",\"adset_id\":\"6036310194508\"},{\"id\":\"6036310231308\",\"name\":\"o7lob\",\"adset_id\":\"6036310192508\"},{\"id\":\"6036310229308\",\"name\":\"9NeWo\",\"adset_id\":\"6036310194508\"},{\"id\":\"6036310214308\",\"name\":\"DYWn6\",\"adset_id\":\"6036310195108\"},{\"id\":\"6036310208908\",\"name\":\"g1nia\",\"adset_id\":\"6036310195108\"},{\"id\":\"6036310208308\",\"name\":\"jqHFF\",\"adset_id\":\"6036310195108\"},{\"id\":\"6035030517108\",\"name\":\"eCBTb\",\"adset_id\":\"6035030430708\"},{\"id\":\"6035030516308\",\"name\":\"du2HD\",\"adset_id\":\"6035030428908\"},{\"id\":\"6035030512308\",\"name\":\"gfdhS\",\"adset_id\":\"6035030428908\"},{\"id\":\"6035030517708\",\"name\":\"u0nVo\",\"adset_id\":\"6035030430708\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNjMxMDIyODkwOAZDZD\",\"after\":\"NjAzNTAzMDUxNzcwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzNTAzMDUxNzcwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAzNjMxMDIyODkwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzNzc2NTAyNzMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6037765004908\",\"name\":\"b8bqp\",\"adset_id\":\"6037764907508\"},{\"id\":\"6037765010108\",\"name\":\"7CTo5\",\"adset_id\":\"6037764905508\"},{\"id\":\"6037765026108\",\"name\":\"Y7By6\",\"adset_id\":\"6037764905708\"},{\"id\":\"6037764995908\",\"name\":\"4TOF0\",\"adset_id\":\"6037764905708\"},{\"id\":\"6037764994508\",\"name\":\"lixYd\",\"adset_id\":\"6037764905708\"},{\"id\":\"6037764995508\",\"name\":\"nLJX9\",\"adset_id\":\"6037764905708\"},{\"id\":\"6037764974108\",\"name\":\"5fl7E\",\"adset_id\":\"6037764902908\"},{\"id\":\"6037764973508\",\"name\":\"FHUG7\",\"adset_id\":\"6037764902908\"},{\"id\":\"6037764973308\",\"name\":\"55vcy\",\"adset_id\":\"6037764902908\"},{\"id\":\"6037764987508\",\"name\":\"2J0WC\",\"adset_id\":\"6037764903508\"},{\"id\":\"6037764982308\",\"name\":\"PyvHd\",\"adset_id\":\"6037764903508\"},{\"id\":\"6037764975308\",\"name\":\"EY6ak\",\"adset_id\":\"6037764903508\"},{\"id\":\"6037797590108\",\"name\":\"lK2vE\",\"adset_id\":\"6037797572108\"},{\"id\":\"6037797585708\",\"name\":\"E7mud\",\"adset_id\":\"6037797572108\"},{\"id\":\"6037797584308\",\"name\":\"ChtO0\",\"adset_id\":\"6037797571708\"},{\"id\":\"6037797582708\",\"name\":\"eByfj\",\"adset_id\":\"6037797571708\"},{\"id\":\"6037797050908\",\"name\":\"RBNbJ\",\"adset_id\":\"6037797043108\"},{\"id\":\"6037797048108\",\"name\":\"mVI7n\",\"adset_id\":\"6037797042908\"},{\"id\":\"6037797046708\",\"name\":\"B5q5S\",\"adset_id\":\"6037797042908\"},{\"id\":\"6037797048308\",\"name\":\"HOoZU\",\"adset_id\":\"6037797043108\"},{\"id\":\"6037796645108\",\"name\":\"aBUd9\",\"adset_id\":\"6037795800308\"},{\"id\":\"6037796644908\",\"name\":\"LCxUd\",\"adset_id\":\"6037795800308\"},{\"id\":\"6036310209108\",\"name\":\"Q0F4Y\",\"adset_id\":\"6036310195108\"},{\"id\":\"6036310265908\",\"name\":\"qlfNg\",\"adset_id\":\"6036310196908\"},{\"id\":\"6036310229708\",\"name\":\"TYQFb\",\"adset_id\":\"6036310195708\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNzc2NTAwNDkwOAZDZD\",\"after\":\"NjAzNjMxMDIyOTcwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzNjMxMDIyOTcwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAzNzc2NTAwNDkwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0MDczOTM4MjMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6040739382108\",\"name\":\"xakn3\",\"adset_id\":\"6040739381508\"},{\"id\":\"6040739381908\",\"name\":\"Bb1XH\",\"adset_id\":\"6040739381508\"},{\"id\":\"6039331866908\",\"name\":\"52nUR\",\"adset_id\":\"6039331671708\"},{\"id\":\"6039331860308\",\"name\":\"YJpmr\",\"adset_id\":\"6039331671908\"},{\"id\":\"6039331850708\",\"name\":\"qMow6\",\"adset_id\":\"6039331671708\"},{\"id\":\"6039331850508\",\"name\":\"ZSvL6\",\"adset_id\":\"6039331673508\"},{\"id\":\"6039331827908\",\"name\":\"p4aI9\",\"adset_id\":\"6039331671708\"},{\"id\":\"6039331827108\",\"name\":\"tnD4Z\",\"adset_id\":\"6039331671908\"},{\"id\":\"6039331813908\",\"name\":\"SSmvx\",\"adset_id\":\"6039331671908\"},{\"id\":\"6039331746308\",\"name\":\"ruB1i\",\"adset_id\":\"6039331673508\"},{\"id\":\"6039331744508\",\"name\":\"DskYn\",\"adset_id\":\"6039331671708\"},{\"id\":\"6039331730908\",\"name\":\"8Rgfm\",\"adset_id\":\"6039331673508\"},{\"id\":\"6039331710908\",\"name\":\"yPDyK\",\"adset_id\":\"6039331673508\"},{\"id\":\"6039331696108\",\"name\":\"jFtyY\",\"adset_id\":\"6039331671908\"},{\"id\":\"6037765028508\",\"name\":\"DH07V\",\"adset_id\":\"6037764903508\"},{\"id\":\"6037765011308\",\"name\":\"RpcqP\",\"adset_id\":\"6037764907508\"},{\"id\":\"6037764982708\",\"name\":\"hroMF\",\"adset_id\":\"6037764906508\"},{\"id\":\"6037764996108\",\"name\":\"2rBcs\",\"adset_id\":\"6037764906508\"},{\"id\":\"6037765011708\",\"name\":\"fE20P\",\"adset_id\":\"6037764905508\"},{\"id\":\"6037765007708\",\"name\":\"7ni2x\",\"adset_id\":\"6037764907508\"},{\"id\":\"6037765009508\",\"name\":\"p1rZX\",\"adset_id\":\"6037764905508\"},{\"id\":\"6037765005108\",\"name\":\"etoPX\",\"adset_id\":\"6037764907508\"},{\"id\":\"6037765010908\",\"name\":\"omir0\",\"adset_id\":\"6037764905508\"},{\"id\":\"6037764987308\",\"name\":\"zq2j6\",\"adset_id\":\"6037764906508\"},{\"id\":\"6037765027308\",\"name\":\"nE1na\",\"adset_id\":\"6037764906508\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0MDczOTM4MjEwOAZDZD\",\"after\":\"NjAzNzc2NTAyNzMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzNzc2NTAyNzMwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjA0MDczOTM4MjEwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzOTMzMTY3OTEwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6039331811708\",\"name\":\"yKaBT\",\"adset_id\":\"6039331672708\"},{\"id\":\"6039331750308\",\"name\":\"3P4Oh\",\"adset_id\":\"6039331672708\"},{\"id\":\"6039331719308\",\"name\":\"35OYO\",\"adset_id\":\"6039331669708\"},{\"id\":\"6039331717508\",\"name\":\"HjQLa\",\"adset_id\":\"6039331669708\"},{\"id\":\"6039331689908\",\"name\":\"eip6H\",\"adset_id\":\"6039331670308\"},{\"id\":\"6039331680708\",\"name\":\"dzKMy\",\"adset_id\":\"6039331670308\"},{\"id\":\"6039331705908\",\"name\":\"VQpvM\",\"adset_id\":\"6039331672708\"},{\"id\":\"6040740930308\",\"name\":\"ieGou\",\"adset_id\":\"6040740929908\"},{\"id\":\"6040740930708\",\"name\":\"yNfka\",\"adset_id\":\"6040740929908\"},{\"id\":\"6040740930508\",\"name\":\"40SzC\",\"adset_id\":\"6040740929908\"},{\"id\":\"6040739728308\",\"name\":\"FDUYR\",\"adset_id\":\"6040739719108\"},{\"id\":\"6040739727308\",\"name\":\"33aLx\",\"adset_id\":\"6040739718708\"},{\"id\":\"6040739727108\",\"name\":\"zZwYq\",\"adset_id\":\"6040739718708\"},{\"id\":\"6040739728708\",\"name\":\"uzJra\",\"adset_id\":\"6040739719108\"},{\"id\":\"6040739728508\",\"name\":\"Jemwv\",\"adset_id\":\"6040739719108\"},{\"id\":\"6040739728908\",\"name\":\"cf9WD\",\"adset_id\":\"6040739719108\"},{\"id\":\"6040739727708\",\"name\":\"M86iU\",\"adset_id\":\"6040739718708\"},{\"id\":\"6040739729508\",\"name\":\"kKyO3\",\"adset_id\":\"6040739717108\"},{\"id\":\"6040739729308\",\"name\":\"5kyU1\",\"adset_id\":\"6040739717108\"},{\"id\":\"6040739729108\",\"name\":\"o5GiS\",\"adset_id\":\"6040739717108\"},{\"id\":\"6040739728108\",\"name\":\"KHrMN\",\"adset_id\":\"6040739719108\"},{\"id\":\"6040739727908\",\"name\":\"ZrB60\",\"adset_id\":\"6040739718908\"},{\"id\":\"6040739727508\",\"name\":\"JgeIi\",\"adset_id\":\"6040739718708\"},{\"id\":\"6040739722108\",\"name\":\"092qK\",\"adset_id\":\"6040739717108\"},{\"id\":\"6040739382308\",\"name\":\"CqGio\",\"adset_id\":\"6040739381508\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzOTMzMTgxMTcwOAZDZD\",\"after\":\"NjA0MDczOTM4MjMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0MDczOTM4MjMwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjAzOTMzMTgxMTcwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0MjYwMTcyNzkwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6042601729508\",\"name\":\"lvvWs\",\"adset_id\":\"6042601725308\"},{\"id\":\"6042601727508\",\"name\":\"b2whn\",\"adset_id\":\"6042601725508\"},{\"id\":\"6042601728708\",\"name\":\"y5LD0\",\"adset_id\":\"6042601725908\"},{\"id\":\"6042213731908\",\"name\":\"eLOJS\",\"adset_id\":\"6042213730708\"},{\"id\":\"6042213731708\",\"name\":\"jhYTs\",\"adset_id\":\"6042213730708\"},{\"id\":\"6042213731508\",\"name\":\"K9yTw\",\"adset_id\":\"6042213730708\"},{\"id\":\"6042213732308\",\"name\":\"KvJBm\",\"adset_id\":\"6042213730508\"},{\"id\":\"6042213732108\",\"name\":\"J2q8m\",\"adset_id\":\"6042213730508\"},{\"id\":\"6042213731308\",\"name\":\"lPyCZ\",\"adset_id\":\"6042213730508\"},{\"id\":\"6042191859108\",\"name\":\"qZnbz\",\"adset_id\":\"6042191852508\"},{\"id\":\"6042191859308\",\"name\":\"0NRsf\",\"adset_id\":\"6042191852508\"},{\"id\":\"6042191859508\",\"name\":\"98g4I\",\"adset_id\":\"6042191852508\"},{\"id\":\"6042191859908\",\"name\":\"yaqhj\",\"adset_id\":\"6042191851108\"},{\"id\":\"6042191859708\",\"name\":\"g1840\",\"adset_id\":\"6042191851108\"},{\"id\":\"6042191854308\",\"name\":\"6Fdbt\",\"adset_id\":\"6042191851108\"},{\"id\":\"6040740280108\",\"name\":\"PUVjX\",\"adset_id\":\"6040740278708\"},{\"id\":\"6040740279908\",\"name\":\"6qXhl\",\"adset_id\":\"6040740278708\"},{\"id\":\"6040740279708\",\"name\":\"KXoMl\",\"adset_id\":\"6040740278708\"},{\"id\":\"6040740280508\",\"name\":\"PvW3C\",\"adset_id\":\"6040740278908\"},{\"id\":\"6040740280308\",\"name\":\"gMFEh\",\"adset_id\":\"6040740278908\"},{\"id\":\"6040740279508\",\"name\":\"CG57t\",\"adset_id\":\"6040740278908\"},{\"id\":\"6039331730508\",\"name\":\"Y9nWS\",\"adset_id\":\"6039331670308\"},{\"id\":\"6039331706508\",\"name\":\"sj0fe\",\"adset_id\":\"6039331672708\"},{\"id\":\"6039331754908\",\"name\":\"5gcfH\",\"adset_id\":\"6039331669708\"},{\"id\":\"6039331679108\",\"name\":\"wH6wG\",\"adset_id\":\"6039331670308\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0MjYwMTcyOTUwOAZDZD\",\"after\":\"NjAzOTMzMTY3OTEwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjAzOTMzMTY3OTEwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjA0MjYwMTcyOTUwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0MjE5MTg1ODcwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6042191858508\",\"name\":\"xMafh\",\"adset_id\":\"6042191852308\"},{\"id\":\"6042191858308\",\"name\":\"INl1W\",\"adset_id\":\"6042191852308\"},{\"id\":\"6042191856508\",\"name\":\"UYIVc\",\"adset_id\":\"6042191851708\"},{\"id\":\"6042191856308\",\"name\":\"W0vKt\",\"adset_id\":\"6042191851708\"},{\"id\":\"6042191856108\",\"name\":\"ZYxuG\",\"adset_id\":\"6042191851708\"},{\"id\":\"6042191855508\",\"name\":\"2n6MV\",\"adset_id\":\"6042191851708\"},{\"id\":\"6042191858108\",\"name\":\"sKjtf\",\"adset_id\":\"6042191852108\"},{\"id\":\"6042191857908\",\"name\":\"49tBj\",\"adset_id\":\"6042191852108\"},{\"id\":\"6042191857708\",\"name\":\"Ns4La\",\"adset_id\":\"6042191852108\"},{\"id\":\"6042191857508\",\"name\":\"irPX1\",\"adset_id\":\"6042191852108\"},{\"id\":\"6042191857308\",\"name\":\"66FUP\",\"adset_id\":\"6042191851908\"},{\"id\":\"6042191857108\",\"name\":\"kKhbf\",\"adset_id\":\"6042191851908\"},{\"id\":\"6042191856908\",\"name\":\"Q8eqt\",\"adset_id\":\"6042191851908\"},{\"id\":\"6042191856708\",\"name\":\"rRTqE\",\"adset_id\":\"6042191851908\"},{\"id\":\"6042601728908\",\"name\":\"eDU6r\",\"adset_id\":\"6042601725308\"},{\"id\":\"6042601726908\",\"name\":\"RzT4y\",\"adset_id\":\"6042601725508\"},{\"id\":\"6042601729108\",\"name\":\"UHWzp\",\"adset_id\":\"6042601725308\"},{\"id\":\"6042601728108\",\"name\":\"0CvrE\",\"adset_id\":\"6042601725908\"},{\"id\":\"6042601727308\",\"name\":\"EiygL\",\"adset_id\":\"6042601725508\"},{\"id\":\"6042601729308\",\"name\":\"XnBtw\",\"adset_id\":\"6042601725308\"},{\"id\":\"6042601728508\",\"name\":\"q4PDE\",\"adset_id\":\"6042601725908\"},{\"id\":\"6042601727708\",\"name\":\"dlWwN\",\"adset_id\":\"6042601725508\"},{\"id\":\"6042601728308\",\"name\":\"0Ukm4\",\"adset_id\":\"6042601725908\"},{\"id\":\"6042601727108\",\"name\":\"bW92c\",\"adset_id\":\"6042601725308\"},{\"id\":\"6042601727908\",\"name\":\"C2u1I\",\"adset_id\":\"6042601725708\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0MjE5MTg1ODUwOAZDZD\",\"after\":\"NjA0MjYwMTcyNzkwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0MjYwMTcyNzkwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjA0MjE5MTg1ODUwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0NDMxNTc0NDUwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6044315742508\",\"name\":\"5nWBy\",\"adset_id\":\"6044315732908\"},{\"id\":\"6044315741108\",\"name\":\"fpI9B\",\"adset_id\":\"6044315731908\"},{\"id\":\"6044315739708\",\"name\":\"iOVXJ\",\"adset_id\":\"6044315731508\"},{\"id\":\"6044315739108\",\"name\":\"vDK9p\",\"adset_id\":\"6044315731708\"},{\"id\":\"6044315736708\",\"name\":\"4TRbo\",\"adset_id\":\"6044315730708\"},{\"id\":\"6044315745308\",\"name\":\"7I9rV\",\"adset_id\":\"6044315733108\"},{\"id\":\"6044315744108\",\"name\":\"JJrt0\",\"adset_id\":\"6044315732508\"},{\"id\":\"6044315741908\",\"name\":\"DZEM7\",\"adset_id\":\"6044315732308\"},{\"id\":\"6044315741708\",\"name\":\"R9i34\",\"adset_id\":\"6044315732108\"},{\"id\":\"6044315741508\",\"name\":\"iGQuD\",\"adset_id\":\"6044315732108\"},{\"id\":\"6044315741308\",\"name\":\"hQjMk\",\"adset_id\":\"6044315732108\"},{\"id\":\"6044315738708\",\"name\":\"IsDoa\",\"adset_id\":\"6044315730908\"},{\"id\":\"6044315742108\",\"name\":\"ShNLN\",\"adset_id\":\"6044315732308\"},{\"id\":\"6044315740308\",\"name\":\"OrHre\",\"adset_id\":\"6044315731508\"},{\"id\":\"6044315740108\",\"name\":\"UVSZy\",\"adset_id\":\"6044315731508\"},{\"id\":\"6044315739508\",\"name\":\"484DX\",\"adset_id\":\"6044315731708\"},{\"id\":\"6042191855908\",\"name\":\"GImC0\",\"adset_id\":\"6042191851508\"},{\"id\":\"6042191855708\",\"name\":\"I75nB\",\"adset_id\":\"6042191851508\"},{\"id\":\"6042191855308\",\"name\":\"OlSuj\",\"adset_id\":\"6042191851508\"},{\"id\":\"6042191854908\",\"name\":\"tWBGC\",\"adset_id\":\"6042191851508\"},{\"id\":\"6042191855108\",\"name\":\"saHH2\",\"adset_id\":\"6042191851308\"},{\"id\":\"6042191854708\",\"name\":\"xftfs\",\"adset_id\":\"6042191851308\"},{\"id\":\"6042191854508\",\"name\":\"5zhbC\",\"adset_id\":\"6042191851308\"},{\"id\":\"6042191858908\",\"name\":\"Ydrq7\",\"adset_id\":\"6042191852308\"},{\"id\":\"6042191858708\",\"name\":\"yJTsh\",\"adset_id\":\"6042191852308\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NDMxNTc0MjUwOAZDZD\",\"after\":\"NjA0MjE5MTg1ODcwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0MjE5MTg1ODcwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjA0NDMxNTc0MjUwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0NDMxNTc0MjMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6044315736508\",\"name\":\"pcrgt\",\"adset_id\":\"6044315731108\"},{\"id\":\"6044315745108\",\"name\":\"CBqKr\",\"adset_id\":\"6044315733108\"},{\"id\":\"6044315737108\",\"name\":\"WUrmi\",\"adset_id\":\"6044315731308\"},{\"id\":\"6044315742708\",\"name\":\"M7XEY\",\"adset_id\":\"6044315732908\"},{\"id\":\"6044315742908\",\"name\":\"FCm05\",\"adset_id\":\"6044315732908\"},{\"id\":\"6044315737508\",\"name\":\"vdHM4\",\"adset_id\":\"6044315731308\"},{\"id\":\"6044315745508\",\"name\":\"9rZp8\",\"adset_id\":\"6044315733308\"},{\"id\":\"6044315737308\",\"name\":\"eEFCH\",\"adset_id\":\"6044315731108\"},{\"id\":\"6044315743108\",\"name\":\"R9MpO\",\"adset_id\":\"6044315732708\"},{\"id\":\"6044315737908\",\"name\":\"0tZsV\",\"adset_id\":\"6044315731108\"},{\"id\":\"6044315736908\",\"name\":\"TwwYT\",\"adset_id\":\"6044315731308\"},{\"id\":\"6044315745908\",\"name\":\"YF3SR\",\"adset_id\":\"6044315733308\"},{\"id\":\"6044315745708\",\"name\":\"wFrBv\",\"adset_id\":\"6044315733308\"},{\"id\":\"6044315744308\",\"name\":\"1ixZd\",\"adset_id\":\"6044315732508\"},{\"id\":\"6044315743708\",\"name\":\"kVnyu\",\"adset_id\":\"6044315732508\"},{\"id\":\"6044315740508\",\"name\":\"p4Kp2\",\"adset_id\":\"6044315731908\"},{\"id\":\"6044315738508\",\"name\":\"j6hOK\",\"adset_id\":\"6044315730908\"},{\"id\":\"6044315746108\",\"name\":\"CQFuN\",\"adset_id\":\"6044315733308\"},{\"id\":\"6044315743908\",\"name\":\"st5Yr\",\"adset_id\":\"6044315732508\"},{\"id\":\"6044315740708\",\"name\":\"Okb2t\",\"adset_id\":\"6044315731908\"},{\"id\":\"6044315738908\",\"name\":\"wD1RO\",\"adset_id\":\"6044315731708\"},{\"id\":\"6044315738108\",\"name\":\"Xjo6Z\",\"adset_id\":\"6044315730908\"},{\"id\":\"6044315744908\",\"name\":\"uQd5n\",\"adset_id\":\"6044315733108\"},{\"id\":\"6044315744708\",\"name\":\"jc6UR\",\"adset_id\":\"6044315733108\"},{\"id\":\"6044315744508\",\"name\":\"FKMGi\",\"adset_id\":\"6044315732508\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NDMxNTczNjUwOAZDZD\",\"after\":\"NjA0NDMxNTc0NDUwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0NDMxNTc0NDUwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjA0NDMxNTczNjUwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0NjgxNjYyNDMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6046816623108\",\"name\":\"y7B30\",\"adset_id\":\"6046816616708\"},{\"id\":\"6046816619908\",\"name\":\"chv46\",\"adset_id\":\"6046816615308\"},{\"id\":\"6046816624508\",\"name\":\"hmXhE\",\"adset_id\":\"6046816616508\"},{\"id\":\"6046816620508\",\"name\":\"gnGQv\",\"adset_id\":\"6046816615908\"},{\"id\":\"6046816622108\",\"name\":\"KXfht\",\"adset_id\":\"6046816616308\"},{\"id\":\"6046816621108\",\"name\":\"7CH82\",\"adset_id\":\"6046816615908\"},{\"id\":\"6046816622308\",\"name\":\"469Oc\",\"adset_id\":\"6046816616308\"},{\"id\":\"6046816619308\",\"name\":\"dWdSf\",\"adset_id\":\"6046816615308\"},{\"id\":\"6046816624908\",\"name\":\"iPNRs\",\"adset_id\":\"6046816616508\"},{\"id\":\"6046816622908\",\"name\":\"onXvp\",\"adset_id\":\"6046816616708\"},{\"id\":\"6046816622708\",\"name\":\"KrpMn\",\"adset_id\":\"6046816616308\"},{\"id\":\"6046816619108\",\"name\":\"yCVhf\",\"adset_id\":\"6046816615508\"},{\"id\":\"6046816619508\",\"name\":\"y5INo\",\"adset_id\":\"6046816615308\"},{\"id\":\"6046816621708\",\"name\":\"CYWfH\",\"adset_id\":\"6046816615508\"},{\"id\":\"6046816620308\",\"name\":\"WJrvY\",\"adset_id\":\"6046816615508\"},{\"id\":\"6046816623508\",\"name\":\"bQ0Ib\",\"adset_id\":\"6046816616708\"},{\"id\":\"6046816623308\",\"name\":\"LlVQs\",\"adset_id\":\"6046816616708\"},{\"id\":\"6044315739908\",\"name\":\"NlaLa\",\"adset_id\":\"6044315731508\"},{\"id\":\"6044315740908\",\"name\":\"DJn6R\",\"adset_id\":\"6044315731908\"},{\"id\":\"6044315738308\",\"name\":\"v70l2\",\"adset_id\":\"6044315730908\"},{\"id\":\"6044315739308\",\"name\":\"Dpfjs\",\"adset_id\":\"6044315731708\"},{\"id\":\"6044315737708\",\"name\":\"YHYlU\",\"adset_id\":\"6044315731108\"},{\"id\":\"6044315743508\",\"name\":\"j42mN\",\"adset_id\":\"6044315732708\"},{\"id\":\"6044315743308\",\"name\":\"VxO5h\",\"adset_id\":\"6044315732708\"},{\"id\":\"6044315742308\",\"name\":\"9rSXl\",\"adset_id\":\"6044315732308\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NjgxNjYyMzEwOAZDZD\",\"after\":\"NjA0NDMxNTc0MjMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0NDMxNTc0MjMwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjA0NjgxNjYyMzEwOAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0OTEzMDI4NTMwOAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6049130286708\",\"name\":\"ZV2bC\",\"adset_id\":\"6049130291108\"},{\"id\":\"6049130290308\",\"name\":\"gDnVs\",\"adset_id\":\"6049130283908\"},{\"id\":\"6049130284708\",\"name\":\"16VDs\",\"adset_id\":\"6049130290508\"},{\"id\":\"6049130285708\",\"name\":\"wFIvs\",\"adset_id\":\"6049130290708\"},{\"id\":\"6049130288708\",\"name\":\"rOgag\",\"adset_id\":\"6049130291508\"},{\"id\":\"6049130288508\",\"name\":\"QF0ou\",\"adset_id\":\"6049130291508\"},{\"id\":\"6049130288108\",\"name\":\"SoW35\",\"adset_id\":\"6049130291308\"},{\"id\":\"6049130286908\",\"name\":\"XY7k0\",\"adset_id\":\"6049130291108\"},{\"id\":\"6049130288308\",\"name\":\"BU7iC\",\"adset_id\":\"6049130291508\"},{\"id\":\"6049130285508\",\"name\":\"93ROe\",\"adset_id\":\"6049130290708\"},{\"id\":\"6046816620708\",\"name\":\"bbsBD\",\"adset_id\":\"6046816615908\"},{\"id\":\"6046816624108\",\"name\":\"RXBGe\",\"adset_id\":\"6046816616908\"},{\"id\":\"6046816620108\",\"name\":\"EHcSE\",\"adset_id\":\"6046816615508\"},{\"id\":\"6046816621508\",\"name\":\"nbhbX\",\"adset_id\":\"6046816615708\"},{\"id\":\"6046816622508\",\"name\":\"xWDpH\",\"adset_id\":\"6046816616308\"},{\"id\":\"6046816620908\",\"name\":\"7XIR8\",\"adset_id\":\"6046816615908\"},{\"id\":\"6046816623708\",\"name\":\"PmuD3\",\"adset_id\":\"6046816616908\"},{\"id\":\"6046816621308\",\"name\":\"Lf1UF\",\"adset_id\":\"6046816615708\"},{\"id\":\"6046816625108\",\"name\":\"c8gn0\",\"adset_id\":\"6046816616108\"},{\"id\":\"6046816623908\",\"name\":\"PfUtt\",\"adset_id\":\"6046816616908\"},{\"id\":\"6046816619708\",\"name\":\"a1kSM\",\"adset_id\":\"6046816616108\"},{\"id\":\"6046816625308\",\"name\":\"fj65S\",\"adset_id\":\"6046816616108\"},{\"id\":\"6046816624708\",\"name\":\"QrnO9\",\"adset_id\":\"6046816616508\"},{\"id\":\"6046816621908\",\"name\":\"fKXOY\",\"adset_id\":\"6046816615708\"},{\"id\":\"6046816624308\",\"name\":\"5yPds\",\"adset_id\":\"6046816616908\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0OTEzMDI4NjcwOAZDZD\",\"after\":\"NjA0NjgxNjYyNDMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0NjgxNjYyNDMwOAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&before=NjA0OTEzMDI4NjcwOAZDZD\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v2.9/ads",
 :as :json,
 :query-params
 {:path "ads",
  :fields "id,name,adset_id",
  :ids "act_10152412627713995",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:status 200,
 :body
 "{\"act_10152412627713995\":{\"data\":[{\"id\":\"6052149268308\",\"name\":\"fBuMh\",\"adset_id\":\"6052149268508\"},{\"id\":\"6052149268108\",\"name\":\"tLEFt\",\"adset_id\":\"6052149268508\"},{\"id\":\"6052149267908\",\"name\":\"KyYOF\",\"adset_id\":\"6052149268508\"},{\"id\":\"6049130284108\",\"name\":\"Vvt8m\",\"adset_id\":\"6049130284508\"},{\"id\":\"6049130284308\",\"name\":\"VvCUW\",\"adset_id\":\"6049130284508\"},{\"id\":\"6049130283308\",\"name\":\"Zdzc8\",\"adset_id\":\"6049130284508\"},{\"id\":\"6049130289308\",\"name\":\"w7gbU\",\"adset_id\":\"6049130291708\"},{\"id\":\"6049130289908\",\"name\":\"WwgGc\",\"adset_id\":\"6049130283908\"},{\"id\":\"6049130285108\",\"name\":\"aotgf\",\"adset_id\":\"6049130290508\"},{\"id\":\"6049130286308\",\"name\":\"LfZJb\",\"adset_id\":\"6049130290908\"},{\"id\":\"6049130287708\",\"name\":\"LGOau\",\"adset_id\":\"6049130291308\"},{\"id\":\"6049130289708\",\"name\":\"sajT3\",\"adset_id\":\"6049130283908\"},{\"id\":\"6049130290108\",\"name\":\"LhvxV\",\"adset_id\":\"6049130283908\"},{\"id\":\"6049130288908\",\"name\":\"3bC3o\",\"adset_id\":\"6049130291708\"},{\"id\":\"6049130287908\",\"name\":\"Txj3f\",\"adset_id\":\"6049130291308\"},{\"id\":\"6049130285908\",\"name\":\"VODHV\",\"adset_id\":\"6049130290708\"},{\"id\":\"6049130289508\",\"name\":\"QNotw\",\"adset_id\":\"6049130291708\"},{\"id\":\"6049130284908\",\"name\":\"1rq9v\",\"adset_id\":\"6049130290508\"},{\"id\":\"6049130286508\",\"name\":\"wml9h\",\"adset_id\":\"6049130290908\"},{\"id\":\"6049130287508\",\"name\":\"bH9gW\",\"adset_id\":\"6049130291308\"},{\"id\":\"6049130289108\",\"name\":\"Dv5LX\",\"adset_id\":\"6049130291708\"},{\"id\":\"6049130287108\",\"name\":\"Uxlgd\",\"adset_id\":\"6049130290908\"},{\"id\":\"6049130287308\",\"name\":\"9m2sl\",\"adset_id\":\"6049130291108\"},{\"id\":\"6049130286108\",\"name\":\"6oYqW\",\"adset_id\":\"6049130290908\"},{\"id\":\"6049130285308\",\"name\":\"sQ0Jt\",\"adset_id\":\"6049130290508\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1MjE0OTI2ODMwOAZDZD\",\"after\":\"NjA0OTEzMDI4NTMwOAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152412627713995/ads?access_token=XXTOKENXX&fields=id%2Cname%2Cadset_id&since&until&limit=25&after=NjA0OTEzMDI4NTMwOAZDZD\"}}}"}
)
})

================================================
File: /test/keboola/snapshots/ads/out/tables/adsets.manifest
================================================
{"columns":["id","ex-account-id","fb-graph-node","parent-id","name","account_id"],"incremental":true,"primary_key":["parent_id","id","account_id"]}

================================================
File: /test/keboola/snapshots/ads/out/tables/adsets/1507033521606
================================================
"6018062856108","act_10152412627713995","page_adsets","act_10152412627713995","fSj3D","10152412627713995"
"6018062856308","act_10152412627713995","page_adsets","act_10152412627713995","gu9YE","10152412627713995"
"6018062856508","act_10152412627713995","page_adsets","act_10152412627713995","TzMRV","10152412627713995"
"6018062856708","act_10152412627713995","page_adsets","act_10152412627713995","CTPI9","10152412627713995"
"6018300845308","act_10152412627713995","page_adsets","act_10152412627713995","rjWck","10152412627713995"
"6018300845508","act_10152412627713995","page_adsets","act_10152412627713995","X9EZs","10152412627713995"
"6018300845708","act_10152412627713995","page_adsets","act_10152412627713995","rFf3N","10152412627713995"
"6018300891508","act_10152412627713995","page_adsets","act_10152412627713995","cFn51","10152412627713995"
"6018300892908","act_10152412627713995","page_adsets","act_10152412627713995","5kTWc","10152412627713995"
"6018300893108","act_10152412627713995","page_adsets","act_10152412627713995","ieBZ3","10152412627713995"
"6018300893308","act_10152412627713995","page_adsets","act_10152412627713995","qyMDy","10152412627713995"
"6018395907508","act_10152412627713995","page_adsets","act_10152412627713995","X8Mo8","10152412627713995"
"6018395907708","act_10152412627713995","page_adsets","act_10152412627713995","agFU1","10152412627713995"
"6018395907908","act_10152412627713995","page_adsets","act_10152412627713995","fpYZr","10152412627713995"
"6018869670708","act_10152412627713995","page_adsets","act_10152412627713995","lCyY1","10152412627713995"
"6018869670908","act_10152412627713995","page_adsets","act_10152412627713995","uHWMW","10152412627713995"
"6018869672708","act_10152412627713995","page_adsets","act_10152412627713995","KcN05","10152412627713995"
"6018869672908","act_10152412627713995","page_adsets","act_10152412627713995","CGHke","10152412627713995"
"6018869673108","act_10152412627713995","page_adsets","act_10152412627713995","NcXrs","10152412627713995"
"6018869673308","act_10152412627713995","page_adsets","act_10152412627713995","qqluK","10152412627713995"
"6019173394508","act_10152412627713995","page_adsets","act_10152412627713995","2UWlJ","10152412627713995"
"6019173396508","act_10152412627713995","page_adsets","act_10152412627713995","Nkbbf","10152412627713995"
"6019173396708","act_10152412627713995","page_adsets","act_10152412627713995","pPTM6","10152412627713995"
"6019173396908","act_10152412627713995","page_adsets","act_10152412627713995","EClvd","10152412627713995"
"6019363984708","act_10152412627713995","page_adsets","act_10152412627713995","5oXqZ","10152412627713995"
"6019363986108","act_10152412627713995","page_adsets","act_10152412627713995","68fUg","10152412627713995"
"6019363987908","act_10152412627713995","page_adsets","act_10152412627713995","7nFaT","10152412627713995"
"6019363988108","act_10152412627713995","page_adsets","act_10152412627713995","piJWY","10152412627713995"
"6019363988308","act_10152412627713995","page_adsets","act_10152412627713995","DCVWn","10152412627713995"
"6019363988508","act_10152412627713995","page_adsets","act_10152412627713995","BKNCL","10152412627713995"
"6019650563308","act_10152412627713995","page_adsets","act_10152412627713995","IKQO3","10152412627713995"
"6019650564708","act_10152412627713995","page_adsets","act_10152412627713995","YHR6l","10152412627713995"
"6019650564908","act_10152412627713995","page_adsets","act_10152412627713995","iyq4U","10152412627713995"
"6019736570308","act_10152412627713995","page_adsets","act_10152412627713995","r6MJb","10152412627713995"
"6019736571708","act_10152412627713995","page_adsets","act_10152412627713995","4d99C","10152412627713995"
"6019736571908","act_10152412627713995","page_adsets","act_10152412627713995","WvMfI","10152412627713995"
"6019739763908","act_10152412627713995","page_adsets","act_10152412627713995","6Mcng","10152412627713995"
"6019739764908","act_10152412627713995","page_adsets","act_10152412627713995","mO1fT","10152412627713995"
"6019739765108","act_10152412627713995","page_adsets","act_10152412627713995","2XKXy","10152412627713995"
"6019833857708","act_10152412627713995","page_adsets","act_10152412627713995","3JdjR","10152412627713995"
"6019833858908","act_10152412627713995","page_adsets","act_10152412627713995","7ucru","10152412627713995"
"6019833859308","act_10152412627713995","page_adsets","act_10152412627713995","ufLPL","10152412627713995"
"6019982602508","act_10152412627713995","page_adsets","act_10152412627713995","EOxGL","10152412627713995"
"6019982772908","act_10152412627713995","page_adsets","act_10152412627713995","OtOE9","10152412627713995"
"6019982774908","act_10152412627713995","page_adsets","act_10152412627713995","rcCqg","10152412627713995"
"6019982775108","act_10152412627713995","page_adsets","act_10152412627713995","qriC4","10152412627713995"
"6019982775308","act_10152412627713995","page_adsets","act_10152412627713995","TCDfs","10152412627713995"
"6020084745308","act_10152412627713995","page_adsets","act_10152412627713995","foUTW","10152412627713995"
"6020084746508","act_10152412627713995","page_adsets","act_10152412627713995","eTybH","10152412627713995"
"6020084747308","act_10152412627713995","page_adsets","act_10152412627713995","EUkNO","10152412627713995"
"6020118445108","act_10152412627713995","page_adsets","act_10152412627713995","reipM","10152412627713995"
"6020176077508","act_10152412627713995","page_adsets","act_10152412627713995","8xP4H","10152412627713995"
"6020304748108","act_10152412627713995","page_adsets","act_10152412627713995","PiVmF","10152412627713995"
"6020374960908","act_10152412627713995","page_adsets","act_10152412627713995","rNGhx","10152412627713995"
"6020525094508","act_10152412627713995","page_adsets","act_10152412627713995","MXuSh","10152412627713995"
"6020525769508","act_10152412627713995","page_adsets","act_10152412627713995","cnBp5","10152412627713995"
"6020764680708","act_10152412627713995","page_adsets","act_10152412627713995","HWM3q","10152412627713995"
"6020779953708","act_10152412627713995","page_adsets","act_10152412627713995","htiai","10152412627713995"
"6020834987908","act_10152412627713995","page_adsets","act_10152412627713995","djnER","10152412627713995"
"6021065595108","act_10152412627713995","page_adsets","act_10152412627713995","ThZMv","10152412627713995"
"6021430991108","act_10152412627713995","page_adsets","act_10152412627713995","d4l1m","10152412627713995"
"6021527352708","act_10152412627713995","page_adsets","act_10152412627713995","RZqtz","10152412627713995"
"6021617811308","act_10152412627713995","page_adsets","act_10152412627713995","6Ctn6","10152412627713995"
"6021618799108","act_10152412627713995","page_adsets","act_10152412627713995","Q99az","10152412627713995"
"6021618800108","act_10152412627713995","page_adsets","act_10152412627713995","dPCXb","10152412627713995"
"6021618800308","act_10152412627713995","page_adsets","act_10152412627713995","2nSMV","10152412627713995"
"6021703482308","act_10152412627713995","page_adsets","act_10152412627713995","rSsoN","10152412627713995"
"6021704238908","act_10152412627713995","page_adsets","act_10152412627713995","96Kcm","10152412627713995"
"6021704239708","act_10152412627713995","page_adsets","act_10152412627713995","R6NxU","10152412627713995"
"6021704239908","act_10152412627713995","page_adsets","act_10152412627713995","syj1X","10152412627713995"
"6021862044508","act_10152412627713995","page_adsets","act_10152412627713995","XrXsP","10152412627713995"
"6022099353908","act_10152412627713995","page_adsets","act_10152412627713995","5G2p4","10152412627713995"
"6022227533708","act_10152412627713995","page_adsets","act_10152412627713995","uwWe5","10152412627713995"
"6022384455308","act_10152412627713995","page_adsets","act_10152412627713995","74Ylr","10152412627713995"
"6022497475308","act_10152412627713995","page_adsets","act_10152412627713995","9TbI4","10152412627713995"
"6022769055908","act_10152412627713995","page_adsets","act_10152412627713995","nFPPU","10152412627713995"
"6022769056108","act_10152412627713995","page_adsets","act_10152412627713995","0a67n","10152412627713995"
"6022769056708","act_10152412627713995","page_adsets","act_10152412627713995","dLxCH","10152412627713995"
"6023110052708","act_10152412627713995","page_adsets","act_10152412627713995","VjDuT","10152412627713995"
"6023170890708","act_10152412627713995","page_adsets","act_10152412627713995","GMu6O","10152412627713995"
"6023170891308","act_10152412627713995","page_adsets","act_10152412627713995","Ml5cG","10152412627713995"
"6023987408708","act_10152412627713995","page_adsets","act_10152412627713995","Ttplp","10152412627713995"
"6023987408908","act_10152412627713995","page_adsets","act_10152412627713995","P9ZtI","10152412627713995"
"6023987409108","act_10152412627713995","page_adsets","act_10152412627713995","b2WWN","10152412627713995"
"6023987409308","act_10152412627713995","page_adsets","act_10152412627713995","1428D","10152412627713995"
"6023987410108","act_10152412627713995","page_adsets","act_10152412627713995","04Z3o","10152412627713995"
"6023987411908","act_10152412627713995","page_adsets","act_10152412627713995","cKj18","10152412627713995"
"6023987412108","act_10152412627713995","page_adsets","act_10152412627713995","qfY05","10152412627713995"
"6023987412508","act_10152412627713995","page_adsets","act_10152412627713995","KXBue","10152412627713995"
"6025342742708","act_10152412627713995","page_adsets","act_10152412627713995","M6qHK","10152412627713995"
"6025342742908","act_10152412627713995","page_adsets","act_10152412627713995","Zb3BC","10152412627713995"
"6025342743108","act_10152412627713995","page_adsets","act_10152412627713995","FWtlt","10152412627713995"
"6025342743708","act_10152412627713995","page_adsets","act_10152412627713995","yunVF","10152412627713995"
"6025523611108","act_10152412627713995","page_adsets","act_10152412627713995","MGbVx","10152412627713995"
"6025523611508","act_10152412627713995","page_adsets","act_10152412627713995","eyYJF","10152412627713995"
"6025523612308","act_10152412627713995","page_adsets","act_10152412627713995","DKHJb","10152412627713995"
"6025523612708","act_10152412627713995","page_adsets","act_10152412627713995","oVMW8","10152412627713995"
"6026287408108","act_10152412627713995","page_adsets","act_10152412627713995","6iEyx","10152412627713995"
"6026287408308","act_10152412627713995","page_adsets","act_10152412627713995","6we19","10152412627713995"
"6026287408508","act_10152412627713995","page_adsets","act_10152412627713995","iSb9l","10152412627713995"
"6026287409108","act_10152412627713995","page_adsets","act_10152412627713995","ZToHw","10152412627713995"
"6026287409908","act_10152412627713995","page_adsets","act_10152412627713995","Rsyee","10152412627713995"
"6026287411108","act_10152412627713995","page_adsets","act_10152412627713995","M06Gq","10152412627713995"
"6026287411908","act_10152412627713995","page_adsets","act_10152412627713995","vkIbP","10152412627713995"
"6026287412308","act_10152412627713995","page_adsets","act_10152412627713995","yOnXI","10152412627713995"
"6026992781108","act_10152412627713995","page_adsets","act_10152412627713995","3CNCq","10152412627713995"
"6026992781308","act_10152412627713995","page_adsets","act_10152412627713995","lfHIc","10152412627713995"
"6026992781908","act_10152412627713995","page_adsets","act_10152412627713995","e5crn","10152412627713995"
"6026992783508","act_10152412627713995","page_adsets","act_10152412627713995","uc5pd","10152412627713995"
"6026992783708","act_10152412627713995","page_adsets","act_10152412627713995","uyDye","10152412627713995"
"6026992784308","act_10152412627713995","page_adsets","act_10152412627713995","gIFm5","10152412627713995"
"6026999962108","act_10152412627713995","page_adsets","act_10152412627713995","rpTpb","10152412627713995"
"6026999962908","act_10152412627713995","page_adsets","act_10152412627713995","4Jfb4","10152412627713995"
"6028106062308","act_10152412627713995","page_adsets","act_10152412627713995","U7w6l","10152412627713995"
"6028106062508","act_10152412627713995","page_adsets","act_10152412627713995","o0nqs","10152412627713995"
"6028106062708","act_10152412627713995","page_adsets","act_10152412627713995","W0qHK","10152412627713995"
"6028106062908","act_10152412627713995","page_adsets","act_10152412627713995","5ah7R","10152412627713995"
"6029050665508","act_10152412627713995","page_adsets","act_10152412627713995","yEDhs","10152412627713995"
"6029050665708","act_10152412627713995","page_adsets","act_10152412627713995","tnOKC","10152412627713995"
"6029050665908","act_10152412627713995","page_adsets","act_10152412627713995","qBKPn","10152412627713995"
"6029050666708","act_10152412627713995","page_adsets","act_10152412627713995","rYBJD","10152412627713995"
"6030899849708","act_10152412627713995","page_adsets","act_10152412627713995","bMV3J","10152412627713995"
"6030899850508","act_10152412627713995","page_adsets","act_10152412627713995","Xt4Nc","10152412627713995"
"6030899850708","act_10152412627713995","page_adsets","act_10152412627713995","bejzM","10152412627713995"
"6030899850908","act_10152412627713995","page_adsets","act_10152412627713995","7ihmO","10152412627713995"
"6031426192908","act_10152412627713995","page_adsets","act_10152412627713995","aO1ge","10152412627713995"
"6031426193508","act_10152412627713995","page_adsets","act_10152412627713995","qC0LY","10152412627713995"
"6032597922908","act_10152412627713995","page_adsets","act_10152412627713995","SDPZG","10152412627713995"
"6032597923108","act_10152412627713995","page_adsets","act_10152412627713995","YOrpl","10152412627713995"
"6032597923508","act_10152412627713995","page_adsets","act_10152412627713995","Cd3wz","10152412627713995"
"6032597923708","act_10152412627713995","page_adsets","act_10152412627713995","FDnrv","10152412627713995"
"6032597924508","act_10152412627713995","page_adsets","act_10152412627713995","vF6ly","10152412627713995"
"6032597925508","act_10152412627713995","page_adsets","act_10152412627713995","YhPQI","10152412627713995"
"6032883803308","act_10152412627713995","page_adsets","act_10152412627713995","yvvJM","10152412627713995"
"6034087416108","act_10152412627713995","page_adsets","act_10152412627713995","YtetE","10152412627713995"
"6034087416508","act_10152412627713995","page_adsets","act_10152412627713995","MxHLP","10152412627713995"
"6034087416708","act_10152412627713995","page_adsets","act_10152412627713995","PsSPS","10152412627713995"
"6034087416908","act_10152412627713995","page_adsets","act_10152412627713995","dYTYM","10152412627713995"
"6034087417908","act_10152412627713995","page_adsets","act_10152412627713995","rmriT","10152412627713995"
"6034087418908","act_10152412627713995","page_adsets","act_10152412627713995","FTJNg","10152412627713995"
"6034803645508","act_10152412627713995","page_adsets","act_10152412627713995","ESHoi","10152412627713995"
"6034803645708","act_10152412627713995","page_adsets","act_10152412627713995","D7GGJ","10152412627713995"
"6034803786708","act_10152412627713995","page_adsets","act_10152412627713995","grFez","10152412627713995"
"6034803787508","act_10152412627713995","page_adsets","act_10152412627713995","YsCCj","10152412627713995"
"6035030428908","act_10152412627713995","page_adsets","act_10152412627713995","vpE52","10152412627713995"
"6035030430708","act_10152412627713995","page_adsets","act_10152412627713995","M8kmP","10152412627713995"
"6036310192508","act_10152412627713995","page_adsets","act_10152412627713995","Rx41z","10152412627713995"
"6036310193308","act_10152412627713995","page_adsets","act_10152412627713995","phsNS","10152412627713995"
"6036310194508","act_10152412627713995","page_adsets","act_10152412627713995","mUbmY","10152412627713995"
"6036310195108","act_10152412627713995","page_adsets","act_10152412627713995","yvG7p","10152412627713995"
"6036310195708","act_10152412627713995","page_adsets","act_10152412627713995","k0vWt","10152412627713995"
"6036310196908","act_10152412627713995","page_adsets","act_10152412627713995","PhkE9","10152412627713995"
"6037764902908","act_10152412627713995","page_adsets","act_10152412627713995","Q7pHX","10152412627713995"
"6037764903508","act_10152412627713995","page_adsets","act_10152412627713995","tbxmF","10152412627713995"
"6037764905508","act_10152412627713995","page_adsets","act_10152412627713995","cTCMK","10152412627713995"
"6037764905708","act_10152412627713995","page_adsets","act_10152412627713995","vtLs7","10152412627713995"
"6037764906508","act_10152412627713995","page_adsets","act_10152412627713995","6jtrF","10152412627713995"
"6037764907508","act_10152412627713995","page_adsets","act_10152412627713995","8QPKq","10152412627713995"
"6037795800308","act_10152412627713995","page_adsets","act_10152412627713995","yGJ36","10152412627713995"
"6037797042908","act_10152412627713995","page_adsets","act_10152412627713995","wd4cC","10152412627713995"
"6037797043108","act_10152412627713995","page_adsets","act_10152412627713995","iszhE","10152412627713995"
"6037797571708","act_10152412627713995","page_adsets","act_10152412627713995","6cHYb","10152412627713995"
"6037797572108","act_10152412627713995","page_adsets","act_10152412627713995","8inzZ","10152412627713995"
"6039331669708","act_10152412627713995","page_adsets","act_10152412627713995","jFlux","10152412627713995"
"6039331670308","act_10152412627713995","page_adsets","act_10152412627713995","iptIa","10152412627713995"
"6039331671708","act_10152412627713995","page_adsets","act_10152412627713995","OI5RE","10152412627713995"
"6039331671908","act_10152412627713995","page_adsets","act_10152412627713995","GUnv7","10152412627713995"
"6039331672708","act_10152412627713995","page_adsets","act_10152412627713995","I4rRE","10152412627713995"
"6039331673508","act_10152412627713995","page_adsets","act_10152412627713995","ulP4n","10152412627713995"
"6040739381508","act_10152412627713995","page_adsets","act_10152412627713995","Ul6aL","10152412627713995"
"6040739717108","act_10152412627713995","page_adsets","act_10152412627713995","1sel3","10152412627713995"
"6040739718708","act_10152412627713995","page_adsets","act_10152412627713995","IXE5p","10152412627713995"
"6040739718908","act_10152412627713995","page_adsets","act_10152412627713995","me1vb","10152412627713995"
"6040739719108","act_10152412627713995","page_adsets","act_10152412627713995","DsqTH","10152412627713995"
"6040740278708","act_10152412627713995","page_adsets","act_10152412627713995","fpmQy","10152412627713995"
"6040740278908","act_10152412627713995","page_adsets","act_10152412627713995","2lmFI","10152412627713995"
"6040740929908","act_10152412627713995","page_adsets","act_10152412627713995","HitQt","10152412627713995"
"6042191851108","act_10152412627713995","page_adsets","act_10152412627713995","7jbcZ","10152412627713995"
"6042191851308","act_10152412627713995","page_adsets","act_10152412627713995","fh1cO","10152412627713995"
"6042191851508","act_10152412627713995","page_adsets","act_10152412627713995","IWGS6","10152412627713995"
"6042191851708","act_10152412627713995","page_adsets","act_10152412627713995","LPGnt","10152412627713995"
"6042191851908","act_10152412627713995","page_adsets","act_10152412627713995","zuCHX","10152412627713995"
"6042191852108","act_10152412627713995","page_adsets","act_10152412627713995","J7Siw","10152412627713995"
"6042191852308","act_10152412627713995","page_adsets","act_10152412627713995","o59zn","10152412627713995"
"6042191852508","act_10152412627713995","page_adsets","act_10152412627713995","bGff0","10152412627713995"
"6042213730508","act_10152412627713995","page_adsets","act_10152412627713995","F8rMm","10152412627713995"
"6042213730708","act_10152412627713995","page_adsets","act_10152412627713995","OQjcX","10152412627713995"
"6042601725308","act_10152412627713995","page_adsets","act_10152412627713995","je10L","10152412627713995"
"6042601725508","act_10152412627713995","page_adsets","act_10152412627713995","ldYff","10152412627713995"
"6042601725708","act_10152412627713995","page_adsets","act_10152412627713995","2Ut4v","10152412627713995"
"6042601725908","act_10152412627713995","page_adsets","act_10152412627713995","cbkEf","10152412627713995"
"6044315730708","act_10152412627713995","page_adsets","act_10152412627713995","VpIDv","10152412627713995"
"6044315730908","act_10152412627713995","page_adsets","act_10152412627713995","dI2Yb","10152412627713995"
"6044315731108","act_10152412627713995","page_adsets","act_10152412627713995","7Xh0z","10152412627713995"
"6044315731308","act_10152412627713995","page_adsets","act_10152412627713995","sOWHu","10152412627713995"
"6044315731508","act_10152412627713995","page_adsets","act_10152412627713995","XUpxQ","10152412627713995"
"6044315731708","act_10152412627713995","page_adsets","act_10152412627713995","or6q8","10152412627713995"
"6044315731908","act_10152412627713995","page_adsets","act_10152412627713995","cMTHD","10152412627713995"
"6044315732108","act_10152412627713995","page_adsets","act_10152412627713995","EviP5","10152412627713995"
"6044315732308","act_10152412627713995","page_adsets","act_10152412627713995","fjOP8","10152412627713995"
"6044315732508","act_10152412627713995","page_adsets","act_10152412627713995","OkDEe","10152412627713995"
"6044315732708","act_10152412627713995","page_adsets","act_10152412627713995","hekty","10152412627713995"
"6044315732908","act_10152412627713995","page_adsets","act_10152412627713995","fRyxl","10152412627713995"
"6044315733108","act_10152412627713995","page_adsets","act_10152412627713995","T4zyT","10152412627713995"
"6044315733308","act_10152412627713995","page_adsets","act_10152412627713995","PoRwx","10152412627713995"
"6046816615308","act_10152412627713995","page_adsets","act_10152412627713995","SVjUv","10152412627713995"
"6046816615508","act_10152412627713995","page_adsets","act_10152412627713995","MBykG","10152412627713995"
"6046816615708","act_10152412627713995","page_adsets","act_10152412627713995","TUBEg","10152412627713995"
"6046816615908","act_10152412627713995","page_adsets","act_10152412627713995","eekc8","10152412627713995"
"6046816616108","act_10152412627713995","page_adsets","act_10152412627713995","e5IK3","10152412627713995"
"6046816616308","act_10152412627713995","page_adsets","act_10152412627713995","g0ZJS","10152412627713995"
"6046816616508","act_10152412627713995","page_adsets","act_10152412627713995","sLLr1","10152412627713995"
"6046816616708","act_10152412627713995","page_adsets","act_10152412627713995","NbiRB","10152412627713995"
"6046816616908","act_10152412627713995","page_adsets","act_10152412627713995","SH7jM","10152412627713995"
"6049130283908","act_10152412627713995","page_adsets","act_10152412627713995","qaayr","10152412627713995"
"6049130284508","act_10152412627713995","page_adsets","act_10152412627713995","tGmrx","10152412627713995"
"6049130290508","act_10152412627713995","page_adsets","act_10152412627713995","hN0IN","10152412627713995"
"6049130290708","act_10152412627713995","page_adsets","act_10152412627713995","4uyo3","10152412627713995"
"6049130290908","act_10152412627713995","page_adsets","act_10152412627713995","HQsPO","10152412627713995"
"6049130291108","act_10152412627713995","page_adsets","act_10152412627713995","9QxN4","10152412627713995"
"6049130291308","act_10152412627713995","page_adsets","act_10152412627713995","dsCBW","10152412627713995"
"6049130291508","act_10152412627713995","page_adsets","act_10152412627713995","9pyEN","10152412627713995"
"6049130291708","act_10152412627713995","page_adsets","act_10152412627713995","ft6Sb","10152412627713995"
"6052149268508","act_10152412627713995","page_adsets","act_10152412627713995","vh9XX","10152412627713995"


================================================
File: /test/keboola/snapshots/ads/out/tables/campaigns/1507033519047
================================================
"6018062854308","act_10152412627713995","page_campaigns","act_10152412627713995","8Gj7i","10152412627713995"
"6018300843708","act_10152412627713995","page_campaigns","act_10152412627713995","hvWzD","10152412627713995"
"6018300843908","act_10152412627713995","page_campaigns","act_10152412627713995","XwYPZ","10152412627713995"
"6019173393708","act_10152412627713995","page_campaigns","act_10152412627713995","oGkEu","10152412627713995"
"6019363983508","act_10152412627713995","page_campaigns","act_10152412627713995","QELGH","10152412627713995"
"6019982601108","act_10152412627713995","page_campaigns","act_10152412627713995","covB4","10152412627713995"
"6019982771708","act_10152412627713995","page_campaigns","act_10152412627713995","RqiZ8","10152412627713995"
"6020012167508","act_10152412627713995","page_campaigns","act_10152412627713995","TuLKl","10152412627713995"
"6020764641508","act_10152412627713995","page_campaigns","act_10152412627713995","Xw0YP","10152412627713995"
"6021430990308","act_10152412627713995","page_campaigns","act_10152412627713995","pay1H","10152412627713995"
"6021618797908","act_10152412627713995","page_campaigns","act_10152412627713995","eiMuF","10152412627713995"
"6021704237308","act_10152412627713995","page_campaigns","act_10152412627713995","rw0TB","10152412627713995"
"6022227532708","act_10152412627713995","page_campaigns","act_10152412627713995","nC8pw","10152412627713995"
"6023110050908","act_10152412627713995","page_campaigns","act_10152412627713995","T0CUW","10152412627713995"
"6023987405508","act_10152412627713995","page_campaigns","act_10152412627713995","DvoMQ","10152412627713995"
"6023987405708","act_10152412627713995","page_campaigns","act_10152412627713995","fDNUQ","10152412627713995"
"6025342736908","act_10152412627713995","page_campaigns","act_10152412627713995","5mHlc","10152412627713995"
"6025523608508","act_10152412627713995","page_campaigns","act_10152412627713995","blxHI","10152412627713995"
"6026287405308","act_10152412627713995","page_campaigns","act_10152412627713995","WCR5z","10152412627713995"
"6026287405508","act_10152412627713995","page_campaigns","act_10152412627713995","Wh6jH","10152412627713995"
"6026992252308","act_10152412627713995","page_campaigns","act_10152412627713995","McnqL","10152412627713995"
"6026992779108","act_10152412627713995","page_campaigns","act_10152412627713995","OoLHu","10152412627713995"
"6028106057908","act_10152412627713995","page_campaigns","act_10152412627713995","XbNoo","10152412627713995"
"6028106058108","act_10152412627713995","page_campaigns","act_10152412627713995","9ISyt","10152412627713995"
"6029050661508","act_10152412627713995","page_campaigns","act_10152412627713995","YKB5o","10152412627713995"
"6029050661908","act_10152412627713995","page_campaigns","act_10152412627713995","LpEbN","10152412627713995"
"6030899843508","act_10152412627713995","page_campaigns","act_10152412627713995","9CmVC","10152412627713995"
"6030899843708","act_10152412627713995","page_campaigns","act_10152412627713995","jU043","10152412627713995"
"6031426188908","act_10152412627713995","page_campaigns","act_10152412627713995","uOYg4","10152412627713995"
"6031426189108","act_10152412627713995","page_campaigns","act_10152412627713995","QhtfU","10152412627713995"
"6032597915908","act_10152412627713995","page_campaigns","act_10152412627713995","nczg6","10152412627713995"
"6032597916108","act_10152412627713995","page_campaigns","act_10152412627713995","PKp9t","10152412627713995"
"6032597916308","act_10152412627713995","page_campaigns","act_10152412627713995","3ynst","10152412627713995"
"6032597916508","act_10152412627713995","page_campaigns","act_10152412627713995","ntQVj","10152412627713995"
"6032883801708","act_10152412627713995","page_campaigns","act_10152412627713995","PV01o","10152412627713995"
"6034087406108","act_10152412627713995","page_campaigns","act_10152412627713995","vT2Kf","10152412627713995"
"6034087406308","act_10152412627713995","page_campaigns","act_10152412627713995","cXdGL","10152412627713995"
"6034087406508","act_10152412627713995","page_campaigns","act_10152412627713995","auoGJ","10152412627713995"
"6034087406708","act_10152412627713995","page_campaigns","act_10152412627713995","3wNMU","10152412627713995"
"6034803642708","act_10152412627713995","page_campaigns","act_10152412627713995","83URP","10152412627713995"
"6036310188308","act_10152412627713995","page_campaigns","act_10152412627713995","o5rDt","10152412627713995"
"6037764899108","act_10152412627713995","page_campaigns","act_10152412627713995","21ctp","10152412627713995"
"6037795175108","act_10152412627713995","page_campaigns","act_10152412627713995","pMeRv","10152412627713995"
"6039331667708","act_10152412627713995","page_campaigns","act_10152412627713995","v6PMg","10152412627713995"
"6040739715908","act_10152412627713995","page_campaigns","act_10152412627713995","pLL8f","10152412627713995"
"6040739716108","act_10152412627713995","page_campaigns","act_10152412627713995","t2d96","10152412627713995"
"6040740277908","act_10152412627713995","page_campaigns","act_10152412627713995","xikYt","10152412627713995"
"6040740278108","act_10152412627713995","page_campaigns","act_10152412627713995","VsXdg","10152412627713995"
"6042191850708","act_10152412627713995","page_campaigns","act_10152412627713995","cyHKO","10152412627713995"
"6042213729708","act_10152412627713995","page_campaigns","act_10152412627713995","poKK7","10152412627713995"
"6042213729908","act_10152412627713995","page_campaigns","act_10152412627713995","In4VK","10152412627713995"
"6042601724508","act_10152412627713995","page_campaigns","act_10152412627713995","yHEZ7","10152412627713995"
"6042601724708","act_10152412627713995","page_campaigns","act_10152412627713995","S5kYi","10152412627713995"
"6044315728708","act_10152412627713995","page_campaigns","act_10152412627713995","jOwZ2","10152412627713995"
"6044315728908","act_10152412627713995","page_campaigns","act_10152412627713995","YsQpP","10152412627713995"
"6044315729108","act_10152412627713995","page_campaigns","act_10152412627713995","JWsNS","10152412627713995"
"6044315729308","act_10152412627713995","page_campaigns","act_10152412627713995","ZrlnR","10152412627713995"
"6044315729508","act_10152412627713995","page_campaigns","act_10152412627713995","oex08","10152412627713995"
"6046816614308","act_10152412627713995","page_campaigns","act_10152412627713995","CKsXC","10152412627713995"
"6046816614508","act_10152412627713995","page_campaigns","act_10152412627713995","OvvPv","10152412627713995"
"6049130283508","act_10152412627713995","page_campaigns","act_10152412627713995","wRoPk","10152412627713995"
"6049130283708","act_10152412627713995","page_campaigns","act_10152412627713995","6EUEL","10152412627713995"
"6052149267708","act_10152412627713995","page_campaigns","act_10152412627713995","zpZri","10152412627713995"


================================================
File: /test/keboola/snapshots/ads/out/tables/accounts
================================================
account_id,name,business_name,currency,id
10152412627713995,blabla,,EUR,act_10152412627713995


================================================
File: /test/keboola/snapshots/ads/out/tables/ads/1507033518092
================================================
"6034803805508","act_10152412627713995","page_ads","act_10152412627713995","WGUGP","6034803786708"
"6034803651908","act_10152412627713995","page_ads","act_10152412627713995","DdBBg","6034803645508"
"6034803800308","act_10152412627713995","page_ads","act_10152412627713995","ihOiV","6034803787508"
"6034803657508","act_10152412627713995","page_ads","act_10152412627713995","PLLct","6034803645508"
"6034803804708","act_10152412627713995","page_ads","act_10152412627713995","5hOGa","6034803786708"
"6034803800508","act_10152412627713995","page_ads","act_10152412627713995","kSbpk","6034803787508"
"6034087426908","act_10152412627713995","page_ads","act_10152412627713995","cNPfx","6034087416908"
"6034087476108","act_10152412627713995","page_ads","act_10152412627713995","CbGKy","6034087416508"
"6034087432708","act_10152412627713995","page_ads","act_10152412627713995","QEP4T","6034087416908"
"6034087456308","act_10152412627713995","page_ads","act_10152412627713995","8kffL","6034087418908"
"6034087426308","act_10152412627713995","page_ads","act_10152412627713995","p0O1E","6034087416908"
"6034087450108","act_10152412627713995","page_ads","act_10152412627713995","oeEWt","6034087418908"
"6034087465708","act_10152412627713995","page_ads","act_10152412627713995","H3rIb","6034087416508"
"6034087428508","act_10152412627713995","page_ads","act_10152412627713995","VQIQF","6034087416908"
"6034087426108","act_10152412627713995","page_ads","act_10152412627713995","hzJJT","6034087416908"
"6034087463708","act_10152412627713995","page_ads","act_10152412627713995","SmZN7","6034087416108"
"6034087446508","act_10152412627713995","page_ads","act_10152412627713995","ezFzc","6034087418908"
"6034087472508","act_10152412627713995","page_ads","act_10152412627713995","Djzar","6034087416108"
"6034087474708","act_10152412627713995","page_ads","act_10152412627713995","OIgv3","6034087416508"
"6034087471108","act_10152412627713995","page_ads","act_10152412627713995","uNd6v","6034087416108"
"6034087450308","act_10152412627713995","page_ads","act_10152412627713995","CZgrQ","6034087418908"
"6035030513308","act_10152412627713995","page_ads","act_10152412627713995","jeapl","6035030428908"
"6035030512708","act_10152412627713995","page_ads","act_10152412627713995","PQDmJ","6035030430708"
"6035030516508","act_10152412627713995","page_ads","act_10152412627713995","9YNZG","6035030428908"
"6035030511908","act_10152412627713995","page_ads","act_10152412627713995","NzaWY","6035030430708"
"6035030517708","act_10152412627713995","page_ads","act_10152412627713995","u0nVo","6035030430708"
"6035030512308","act_10152412627713995","page_ads","act_10152412627713995","gfdhS","6035030428908"
"6035030516308","act_10152412627713995","page_ads","act_10152412627713995","du2HD","6035030428908"
"6035030517108","act_10152412627713995","page_ads","act_10152412627713995","eCBTb","6035030430708"
"6036310208308","act_10152412627713995","page_ads","act_10152412627713995","jqHFF","6036310195108"
"6036310208908","act_10152412627713995","page_ads","act_10152412627713995","g1nia","6036310195108"
"6036310214308","act_10152412627713995","page_ads","act_10152412627713995","DYWn6","6036310195108"
"6036310229308","act_10152412627713995","page_ads","act_10152412627713995","9NeWo","6036310194508"
"6036310231308","act_10152412627713995","page_ads","act_10152412627713995","o7lob","6036310192508"
"6036310231908","act_10152412627713995","page_ads","act_10152412627713995","sO4hr","6036310194508"
"6036310235908","act_10152412627713995","page_ads","act_10152412627713995","gUC2K","6036310194508"
"6036310216708","act_10152412627713995","page_ads","act_10152412627713995","jWuMq","6036310193308"
"6036310223908","act_10152412627713995","page_ads","act_10152412627713995","OKL4K","6036310193308"
"6036310232308","act_10152412627713995","page_ads","act_10152412627713995","sgC1H","6036310195708"
"6036310232708","act_10152412627713995","page_ads","act_10152412627713995","VvTFE","6036310195708"
"6036310232908","act_10152412627713995","page_ads","act_10152412627713995","PgkFP","6036310193308"
"6036310238108","act_10152412627713995","page_ads","act_10152412627713995","mgOim","6036310192508"
"6036310239508","act_10152412627713995","page_ads","act_10152412627713995","wh5Gu","6036310192508"
"6036310223708","act_10152412627713995","page_ads","act_10152412627713995","e5bnO","6036310195708"
"6036310264508","act_10152412627713995","page_ads","act_10152412627713995","t12XV","6036310196908"
"6036310265308","act_10152412627713995","page_ads","act_10152412627713995","DsLtQ","6036310196908"
"6036310266508","act_10152412627713995","page_ads","act_10152412627713995","SbeyC","6036310196908"
"6036310235508","act_10152412627713995","page_ads","act_10152412627713995","u3jUy","6036310192508"
"6036310216508","act_10152412627713995","page_ads","act_10152412627713995","wCfIR","6036310193308"
"6036310228908","act_10152412627713995","page_ads","act_10152412627713995","pgr9R","6036310194508"
"6036310229708","act_10152412627713995","page_ads","act_10152412627713995","TYQFb","6036310195708"
"6036310265908","act_10152412627713995","page_ads","act_10152412627713995","qlfNg","6036310196908"
"6036310209108","act_10152412627713995","page_ads","act_10152412627713995","Q0F4Y","6036310195108"
"6037796644908","act_10152412627713995","page_ads","act_10152412627713995","LCxUd","6037795800308"
"6037796645108","act_10152412627713995","page_ads","act_10152412627713995","aBUd9","6037795800308"
"6037797048308","act_10152412627713995","page_ads","act_10152412627713995","HOoZU","6037797043108"
"6037797046708","act_10152412627713995","page_ads","act_10152412627713995","B5q5S","6037797042908"
"6037797048108","act_10152412627713995","page_ads","act_10152412627713995","mVI7n","6037797042908"
"6037797050908","act_10152412627713995","page_ads","act_10152412627713995","RBNbJ","6037797043108"
"6037797582708","act_10152412627713995","page_ads","act_10152412627713995","eByfj","6037797571708"
"6037797584308","act_10152412627713995","page_ads","act_10152412627713995","ChtO0","6037797571708"
"6037797585708","act_10152412627713995","page_ads","act_10152412627713995","E7mud","6037797572108"
"6037797590108","act_10152412627713995","page_ads","act_10152412627713995","lK2vE","6037797572108"
"6037764975308","act_10152412627713995","page_ads","act_10152412627713995","EY6ak","6037764903508"
"6037764982308","act_10152412627713995","page_ads","act_10152412627713995","PyvHd","6037764903508"
"6037764987508","act_10152412627713995","page_ads","act_10152412627713995","2J0WC","6037764903508"
"6037764973308","act_10152412627713995","page_ads","act_10152412627713995","55vcy","6037764902908"
"6037764973508","act_10152412627713995","page_ads","act_10152412627713995","FHUG7","6037764902908"
"6037764974108","act_10152412627713995","page_ads","act_10152412627713995","5fl7E","6037764902908"
"6037764995508","act_10152412627713995","page_ads","act_10152412627713995","nLJX9","6037764905708"
"6037764994508","act_10152412627713995","page_ads","act_10152412627713995","lixYd","6037764905708"
"6037764995908","act_10152412627713995","page_ads","act_10152412627713995","4TOF0","6037764905708"
"6037765026108","act_10152412627713995","page_ads","act_10152412627713995","Y7By6","6037764905708"
"6037765010108","act_10152412627713995","page_ads","act_10152412627713995","7CTo5","6037764905508"
"6037765004908","act_10152412627713995","page_ads","act_10152412627713995","b8bqp","6037764907508"
"6037765027308","act_10152412627713995","page_ads","act_10152412627713995","nE1na","6037764906508"
"6037764987308","act_10152412627713995","page_ads","act_10152412627713995","zq2j6","6037764906508"
"6037765010908","act_10152412627713995","page_ads","act_10152412627713995","omir0","6037764905508"
"6037765005108","act_10152412627713995","page_ads","act_10152412627713995","etoPX","6037764907508"
"6037765009508","act_10152412627713995","page_ads","act_10152412627713995","p1rZX","6037764905508"
"6037765007708","act_10152412627713995","page_ads","act_10152412627713995","7ni2x","6037764907508"
"6037765011708","act_10152412627713995","page_ads","act_10152412627713995","fE20P","6037764905508"
"6037764996108","act_10152412627713995","page_ads","act_10152412627713995","2rBcs","6037764906508"
"6037764982708","act_10152412627713995","page_ads","act_10152412627713995","hroMF","6037764906508"
"6037765011308","act_10152412627713995","page_ads","act_10152412627713995","RpcqP","6037764907508"
"6037765028508","act_10152412627713995","page_ads","act_10152412627713995","DH07V","6037764903508"
"6039331696108","act_10152412627713995","page_ads","act_10152412627713995","jFtyY","6039331671908"
"6039331710908","act_10152412627713995","page_ads","act_10152412627713995","yPDyK","6039331673508"
"6039331730908","act_10152412627713995","page_ads","act_10152412627713995","8Rgfm","6039331673508"
"6039331744508","act_10152412627713995","page_ads","act_10152412627713995","DskYn","6039331671708"
"6039331746308","act_10152412627713995","page_ads","act_10152412627713995","ruB1i","6039331673508"
"6039331813908","act_10152412627713995","page_ads","act_10152412627713995","SSmvx","6039331671908"
"6039331827108","act_10152412627713995","page_ads","act_10152412627713995","tnD4Z","6039331671908"
"6039331827908","act_10152412627713995","page_ads","act_10152412627713995","p4aI9","6039331671708"
"6039331850508","act_10152412627713995","page_ads","act_10152412627713995","ZSvL6","6039331673508"
"6039331850708","act_10152412627713995","page_ads","act_10152412627713995","qMow6","6039331671708"
"6039331860308","act_10152412627713995","page_ads","act_10152412627713995","YJpmr","6039331671908"
"6039331866908","act_10152412627713995","page_ads","act_10152412627713995","52nUR","6039331671708"
"6040739381908","act_10152412627713995","page_ads","act_10152412627713995","Bb1XH","6040739381508"
"6040739382108","act_10152412627713995","page_ads","act_10152412627713995","xakn3","6040739381508"
"6040739382308","act_10152412627713995","page_ads","act_10152412627713995","CqGio","6040739381508"
"6040739722108","act_10152412627713995","page_ads","act_10152412627713995","092qK","6040739717108"
"6040739727508","act_10152412627713995","page_ads","act_10152412627713995","JgeIi","6040739718708"
"6040739727908","act_10152412627713995","page_ads","act_10152412627713995","ZrB60","6040739718908"
"6040739728108","act_10152412627713995","page_ads","act_10152412627713995","KHrMN","6040739719108"
"6040739729108","act_10152412627713995","page_ads","act_10152412627713995","o5GiS","6040739717108"
"6040739729308","act_10152412627713995","page_ads","act_10152412627713995","5kyU1","6040739717108"
"6040739729508","act_10152412627713995","page_ads","act_10152412627713995","kKyO3","6040739717108"
"6040739727708","act_10152412627713995","page_ads","act_10152412627713995","M86iU","6040739718708"
"6040739728908","act_10152412627713995","page_ads","act_10152412627713995","cf9WD","6040739719108"
"6040739728508","act_10152412627713995","page_ads","act_10152412627713995","Jemwv","6040739719108"
"6040739728708","act_10152412627713995","page_ads","act_10152412627713995","uzJra","6040739719108"
"6040739727108","act_10152412627713995","page_ads","act_10152412627713995","zZwYq","6040739718708"
"6040739727308","act_10152412627713995","page_ads","act_10152412627713995","33aLx","6040739718708"
"6040739728308","act_10152412627713995","page_ads","act_10152412627713995","FDUYR","6040739719108"
"6040740930508","act_10152412627713995","page_ads","act_10152412627713995","40SzC","6040740929908"
"6040740930708","act_10152412627713995","page_ads","act_10152412627713995","yNfka","6040740929908"
"6040740930308","act_10152412627713995","page_ads","act_10152412627713995","ieGou","6040740929908"
"6039331705908","act_10152412627713995","page_ads","act_10152412627713995","VQpvM","6039331672708"
"6039331680708","act_10152412627713995","page_ads","act_10152412627713995","dzKMy","6039331670308"
"6039331689908","act_10152412627713995","page_ads","act_10152412627713995","eip6H","6039331670308"
"6039331717508","act_10152412627713995","page_ads","act_10152412627713995","HjQLa","6039331669708"
"6039331719308","act_10152412627713995","page_ads","act_10152412627713995","35OYO","6039331669708"
"6039331750308","act_10152412627713995","page_ads","act_10152412627713995","3P4Oh","6039331672708"
"6039331811708","act_10152412627713995","page_ads","act_10152412627713995","yKaBT","6039331672708"
"6039331679108","act_10152412627713995","page_ads","act_10152412627713995","wH6wG","6039331670308"
"6039331754908","act_10152412627713995","page_ads","act_10152412627713995","5gcfH","6039331669708"
"6039331706508","act_10152412627713995","page_ads","act_10152412627713995","sj0fe","6039331672708"
"6039331730508","act_10152412627713995","page_ads","act_10152412627713995","Y9nWS","6039331670308"
"6040740279508","act_10152412627713995","page_ads","act_10152412627713995","CG57t","6040740278908"
"6040740280308","act_10152412627713995","page_ads","act_10152412627713995","gMFEh","6040740278908"
"6040740280508","act_10152412627713995","page_ads","act_10152412627713995","PvW3C","6040740278908"
"6040740279708","act_10152412627713995","page_ads","act_10152412627713995","KXoMl","6040740278708"
"6040740279908","act_10152412627713995","page_ads","act_10152412627713995","6qXhl","6040740278708"
"6040740280108","act_10152412627713995","page_ads","act_10152412627713995","PUVjX","6040740278708"
"6042191854308","act_10152412627713995","page_ads","act_10152412627713995","6Fdbt","6042191851108"
"6042191859708","act_10152412627713995","page_ads","act_10152412627713995","g1840","6042191851108"
"6042191859908","act_10152412627713995","page_ads","act_10152412627713995","yaqhj","6042191851108"
"6042191859508","act_10152412627713995","page_ads","act_10152412627713995","98g4I","6042191852508"
"6042191859308","act_10152412627713995","page_ads","act_10152412627713995","0NRsf","6042191852508"
"6042191859108","act_10152412627713995","page_ads","act_10152412627713995","qZnbz","6042191852508"
"6042213731308","act_10152412627713995","page_ads","act_10152412627713995","lPyCZ","6042213730508"
"6042213732108","act_10152412627713995","page_ads","act_10152412627713995","J2q8m","6042213730508"
"6042213732308","act_10152412627713995","page_ads","act_10152412627713995","KvJBm","6042213730508"
"6042213731508","act_10152412627713995","page_ads","act_10152412627713995","K9yTw","6042213730708"
"6042213731708","act_10152412627713995","page_ads","act_10152412627713995","jhYTs","6042213730708"
"6042213731908","act_10152412627713995","page_ads","act_10152412627713995","eLOJS","6042213730708"
"6042601728708","act_10152412627713995","page_ads","act_10152412627713995","y5LD0","6042601725908"
"6042601727508","act_10152412627713995","page_ads","act_10152412627713995","b2whn","6042601725508"
"6042601729508","act_10152412627713995","page_ads","act_10152412627713995","lvvWs","6042601725308"
"6042601727908","act_10152412627713995","page_ads","act_10152412627713995","C2u1I","6042601725708"
"6042601727108","act_10152412627713995","page_ads","act_10152412627713995","bW92c","6042601725308"
"6042601728308","act_10152412627713995","page_ads","act_10152412627713995","0Ukm4","6042601725908"
"6042601727708","act_10152412627713995","page_ads","act_10152412627713995","dlWwN","6042601725508"
"6042601728508","act_10152412627713995","page_ads","act_10152412627713995","q4PDE","6042601725908"
"6042601729308","act_10152412627713995","page_ads","act_10152412627713995","XnBtw","6042601725308"
"6042601727308","act_10152412627713995","page_ads","act_10152412627713995","EiygL","6042601725508"
"6042601728108","act_10152412627713995","page_ads","act_10152412627713995","0CvrE","6042601725908"
"6042601729108","act_10152412627713995","page_ads","act_10152412627713995","UHWzp","6042601725308"
"6042601726908","act_10152412627713995","page_ads","act_10152412627713995","RzT4y","6042601725508"
"6042601728908","act_10152412627713995","page_ads","act_10152412627713995","eDU6r","6042601725308"
"6042191856708","act_10152412627713995","page_ads","act_10152412627713995","rRTqE","6042191851908"
"6042191856908","act_10152412627713995","page_ads","act_10152412627713995","Q8eqt","6042191851908"
"6042191857108","act_10152412627713995","page_ads","act_10152412627713995","kKhbf","6042191851908"
"6042191857308","act_10152412627713995","page_ads","act_10152412627713995","66FUP","6042191851908"
"6042191857508","act_10152412627713995","page_ads","act_10152412627713995","irPX1","6042191852108"
"6042191857708","act_10152412627713995","page_ads","act_10152412627713995","Ns4La","6042191852108"
"6042191857908","act_10152412627713995","page_ads","act_10152412627713995","49tBj","6042191852108"
"6042191858108","act_10152412627713995","page_ads","act_10152412627713995","sKjtf","6042191852108"
"6042191855508","act_10152412627713995","page_ads","act_10152412627713995","2n6MV","6042191851708"
"6042191856108","act_10152412627713995","page_ads","act_10152412627713995","ZYxuG","6042191851708"
"6042191856308","act_10152412627713995","page_ads","act_10152412627713995","W0vKt","6042191851708"
"6042191856508","act_10152412627713995","page_ads","act_10152412627713995","UYIVc","6042191851708"
"6042191858308","act_10152412627713995","page_ads","act_10152412627713995","INl1W","6042191852308"
"6042191858508","act_10152412627713995","page_ads","act_10152412627713995","xMafh","6042191852308"
"6042191858708","act_10152412627713995","page_ads","act_10152412627713995","yJTsh","6042191852308"
"6042191858908","act_10152412627713995","page_ads","act_10152412627713995","Ydrq7","6042191852308"
"6042191854508","act_10152412627713995","page_ads","act_10152412627713995","5zhbC","6042191851308"
"6042191854708","act_10152412627713995","page_ads","act_10152412627713995","xftfs","6042191851308"
"6042191855108","act_10152412627713995","page_ads","act_10152412627713995","saHH2","6042191851308"
"6042191854908","act_10152412627713995","page_ads","act_10152412627713995","tWBGC","6042191851508"
"6042191855308","act_10152412627713995","page_ads","act_10152412627713995","OlSuj","6042191851508"
"6042191855708","act_10152412627713995","page_ads","act_10152412627713995","I75nB","6042191851508"
"6042191855908","act_10152412627713995","page_ads","act_10152412627713995","GImC0","6042191851508"
"6044315739508","act_10152412627713995","page_ads","act_10152412627713995","484DX","6044315731708"
"6044315740108","act_10152412627713995","page_ads","act_10152412627713995","UVSZy","6044315731508"
"6044315740308","act_10152412627713995","page_ads","act_10152412627713995","OrHre","6044315731508"
"6044315742108","act_10152412627713995","page_ads","act_10152412627713995","ShNLN","6044315732308"
"6044315738708","act_10152412627713995","page_ads","act_10152412627713995","IsDoa","6044315730908"
"6044315741308","act_10152412627713995","page_ads","act_10152412627713995","hQjMk","6044315732108"
"6044315741508","act_10152412627713995","page_ads","act_10152412627713995","iGQuD","6044315732108"
"6044315741708","act_10152412627713995","page_ads","act_10152412627713995","R9i34","6044315732108"
"6044315741908","act_10152412627713995","page_ads","act_10152412627713995","DZEM7","6044315732308"
"6044315744108","act_10152412627713995","page_ads","act_10152412627713995","JJrt0","6044315732508"
"6044315745308","act_10152412627713995","page_ads","act_10152412627713995","7I9rV","6044315733108"
"6044315736708","act_10152412627713995","page_ads","act_10152412627713995","4TRbo","6044315730708"
"6044315739108","act_10152412627713995","page_ads","act_10152412627713995","vDK9p","6044315731708"
"6044315739708","act_10152412627713995","page_ads","act_10152412627713995","iOVXJ","6044315731508"
"6044315741108","act_10152412627713995","page_ads","act_10152412627713995","fpI9B","6044315731908"
"6044315742508","act_10152412627713995","page_ads","act_10152412627713995","5nWBy","6044315732908"
"6044315744508","act_10152412627713995","page_ads","act_10152412627713995","FKMGi","6044315732508"
"6044315744708","act_10152412627713995","page_ads","act_10152412627713995","jc6UR","6044315733108"
"6044315744908","act_10152412627713995","page_ads","act_10152412627713995","uQd5n","6044315733108"
"6044315738108","act_10152412627713995","page_ads","act_10152412627713995","Xjo6Z","6044315730908"
"6044315738908","act_10152412627713995","page_ads","act_10152412627713995","wD1RO","6044315731708"
"6044315740708","act_10152412627713995","page_ads","act_10152412627713995","Okb2t","6044315731908"
"6044315743908","act_10152412627713995","page_ads","act_10152412627713995","st5Yr","6044315732508"
"6044315746108","act_10152412627713995","page_ads","act_10152412627713995","CQFuN","6044315733308"
"6044315738508","act_10152412627713995","page_ads","act_10152412627713995","j6hOK","6044315730908"
"6044315740508","act_10152412627713995","page_ads","act_10152412627713995","p4Kp2","6044315731908"
"6044315743708","act_10152412627713995","page_ads","act_10152412627713995","kVnyu","6044315732508"
"6044315744308","act_10152412627713995","page_ads","act_10152412627713995","1ixZd","6044315732508"
"6044315745708","act_10152412627713995","page_ads","act_10152412627713995","wFrBv","6044315733308"
"6044315745908","act_10152412627713995","page_ads","act_10152412627713995","YF3SR","6044315733308"
"6044315736908","act_10152412627713995","page_ads","act_10152412627713995","TwwYT","6044315731308"
"6044315737908","act_10152412627713995","page_ads","act_10152412627713995","0tZsV","6044315731108"
"6044315743108","act_10152412627713995","page_ads","act_10152412627713995","R9MpO","6044315732708"
"6044315737308","act_10152412627713995","page_ads","act_10152412627713995","eEFCH","6044315731108"
"6044315745508","act_10152412627713995","page_ads","act_10152412627713995","9rZp8","6044315733308"
"6044315737508","act_10152412627713995","page_ads","act_10152412627713995","vdHM4","6044315731308"
"6044315742908","act_10152412627713995","page_ads","act_10152412627713995","FCm05","6044315732908"
"6044315742708","act_10152412627713995","page_ads","act_10152412627713995","M7XEY","6044315732908"
"6044315737108","act_10152412627713995","page_ads","act_10152412627713995","WUrmi","6044315731308"
"6044315745108","act_10152412627713995","page_ads","act_10152412627713995","CBqKr","6044315733108"
"6044315736508","act_10152412627713995","page_ads","act_10152412627713995","pcrgt","6044315731108"
"6044315742308","act_10152412627713995","page_ads","act_10152412627713995","9rSXl","6044315732308"
"6044315743308","act_10152412627713995","page_ads","act_10152412627713995","VxO5h","6044315732708"
"6044315743508","act_10152412627713995","page_ads","act_10152412627713995","j42mN","6044315732708"
"6044315737708","act_10152412627713995","page_ads","act_10152412627713995","YHYlU","6044315731108"
"6044315739308","act_10152412627713995","page_ads","act_10152412627713995","Dpfjs","6044315731708"
"6044315738308","act_10152412627713995","page_ads","act_10152412627713995","v70l2","6044315730908"
"6044315740908","act_10152412627713995","page_ads","act_10152412627713995","DJn6R","6044315731908"
"6044315739908","act_10152412627713995","page_ads","act_10152412627713995","NlaLa","6044315731508"
"6046816623308","act_10152412627713995","page_ads","act_10152412627713995","LlVQs","6046816616708"
"6046816623508","act_10152412627713995","page_ads","act_10152412627713995","bQ0Ib","6046816616708"
"6046816620308","act_10152412627713995","page_ads","act_10152412627713995","WJrvY","6046816615508"
"6046816621708","act_10152412627713995","page_ads","act_10152412627713995","CYWfH","6046816615508"
"6046816619508","act_10152412627713995","page_ads","act_10152412627713995","y5INo","6046816615308"
"6046816619108","act_10152412627713995","page_ads","act_10152412627713995","yCVhf","6046816615508"
"6046816622708","act_10152412627713995","page_ads","act_10152412627713995","KrpMn","6046816616308"
"6046816622908","act_10152412627713995","page_ads","act_10152412627713995","onXvp","6046816616708"
"6046816624908","act_10152412627713995","page_ads","act_10152412627713995","iPNRs","6046816616508"
"6046816619308","act_10152412627713995","page_ads","act_10152412627713995","dWdSf","6046816615308"
"6046816622308","act_10152412627713995","page_ads","act_10152412627713995","469Oc","6046816616308"
"6046816621108","act_10152412627713995","page_ads","act_10152412627713995","7CH82","6046816615908"
"6046816622108","act_10152412627713995","page_ads","act_10152412627713995","KXfht","6046816616308"
"6046816620508","act_10152412627713995","page_ads","act_10152412627713995","gnGQv","6046816615908"
"6046816624508","act_10152412627713995","page_ads","act_10152412627713995","hmXhE","6046816616508"
"6046816619908","act_10152412627713995","page_ads","act_10152412627713995","chv46","6046816615308"
"6046816623108","act_10152412627713995","page_ads","act_10152412627713995","y7B30","6046816616708"
"6046816624308","act_10152412627713995","page_ads","act_10152412627713995","5yPds","6046816616908"
"6046816621908","act_10152412627713995","page_ads","act_10152412627713995","fKXOY","6046816615708"
"6046816624708","act_10152412627713995","page_ads","act_10152412627713995","QrnO9","6046816616508"
"6046816625308","act_10152412627713995","page_ads","act_10152412627713995","fj65S","6046816616108"
"6046816619708","act_10152412627713995","page_ads","act_10152412627713995","a1kSM","6046816616108"
"6046816623908","act_10152412627713995","page_ads","act_10152412627713995","PfUtt","6046816616908"
"6046816625108","act_10152412627713995","page_ads","act_10152412627713995","c8gn0","6046816616108"
"6046816621308","act_10152412627713995","page_ads","act_10152412627713995","Lf1UF","6046816615708"
"6046816623708","act_10152412627713995","page_ads","act_10152412627713995","PmuD3","6046816616908"
"6046816620908","act_10152412627713995","page_ads","act_10152412627713995","7XIR8","6046816615908"
"6046816622508","act_10152412627713995","page_ads","act_10152412627713995","xWDpH","6046816616308"
"6046816621508","act_10152412627713995","page_ads","act_10152412627713995","nbhbX","6046816615708"
"6046816620108","act_10152412627713995","page_ads","act_10152412627713995","EHcSE","6046816615508"
"6046816624108","act_10152412627713995","page_ads","act_10152412627713995","RXBGe","6046816616908"
"6046816620708","act_10152412627713995","page_ads","act_10152412627713995","bbsBD","6046816615908"
"6049130285508","act_10152412627713995","page_ads","act_10152412627713995","93ROe","6049130290708"
"6049130288308","act_10152412627713995","page_ads","act_10152412627713995","BU7iC","6049130291508"
"6049130286908","act_10152412627713995","page_ads","act_10152412627713995","XY7k0","6049130291108"
"6049130288108","act_10152412627713995","page_ads","act_10152412627713995","SoW35","6049130291308"
"6049130288508","act_10152412627713995","page_ads","act_10152412627713995","QF0ou","6049130291508"
"6049130288708","act_10152412627713995","page_ads","act_10152412627713995","rOgag","6049130291508"
"6049130285708","act_10152412627713995","page_ads","act_10152412627713995","wFIvs","6049130290708"
"6049130284708","act_10152412627713995","page_ads","act_10152412627713995","16VDs","6049130290508"
"6049130290308","act_10152412627713995","page_ads","act_10152412627713995","gDnVs","6049130283908"
"6049130286708","act_10152412627713995","page_ads","act_10152412627713995","ZV2bC","6049130291108"
"6049130285308","act_10152412627713995","page_ads","act_10152412627713995","sQ0Jt","6049130290508"
"6049130286108","act_10152412627713995","page_ads","act_10152412627713995","6oYqW","6049130290908"
"6049130287308","act_10152412627713995","page_ads","act_10152412627713995","9m2sl","6049130291108"
"6049130287108","act_10152412627713995","page_ads","act_10152412627713995","Uxlgd","6049130290908"
"6049130289108","act_10152412627713995","page_ads","act_10152412627713995","Dv5LX","6049130291708"
"6049130287508","act_10152412627713995","page_ads","act_10152412627713995","bH9gW","6049130291308"
"6049130286508","act_10152412627713995","page_ads","act_10152412627713995","wml9h","6049130290908"
"6049130284908","act_10152412627713995","page_ads","act_10152412627713995","1rq9v","6049130290508"
"6049130289508","act_10152412627713995","page_ads","act_10152412627713995","QNotw","6049130291708"
"6049130285908","act_10152412627713995","page_ads","act_10152412627713995","VODHV","6049130290708"
"6049130287908","act_10152412627713995","page_ads","act_10152412627713995","Txj3f","6049130291308"
"6049130288908","act_10152412627713995","page_ads","act_10152412627713995","3bC3o","6049130291708"
"6049130290108","act_10152412627713995","page_ads","act_10152412627713995","LhvxV","6049130283908"
"6049130289708","act_10152412627713995","page_ads","act_10152412627713995","sajT3","6049130283908"
"6049130287708","act_10152412627713995","page_ads","act_10152412627713995","LGOau","6049130291308"
"6049130286308","act_10152412627713995","page_ads","act_10152412627713995","LfZJb","6049130290908"
"6049130285108","act_10152412627713995","page_ads","act_10152412627713995","aotgf","6049130290508"
"6049130289908","act_10152412627713995","page_ads","act_10152412627713995","WwgGc","6049130283908"
"6049130289308","act_10152412627713995","page_ads","act_10152412627713995","w7gbU","6049130291708"
"6049130283308","act_10152412627713995","page_ads","act_10152412627713995","Zdzc8","6049130284508"
"6049130284308","act_10152412627713995","page_ads","act_10152412627713995","VvCUW","6049130284508"
"6049130284108","act_10152412627713995","page_ads","act_10152412627713995","Vvt8m","6049130284508"
"6052149267908","act_10152412627713995","page_ads","act_10152412627713995","KyYOF","6052149268508"
"6052149268108","act_10152412627713995","page_ads","act_10152412627713995","tLEFt","6052149268508"
"6052149268308","act_10152412627713995","page_ads","act_10152412627713995","fBuMh","6052149268508"
"6023987443108","act_10152412627713995","page_ads","act_10152412627713995","xcVW2","6023987408908"
"6023987456508","act_10152412627713995","page_ads","act_10152412627713995","FpDMV","6023987409108"
"6023987458908","act_10152412627713995","page_ads","act_10152412627713995","yn0JB","6023987409308"
"6023987533508","act_10152412627713995","page_ads","act_10152412627713995","BHebB","6023987411908"
"6023987538308","act_10152412627713995","page_ads","act_10152412627713995","pGKum","6023987412508"
"6023987420308","act_10152412627713995","page_ads","act_10152412627713995","XOlbx","6023987408908"
"6023987429708","act_10152412627713995","page_ads","act_10152412627713995","pvgBy","6023987408708"
"6023987511508","act_10152412627713995","page_ads","act_10152412627713995","dlTNg","6023987412108"
"6023987489308","act_10152412627713995","page_ads","act_10152412627713995","96ysG","6023987410108"
"6025342775308","act_10152412627713995","page_ads","act_10152412627713995","7114e","6025342743108"
"6025342779108","act_10152412627713995","page_ads","act_10152412627713995","Tuzky","6025342742908"
"6025342805908","act_10152412627713995","page_ads","act_10152412627713995","x7Tsf","6025342743708"
"6025342783308","act_10152412627713995","page_ads","act_10152412627713995","lKC3N","6025342743108"
"6025342761508","act_10152412627713995","page_ads","act_10152412627713995","wiyIc","6025342743108"
"6025342767108","act_10152412627713995","page_ads","act_10152412627713995","885co","6025342742708"
"6025342768108","act_10152412627713995","page_ads","act_10152412627713995","GMJkz","6025342742708"
"6025342778908","act_10152412627713995","page_ads","act_10152412627713995","x7dG9","6025342743708"
"6025342768708","act_10152412627713995","page_ads","act_10152412627713995","FKMGc","6025342742908"
"6025342777908","act_10152412627713995","page_ads","act_10152412627713995","BUuil","6025342742908"
"6025342800908","act_10152412627713995","page_ads","act_10152412627713995","T7beL","6025342742908"
"6025342762308","act_10152412627713995","page_ads","act_10152412627713995","NyYmK","6025342742708"
"6025342789108","act_10152412627713995","page_ads","act_10152412627713995","7OEs8","6025342743708"
"6025342762908","act_10152412627713995","page_ads","act_10152412627713995","BdLpO","6025342742708"
"6025342774108","act_10152412627713995","page_ads","act_10152412627713995","vb4Zh","6025342742708"
"6025342788108","act_10152412627713995","page_ads","act_10152412627713995","lDxd6","6025342742908"
"6025342776708","act_10152412627713995","page_ads","act_10152412627713995","liV2F","6025342743108"
"6025342786308","act_10152412627713995","page_ads","act_10152412627713995","r5n52","6025342743708"
"6025342811108","act_10152412627713995","page_ads","act_10152412627713995","ucNxD","6025342743708"
"6025342784108","act_10152412627713995","page_ads","act_10152412627713995","s3xJX","6025342742708"
"6025342784908","act_10152412627713995","page_ads","act_10152412627713995","wz4UX","6025342743108"
"6025342794908","act_10152412627713995","page_ads","act_10152412627713995","5hl0e","6025342743708"
"6025342765708","act_10152412627713995","page_ads","act_10152412627713995","ulVJY","6025342743108"
"6025342800708","act_10152412627713995","page_ads","act_10152412627713995","YBoTq","6025342742908"
"6025523634308","act_10152412627713995","page_ads","act_10152412627713995","QVNo2","6025523612308"
"6025523647108","act_10152412627713995","page_ads","act_10152412627713995","2jaPz","6025523611508"
"6025523653308","act_10152412627713995","page_ads","act_10152412627713995","S8hZa","6025523612708"
"6025523639108","act_10152412627713995","page_ads","act_10152412627713995","JMLPN","6025523612308"
"6025523653508","act_10152412627713995","page_ads","act_10152412627713995","6pUk4","6025523611508"
"6025523616908","act_10152412627713995","page_ads","act_10152412627713995","2dtZJ","6025523611108"
"6025523627708","act_10152412627713995","page_ads","act_10152412627713995","ELtk3","6025523612308"
"6025523620108","act_10152412627713995","page_ads","act_10152412627713995","LyQ4T","6025523611108"
"6025523631908","act_10152412627713995","page_ads","act_10152412627713995","WJdw0","6025523612308"
"6025523648108","act_10152412627713995","page_ads","act_10152412627713995","2KsUM","6025523611508"
"6025523668708","act_10152412627713995","page_ads","act_10152412627713995","7GIY6","6025523611108"
"6025523642708","act_10152412627713995","page_ads","act_10152412627713995","Yjvl5","6025523611508"
"6025523656508","act_10152412627713995","page_ads","act_10152412627713995","FJwMw","6025523612708"
"6025523667108","act_10152412627713995","page_ads","act_10152412627713995","bddh2","6025523612708"
"6025523660308","act_10152412627713995","page_ads","act_10152412627713995","Pjpfr","6025523612708"
"6025523650508","act_10152412627713995","page_ads","act_10152412627713995","pGDL5","6025523611508"
"6025523677308","act_10152412627713995","page_ads","act_10152412627713995","1dOee","6025523612708"
"6025523618308","act_10152412627713995","page_ads","act_10152412627713995","iY32T","6025523611108"
"6025523620308","act_10152412627713995","page_ads","act_10152412627713995","3hMRY","6025523611108"
"6025523659708","act_10152412627713995","page_ads","act_10152412627713995","gWQWN","6025523611108"
"6025523617308","act_10152412627713995","page_ads","act_10152412627713995","YRLXP","6025523612308"
"6025523634908","act_10152412627713995","page_ads","act_10152412627713995","88Euw","6025523612308"
"6025523654508","act_10152412627713995","page_ads","act_10152412627713995","zn3KU","6025523611508"
"6025523677508","act_10152412627713995","page_ads","act_10152412627713995","1cnxj","6025523612708"
"6026287437508","act_10152412627713995","page_ads","act_10152412627713995","mNrPZ","6026287408308"
"6026287514508","act_10152412627713995","page_ads","act_10152412627713995","6rq3s","6026287411108"
"6026287495108","act_10152412627713995","page_ads","act_10152412627713995","Dba35","6026287408108"
"6026287435708","act_10152412627713995","page_ads","act_10152412627713995","ksY0g","6026287409108"
"6026287531508","act_10152412627713995","page_ads","act_10152412627713995","qm7dK","6026287412308"
"6026287447108","act_10152412627713995","page_ads","act_10152412627713995","TY7XM","6026287408308"
"6026287421308","act_10152412627713995","page_ads","act_10152412627713995","KSvqW","6026287408308"
"6026287435908","act_10152412627713995","page_ads","act_10152412627713995","IaX92","6026287409108"
"6026287525308","act_10152412627713995","page_ads","act_10152412627713995","HDlc2","6026287412308"
"6026287426708","act_10152412627713995","page_ads","act_10152412627713995","4f0X2","6026287409908"
"6026287494908","act_10152412627713995","page_ads","act_10152412627713995","19u8x","6026287408108"
"6026287550308","act_10152412627713995","page_ads","act_10152412627713995","Td958","6026287411908"
"6026287505908","act_10152412627713995","page_ads","act_10152412627713995","zYe4L","6026287411108"
"6026287546308","act_10152412627713995","page_ads","act_10152412627713995","4gjkK","6026287411908"
"6026287473908","act_10152412627713995","page_ads","act_10152412627713995","78lyD","6026287408508"
"6026287549908","act_10152412627713995","page_ads","act_10152412627713995","GXWjq","6026287411908"
"6026287469908","act_10152412627713995","page_ads","act_10152412627713995","rKI5s","6026287408508"
"6026287499708","act_10152412627713995","page_ads","act_10152412627713995","31v0S","6026287408108"
"6026287515508","act_10152412627713995","page_ads","act_10152412627713995","8PHFX","6026287411108"
"6026287449508","act_10152412627713995","page_ads","act_10152412627713995","Vj6m3","6026287409108"
"6026287436108","act_10152412627713995","page_ads","act_10152412627713995","CLaBF","6026287409108"
"6026287460708","act_10152412627713995","page_ads","act_10152412627713995","63fjj","6026287409908"
"6026287532708","act_10152412627713995","page_ads","act_10152412627713995","9rWUn","6026287412308"
"6026287453508","act_10152412627713995","page_ads","act_10152412627713995","o6yhl","6026287408308"
"6026287536708","act_10152412627713995","page_ads","act_10152412627713995","Raq7g","6026287412308"
"6026287540908","act_10152412627713995","page_ads","act_10152412627713995","GhKdL","6026287411908"
"6026287474708","act_10152412627713995","page_ads","act_10152412627713995","jFCOT","6026287409908"
"6026287502108","act_10152412627713995","page_ads","act_10152412627713995","F0dkT","6026287408108"
"6026287490108","act_10152412627713995","page_ads","act_10152412627713995","m2kQq","6026287408108"
"6026287473308","act_10152412627713995","page_ads","act_10152412627713995","aM0wK","6026287408508"
"6026287458308","act_10152412627713995","page_ads","act_10152412627713995","aBqL2","6026287409908"
"6026287438708","act_10152412627713995","page_ads","act_10152412627713995","UwI1G","6026287409108"
"6026287550108","act_10152412627713995","page_ads","act_10152412627713995","L7uhW","6026287411908"
"6026287422508","act_10152412627713995","page_ads","act_10152412627713995","s54mJ","6026287408308"
"6026287513908","act_10152412627713995","page_ads","act_10152412627713995","GxM6Q","6026287411108"
"6026287431108","act_10152412627713995","page_ads","act_10152412627713995","OQEI6","6026287408308"
"6026287539908","act_10152412627713995","page_ads","act_10152412627713995","8s2XL","6026287411908"
"6026287515708","act_10152412627713995","page_ads","act_10152412627713995","aQwWU","6026287411108"
"6026287477508","act_10152412627713995","page_ads","act_10152412627713995","08abp","6026287408508"
"6026287460908","act_10152412627713995","page_ads","act_10152412627713995","Xl9Eq","6026287409908"
"6026287461908","act_10152412627713995","page_ads","act_10152412627713995","kErHO","6026287409908"
"6026287480308","act_10152412627713995","page_ads","act_10152412627713995","aTEit","6026287408508"
"6026287472308","act_10152412627713995","page_ads","act_10152412627713995","lg3uD","6026287408508"
"6026287525508","act_10152412627713995","page_ads","act_10152412627713995","lbpRt","6026287412308"
"6026287438508","act_10152412627713995","page_ads","act_10152412627713995","FH3Nh","6026287409108"
"6026287525708","act_10152412627713995","page_ads","act_10152412627713995","cYFQb","6026287412308"
"6026287508508","act_10152412627713995","page_ads","act_10152412627713995","LNtHp","6026287411108"
"6026287489508","act_10152412627713995","page_ads","act_10152412627713995","L7peY","6026287408108"
"6026992894508","act_10152412627713995","page_ads","act_10152412627713995","SUTP1","6026992781108"
"6026992936308","act_10152412627713995","page_ads","act_10152412627713995","jXQcy","6026992784308"
"6026992875508","act_10152412627713995","page_ads","act_10152412627713995","iaIzq","6026992783508"
"6026992954708","act_10152412627713995","page_ads","act_10152412627713995","qMHYm","6026992783708"
"6026992949908","act_10152412627713995","page_ads","act_10152412627713995","fMXBx","6026992783708"
"6026992955908","act_10152412627713995","page_ads","act_10152412627713995","30xsz","6026992783708"
"6026992891708","act_10152412627713995","page_ads","act_10152412627713995","tZsuY","6026992781108"
"6026992951108","act_10152412627713995","page_ads","act_10152412627713995","lH8sR","6026992783708"
"6026992874908","act_10152412627713995","page_ads","act_10152412627713995","q9Mu0","6026992781108"
"6026992884708","act_10152412627713995","page_ads","act_10152412627713995","XJPpC","6026992781108"
"6026992934108","act_10152412627713995","page_ads","act_10152412627713995","Xn0dZ","6026992784308"
"6026992929308","act_10152412627713995","page_ads","act_10152412627713995","OhkcL","6026992783508"
"6026992878908","act_10152412627713995","page_ads","act_10152412627713995","ENtw5","6026992781108"
"6026992923908","act_10152412627713995","page_ads","act_10152412627713995","h95y2","6026992783508"
"6026992957508","act_10152412627713995","page_ads","act_10152412627713995","Z4PYM","6026992783708"
"6026992934908","act_10152412627713995","page_ads","act_10152412627713995","q7oZC","6026992784308"
"6026992924108","act_10152412627713995","page_ads","act_10152412627713995","PppHB","6026992783508"
"6026992939908","act_10152412627713995","page_ads","act_10152412627713995","wkRV4","6026992784308"
"6026992883708","act_10152412627713995","page_ads","act_10152412627713995","lWlEc","6026992783508"
"6026992925508","act_10152412627713995","page_ads","act_10152412627713995","qPJqk","6026992783508"
"6026992949508","act_10152412627713995","page_ads","act_10152412627713995","csY61","6026992784308"
"6026992948508","act_10152412627713995","page_ads","act_10152412627713995","SR4nw","6026992783708"
"6026992883308","act_10152412627713995","page_ads","act_10152412627713995","UVDC7","6026992781108"
"6026992948708","act_10152412627713995","page_ads","act_10152412627713995","o7WZ0","6026992784308"
"6026999983508","act_10152412627713995","page_ads","act_10152412627713995","7ufil","6026999962108"
"6026999980308","act_10152412627713995","page_ads","act_10152412627713995","2gafU","6026999962108"
"6026999989708","act_10152412627713995","page_ads","act_10152412627713995","jKiJr","6026999962108"
"6026999975908","act_10152412627713995","page_ads","act_10152412627713995","U5PWs","6026999962908"
"6026999967908","act_10152412627713995","page_ads","act_10152412627713995","ToSV5","6026999962908"
"6026999982108","act_10152412627713995","page_ads","act_10152412627713995","7GPG4","6026999962108"
"6026999984108","act_10152412627713995","page_ads","act_10152412627713995","6PhCe","6026999962108"
"6026999968108","act_10152412627713995","page_ads","act_10152412627713995","DVIHt","6026999962908"
"6026999994708","act_10152412627713995","page_ads","act_10152412627713995","miv4k","6026999962108"
"6026999965508","act_10152412627713995","page_ads","act_10152412627713995","7tObP","6026999962908"
"6026999972308","act_10152412627713995","page_ads","act_10152412627713995","T4bsC","6026999962908"
"6026999969308","act_10152412627713995","page_ads","act_10152412627713995","VSo8k","6026999962908"
"6026992873508","act_10152412627713995","page_ads","act_10152412627713995","5mOKc","6026992781908"
"6026992886908","act_10152412627713995","page_ads","act_10152412627713995","YKjW8","6026992781908"
"6026992887508","act_10152412627713995","page_ads","act_10152412627713995","QY7zF","6026992781908"
"6026992887708","act_10152412627713995","page_ads","act_10152412627713995","yLbJi","6026992781908"
"6026992895708","act_10152412627713995","page_ads","act_10152412627713995","ilpEZ","6026992781908"
"6026992906108","act_10152412627713995","page_ads","act_10152412627713995","paDxV","6026992781908"
"6026992869108","act_10152412627713995","page_ads","act_10152412627713995","gxTqD","6026992781308"
"6026992873708","act_10152412627713995","page_ads","act_10152412627713995","TDn8L","6026992781308"
"6026992873908","act_10152412627713995","page_ads","act_10152412627713995","LComl","6026992781308"
"6026992879508","act_10152412627713995","page_ads","act_10152412627713995","VCJiQ","6026992781308"
"6026992879908","act_10152412627713995","page_ads","act_10152412627713995","MIl8h","6026992781308"
"6026992898708","act_10152412627713995","page_ads","act_10152412627713995","PK7I8","6026992781308"
"6028106084508","act_10152412627713995","page_ads","act_10152412627713995","i770s","6028106062308"
"6028106084708","act_10152412627713995","page_ads","act_10152412627713995","zKUxi","6028106062708"
"6028106098708","act_10152412627713995","page_ads","act_10152412627713995","P9zIu","6028106062308"
"6028106116108","act_10152412627713995","page_ads","act_10152412627713995","xc0wj","6028106062308"
"6028106118508","act_10152412627713995","page_ads","act_10152412627713995","qoBUl","6028106062308"
"6028106120308","act_10152412627713995","page_ads","act_10152412627713995","JxNMf","6028106062708"
"6028106124108","act_10152412627713995","page_ads","act_10152412627713995","9vVYr","6028106062708"
"6028106124508","act_10152412627713995","page_ads","act_10152412627713995","OCd7V","6028106062708"
"6028106114508","act_10152412627713995","page_ads","act_10152412627713995","6Qhd3","6028106062308"
"6028106089308","act_10152412627713995","page_ads","act_10152412627713995","5NTnp","6028106062708"
"6028106095108","act_10152412627713995","page_ads","act_10152412627713995","bUkBF","6028106062308"
"6028106124708","act_10152412627713995","page_ads","act_10152412627713995","4tr87","6028106062708"
"6028106071108","act_10152412627713995","page_ads","act_10152412627713995","KFKl4","6028106062508"
"6028106079708","act_10152412627713995","page_ads","act_10152412627713995","1KDgq","6028106062508"
"6028106094108","act_10152412627713995","page_ads","act_10152412627713995","6LqaV","6028106062908"
"6028106069108","act_10152412627713995","page_ads","act_10152412627713995","X9BzH","6028106062508"
"6028106069308","act_10152412627713995","page_ads","act_10152412627713995","G6I0x","6028106062508"
"6028106071308","act_10152412627713995","page_ads","act_10152412627713995","P3Jpx","6028106062508"
"6028106081108","act_10152412627713995","page_ads","act_10152412627713995","h1pWc","6028106062508"
"6028106081708","act_10152412627713995","page_ads","act_10152412627713995","Lnznq","6028106062908"
"6028106082108","act_10152412627713995","page_ads","act_10152412627713995","S7yW2","6028106062908"
"6028106087908","act_10152412627713995","page_ads","act_10152412627713995","ZYnbV","6028106062908"
"6028106102108","act_10152412627713995","page_ads","act_10152412627713995","U4M5s","6028106062908"
"6028106103908","act_10152412627713995","page_ads","act_10152412627713995","0n4EY","6028106062908"
"6028898641508","act_10152412627713995","page_ads","act_10152412627713995","m0Rnd","6028106062908"
"6028898635708","act_10152412627713995","page_ads","act_10152412627713995","FOVOI","6028106062908"
"6028898633108","act_10152412627713995","page_ads","act_10152412627713995","vRZv3","6028106062508"
"6028898638308","act_10152412627713995","page_ads","act_10152412627713995","89HTq","6028106062508"
"6028898636308","act_10152412627713995","page_ads","act_10152412627713995","3CsHN","6028106062508"
"6028898642108","act_10152412627713995","page_ads","act_10152412627713995","9z8LL","6028106062908"
"6028898631308","act_10152412627713995","page_ads","act_10152412627713995","Cixhi","6028106062508"
"6028898634708","act_10152412627713995","page_ads","act_10152412627713995","zQMSn","6028106062508"
"6028898642308","act_10152412627713995","page_ads","act_10152412627713995","YLBmL","6028106062908"
"6029050702508","act_10152412627713995","page_ads","act_10152412627713995","1539L","6029050665708"
"6029050737908","act_10152412627713995","page_ads","act_10152412627713995","yVPaH","6029050666708"
"6029050691108","act_10152412627713995","page_ads","act_10152412627713995","o5SIw","6029050665908"
"6029050688508","act_10152412627713995","page_ads","act_10152412627713995","JVeVE","6029050665908"
"6029050709508","act_10152412627713995","page_ads","act_10152412627713995","0Hunb","6029050665508"
"6029050681108","act_10152412627713995","page_ads","act_10152412627713995","EIb74","6029050665908"
"6029050701308","act_10152412627713995","page_ads","act_10152412627713995","Pfvuj","6029050665708"
"6029050748708","act_10152412627713995","page_ads","act_10152412627713995","7Z6w6","6029050666708"
"6029050676708","act_10152412627713995","page_ads","act_10152412627713995","v00bx","6029050665908"
"6029050692908","act_10152412627713995","page_ads","act_10152412627713995","FEzTy","6029050665908"
"6029050721108","act_10152412627713995","page_ads","act_10152412627713995","cSL65","6029050665508"
"6029050705108","act_10152412627713995","page_ads","act_10152412627713995","0HhVp","6029050665708"
"6029050761308","act_10152412627713995","page_ads","act_10152412627713995","6B0wB","6029050666708"
"6029050670908","act_10152412627713995","page_ads","act_10152412627713995","nrDvT","6029050665908"
"6029050690908","act_10152412627713995","page_ads","act_10152412627713995","9lOmE","6029050666708"
"6029050677508","act_10152412627713995","page_ads","act_10152412627713995","5ydUL","6029050665908"
"6029050748508","act_10152412627713995","page_ads","act_10152412627713995","IPwhY","6029050666708"
"6029050723708","act_10152412627713995","page_ads","act_10152412627713995","iJ9mF","6029050665508"
"6029050739908","act_10152412627713995","page_ads","act_10152412627713995","nMBp8","6029050666708"
"6029050741108","act_10152412627713995","page_ads","act_10152412627713995","VQnIt","6029050666708"
"6029050737108","act_10152412627713995","page_ads","act_10152412627713995","WwtHS","6029050666708"
"6029050753708","act_10152412627713995","page_ads","act_10152412627713995","vo5IC","6029050666708"
"6029050707308","act_10152412627713995","page_ads","act_10152412627713995","r5JkM","6029050665708"
"6029050710708","act_10152412627713995","page_ads","act_10152412627713995","ZiqVY","6029050665708"
"6029050721308","act_10152412627713995","page_ads","act_10152412627713995","BPq3D","6029050665508"
"6029050749708","act_10152412627713995","page_ads","act_10152412627713995","Q2Pqb","6029050666708"
"6029050691508","act_10152412627713995","page_ads","act_10152412627713995","63ZG5","6029050665908"
"6029050720908","act_10152412627713995","page_ads","act_10152412627713995","cZrEL","6029050665508"
"6029050705508","act_10152412627713995","page_ads","act_10152412627713995","XSCnU","6029050665708"
"6029050671108","act_10152412627713995","page_ads","act_10152412627713995","fJ0fp","6029050665908"
"6029050673308","act_10152412627713995","page_ads","act_10152412627713995","DeWSB","6029050665908"
"6029050722708","act_10152412627713995","page_ads","act_10152412627713995","qY2E6","6029050665508"
"6029050673508","act_10152412627713995","page_ads","act_10152412627713995","txNLx","6029050665908"
"6030899860908","act_10152412627713995","page_ads","act_10152412627713995","cvreS","6030899849708"
"6030899879908","act_10152412627713995","page_ads","act_10152412627713995","Pd7so","6030899850508"
"6030899938508","act_10152412627713995","page_ads","act_10152412627713995","bCQY1","6030899850908"
"6030899864908","act_10152412627713995","page_ads","act_10152412627713995","faa4v","6030899850508"
"6030899916708","act_10152412627713995","page_ads","act_10152412627713995","erbEE","6030899849708"
"6030899880908","act_10152412627713995","page_ads","act_10152412627713995","4afLo","6030899850708"
"6030899925908","act_10152412627713995","page_ads","act_10152412627713995","wyzjZ","6030899850908"
"6030899885708","act_10152412627713995","page_ads","act_10152412627713995","roE6F","6030899850508"
"6030899891708","act_10152412627713995","page_ads","act_10152412627713995","WB39d","6030899849708"
"6030899863308","act_10152412627713995","page_ads","act_10152412627713995","duZpW","6030899849708"
"6030899859908","act_10152412627713995","page_ads","act_10152412627713995","E0RxO","6030899850908"
"6030899949908","act_10152412627713995","page_ads","act_10152412627713995","Da5Yj","6030899850908"
"6030899868708","act_10152412627713995","page_ads","act_10152412627713995","4G3hR","6030899849708"
"6030899932708","act_10152412627713995","page_ads","act_10152412627713995","H4t2v","6030899850908"
"6030899925508","act_10152412627713995","page_ads","act_10152412627713995","T2Y0u","6030899850908"
"6030899940108","act_10152412627713995","page_ads","act_10152412627713995","gYT55","6030899850908"
"6030899927108","act_10152412627713995","page_ads","act_10152412627713995","BZowK","6030899850908"
"6030899872708","act_10152412627713995","page_ads","act_10152412627713995","ltLog","6030899850708"
"6030899889908","act_10152412627713995","page_ads","act_10152412627713995","92keU","6030899849708"
"6030899881108","act_10152412627713995","page_ads","act_10152412627713995","sSTsn","6030899850708"
"6030899936108","act_10152412627713995","page_ads","act_10152412627713995","i11sg","6030899850908"
"6030899913708","act_10152412627713995","page_ads","act_10152412627713995","K1fRa","6030899849708"
"6030899877108","act_10152412627713995","page_ads","act_10152412627713995","3CoOr","6030899850508"
"6030899876908","act_10152412627713995","page_ads","act_10152412627713995","7Wn6t","6030899850708"
"6030899876308","act_10152412627713995","page_ads","act_10152412627713995","ctDgy","6030899849708"
"6030899862908","act_10152412627713995","page_ads","act_10152412627713995","xVTN6","6030899849708"
"6030899937308","act_10152412627713995","page_ads","act_10152412627713995","TmJpR","6030899850908"
"6030899860708","act_10152412627713995","page_ads","act_10152412627713995","uQvFf","6030899849708"
"6030899884508","act_10152412627713995","page_ads","act_10152412627713995","UIIpp","6030899850508"
"6030899883908","act_10152412627713995","page_ads","act_10152412627713995","mWzwF","6030899850508"
"6030899913508","act_10152412627713995","page_ads","act_10152412627713995","Pyak8","6030899850708"
"6030899909508","act_10152412627713995","page_ads","act_10152412627713995","5KBCn","6030899849708"
"6031427408308","act_10152412627713995","page_ads","act_10152412627713995","PjOUS","6030899849708"
"6031427410508","act_10152412627713995","page_ads","act_10152412627713995","kSRNL","6030899849708"
"6031427406108","act_10152412627713995","page_ads","act_10152412627713995","7Ndde","6030899849708"
"6030899869708","act_10152412627713995","page_ads","act_10152412627713995","SBnbS","6030899850708"
"6031427637708","act_10152412627713995","page_ads","act_10152412627713995","ZiXoN","6030899850708"
"6031427640908","act_10152412627713995","page_ads","act_10152412627713995","BuYhC","6030899850708"
"6031427638508","act_10152412627713995","page_ads","act_10152412627713995","XWCHB","6030899850708"
"6031427405308","act_10152412627713995","page_ads","act_10152412627713995","HEKml","6030899849708"
"6031426210708","act_10152412627713995","page_ads","act_10152412627713995","WwbVh","6031426192908"
"6031426209508","act_10152412627713995","page_ads","act_10152412627713995","4Nb9Y","6031426193508"
"6031426204508","act_10152412627713995","page_ads","act_10152412627713995","JpbO8","6031426193508"
"6031426201908","act_10152412627713995","page_ads","act_10152412627713995","8TYh9","6031426192908"
"6031427639708","act_10152412627713995","page_ads","act_10152412627713995","CoUGp","6030899850708"
"6032597936708","act_10152412627713995","page_ads","act_10152412627713995","6vVfm","6032597924508"
"6032597942708","act_10152412627713995","page_ads","act_10152412627713995","yqFUl","6032597924508"
"6032597932708","act_10152412627713995","page_ads","act_10152412627713995","kRps0","6032597924508"
"6032597960108","act_10152412627713995","page_ads","act_10152412627713995","mgmrz","6032597923108"
"6032597940108","act_10152412627713995","page_ads","act_10152412627713995","borpm","6032597924508"
"6032597931508","act_10152412627713995","page_ads","act_10152412627713995","ChELm","6032597922908"
"6032597934908","act_10152412627713995","page_ads","act_10152412627713995","J8QwI","6032597922908"
"6032597935308","act_10152412627713995","page_ads","act_10152412627713995","Xw0Bs","6032597922908"
"6032597940308","act_10152412627713995","page_ads","act_10152412627713995","aNxmO","6032597922908"
"6032597952308","act_10152412627713995","page_ads","act_10152412627713995","kjvnZ","6032597925508"
"6032597956108","act_10152412627713995","page_ads","act_10152412627713995","dNIna","6032597925508"
"6032597957308","act_10152412627713995","page_ads","act_10152412627713995","Vhcx6","6032597925508"
"6032597965508","act_10152412627713995","page_ads","act_10152412627713995","MWxq1","6032597923708"
"6032597968508","act_10152412627713995","page_ads","act_10152412627713995","dgxzJ","6032597923508"
"6032597970908","act_10152412627713995","page_ads","act_10152412627713995","8gZgV","6032597923708"
"6032597974108","act_10152412627713995","page_ads","act_10152412627713995","Td1Hj","6032597923508"
"6033395283108","act_10152412627713995","page_ads","act_10152412627713995","M1Rvc","6032597922908"
"6033395285908","act_10152412627713995","page_ads","act_10152412627713995","TTmod","6032597925508"
"6033395290308","act_10152412627713995","page_ads","act_10152412627713995","uGIOy","6032597923508"
"6033395290508","act_10152412627713995","page_ads","act_10152412627713995","9hww7","6032597923708"
"6032883805508","act_10152412627713995","page_ads","act_10152412627713995","vBiXT","6032883803308"
"6034087439908","act_10152412627713995","page_ads","act_10152412627713995","ozBYb","6034087417908"
"6034087432908","act_10152412627713995","page_ads","act_10152412627713995","j0YTL","6034087417908"
"6034087439108","act_10152412627713995","page_ads","act_10152412627713995","q7POe","6034087417908"
"6034087450708","act_10152412627713995","page_ads","act_10152412627713995","kCfyS","6034087416708"
"6034087442908","act_10152412627713995","page_ads","act_10152412627713995","Bu2L6","6034087417908"
"6034803654708","act_10152412627713995","page_ads","act_10152412627713995","kd9T5","6034803645708"
"6034803796708","act_10152412627713995","page_ads","act_10152412627713995","ocfUp","6034803787508"
"6034803801908","act_10152412627713995","page_ads","act_10152412627713995","fShM7","6034803787508"
"6034803656508","act_10152412627713995","page_ads","act_10152412627713995","ZZ8NT","6034803645508"
"6034803653108","act_10152412627713995","page_ads","act_10152412627713995","nxLGj","6034803645708"
"6034803649308","act_10152412627713995","page_ads","act_10152412627713995","qJ7iX","6034803645708"
"6034803650708","act_10152412627713995","page_ads","act_10152412627713995","cajPO","6034803645708"
"6034803797708","act_10152412627713995","page_ads","act_10152412627713995","DZ5Y2","6034803786708"
"6034803804908","act_10152412627713995","page_ads","act_10152412627713995","xfPU7","6034803786708"
"6034803656708","act_10152412627713995","page_ads","act_10152412627713995","CGmVr","6034803645508"
"6018062871308","act_10152412627713995","page_ads","act_10152412627713995","tjmOO","6018062856508"
"6018062889508","act_10152412627713995","page_ads","act_10152412627713995","ne5Xv","6018062856308"
"6018062871108","act_10152412627713995","page_ads","act_10152412627713995","GXntd","6018062856308"
"6018062870708","act_10152412627713995","page_ads","act_10152412627713995","JHPrt","6018062856708"
"6018062869108","act_10152412627713995","page_ads","act_10152412627713995","8Bant","6018062856508"
"6018062888908","act_10152412627713995","page_ads","act_10152412627713995","tVdpz","6018062856708"
"6018062870908","act_10152412627713995","page_ads","act_10152412627713995","L3oE1","6018062856108"
"6018062872108","act_10152412627713995","page_ads","act_10152412627713995","awcDg","6018062856308"
"6018062892708","act_10152412627713995","page_ads","act_10152412627713995","6J30o","6018062856508"
"6018062871708","act_10152412627713995","page_ads","act_10152412627713995","f36Pu","6018062856708"
"6018062892908","act_10152412627713995","page_ads","act_10152412627713995","gSBRw","6018062856108"
"6018062893108","act_10152412627713995","page_ads","act_10152412627713995","7Lbos","6018062856108"
"6018062889108","act_10152412627713995","page_ads","act_10152412627713995","dbQzH","6018062856708"
"6018062894108","act_10152412627713995","page_ads","act_10152412627713995","vG0i3","6018062856108"
"6018062889708","act_10152412627713995","page_ads","act_10152412627713995","42c7e","6018062856508"
"6018062871908","act_10152412627713995","page_ads","act_10152412627713995","LnL9S","6018062856308"
"6018300848508","act_10152412627713995","page_ads","act_10152412627713995","W8F50","6018300845308"
"6018300849108","act_10152412627713995","page_ads","act_10152412627713995","vQqzn","6018300845708"
"6018300848308","act_10152412627713995","page_ads","act_10152412627713995","oED95","6018300845508"
"6018395909508","act_10152412627713995","page_ads","act_10152412627713995","kaeui","6018395907508"
"6018395910508","act_10152412627713995","page_ads","act_10152412627713995","6SPvR","6018395907708"
"6018395910908","act_10152412627713995","page_ads","act_10152412627713995","Vq2CN","6018395907908"
"6018869679308","act_10152412627713995","page_ads","act_10152412627713995","sh0Cn","6018869673108"
"6018869679508","act_10152412627713995","page_ads","act_10152412627713995","LdBZr","6018869672708"
"6018869682708","act_10152412627713995","page_ads","act_10152412627713995","y3wsl","6018869670908"
"6018869680508","act_10152412627713995","page_ads","act_10152412627713995","2BLdq","6018869673308"
"6018869683908","act_10152412627713995","page_ads","act_10152412627713995","noV49","6018869670708"
"6018869680108","act_10152412627713995","page_ads","act_10152412627713995","pCfLX","6018869672908"
"6019173405308","act_10152412627713995","page_ads","act_10152412627713995","esl6P","6019173396508"
"6019173407708","act_10152412627713995","page_ads","act_10152412627713995","klwJ2","6019173396908"
"6019173428908","act_10152412627713995","page_ads","act_10152412627713995","YiIF4","6019173396708"
"6019173428708","act_10152412627713995","page_ads","act_10152412627713995","THPuu","6019173396708"
"6019173407508","act_10152412627713995","page_ads","act_10152412627713995","zv9qj","6019173396908"
"6019173421508","act_10152412627713995","page_ads","act_10152412627713995","B7ZxJ","6019173394508"
"6019173409508","act_10152412627713995","page_ads","act_10152412627713995","QPWFl","6019173396908"
"6019173404908","act_10152412627713995","page_ads","act_10152412627713995","KosJT","6019173396508"
"6019173405108","act_10152412627713995","page_ads","act_10152412627713995","wN5wz","6019173396508"
"6019173408108","act_10152412627713995","page_ads","act_10152412627713995","I8P3d","6019173396508"
"6019173409708","act_10152412627713995","page_ads","act_10152412627713995","3e5YP","6019173396908"
"6019173417508","act_10152412627713995","page_ads","act_10152412627713995","IbK6j","6019173396708"
"6019173421708","act_10152412627713995","page_ads","act_10152412627713995","d9HW3","6019173394508"
"6019173417308","act_10152412627713995","page_ads","act_10152412627713995","sbCQu","6019173396708"
"6019173422108","act_10152412627713995","page_ads","act_10152412627713995","uNTTx","6019173394508"
"6019173407108","act_10152412627713995","page_ads","act_10152412627713995","g3cOp","6019173394508"
"6018300914908","act_10152412627713995","page_ads","act_10152412627713995","kzre5","6018300892908"
"6018300916108","act_10152412627713995","page_ads","act_10152412627713995","sbUdx","6018300892908"
"6018300894708","act_10152412627713995","page_ads","act_10152412627713995","pawbI","6018300893108"
"6018300916308","act_10152412627713995","page_ads","act_10152412627713995","2CSY5","6018300892908"
"6018300903908","act_10152412627713995","page_ads","act_10152412627713995","rRBfL","6018300891508"
"6018300915108","act_10152412627713995","page_ads","act_10152412627713995","XMjco","6018300892908"
"6018300913908","act_10152412627713995","page_ads","act_10152412627713995","WX8fk","6018300893308"
"6018300894108","act_10152412627713995","page_ads","act_10152412627713995","zfK6v","6018300893108"
"6018300903708","act_10152412627713995","page_ads","act_10152412627713995","CL0LB","6018300891508"
"6018300914108","act_10152412627713995","page_ads","act_10152412627713995","LHTal","6018300893308"
"6018300904308","act_10152412627713995","page_ads","act_10152412627713995","Z4en3","6018300891508"
"6018300895108","act_10152412627713995","page_ads","act_10152412627713995","9kXiQ","6018300893108"
"6018300916508","act_10152412627713995","page_ads","act_10152412627713995","cUPRP","6018300893308"
"6018300914708","act_10152412627713995","page_ads","act_10152412627713995","joES9","6018300893308"
"6018300895508","act_10152412627713995","page_ads","act_10152412627713995","tlsRw","6018300893108"
"6018300903508","act_10152412627713995","page_ads","act_10152412627713995","HKRhL","6018300891508"
"6019363993308","act_10152412627713995","page_ads","act_10152412627713995","Fzau0","6019363986108"
"6019363993108","act_10152412627713995","page_ads","act_10152412627713995","q4JBg","6019363988508"
"6019363992508","act_10152412627713995","page_ads","act_10152412627713995","1BmKI","6019363988308"
"6019363992908","act_10152412627713995","page_ads","act_10152412627713995","iZe0C","6019363984708"
"6019363992708","act_10152412627713995","page_ads","act_10152412627713995","wBXJ6","6019363988108"
"6019363992308","act_10152412627713995","page_ads","act_10152412627713995","cppJg","6019363987908"
"6019650567708","act_10152412627713995","page_ads","act_10152412627713995","7FZuG","6019650563308"
"6019650567508","act_10152412627713995","page_ads","act_10152412627713995","eEZ5P","6019650564908"
"6019650567908","act_10152412627713995","page_ads","act_10152412627713995","b2otM","6019650564708"
"6019736574308","act_10152412627713995","page_ads","act_10152412627713995","nLlIC","6019736571708"
"6019736573908","act_10152412627713995","page_ads","act_10152412627713995","G6el9","6019736571908"
"6019736574108","act_10152412627713995","page_ads","act_10152412627713995","t4tmk","6019736570308"
"6019739767708","act_10152412627713995","page_ads","act_10152412627713995","vG6yo","6019739765108"
"6019739768708","act_10152412627713995","page_ads","act_10152412627713995","OKdg8","6019739764908"
"6019739767508","act_10152412627713995","page_ads","act_10152412627713995","nlWqo","6019739763908"
"6019833861108","act_10152412627713995","page_ads","act_10152412627713995","LlgIQ","6019833859308"
"6019833860708","act_10152412627713995","page_ads","act_10152412627713995","VxyEw","6019833857708"
"6019833860908","act_10152412627713995","page_ads","act_10152412627713995","mFCTP","6019833858908"
"6019982788508","act_10152412627713995","page_ads","act_10152412627713995","N1DN3","6019982775108"
"6019982776908","act_10152412627713995","page_ads","act_10152412627713995","02Q02","6019982775108"
"6019982778508","act_10152412627713995","page_ads","act_10152412627713995","QRnYD","6019982772908"
"6019982787308","act_10152412627713995","page_ads","act_10152412627713995","rEmQh","6019982774908"
"6019982795308","act_10152412627713995","page_ads","act_10152412627713995","OmQfI","6019982775308"
"6019982789708","act_10152412627713995","page_ads","act_10152412627713995","a0wI8","6019982774908"
"6019982776508","act_10152412627713995","page_ads","act_10152412627713995","htud6","6019982772908"
"6019982803308","act_10152412627713995","page_ads","act_10152412627713995","KrRva","6019982775308"
"6019982603508","act_10152412627713995","page_ads","act_10152412627713995","qqdi3","6019982602508"
"6019982803108","act_10152412627713995","page_ads","act_10152412627713995","uKiUw","6019982775308"
"6019982777308","act_10152412627713995","page_ads","act_10152412627713995","mniXg","6019982774908"
"6019982776708","act_10152412627713995","page_ads","act_10152412627713995","gmfu5","6019982774908"
"6019982777108","act_10152412627713995","page_ads","act_10152412627713995","7OulW","6019982775108"
"6019982788308","act_10152412627713995","page_ads","act_10152412627713995","voTBD","6019982775108"
"6019982783908","act_10152412627713995","page_ads","act_10152412627713995","eBILq","6019982775308"
"6019982776108","act_10152412627713995","page_ads","act_10152412627713995","Qbct7","6019982772908"
"6019982776308","act_10152412627713995","page_ads","act_10152412627713995","o10Pr","6019982772908"
"6020118446708","act_10152412627713995","page_ads","act_10152412627713995","wqUv8","6020118445108"
"6020084752908","act_10152412627713995","page_ads","act_10152412627713995","tUqgY","6020084746508"
"6020084753308","act_10152412627713995","page_ads","act_10152412627713995","T1kGZ","6020084745308"
"6020084753108","act_10152412627713995","page_ads","act_10152412627713995","n9KPK","6020084747308"
"6020176079708","act_10152412627713995","page_ads","act_10152412627713995","jjQLg","6020176077508"
"6020304750308","act_10152412627713995","page_ads","act_10152412627713995","zUW0D","6020304748108"
"6020374962708","act_10152412627713995","page_ads","act_10152412627713995","3PfUC","6020374960908"
"6020525771108","act_10152412627713995","page_ads","act_10152412627713995","vDy7I","6020525769508"
"6020525096108","act_10152412627713995","page_ads","act_10152412627713995","TYNLc","6020525094508"
"6020764695508","act_10152412627713995","page_ads","act_10152412627713995","UUJaf","6020764680708"
"6020779955508","act_10152412627713995","page_ads","act_10152412627713995","5yGHt","6020779953708"
"6020834991508","act_10152412627713995","page_ads","act_10152412627713995","Sajrp","6020834987908"
"6021065596708","act_10152412627713995","page_ads","act_10152412627713995","L7jdp","6021065595108"
"6021430992908","act_10152412627713995","page_ads","act_10152412627713995","U8O5F","6021430991108"
"6021527357508","act_10152412627713995","page_ads","act_10152412627713995","Dzfc9","6021527352708"
"6021617813108","act_10152412627713995","page_ads","act_10152412627713995","gPLse","6021617811308"
"6021642133308","act_10152412627713995","page_ads","act_10152412627713995","pPdJB","6021618800308"
"6021642116108","act_10152412627713995","page_ads","act_10152412627713995","FiZVH","6021618800108"
"6021642121108","act_10152412627713995","page_ads","act_10152412627713995","qvsWk","6021618800308"
"6021642116908","act_10152412627713995","page_ads","act_10152412627713995","jdIpQ","6021618800108"
"6021642106508","act_10152412627713995","page_ads","act_10152412627713995","g6j3z","6021618799108"
"6021642123508","act_10152412627713995","page_ads","act_10152412627713995","9NdKu","6021618800308"
"6021642115308","act_10152412627713995","page_ads","act_10152412627713995","52cMv","6021618800108"
"6021642106108","act_10152412627713995","page_ads","act_10152412627713995","Wd5aO","6021618799108"
"6021642106908","act_10152412627713995","page_ads","act_10152412627713995","9NNHs","6021618799108"
"6021642116508","act_10152412627713995","page_ads","act_10152412627713995","WcE2B","6021618800108"
"6021642118508","act_10152412627713995","page_ads","act_10152412627713995","GvD6M","6021618799108"
"6021642126308","act_10152412627713995","page_ads","act_10152412627713995","JiR9J","6021618800308"
"6021704702108","act_10152412627713995","page_ads","act_10152412627713995","K9QRq","6021704239908"
"6021704702508","act_10152412627713995","page_ads","act_10152412627713995","Iarhf","6021704239908"
"6021704693308","act_10152412627713995","page_ads","act_10152412627713995","d158E","6021704239908"
"6021704678708","act_10152412627713995","page_ads","act_10152412627713995","hBK5s","6021704238908"
"6021704692108","act_10152412627713995","page_ads","act_10152412627713995","dUit2","6021704239908"
"6021704677708","act_10152412627713995","page_ads","act_10152412627713995","SPdQX","6021704238908"
"6021704679708","act_10152412627713995","page_ads","act_10152412627713995","i9RmL","6021704238908"
"6021704687708","act_10152412627713995","page_ads","act_10152412627713995","umlRG","6021704238908"
"6021704689508","act_10152412627713995","page_ads","act_10152412627713995","cZzmh","6021704239708"
"6021704696908","act_10152412627713995","page_ads","act_10152412627713995","eplPj","6021704239708"
"6021704697108","act_10152412627713995","page_ads","act_10152412627713995","HBvrs","6021704239708"
"6021704697708","act_10152412627713995","page_ads","act_10152412627713995","0cpPE","6021704239708"
"6021723124708","act_10152412627713995","page_ads","act_10152412627713995","f7Zw3","6021704239708"
"6021723127108","act_10152412627713995","page_ads","act_10152412627713995","dLdZr","6021704239708"
"6021703484108","act_10152412627713995","page_ads","act_10152412627713995","BtfV1","6021703482308"
"6021862046708","act_10152412627713995","page_ads","act_10152412627713995","XfIup","6021862044508"
"6022099356108","act_10152412627713995","page_ads","act_10152412627713995","EC1gZ","6022099353908"
"6022227539308","act_10152412627713995","page_ads","act_10152412627713995","kGWLE","6022227533708"
"6022384461308","act_10152412627713995","page_ads","act_10152412627713995","mir8c","6022384455308"
"6022497476908","act_10152412627713995","page_ads","act_10152412627713995","yUdiZ","6022497475308"
"6022769071908","act_10152412627713995","page_ads","act_10152412627713995","Z0KXX","6022769056708"
"6022769062508","act_10152412627713995","page_ads","act_10152412627713995","BX9H2","6022769056108"
"6022769067708","act_10152412627713995","page_ads","act_10152412627713995","gNsdT","6022769055908"
"6023110054708","act_10152412627713995","page_ads","act_10152412627713995","6pNyZ","6023110052708"
"6023170899108","act_10152412627713995","page_ads","act_10152412627713995","ixQsz","6023170890708"
"6023170901908","act_10152412627713995","page_ads","act_10152412627713995","PzcNQ","6023170891308"
"6023987425908","act_10152412627713995","page_ads","act_10152412627713995","fKihc","6023987408708"
"6023987429908","act_10152412627713995","page_ads","act_10152412627713995","d7XN5","6023987408708"
"6023987493908","act_10152412627713995","page_ads","act_10152412627713995","UopYK","6023987410108"
"6023987429508","act_10152412627713995","page_ads","act_10152412627713995","CdU7X","6023987408908"
"6023987510508","act_10152412627713995","page_ads","act_10152412627713995","UWDKO","6023987412108"
"6023987418708","act_10152412627713995","page_ads","act_10152412627713995","gsqzO","6023987408708"
"6023987533708","act_10152412627713995","page_ads","act_10152412627713995","8FuX0","6023987411908"
"6023987419508","act_10152412627713995","page_ads","act_10152412627713995","hqjQH","6023987408708"
"6023987429308","act_10152412627713995","page_ads","act_10152412627713995","Cfl16","6023987408708"
"6023987493508","act_10152412627713995","page_ads","act_10152412627713995","UBV8p","6023987410108"
"6023987458508","act_10152412627713995","page_ads","act_10152412627713995","PDjQR","6023987409308"
"6023987518708","act_10152412627713995","page_ads","act_10152412627713995","P1O2r","6023987412508"
"6023987486908","act_10152412627713995","page_ads","act_10152412627713995","jYMpU","6023987412108"
"6023987520908","act_10152412627713995","page_ads","act_10152412627713995","ep7Fe","6023987412508"
"6023987521908","act_10152412627713995","page_ads","act_10152412627713995","j1kEj","6023987412508"
"6023987533908","act_10152412627713995","page_ads","act_10152412627713995","2sLqX","6023987411908"
"6023987537308","act_10152412627713995","page_ads","act_10152412627713995","JB9pp","6023987411908"
"6023987538708","act_10152412627713995","page_ads","act_10152412627713995","8mU61","6023987411908"
"6023987510108","act_10152412627713995","page_ads","act_10152412627713995","4rZtv","6023987412108"
"6023987538908","act_10152412627713995","page_ads","act_10152412627713995","SPOPE","6023987411908"
"6023987510308","act_10152412627713995","page_ads","act_10152412627713995","Pm1tj","6023987412108"
"6023987518308","act_10152412627713995","page_ads","act_10152412627713995","1omLU","6023987412508"
"6023987538508","act_10152412627713995","page_ads","act_10152412627713995","8T1VS","6023987412508"
"6023987485508","act_10152412627713995","page_ads","act_10152412627713995","8W15M","6023987410108"
"6023987454108","act_10152412627713995","page_ads","act_10152412627713995","nWaam","6023987409308"
"6023987470108","act_10152412627713995","page_ads","act_10152412627713995","PHtIT","6023987409308"
"6023987470308","act_10152412627713995","page_ads","act_10152412627713995","jaZEC","6023987409308"
"6023987441508","act_10152412627713995","page_ads","act_10152412627713995","k75Lt","6023987408908"
"6023987494108","act_10152412627713995","page_ads","act_10152412627713995","nKy2s","6023987410108"
"6023987461908","act_10152412627713995","page_ads","act_10152412627713995","IoRS9","6023987409108"
"6023987493708","act_10152412627713995","page_ads","act_10152412627713995","1CZe7","6023987410108"
"6023987472308","act_10152412627713995","page_ads","act_10152412627713995","xst89","6023987409108"
"6023987472508","act_10152412627713995","page_ads","act_10152412627713995","dbZRs","6023987409108"
"6023987441108","act_10152412627713995","page_ads","act_10152412627713995","Jz2f7","6023987408908"
"6023987458708","act_10152412627713995","page_ads","act_10152412627713995","vfrzS","6023987409108"
"6023987488708","act_10152412627713995","page_ads","act_10152412627713995","KNyaZ","6023987412108"
"6023987472908","act_10152412627713995","page_ads","act_10152412627713995","cCq5C","6023987409108"
"6023987454908","act_10152412627713995","page_ads","act_10152412627713995","fRvtr","6023987409308"
"6023987441308","act_10152412627713995","page_ads","act_10152412627713995","aYSjh","6023987408908"


================================================
File: /test/keboola/snapshots/ads/out/tables/ads.manifest
================================================
{"columns":["id","ex-account-id","fb-graph-node","parent-id","name","adset_id"],"incremental":true,"primary_key":["parent_id","id"]}

================================================
File: /test/keboola/snapshots/ads/out/tables/campaigns.manifest
================================================
{"columns":["id","ex-account-id","fb-graph-node","parent-id","name","account_id"],"incremental":true,"primary_key":["parent_id","id","account_id"]}

================================================
File: /test/keboola/snapshots/ads/test_ads.clj
================================================
(ns keboola.snapshots.ads.test-ads
  (:require [keboola.snapshots.ads.apicalls :as apicalls]
            [clojure.test :as t :refer :all]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.test-utils.core :as test-utils]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            )
  (:use clj-http.fake))

(deftest ads-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "ads"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "test/keboola/snapshots/ads")
    (test-utils/copy-config-tmp "test/keboola/snapshots/ads" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "test/keboola/snapshots/ads" tmp-dir)
      )))

================================================
File: /test/keboola/snapshots/ads/config.json
================================================
{
  "storage" : { },
  "parameters" : {
    "accounts" : {
      "act_10152412627713995" : {
        "account_id" : "10152412627713995",
        "business_name" : "",
        "currency" : "EUR",
        "id" : "act_10152412627713995",
        "name" : "blabla"
      }
    },
    "api-version" : "v2.9",
    "queries" : [ {
      "name" : "ads",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "ads",
        "fields" : "id,name,adset_id",
        "ids" : null
      }
    }, {
      "name" : "campaigns",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "campaigns",
        "fields" : "id,name,account_id",
        "ids" : null
      }
    }, {
      "name" : "adsets",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "adsets",
        "fields" : "id,name,account_id",
        "ids" : null
      }
    } ]
  },
  "authorization" : {
    "oauth_api" : {
      "id" : "keboola.ex-facebook-ads",
      "credentials" : {
        "id" : "main",
        "authorizedFor" : "Myself",
        "creator" : {
          "id" : "1234",
          "description" : "me@keboola.com"
        },
        "created" : "2016-01-31 00:13:30",
        "oauthVersion" : "facebook",
        "appKey" : "xxx",
        "#data" : "{\"token\":\"XXTOKENXX\"}",
        "#appSecret" : "KBC::Encrypted==ENCODEDSTRING=="
      }
    }
  }
}

================================================
File: /test/keboola/snapshots/campaignsinsights/apicalls.clj
================================================
(ns keboola.snapshots.campaignsinsights.apicalls)
(def recorded 
{
{:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyMDQ3MDA2NTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020469208070\"},{\"id\":\"6020416026470\"},{\"id\":\"6020411414470\"},{\"id\":\"6019681080270\"},{\"id\":\"6019644104070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDQ2OTIwODA3MAZDZD\",\"after\":\"NjAxOTY0NDEwNDA3MAZDZD\"},\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjAyMDQ2OTIwODA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyNjU0Mjk3MDY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6026542970270\"},{\"id\":\"6026542970070\"},{\"id\":\"6026392074870\"},{\"id\":\"6026011237870\"},{\"id\":\"6025695642470\"},{\"id\":\"6025687679470\"},{\"id\":\"6025591979870\"},{\"id\":\"6025562944470\"},{\"id\":\"6025560438470\"},{\"id\":\"6025560438270\"},{\"id\":\"6024565463270\"},{\"id\":\"6023187817470\"},{\"id\":\"6023044208270\"},{\"id\":\"6022819846270\"},{\"id\":\"6022818793470\"},{\"id\":\"6022738122670\"},{\"id\":\"6022421550870\"},{\"id\":\"6022120952670\"},{\"id\":\"6021919243270\"},{\"id\":\"6021754733070\"},{\"id\":\"6020917424270\"},{\"id\":\"6020916526670\"},{\"id\":\"6020663864070\"},{\"id\":\"6020590268670\"},{\"id\":\"6020470065070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNjU0Mjk3MDI3MAZDZD\",\"after\":\"NjAyMDQ3MDA2NTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyMDQ3MDA2NTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjAyNjU0Mjk3MDI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAzNDI2NTYwMzQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6034264589670\"},{\"id\":\"6032861605270\"},{\"id\":\"6032749476870\"},{\"id\":\"6032749083470\"},{\"id\":\"6032111463870\"},{\"id\":\"6031717809670\"},{\"id\":\"6031491138270\"},{\"id\":\"6031490818470\"},{\"id\":\"6031489843470\"},{\"id\":\"6030606674870\"},{\"id\":\"6030029668070\"},{\"id\":\"6029842967270\"},{\"id\":\"6029750174870\"},{\"id\":\"6029341869270\"},{\"id\":\"6029058309270\"},{\"id\":\"6028994834670\"},{\"id\":\"6028356677270\"},{\"id\":\"6028346486870\"},{\"id\":\"6028270919670\"},{\"id\":\"6027882130070\"},{\"id\":\"6027570733670\"},{\"id\":\"6027170240470\"},{\"id\":\"6026798951070\"},{\"id\":\"6026567452670\"},{\"id\":\"6026542970670\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNDI2NDU4OTY3MAZDZD\",\"after\":\"NjAyNjU0Mjk3MDY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyNjU0Mjk3MDY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjAzNDI2NDU4OTY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0NDM1NDU2OTg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6044285810470\"},{\"id\":\"6044125274470\"},{\"id\":\"6044004779270\"},{\"id\":\"6043918161870\"},{\"id\":\"6043742649270\"},{\"id\":\"6043633602670\"},{\"id\":\"6043374806070\"},{\"id\":\"6042985120870\"},{\"id\":\"6042976332870\"},{\"id\":\"6042973616070\"},{\"id\":\"6042906710270\"},{\"id\":\"6042138678870\"},{\"id\":\"6042063797070\"},{\"id\":\"6041830861470\"},{\"id\":\"6041002071870\"},{\"id\":\"6040759465870\"},{\"id\":\"6040021891070\"},{\"id\":\"6039831650670\"},{\"id\":\"6038701396470\"},{\"id\":\"6038388592270\"},{\"id\":\"6035594872670\"},{\"id\":\"6035561736270\"},{\"id\":\"6035560883270\"},{\"id\":\"6034785536270\"},{\"id\":\"6034265603470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NDI4NTgxMDQ3MAZDZD\",\"after\":\"NjAzNDI2NTYwMzQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAzNDI2NTYwMzQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA0NDI4NTgxMDQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0Njc1ODExMDQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6046742077270\"},{\"id\":\"6046739319070\"},{\"id\":\"6046557726070\"},{\"id\":\"6046313822470\"},{\"id\":\"6046072317270\"},{\"id\":\"6045767050470\"},{\"id\":\"6045748996670\"},{\"id\":\"6045681095470\"},{\"id\":\"6045680477270\"},{\"id\":\"6045679590270\"},{\"id\":\"6045675780870\"},{\"id\":\"6045211083870\"},{\"id\":\"6045135612470\"},{\"id\":\"6045058522470\"},{\"id\":\"6045056840070\"},{\"id\":\"6044901291270\"},{\"id\":\"6044802438470\"},{\"id\":\"6044801305070\"},{\"id\":\"6044647763270\"},{\"id\":\"6044647679270\"},{\"id\":\"6044442014070\"},{\"id\":\"6044441442470\"},{\"id\":\"6044438044870\"},{\"id\":\"6044356472870\"},{\"id\":\"6044354569870\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0Njc0MjA3NzI3MAZDZD\",\"after\":\"NjA0NDM1NDU2OTg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0NDM1NDU2OTg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA0Njc0MjA3NzI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0OTQ3NzA3MTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6049477055470\"},{\"id\":\"6049242019670\"},{\"id\":\"6049022368270\"},{\"id\":\"6048947178270\"},{\"id\":\"6048780289870\"},{\"id\":\"6048770169470\"},{\"id\":\"6048738596870\"},{\"id\":\"6048736766070\"},{\"id\":\"6048676993470\"},{\"id\":\"6048570034270\"},{\"id\":\"6048275369870\"},{\"id\":\"6048273191270\"},{\"id\":\"6047396558670\"},{\"id\":\"6047307283670\"},{\"id\":\"6047306634870\"},{\"id\":\"6047081632270\"},{\"id\":\"6047063290470\"},{\"id\":\"6047042026070\"},{\"id\":\"6046855206270\"},{\"id\":\"6046854391470\"},{\"id\":\"6046849858470\"},{\"id\":\"6046845870270\"},{\"id\":\"6046839574670\"},{\"id\":\"6046826881670\"},{\"id\":\"6046758110470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0OTQ3NzA1NTQ3MAZDZD\",\"after\":\"NjA0Njc1ODExMDQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0Njc1ODExMDQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA0OTQ3NzA1NTQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA1NDQyMDc4MTQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6054416868470\"},{\"id\":\"6054156231270\"},{\"id\":\"6054100441670\"},{\"id\":\"6054021363670\"},{\"id\":\"6053526258870\"},{\"id\":\"6053503508270\"},{\"id\":\"6053440027070\"},{\"id\":\"6053438440070\"},{\"id\":\"6052346706870\"},{\"id\":\"6052284860670\"},{\"id\":\"6051389683270\"},{\"id\":\"6051325162670\"},{\"id\":\"6051274943470\"},{\"id\":\"6051273672470\"},{\"id\":\"6051207170470\"},{\"id\":\"6051206502470\"},{\"id\":\"6050849364870\"},{\"id\":\"6050791810470\"},{\"id\":\"6050387155470\"},{\"id\":\"6050185887270\"},{\"id\":\"6050020410270\"},{\"id\":\"6049672599070\"},{\"id\":\"6049664623270\"},{\"id\":\"6049541694670\"},{\"id\":\"6049477071070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1NDQxNjg2ODQ3MAZDZD\",\"after\":\"NjA0OTQ3NzA3MTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0OTQ3NzA3MTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA1NDQxNjg2ODQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA2NDUzMjQzNjQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6064431745270\"},{\"id\":\"6063345207270\"},{\"id\":\"6063304977870\"},{\"id\":\"6062984300870\"},{\"id\":\"6062511159270\"},{\"id\":\"6058727884070\"},{\"id\":\"6058582351470\"},{\"id\":\"6058442622270\"},{\"id\":\"6057691860670\"},{\"id\":\"6056334638670\"},{\"id\":\"6056278906470\"},{\"id\":\"6056276209070\"},{\"id\":\"6056083058270\"},{\"id\":\"6056082641870\"},{\"id\":\"6055927657670\"},{\"id\":\"6055518600270\"},{\"id\":\"6055518574070\"},{\"id\":\"6055383466070\"},{\"id\":\"6055319065470\"},{\"id\":\"6055103761870\"},{\"id\":\"6054977645870\"},{\"id\":\"6054976892670\"},{\"id\":\"6054824761470\"},{\"id\":\"6054543737270\"},{\"id\":\"6054420781470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2NDQzMTc0NTI3MAZDZD\",\"after\":\"NjA1NDQyMDc4MTQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA1NDQyMDc4MTQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA2NDQzMTc0NTI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyNDkxMjk3NzI5MQZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6023897973491\"},{\"id\":\"6023897973091\"},{\"id\":\"6023226201691\"},{\"id\":\"6023226201491\"},{\"id\":\"6022703845491\"},{\"id\":\"6022703845291\"},{\"id\":\"6022061422691\"},{\"id\":\"6022061422491\"},{\"id\":\"6021366361491\"},{\"id\":\"6021358043091\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMzg5Nzk3MzQ5MQZDZD\",\"after\":\"NjAyMTM1ODA0MzA5MQZDZD\"},\"previous\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjAyMzg5Nzk3MzQ5MQZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0NTEwNTY0MDI5MQZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6045105640091\"},{\"id\":\"6043050813291\"},{\"id\":\"6043050813091\"},{\"id\":\"6041314496091\"},{\"id\":\"6041314495891\"},{\"id\":\"6040080787491\"},{\"id\":\"6040080787291\"},{\"id\":\"6038584660491\"},{\"id\":\"6038584660291\"},{\"id\":\"6036015877691\"},{\"id\":\"6036015877491\"},{\"id\":\"6033247058891\"},{\"id\":\"6033247058691\"},{\"id\":\"6030987390091\"},{\"id\":\"6030987180891\"},{\"id\":\"6029847645491\"},{\"id\":\"6029847645091\"},{\"id\":\"6028435214091\"},{\"id\":\"6028435026491\"},{\"id\":\"6027316298291\"},{\"id\":\"6027316298091\"},{\"id\":\"6026456340691\"},{\"id\":\"6026456340291\"},{\"id\":\"6024913957091\"},{\"id\":\"6024912977291\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NTEwNTY0MDA5MQZDZD\",\"after\":\"NjAyNDkxMjk3NzI5MQZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyNDkxMjk3NzI5MQZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA0NTEwNTY0MDA5MQZDZD\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v2.9/campaigns",
 :as :json,
 :query-params
 {:path "campaigns",
  :fields
  "insights.action_breakdowns(action_reaction).date_preset(last_3d).time_increment(1){account_id,account_name,campaign_id,campaign_name,actions}",
  :ids "act_10152562141153995,act_10152437784203995",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:status 200,
 :body
 "{\"act_10152562141153995\":{\"data\":[{\"id\":\"6068646006091\"},{\"id\":\"6068646004891\"},{\"id\":\"6067304577691\"},{\"id\":\"6067304573891\"},{\"id\":\"6065959730491\"},{\"id\":\"6065840488091\"},{\"id\":\"6064029033691\"},{\"id\":\"6062362317291\"},{\"id\":\"6061135790891\"},{\"id\":\"6060853608091\"},{\"id\":\"6059433582691\"},{\"id\":\"6059433582291\"},{\"id\":\"6057598024691\"},{\"id\":\"6057529087491\"},{\"id\":\"6054030251891\"},{\"id\":\"6054030251691\"},{\"id\":\"6052269660491\"},{\"id\":\"6052269659691\"},{\"id\":\"6050373553091\"},{\"id\":\"6050373552891\"},{\"id\":\"6048599743691\"},{\"id\":\"6048599743491\"},{\"id\":\"6046869215491\"},{\"id\":\"6046869215291\"},{\"id\":\"6045105640291\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2ODY0NjAwNjA5MQZDZD\",\"after\":\"NjA0NTEwNTY0MDI5MQZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0NTEwNTY0MDI5MQZDZD\"}},\"act_10152437784203995\":{\"data\":[{\"insights\":{\"data\":[{\"account_id\":\"10152437784203995\",\"account_name\":\"SWpLR\",\"campaign_id\":\"6077980757070\",\"campaign_name\":\"4RDvi\",\"actions\":[{\"action_type\":\"comment\",\"value\":\"12\"},{\"action_type\":\"like\",\"value\":\"9\"},{\"action_type\":\"link_click\",\"value\":\"215\"},{\"action_type\":\"post\",\"value\":\"6\"},{\"action_reaction\":\"like\",\"action_type\":\"post_reaction\",\"value\":\"51\"},{\"action_reaction\":\"love\",\"action_type\":\"post_reaction\",\"value\":\"6\"},{\"action_reaction\":\"angry\",\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"page_engagement\",\"value\":\"300\"},{\"action_type\":\"post_engagement\",\"value\":\"291\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6077980757070\"},{\"insights\":{\"data\":[{\"account_id\":\"10152437784203995\",\"account_name\":\"XhW5S\",\"campaign_id\":\"6077417491670\",\"campaign_name\":\"BSnWN\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"68\"},{\"action_type\":\"video_view\",\"value\":\"2983\"},{\"action_type\":\"page_engagement\",\"value\":\"3051\"},{\"action_type\":\"post_engagement\",\"value\":\"3051\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"account_id\":\"10152437784203995\",\"account_name\":\"JSUXq\",\"campaign_id\":\"6077417491670\",\"campaign_name\":\"o1Yj3\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"79\"},{\"action_type\":\"video_view\",\"value\":\"3325\"},{\"action_type\":\"page_engagement\",\"value\":\"3404\"},{\"action_type\":\"post_engagement\",\"value\":\"3404\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"account_id\":\"10152437784203995\",\"account_name\":\"RGEZg\",\"campaign_id\":\"6077417491670\",\"campaign_name\":\"b1LRp\",\"actions\":[{\"action_type\":\"link_click\",\"value\":\"96\"},{\"action_type\":\"video_view\",\"value\":\"3352\"},{\"action_type\":\"page_engagement\",\"value\":\"3448\"},{\"action_type\":\"post_engagement\",\"value\":\"3448\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077417491670\"},{\"insights\":{\"data\":[{\"account_id\":\"10152437784203995\",\"account_name\":\"qFY9s\",\"campaign_id\":\"6077413250870\",\"campaign_name\":\"PtYyF\",\"actions\":[{\"action_type\":\"like\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"118\"},{\"action_type\":\"video_view\",\"value\":\"2022\"},{\"action_reaction\":\"like\",\"action_type\":\"post_reaction\",\"value\":\"36\"},{\"action_type\":\"page_engagement\",\"value\":\"2177\"},{\"action_type\":\"post_engagement\",\"value\":\"2176\"}],\"date_start\":\"2017-09-30\",\"date_stop\":\"2017-09-30\"},{\"account_id\":\"10152437784203995\",\"account_name\":\"R9B0i\",\"campaign_id\":\"6077413250870\",\"campaign_name\":\"ISlja\",\"actions\":[{\"action_type\":\"like\",\"value\":\"5\"},{\"action_type\":\"link_click\",\"value\":\"149\"},{\"action_type\":\"video_view\",\"value\":\"2547\"},{\"action_reaction\":\"like\",\"action_type\":\"post_reaction\",\"value\":\"45\"},{\"action_reaction\":\"love\",\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"page_engagement\",\"value\":\"2747\"},{\"action_type\":\"post_engagement\",\"value\":\"2742\"}],\"date_start\":\"2017-10-01\",\"date_stop\":\"2017-10-01\"},{\"account_id\":\"10152437784203995\",\"account_name\":\"JU1Ti\",\"campaign_id\":\"6077413250870\",\"campaign_name\":\"BqdkT\",\"actions\":[{\"action_type\":\"like\",\"value\":\"2\"},{\"action_type\":\"link_click\",\"value\":\"134\"},{\"action_type\":\"post\",\"value\":\"1\"},{\"action_type\":\"video_view\",\"value\":\"2297\"},{\"action_reaction\":\"like\",\"action_type\":\"post_reaction\",\"value\":\"24\"},{\"action_type\":\"page_engagement\",\"value\":\"2458\"},{\"action_type\":\"post_engagement\",\"value\":\"2456\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MgZDZD\"}}},\"id\":\"6077413250870\"},{\"insights\":{\"data\":[{\"account_id\":\"10152437784203995\",\"account_name\":\"QmZ4l\",\"campaign_id\":\"6074690268470\",\"campaign_name\":\"FYqnH\",\"actions\":[{\"action_type\":\"comment\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"22\"},{\"action_type\":\"post\",\"value\":\"2\"},{\"action_type\":\"video_view\",\"value\":\"7469\"},{\"action_reaction\":\"like\",\"action_type\":\"post_reaction\",\"value\":\"3\"},{\"action_type\":\"page_engagement\",\"value\":\"7497\"},{\"action_type\":\"post_engagement\",\"value\":\"7497\"}],\"date_start\":\"2017-10-02\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6074690268470\"},{\"id\":\"6074689556670\"},{\"id\":\"6069555245670\"},{\"id\":\"6069217028270\"},{\"id\":\"6068707379270\"},{\"id\":\"6068653241670\"},{\"id\":\"6068652938870\"},{\"id\":\"6068652327670\"},{\"id\":\"6068589341870\"},{\"id\":\"6068588511070\"},{\"id\":\"6068583640870\"},{\"id\":\"6068582923670\"},{\"id\":\"6068471216470\"},{\"id\":\"6067951892070\"},{\"id\":\"6067950376070\"},{\"id\":\"6067819031670\"},{\"id\":\"6067543257670\"},{\"id\":\"6066502493470\"},{\"id\":\"6066502010270\"},{\"id\":\"6065546046870\"},{\"id\":\"6064534431070\"},{\"id\":\"6064532436470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA3Nzk4MDc1NzA3MAZDZD\",\"after\":\"NjA2NDUzMjQzNjQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_3d%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA2NDUzMjQzNjQ3MAZDZD\"}}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyMDQ3MDA2NTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020469208070\"},{\"id\":\"6020416026470\"},{\"id\":\"6020411414470\"},{\"id\":\"6019681080270\"},{\"id\":\"6019644104070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDQ2OTIwODA3MAZDZD\",\"after\":\"NjAxOTY0NDEwNDA3MAZDZD\"},\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjAyMDQ2OTIwODA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyNjU0Mjk3MDY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6026542970270\"},{\"id\":\"6026542970070\"},{\"id\":\"6026392074870\"},{\"id\":\"6026011237870\"},{\"id\":\"6025695642470\"},{\"id\":\"6025687679470\"},{\"id\":\"6025591979870\"},{\"id\":\"6025562944470\"},{\"id\":\"6025560438470\"},{\"id\":\"6025560438270\"},{\"id\":\"6024565463270\"},{\"id\":\"6023187817470\"},{\"id\":\"6023044208270\"},{\"id\":\"6022819846270\"},{\"id\":\"6022818793470\"},{\"id\":\"6022738122670\"},{\"id\":\"6022421550870\"},{\"id\":\"6022120952670\"},{\"id\":\"6021919243270\"},{\"id\":\"6021754733070\"},{\"id\":\"6020917424270\"},{\"id\":\"6020916526670\"},{\"id\":\"6020663864070\"},{\"id\":\"6020590268670\"},{\"id\":\"6020470065070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNjU0Mjk3MDI3MAZDZD\",\"after\":\"NjAyMDQ3MDA2NTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyMDQ3MDA2NTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjAyNjU0Mjk3MDI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAzNDI2NTYwMzQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6034264589670\"},{\"id\":\"6032861605270\"},{\"id\":\"6032749476870\"},{\"id\":\"6032749083470\"},{\"id\":\"6032111463870\"},{\"id\":\"6031717809670\"},{\"id\":\"6031491138270\"},{\"id\":\"6031490818470\"},{\"id\":\"6031489843470\"},{\"id\":\"6030606674870\"},{\"id\":\"6030029668070\"},{\"id\":\"6029842967270\"},{\"id\":\"6029750174870\"},{\"id\":\"6029341869270\"},{\"id\":\"6029058309270\"},{\"id\":\"6028994834670\"},{\"id\":\"6028356677270\"},{\"id\":\"6028346486870\"},{\"id\":\"6028270919670\"},{\"id\":\"6027882130070\"},{\"id\":\"6027570733670\"},{\"id\":\"6027170240470\"},{\"id\":\"6026798951070\"},{\"id\":\"6026567452670\"},{\"id\":\"6026542970670\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNDI2NDU4OTY3MAZDZD\",\"after\":\"NjAyNjU0Mjk3MDY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyNjU0Mjk3MDY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjAzNDI2NDU4OTY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0NDM1NDU2OTg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6044285810470\"},{\"id\":\"6044125274470\"},{\"id\":\"6044004779270\"},{\"id\":\"6043918161870\"},{\"id\":\"6043742649270\"},{\"id\":\"6043633602670\"},{\"id\":\"6043374806070\"},{\"id\":\"6042985120870\"},{\"id\":\"6042976332870\"},{\"id\":\"6042973616070\"},{\"id\":\"6042906710270\"},{\"id\":\"6042138678870\"},{\"id\":\"6042063797070\"},{\"id\":\"6041830861470\"},{\"id\":\"6041002071870\"},{\"id\":\"6040759465870\"},{\"id\":\"6040021891070\"},{\"id\":\"6039831650670\"},{\"id\":\"6038701396470\"},{\"id\":\"6038388592270\"},{\"id\":\"6035594872670\"},{\"id\":\"6035561736270\"},{\"id\":\"6035560883270\"},{\"id\":\"6034785536270\"},{\"id\":\"6034265603470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NDI4NTgxMDQ3MAZDZD\",\"after\":\"NjAzNDI2NTYwMzQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAzNDI2NTYwMzQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA0NDI4NTgxMDQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0Njc1ODExMDQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6046742077270\"},{\"id\":\"6046739319070\"},{\"id\":\"6046557726070\"},{\"id\":\"6046313822470\"},{\"id\":\"6046072317270\"},{\"id\":\"6045767050470\"},{\"id\":\"6045748996670\"},{\"id\":\"6045681095470\"},{\"id\":\"6045680477270\"},{\"id\":\"6045679590270\"},{\"id\":\"6045675780870\"},{\"id\":\"6045211083870\"},{\"id\":\"6045135612470\"},{\"id\":\"6045058522470\"},{\"id\":\"6045056840070\"},{\"id\":\"6044901291270\"},{\"id\":\"6044802438470\"},{\"id\":\"6044801305070\"},{\"id\":\"6044647763270\"},{\"id\":\"6044647679270\"},{\"id\":\"6044442014070\"},{\"id\":\"6044441442470\"},{\"id\":\"6044438044870\"},{\"id\":\"6044356472870\"},{\"id\":\"6044354569870\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0Njc0MjA3NzI3MAZDZD\",\"after\":\"NjA0NDM1NDU2OTg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0NDM1NDU2OTg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA0Njc0MjA3NzI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0OTQ3NzA3MTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6049477055470\"},{\"id\":\"6049242019670\"},{\"id\":\"6049022368270\"},{\"id\":\"6048947178270\"},{\"id\":\"6048780289870\"},{\"id\":\"6048770169470\"},{\"id\":\"6048738596870\"},{\"id\":\"6048736766070\"},{\"id\":\"6048676993470\"},{\"id\":\"6048570034270\"},{\"id\":\"6048275369870\"},{\"id\":\"6048273191270\"},{\"id\":\"6047396558670\"},{\"id\":\"6047307283670\"},{\"id\":\"6047306634870\"},{\"id\":\"6047081632270\"},{\"id\":\"6047063290470\"},{\"id\":\"6047042026070\"},{\"id\":\"6046855206270\"},{\"id\":\"6046854391470\"},{\"id\":\"6046849858470\"},{\"id\":\"6046845870270\"},{\"id\":\"6046839574670\"},{\"id\":\"6046826881670\"},{\"id\":\"6046758110470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0OTQ3NzA1NTQ3MAZDZD\",\"after\":\"NjA0Njc1ODExMDQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0Njc1ODExMDQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA0OTQ3NzA1NTQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA1NDQyMDc4MTQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6054416868470\"},{\"id\":\"6054156231270\"},{\"id\":\"6054100441670\"},{\"id\":\"6054021363670\"},{\"id\":\"6053526258870\"},{\"id\":\"6053503508270\"},{\"id\":\"6053440027070\"},{\"id\":\"6053438440070\"},{\"id\":\"6052346706870\"},{\"id\":\"6052284860670\"},{\"id\":\"6051389683270\"},{\"id\":\"6051325162670\"},{\"id\":\"6051274943470\"},{\"id\":\"6051273672470\"},{\"id\":\"6051207170470\"},{\"id\":\"6051206502470\"},{\"id\":\"6050849364870\"},{\"id\":\"6050791810470\"},{\"id\":\"6050387155470\"},{\"id\":\"6050185887270\"},{\"id\":\"6050020410270\"},{\"id\":\"6049672599070\"},{\"id\":\"6049664623270\"},{\"id\":\"6049541694670\"},{\"id\":\"6049477071070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1NDQxNjg2ODQ3MAZDZD\",\"after\":\"NjA0OTQ3NzA3MTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0OTQ3NzA3MTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA1NDQxNjg2ODQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA2NDUzMjQzNjQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"insights\":{\"data\":[{\"account_id\":\"10152437784203995\",\"account_name\":\"WPSWt\",\"campaign_id\":\"6064431745270\",\"campaign_name\":\"KDE2f\",\"actions\":[{\"action_type\":\"like\",\"value\":\"5\"},{\"action_type\":\"link_click\",\"value\":\"202\"},{\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"page_engagement\",\"value\":\"208\"},{\"action_type\":\"post_engagement\",\"value\":\"203\"}],\"date_start\":\"2017-04-01\",\"date_stop\":\"2017-04-01\"},{\"account_id\":\"10152437784203995\",\"account_name\":\"FKSUj\",\"campaign_id\":\"6064431745270\",\"campaign_name\":\"bV0Vb\",\"actions\":[{\"action_type\":\"comment\",\"value\":\"1\"},{\"action_type\":\"like\",\"value\":\"2\"},{\"action_type\":\"link_click\",\"value\":\"216\"},{\"action_type\":\"post_reaction\",\"value\":\"2\"},{\"action_type\":\"page_engagement\",\"value\":\"221\"},{\"action_type\":\"post_engagement\",\"value\":\"219\"}],\"date_start\":\"2017-04-02\",\"date_stop\":\"2017-04-02\"},{\"account_id\":\"10152437784203995\",\"account_name\":\"ygjum\",\"campaign_id\":\"6064431745270\",\"campaign_name\":\"nESev\",\"actions\":[{\"action_type\":\"comment\",\"value\":\"2\"},{\"action_type\":\"link_click\",\"value\":\"213\"},{\"action_type\":\"post\",\"value\":\"1\"},{\"action_type\":\"post_reaction\",\"value\":\"7\"},{\"action_type\":\"page_engagement\",\"value\":\"223\"},{\"action_type\":\"post_engagement\",\"value\":\"223\"}],\"date_start\":\"2017-04-03\",\"date_stop\":\"2017-04-03\"},{\"account_id\":\"10152437784203995\",\"account_name\":\"kNwYF\",\"campaign_id\":\"6064431745270\",\"campaign_name\":\"dpZwa\",\"actions\":[{\"action_type\":\"like\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"213\"},{\"action_type\":\"post_reaction\",\"value\":\"4\"},{\"action_type\":\"page_engagement\",\"value\":\"218\"},{\"action_type\":\"post_engagement\",\"value\":\"217\"}],\"date_start\":\"2017-04-04\",\"date_stop\":\"2017-04-04\"},{\"account_id\":\"10152437784203995\",\"account_name\":\"pZt8D\",\"campaign_id\":\"6064431745270\",\"campaign_name\":\"BT131\",\"actions\":[{\"action_type\":\"comment\",\"value\":\"2\"},{\"action_type\":\"like\",\"value\":\"2\"},{\"action_type\":\"link_click\",\"value\":\"196\"},{\"action_type\":\"post_reaction\",\"value\":\"4\"},{\"action_type\":\"page_engagement\",\"value\":\"204\"},{\"action_type\":\"post_engagement\",\"value\":\"202\"}],\"date_start\":\"2017-04-05\",\"date_stop\":\"2017-04-05\"},{\"account_id\":\"10152437784203995\",\"account_name\":\"637mb\",\"campaign_id\":\"6064431745270\",\"campaign_name\":\"PRjKz\",\"actions\":[{\"action_type\":\"like\",\"value\":\"4\"},{\"action_type\":\"link_click\",\"value\":\"195\"},{\"action_type\":\"post\",\"value\":\"1\"},{\"action_type\":\"post_reaction\",\"value\":\"1\"},{\"action_type\":\"page_engagement\",\"value\":\"201\"},{\"action_type\":\"post_engagement\",\"value\":\"197\"}],\"date_start\":\"2017-04-06\",\"date_stop\":\"2017-04-06\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"NQZDZD\"}}},\"id\":\"6064431745270\"},{\"id\":\"6063345207270\"},{\"id\":\"6063304977870\"},{\"id\":\"6062984300870\"},{\"id\":\"6062511159270\"},{\"id\":\"6058727884070\"},{\"id\":\"6058582351470\"},{\"id\":\"6058442622270\"},{\"id\":\"6057691860670\"},{\"id\":\"6056334638670\"},{\"id\":\"6056278906470\"},{\"id\":\"6056276209070\"},{\"id\":\"6056083058270\"},{\"id\":\"6056082641870\"},{\"id\":\"6055927657670\"},{\"id\":\"6055518600270\"},{\"id\":\"6055518574070\"},{\"id\":\"6055383466070\"},{\"id\":\"6055319065470\"},{\"id\":\"6055103761870\"},{\"id\":\"6054977645870\"},{\"id\":\"6054976892670\"},{\"id\":\"6054824761470\"},{\"id\":\"6054543737270\"},{\"id\":\"6054420781470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2NDQzMTc0NTI3MAZDZD\",\"after\":\"NjA1NDQyMDc4MTQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA1NDQyMDc4MTQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA2NDQzMTc0NTI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyNDkxMjk3NzI5MQZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6023897973491\"},{\"id\":\"6023897973091\"},{\"id\":\"6023226201691\"},{\"id\":\"6023226201491\"},{\"id\":\"6022703845491\"},{\"id\":\"6022703845291\"},{\"id\":\"6022061422691\"},{\"id\":\"6022061422491\"},{\"id\":\"6021366361491\"},{\"id\":\"6021358043091\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMzg5Nzk3MzQ5MQZDZD\",\"after\":\"NjAyMTM1ODA0MzA5MQZDZD\"},\"previous\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjAyMzg5Nzk3MzQ5MQZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0NTEwNTY0MDI5MQZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6045105640091\"},{\"id\":\"6043050813291\"},{\"id\":\"6043050813091\"},{\"id\":\"6041314496091\"},{\"id\":\"6041314495891\"},{\"id\":\"6040080787491\"},{\"id\":\"6040080787291\"},{\"id\":\"6038584660491\"},{\"id\":\"6038584660291\"},{\"id\":\"6036015877691\"},{\"id\":\"6036015877491\"},{\"id\":\"6033247058891\"},{\"id\":\"6033247058691\"},{\"id\":\"6030987390091\"},{\"id\":\"6030987180891\"},{\"id\":\"6029847645491\"},{\"id\":\"6029847645091\"},{\"id\":\"6028435214091\"},{\"id\":\"6028435026491\"},{\"id\":\"6027316298291\"},{\"id\":\"6027316298091\"},{\"id\":\"6026456340691\"},{\"id\":\"6026456340291\"},{\"id\":\"6024913957091\"},{\"id\":\"6024912977291\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NTEwNTY0MDA5MQZDZD\",\"after\":\"NjAyNDkxMjk3NzI5MQZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjAyNDkxMjk3NzI5MQZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&before=NjA0NTEwNTY0MDA5MQZDZD\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v2.9/campaigns",
 :as :json,
 :query-params
 {:path "campaigns",
  :fields
  "insights.time_range({'since':'2017-04-01','until':'2017-04-06'}).action_breakdowns(action_type).time_increment(1){account_id,account_name,campaign_id,campaign_name,actions}",
  :ids "act_10152562141153995,act_10152437784203995",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:status 200,
 :body
 "{\"act_10152562141153995\":{\"data\":[{\"id\":\"6068646006091\"},{\"id\":\"6068646004891\"},{\"id\":\"6067304577691\"},{\"id\":\"6067304573891\"},{\"id\":\"6065959730491\"},{\"id\":\"6065840488091\"},{\"insights\":{\"data\":[{\"account_id\":\"10152562141153995\",\"account_name\":\"S6ri9\",\"campaign_id\":\"6064029033691\",\"campaign_name\":\"zN5e9\",\"actions\":[{\"action_type\":\"like\",\"value\":\"3\"},{\"action_type\":\"link_click\",\"value\":\"163\"},{\"action_type\":\"offsite_conversion.registration\",\"value\":\"5\"},{\"action_type\":\"post_reaction\",\"value\":\"14\"},{\"action_type\":\"page_engagement\",\"value\":\"180\"},{\"action_type\":\"post_engagement\",\"value\":\"177\"},{\"action_type\":\"offsite_conversion\",\"value\":\"5\"}],\"date_start\":\"2017-04-01\",\"date_stop\":\"2017-04-01\"},{\"account_id\":\"10152562141153995\",\"account_name\":\"juMEZ\",\"campaign_id\":\"6064029033691\",\"campaign_name\":\"TatD1\",\"actions\":[{\"action_type\":\"comment\",\"value\":\"2\"},{\"action_type\":\"offsite_conversion.custom.270601453373563\",\"value\":\"7\"},{\"action_type\":\"like\",\"value\":\"9\"},{\"action_type\":\"link_click\",\"value\":\"304\"},{\"action_type\":\"offsite_conversion.fb_pixel_lead\",\"value\":\"7\"},{\"action_type\":\"offsite_conversion.registration\",\"value\":\"4\"},{\"action_type\":\"post\",\"value\":\"3\"},{\"action_type\":\"post_reaction\",\"value\":\"22\"},{\"action_type\":\"page_engagement\",\"value\":\"340\"},{\"action_type\":\"post_engagement\",\"value\":\"331\"},{\"action_type\":\"offsite_conversion\",\"value\":\"18\"}],\"date_start\":\"2017-04-02\",\"date_stop\":\"2017-04-02\"},{\"account_id\":\"10152562141153995\",\"account_name\":\"e1XHt\",\"campaign_id\":\"6064029033691\",\"campaign_name\":\"BedBO\",\"actions\":[{\"action_type\":\"offsite_conversion.custom.270601453373563\",\"value\":\"5\"},{\"action_type\":\"like\",\"value\":\"3\"},{\"action_type\":\"link_click\",\"value\":\"214\"},{\"action_type\":\"offsite_conversion.fb_pixel_lead\",\"value\":\"5\"},{\"action_type\":\"offsite_conversion.registration\",\"value\":\"6\"},{\"action_type\":\"post_reaction\",\"value\":\"8\"},{\"action_type\":\"page_engagement\",\"value\":\"225\"},{\"action_type\":\"post_engagement\",\"value\":\"222\"},{\"action_type\":\"offsite_conversion\",\"value\":\"16\"}],\"date_start\":\"2017-04-03\",\"date_stop\":\"2017-04-03\"},{\"account_id\":\"10152562141153995\",\"account_name\":\"O3Qbr\",\"campaign_id\":\"6064029033691\",\"campaign_name\":\"dXLBS\",\"actions\":[{\"action_type\":\"offsite_conversion.custom.270601453373563\",\"value\":\"7\"},{\"action_type\":\"like\",\"value\":\"6\"},{\"action_type\":\"link_click\",\"value\":\"225\"},{\"action_type\":\"offsite_conversion.fb_pixel_lead\",\"value\":\"7\"},{\"action_type\":\"offsite_conversion.registration\",\"value\":\"9\"},{\"action_type\":\"post\",\"value\":\"2\"},{\"action_type\":\"post_reaction\",\"value\":\"6\"},{\"action_type\":\"page_engagement\",\"value\":\"239\"},{\"action_type\":\"post_engagement\",\"value\":\"233\"},{\"action_type\":\"offsite_conversion\",\"value\":\"23\"}],\"date_start\":\"2017-04-04\",\"date_stop\":\"2017-04-04\"},{\"account_id\":\"10152562141153995\",\"account_name\":\"SgcUJ\",\"campaign_id\":\"6064029033691\",\"campaign_name\":\"SwWMC\",\"actions\":[{\"action_type\":\"offsite_conversion.custom.270601453373563\",\"value\":\"2\"},{\"action_type\":\"like\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"232\"},{\"action_type\":\"offsite_conversion.fb_pixel_lead\",\"value\":\"2\"},{\"action_type\":\"offsite_conversion.registration\",\"value\":\"13\"},{\"action_type\":\"post\",\"value\":\"2\"},{\"action_type\":\"post_reaction\",\"value\":\"8\"},{\"action_type\":\"page_engagement\",\"value\":\"243\"},{\"action_type\":\"post_engagement\",\"value\":\"242\"},{\"action_type\":\"offsite_conversion\",\"value\":\"17\"}],\"date_start\":\"2017-04-05\",\"date_stop\":\"2017-04-05\"},{\"account_id\":\"10152562141153995\",\"account_name\":\"TLkaO\",\"campaign_id\":\"6064029033691\",\"campaign_name\":\"fNBib\",\"actions\":[{\"action_type\":\"offsite_conversion.custom.270601453373563\",\"value\":\"1\"},{\"action_type\":\"like\",\"value\":\"1\"},{\"action_type\":\"link_click\",\"value\":\"252\"},{\"action_type\":\"offsite_conversion.fb_pixel_lead\",\"value\":\"1\"},{\"action_type\":\"offsite_conversion.registration\",\"value\":\"8\"},{\"action_type\":\"post_reaction\",\"value\":\"12\"},{\"action_type\":\"page_engagement\",\"value\":\"265\"},{\"action_type\":\"post_engagement\",\"value\":\"264\"},{\"action_type\":\"offsite_conversion\",\"value\":\"10\"}],\"date_start\":\"2017-04-06\",\"date_stop\":\"2017-04-06\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"NQZDZD\"}}},\"id\":\"6064029033691\"},{\"id\":\"6062362317291\"},{\"id\":\"6061135790891\"},{\"id\":\"6060853608091\"},{\"id\":\"6059433582691\"},{\"id\":\"6059433582291\"},{\"id\":\"6057598024691\"},{\"id\":\"6057529087491\"},{\"id\":\"6054030251891\"},{\"id\":\"6054030251691\"},{\"id\":\"6052269660491\"},{\"id\":\"6052269659691\"},{\"id\":\"6050373553091\"},{\"id\":\"6050373552891\"},{\"id\":\"6048599743691\"},{\"id\":\"6048599743491\"},{\"id\":\"6046869215491\"},{\"id\":\"6046869215291\"},{\"id\":\"6045105640291\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2ODY0NjAwNjA5MQZDZD\",\"after\":\"NjA0NTEwNTY0MDI5MQZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA0NTEwNTY0MDI5MQZDZD\"}},\"act_10152437784203995\":{\"data\":[{\"id\":\"6077980757070\"},{\"id\":\"6077417491670\"},{\"id\":\"6077413250870\"},{\"id\":\"6074690268470\"},{\"id\":\"6074689556670\"},{\"id\":\"6069555245670\"},{\"id\":\"6069217028270\"},{\"id\":\"6068707379270\"},{\"id\":\"6068653241670\"},{\"id\":\"6068652938870\"},{\"id\":\"6068652327670\"},{\"id\":\"6068589341870\"},{\"id\":\"6068588511070\"},{\"id\":\"6068583640870\"},{\"id\":\"6068582923670\"},{\"id\":\"6068471216470\"},{\"id\":\"6067951892070\"},{\"id\":\"6067950376070\"},{\"id\":\"6067819031670\"},{\"id\":\"6067543257670\"},{\"id\":\"6066502493470\"},{\"id\":\"6066502010270\"},{\"id\":\"6065546046870\"},{\"id\":\"6064534431070\"},{\"id\":\"6064532436470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA3Nzk4MDc1NzA3MAZDZD\",\"after\":\"NjA2NDUzMjQzNjQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.time_range%28%7B%27since%27%3A%272017-04-01%27%2C%27until%27%3A%272017-04-06%27%7D%29.action_breakdowns%28action_type%29.time_increment%281%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cactions%7D&since&until&limit=25&after=NjA2NDUzMjQzNjQ3MAZDZD\"}}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjAyMDQ3MDA2NTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6020469208070\"},{\"id\":\"6020416026470\"},{\"id\":\"6020411414470\"},{\"id\":\"6019681080270\"},{\"id\":\"6019644104070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMDQ2OTIwODA3MAZDZD\",\"after\":\"NjAxOTY0NDEwNDA3MAZDZD\"},\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&before=NjAyMDQ2OTIwODA3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjAyNjU0Mjk3MDY3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6026542970270\"},{\"id\":\"6026542970070\"},{\"id\":\"6026392074870\"},{\"id\":\"6026011237870\"},{\"id\":\"6025695642470\"},{\"id\":\"6025687679470\"},{\"id\":\"6025591979870\"},{\"id\":\"6025562944470\"},{\"id\":\"6025560438470\"},{\"id\":\"6025560438270\"},{\"id\":\"6024565463270\"},{\"id\":\"6023187817470\"},{\"id\":\"6023044208270\"},{\"id\":\"6022819846270\"},{\"id\":\"6022818793470\"},{\"id\":\"6022738122670\"},{\"id\":\"6022421550870\"},{\"id\":\"6022120952670\"},{\"id\":\"6021919243270\"},{\"id\":\"6021754733070\"},{\"id\":\"6020917424270\"},{\"id\":\"6020916526670\"},{\"id\":\"6020663864070\"},{\"id\":\"6020590268670\"},{\"id\":\"6020470065070\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyNjU0Mjk3MDI3MAZDZD\",\"after\":\"NjAyMDQ3MDA2NTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjAyMDQ3MDA2NTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&before=NjAyNjU0Mjk3MDI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjAzNDI2NTYwMzQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6034264589670\"},{\"id\":\"6032861605270\"},{\"id\":\"6032749476870\"},{\"id\":\"6032749083470\"},{\"id\":\"6032111463870\"},{\"id\":\"6031717809670\"},{\"id\":\"6031491138270\"},{\"id\":\"6031490818470\"},{\"id\":\"6031489843470\"},{\"id\":\"6030606674870\"},{\"id\":\"6030029668070\"},{\"id\":\"6029842967270\"},{\"id\":\"6029750174870\"},{\"id\":\"6029341869270\"},{\"id\":\"6029058309270\"},{\"id\":\"6028994834670\"},{\"id\":\"6028356677270\"},{\"id\":\"6028346486870\"},{\"id\":\"6028270919670\"},{\"id\":\"6027882130070\"},{\"id\":\"6027570733670\"},{\"id\":\"6027170240470\"},{\"id\":\"6026798951070\"},{\"id\":\"6026567452670\"},{\"id\":\"6026542970670\"}],\"paging\":{\"cursors\":{\"before\":\"NjAzNDI2NDU4OTY3MAZDZD\",\"after\":\"NjAyNjU0Mjk3MDY3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjAyNjU0Mjk3MDY3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&before=NjAzNDI2NDU4OTY3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA0NDM1NDU2OTg3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6044285810470\"},{\"id\":\"6044125274470\"},{\"id\":\"6044004779270\"},{\"id\":\"6043918161870\"},{\"id\":\"6043742649270\"},{\"id\":\"6043633602670\"},{\"id\":\"6043374806070\"},{\"id\":\"6042985120870\"},{\"id\":\"6042976332870\"},{\"id\":\"6042973616070\"},{\"id\":\"6042906710270\"},{\"id\":\"6042138678870\"},{\"id\":\"6042063797070\"},{\"id\":\"6041830861470\"},{\"id\":\"6041002071870\"},{\"id\":\"6040759465870\"},{\"id\":\"6040021891070\"},{\"id\":\"6039831650670\"},{\"id\":\"6038701396470\"},{\"id\":\"6038388592270\"},{\"id\":\"6035594872670\"},{\"id\":\"6035561736270\"},{\"id\":\"6035560883270\"},{\"id\":\"6034785536270\"},{\"id\":\"6034265603470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NDI4NTgxMDQ3MAZDZD\",\"after\":\"NjAzNDI2NTYwMzQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjAzNDI2NTYwMzQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&before=NjA0NDI4NTgxMDQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA0Njc1ODExMDQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6046742077270\"},{\"id\":\"6046739319070\"},{\"id\":\"6046557726070\"},{\"id\":\"6046313822470\"},{\"id\":\"6046072317270\"},{\"id\":\"6045767050470\"},{\"id\":\"6045748996670\"},{\"id\":\"6045681095470\"},{\"id\":\"6045680477270\"},{\"id\":\"6045679590270\"},{\"id\":\"6045675780870\"},{\"id\":\"6045211083870\"},{\"id\":\"6045135612470\"},{\"id\":\"6045058522470\"},{\"id\":\"6045056840070\"},{\"id\":\"6044901291270\"},{\"id\":\"6044802438470\"},{\"id\":\"6044801305070\"},{\"id\":\"6044647763270\"},{\"id\":\"6044647679270\"},{\"id\":\"6044442014070\"},{\"id\":\"6044441442470\"},{\"id\":\"6044438044870\"},{\"id\":\"6044356472870\"},{\"id\":\"6044354569870\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0Njc0MjA3NzI3MAZDZD\",\"after\":\"NjA0NDM1NDU2OTg3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA0NDM1NDU2OTg3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&before=NjA0Njc0MjA3NzI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA0OTQ3NzA3MTA3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6049477055470\"},{\"id\":\"6049242019670\"},{\"id\":\"6049022368270\"},{\"id\":\"6048947178270\"},{\"id\":\"6048780289870\"},{\"id\":\"6048770169470\"},{\"id\":\"6048738596870\"},{\"id\":\"6048736766070\"},{\"id\":\"6048676993470\"},{\"id\":\"6048570034270\"},{\"id\":\"6048275369870\"},{\"id\":\"6048273191270\"},{\"id\":\"6047396558670\"},{\"id\":\"6047307283670\"},{\"id\":\"6047306634870\"},{\"id\":\"6047081632270\"},{\"id\":\"6047063290470\"},{\"id\":\"6047042026070\"},{\"id\":\"6046855206270\"},{\"id\":\"6046854391470\"},{\"id\":\"6046849858470\"},{\"id\":\"6046845870270\"},{\"id\":\"6046839574670\"},{\"id\":\"6046826881670\"},{\"id\":\"6046758110470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0OTQ3NzA1NTQ3MAZDZD\",\"after\":\"NjA0Njc1ODExMDQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA0Njc1ODExMDQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&before=NjA0OTQ3NzA1NTQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA1NDQyMDc4MTQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6054416868470\"},{\"id\":\"6054156231270\"},{\"id\":\"6054100441670\"},{\"id\":\"6054021363670\"},{\"id\":\"6053526258870\"},{\"id\":\"6053503508270\"},{\"id\":\"6053440027070\"},{\"id\":\"6053438440070\"},{\"id\":\"6052346706870\"},{\"id\":\"6052284860670\"},{\"id\":\"6051389683270\"},{\"id\":\"6051325162670\"},{\"id\":\"6051274943470\"},{\"id\":\"6051273672470\"},{\"id\":\"6051207170470\"},{\"id\":\"6051206502470\"},{\"id\":\"6050849364870\"},{\"id\":\"6050791810470\"},{\"id\":\"6050387155470\"},{\"id\":\"6050185887270\"},{\"id\":\"6050020410270\"},{\"id\":\"6049672599070\"},{\"id\":\"6049664623270\"},{\"id\":\"6049541694670\"},{\"id\":\"6049477071070\"}],\"paging\":{\"cursors\":{\"before\":\"NjA1NDQxNjg2ODQ3MAZDZD\",\"after\":\"NjA0OTQ3NzA3MTA3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA0OTQ3NzA3MTA3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&before=NjA1NDQxNjg2ODQ3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA2NDUzMjQzNjQ3MAZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6064431745270\"},{\"id\":\"6063345207270\"},{\"id\":\"6063304977870\"},{\"id\":\"6062984300870\"},{\"id\":\"6062511159270\"},{\"id\":\"6058727884070\"},{\"id\":\"6058582351470\"},{\"id\":\"6058442622270\"},{\"id\":\"6057691860670\"},{\"id\":\"6056334638670\"},{\"id\":\"6056278906470\"},{\"id\":\"6056276209070\"},{\"id\":\"6056083058270\"},{\"id\":\"6056082641870\"},{\"id\":\"6055927657670\"},{\"id\":\"6055518600270\"},{\"id\":\"6055518574070\"},{\"id\":\"6055383466070\"},{\"id\":\"6055319065470\"},{\"id\":\"6055103761870\"},{\"id\":\"6054977645870\"},{\"id\":\"6054976892670\"},{\"id\":\"6054824761470\"},{\"id\":\"6054543737270\"},{\"id\":\"6054420781470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2NDQzMTc0NTI3MAZDZD\",\"after\":\"NjA1NDQyMDc4MTQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA1NDQyMDc4MTQ3MAZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&before=NjA2NDQzMTc0NTI3MAZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjAyNDkxMjk3NzI5MQZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6023897973491\"},{\"id\":\"6023897973091\"},{\"id\":\"6023226201691\"},{\"id\":\"6023226201491\"},{\"id\":\"6022703845491\"},{\"id\":\"6022703845291\"},{\"id\":\"6022061422691\"},{\"id\":\"6022061422491\"},{\"id\":\"6021366361491\"},{\"id\":\"6021358043091\"}],\"paging\":{\"cursors\":{\"before\":\"NjAyMzg5Nzk3MzQ5MQZDZD\",\"after\":\"NjAyMTM1ODA0MzA5MQZDZD\"},\"previous\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&before=NjAyMzg5Nzk3MzQ5MQZDZD\"}}"}
){:method :get,
 :address
 "https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA0NTEwNTY0MDI5MQZDZD",
 :as :json}
(fn [req]{:status 200,
 :body
 "{\"data\":[{\"id\":\"6045105640091\"},{\"id\":\"6043050813291\"},{\"id\":\"6043050813091\"},{\"id\":\"6041314496091\"},{\"id\":\"6041314495891\"},{\"id\":\"6040080787491\"},{\"id\":\"6040080787291\"},{\"id\":\"6038584660491\"},{\"id\":\"6038584660291\"},{\"id\":\"6036015877691\"},{\"id\":\"6036015877491\"},{\"id\":\"6033247058891\"},{\"id\":\"6033247058691\"},{\"id\":\"6030987390091\"},{\"id\":\"6030987180891\"},{\"id\":\"6029847645491\"},{\"id\":\"6029847645091\"},{\"id\":\"6028435214091\"},{\"id\":\"6028435026491\"},{\"id\":\"6027316298291\"},{\"id\":\"6027316298091\"},{\"id\":\"6026456340691\"},{\"id\":\"6026456340291\"},{\"id\":\"6024913957091\"},{\"id\":\"6024912977291\"}],\"paging\":{\"cursors\":{\"before\":\"NjA0NTEwNTY0MDA5MQZDZD\",\"after\":\"NjAyNDkxMjk3NzI5MQZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjAyNDkxMjk3NzI5MQZDZD\",\"previous\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&before=NjA0NTEwNTY0MDA5MQZDZD\"}}"}
){:method :get,
 :address "https://graph.facebook.com/v2.9/campaigns",
 :as :json,
 :query-params
 {:path "campaigns",
  :fields
  "insights.action_breakdowns(action_reaction).date_preset(last_28d){account_id,account_name,campaign_id,campaign_name,impressions,clicks,spend,reach} ",
  :ids "act_10152562141153995,act_10152437784203995",
  :access_token "XXTOKENXX",
  :since "",
  :until ""}}
(fn [req]{:status 200,
 :body
 "{\"act_10152562141153995\":{\"data\":[{\"id\":\"6068646006091\"},{\"id\":\"6068646004891\"},{\"id\":\"6067304577691\"},{\"id\":\"6067304573891\"},{\"id\":\"6065959730491\"},{\"id\":\"6065840488091\"},{\"id\":\"6064029033691\"},{\"id\":\"6062362317291\"},{\"id\":\"6061135790891\"},{\"id\":\"6060853608091\"},{\"id\":\"6059433582691\"},{\"id\":\"6059433582291\"},{\"id\":\"6057598024691\"},{\"id\":\"6057529087491\"},{\"id\":\"6054030251891\"},{\"id\":\"6054030251691\"},{\"id\":\"6052269660491\"},{\"id\":\"6052269659691\"},{\"id\":\"6050373553091\"},{\"id\":\"6050373552891\"},{\"id\":\"6048599743691\"},{\"id\":\"6048599743491\"},{\"id\":\"6046869215491\"},{\"id\":\"6046869215291\"},{\"id\":\"6045105640291\"}],\"paging\":{\"cursors\":{\"before\":\"NjA2ODY0NjAwNjA5MQZDZD\",\"after\":\"NjA0NTEwNTY0MDI5MQZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152562141153995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA0NTEwNTY0MDI5MQZDZD\"}},\"act_10152437784203995\":{\"data\":[{\"insights\":{\"data\":[{\"campaign_name\":\"6IBcd\",\"impressions\":\"11893\",\"campaign_id\":\"6077980757070\",\"account_id\":\"10152437784203995\",\"clicks\":\"549\",\"reach\":\"11743\",\"spend\":\"30.9\",\"date_start\":\"2017-09-05\",\"account_name\":\"W7Yd9\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6077980757070\"},{\"insights\":{\"data\":[{\"campaign_name\":\"2CEbM\",\"impressions\":\"315985\",\"campaign_id\":\"6077417491670\",\"account_id\":\"10152437784203995\",\"clicks\":\"905\",\"reach\":\"116782\",\"spend\":\"496.38\",\"date_start\":\"2017-09-05\",\"account_name\":\"4IYqn\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6077417491670\"},{\"insights\":{\"data\":[{\"campaign_name\":\"6iuz6\",\"impressions\":\"130444\",\"campaign_id\":\"6077413250870\",\"account_id\":\"10152437784203995\",\"clicks\":\"2281\",\"reach\":\"63973\",\"spend\":\"683.53\",\"date_start\":\"2017-09-05\",\"account_name\":\"ypee3\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6077413250870\"},{\"insights\":{\"data\":[{\"campaign_name\":\"a38Vu\",\"impressions\":\"108569\",\"campaign_id\":\"6074690268470\",\"account_id\":\"10152437784203995\",\"clicks\":\"638\",\"reach\":\"49464\",\"spend\":\"392.02\",\"date_start\":\"2017-09-05\",\"account_name\":\"tbJHb\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6074690268470\"},{\"insights\":{\"data\":[{\"campaign_name\":\"iJpYG\",\"impressions\":\"33258\",\"campaign_id\":\"6074689556670\",\"account_id\":\"10152437784203995\",\"clicks\":\"1318\",\"reach\":\"21275\",\"spend\":\"166\",\"date_start\":\"2017-09-05\",\"account_name\":\"L7wDe\",\"date_stop\":\"2017-10-02\"}],\"paging\":{\"cursors\":{\"before\":\"MAZDZD\",\"after\":\"MAZDZD\"}}},\"id\":\"6074689556670\"},{\"id\":\"6069555245670\"},{\"id\":\"6069217028270\"},{\"id\":\"6068707379270\"},{\"id\":\"6068653241670\"},{\"id\":\"6068652938870\"},{\"id\":\"6068652327670\"},{\"id\":\"6068589341870\"},{\"id\":\"6068588511070\"},{\"id\":\"6068583640870\"},{\"id\":\"6068582923670\"},{\"id\":\"6068471216470\"},{\"id\":\"6067951892070\"},{\"id\":\"6067950376070\"},{\"id\":\"6067819031670\"},{\"id\":\"6067543257670\"},{\"id\":\"6066502493470\"},{\"id\":\"6066502010270\"},{\"id\":\"6065546046870\"},{\"id\":\"6064534431070\"},{\"id\":\"6064532436470\"}],\"paging\":{\"cursors\":{\"before\":\"NjA3Nzk4MDc1NzA3MAZDZD\",\"after\":\"NjA2NDUzMjQzNjQ3MAZDZD\"},\"next\":\"https://graph.facebook.com/v2.9/act_10152437784203995/campaigns?access_token=XXTOKENXX&fields=insights.action_breakdowns%28action_reaction%29.date_preset%28last_28d%29%7Baccount_id%2Caccount_name%2Ccampaign_id%2Ccampaign_name%2Cimpressions%2Cclicks%2Cspend%2Creach%7D+&since&until&limit=25&after=NjA2NDUzMjQzNjQ3MAZDZD\"}}}"}
)
})

================================================
File: /test/keboola/snapshots/campaignsinsights/test_campaignsinsights.clj
================================================
(ns keboola.snapshots.campaignsinsights.test-campaignsinsights
  (:require [keboola.snapshots.campaignsinsights.apicalls :as apicalls]
            [clojure.test :as t :refer :all]
            [keboola.snapshots.outdirs-check :as outdirs-check]
            [keboola.test-utils.core :as test-utils]
            [keboola.facebook.extractor.sync-actions :refer [disable-log-token]]
            [keboola.facebook.extractor.output :refer [reset-columns-map]]
            [keboola.facebook.extractor.core :refer [prepare-and-run]]
            )
  (:use clj-http.fake))

(deftest campaignsinsights-test
  (let [tmp-dir (.getPath (test-utils/mk-tmp-dir! "campaignsinsights"))]
    (disable-log-token)
    (println "testing dir:" tmp-dir)
    (println "expected dir:" "test/keboola/snapshots/campaignsinsights")
    (test-utils/copy-config-tmp "test/keboola/snapshots/campaignsinsights" tmp-dir)
    (with-global-fake-routes-in-isolation
      apicalls/recorded
      (reset-columns-map)
      (prepare-and-run tmp-dir)
      (outdirs-check/is-equal "test/keboola/snapshots/campaignsinsights" tmp-dir)
      )))

================================================
File: /test/keboola/snapshots/campaignsinsights/out/tables/campaigns_insights_reaction_insights.manifest
================================================
{"columns":["ex-account-id","fb-graph-node","parent-id","ads_action_name","action_type","action_reaction","value","account_id","account_name","campaign_id","campaign_name","date_start","date_stop"],"incremental":true,"primary_key":["parent_id","account_id","campaign_id","date_start","date_stop","ads_action_name","action_type","action_reaction"]}

================================================
File: /test/keboola/snapshots/campaignsinsights/out/tables/campaigns_insights.manifest
================================================
{"columns":["ex-account-id","fb-graph-node","parent-id","account_id","account_name","campaign_id","campaign_name","clicks","date_start","date_stop","impressions","reach","spend"],"incremental":true,"primary_key":["parent_id","account_id","campaign_id","date_start","date_stop"]}

================================================
File: /test/keboola/snapshots/campaignsinsights/out/tables/accounts
================================================
account_id,name,business_name,currency,id
10152562141153995,blabla,,EUR,act_10152562141153995


================================================
File: /test/keboola/snapshots/campaignsinsights/out/tables/campaigns_insights_type_insights.manifest
================================================
{"columns":["ex-account-id","fb-graph-node","parent-id","ads_action_name","action_type","value","account_id","account_name","campaign_id","campaign_name","date_start","date_stop"],"incremental":true,"primary_key":["parent_id","account_id","campaign_id","date_start","date_stop","ads_action_name","action_type"]}

================================================
File: /test/keboola/snapshots/campaignsinsights/out/tables/campaigns_insights_reaction_insights/1507031560441
================================================
"act_10152437784203995","page_campaigns_insights","6074690268470","actions","post_engagement","","7497","10152437784203995","QmZ4l","6074690268470","FYqnH","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6074690268470","actions","page_engagement","","7497","10152437784203995","QmZ4l","6074690268470","FYqnH","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6074690268470","actions","post_reaction","like","3","10152437784203995","QmZ4l","6074690268470","FYqnH","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6074690268470","actions","video_view","","7469","10152437784203995","QmZ4l","6074690268470","FYqnH","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6074690268470","actions","post","","2","10152437784203995","QmZ4l","6074690268470","FYqnH","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6074690268470","actions","link_click","","22","10152437784203995","QmZ4l","6074690268470","FYqnH","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6074690268470","actions","comment","","1","10152437784203995","QmZ4l","6074690268470","FYqnH","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","post_engagement","","2456","10152437784203995","JU1Ti","6077413250870","BqdkT","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","page_engagement","","2458","10152437784203995","JU1Ti","6077413250870","BqdkT","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","post_reaction","like","24","10152437784203995","JU1Ti","6077413250870","BqdkT","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","video_view","","2297","10152437784203995","JU1Ti","6077413250870","BqdkT","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","post","","1","10152437784203995","JU1Ti","6077413250870","BqdkT","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","link_click","","134","10152437784203995","JU1Ti","6077413250870","BqdkT","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","like","","2","10152437784203995","JU1Ti","6077413250870","BqdkT","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","post_engagement","","2742","10152437784203995","R9B0i","6077413250870","ISlja","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","page_engagement","","2747","10152437784203995","R9B0i","6077413250870","ISlja","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","post_reaction","love","1","10152437784203995","R9B0i","6077413250870","ISlja","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","post_reaction","like","45","10152437784203995","R9B0i","6077413250870","ISlja","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","video_view","","2547","10152437784203995","R9B0i","6077413250870","ISlja","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","link_click","","149","10152437784203995","R9B0i","6077413250870","ISlja","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","like","","5","10152437784203995","R9B0i","6077413250870","ISlja","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","post_engagement","","2176","10152437784203995","qFY9s","6077413250870","PtYyF","2017-09-30","2017-09-30"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","page_engagement","","2177","10152437784203995","qFY9s","6077413250870","PtYyF","2017-09-30","2017-09-30"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","post_reaction","like","36","10152437784203995","qFY9s","6077413250870","PtYyF","2017-09-30","2017-09-30"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","video_view","","2022","10152437784203995","qFY9s","6077413250870","PtYyF","2017-09-30","2017-09-30"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","link_click","","118","10152437784203995","qFY9s","6077413250870","PtYyF","2017-09-30","2017-09-30"
"act_10152437784203995","page_campaigns_insights","6077413250870","actions","like","","1","10152437784203995","qFY9s","6077413250870","PtYyF","2017-09-30","2017-09-30"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","post_engagement","","3448","10152437784203995","RGEZg","6077417491670","b1LRp","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","page_engagement","","3448","10152437784203995","RGEZg","6077417491670","b1LRp","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","video_view","","3352","10152437784203995","RGEZg","6077417491670","b1LRp","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","link_click","","96","10152437784203995","RGEZg","6077417491670","b1LRp","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","post_engagement","","3404","10152437784203995","JSUXq","6077417491670","o1Yj3","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","page_engagement","","3404","10152437784203995","JSUXq","6077417491670","o1Yj3","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","video_view","","3325","10152437784203995","JSUXq","6077417491670","o1Yj3","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","link_click","","79","10152437784203995","JSUXq","6077417491670","o1Yj3","2017-10-01","2017-10-01"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","post_engagement","","3051","10152437784203995","XhW5S","6077417491670","BSnWN","2017-09-30","2017-09-30"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","page_engagement","","3051","10152437784203995","XhW5S","6077417491670","BSnWN","2017-09-30","2017-09-30"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","video_view","","2983","10152437784203995","XhW5S","6077417491670","BSnWN","2017-09-30","2017-09-30"
"act_10152437784203995","page_campaigns_insights","6077417491670","actions","link_click","","68","10152437784203995","XhW5S","6077417491670","BSnWN","2017-09-30","2017-09-30"
"act_10152437784203995","page_campaigns_insights","6077980757070","actions","post_engagement","","291","10152437784203995","SWpLR","6077980757070","4RDvi","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077980757070","actions","page_engagement","","300","10152437784203995","SWpLR","6077980757070","4RDvi","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077980757070","actions","post_reaction","angry","1","10152437784203995","SWpLR","6077980757070","4RDvi","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077980757070","actions","post_reaction","love","6","10152437784203995","SWpLR","6077980757070","4RDvi","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077980757070","actions","post_reaction","like","51","10152437784203995","SWpLR","6077980757070","4RDvi","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077980757070","actions","post","","6","10152437784203995","SWpLR","6077980757070","4RDvi","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077980757070","actions","link_click","","215","10152437784203995","SWpLR","6077980757070","4RDvi","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077980757070","actions","like","","9","10152437784203995","SWpLR","6077980757070","4RDvi","2017-10-02","2017-10-02"
"act_10152437784203995","page_campaigns_insights","6077980757070","actions","comment","","12","10152437784203995","SWpLR","6077980757070","4RDvi","2017-10-02","2017-10-02"


================================================
File: /test/keboola/snapshots/campaignsinsights/out/tables/campaigns_insights_type_insights/1507031550083
================================================
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_engagement","197","10152437784203995","637mb","6064431745270","PRjKz","2017-04-06","2017-04-06"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","page_engagement","201","10152437784203995","637mb","6064431745270","PRjKz","2017-04-06","2017-04-06"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_reaction","1","10152437784203995","637mb","6064431745270","PRjKz","2017-04-06","2017-04-06"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post","1","10152437784203995","637mb","6064431745270","PRjKz","2017-04-06","2017-04-06"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","link_click","195","10152437784203995","637mb","6064431745270","PRjKz","2017-04-06","2017-04-06"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","like","4","10152437784203995","637mb","6064431745270","PRjKz","2017-04-06","2017-04-06"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_engagement","202","10152437784203995","pZt8D","6064431745270","BT131","2017-04-05","2017-04-05"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","page_engagement","204","10152437784203995","pZt8D","6064431745270","BT131","2017-04-05","2017-04-05"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_reaction","4","10152437784203995","pZt8D","6064431745270","BT131","2017-04-05","2017-04-05"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","link_click","196","10152437784203995","pZt8D","6064431745270","BT131","2017-04-05","2017-04-05"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","like","2","10152437784203995","pZt8D","6064431745270","BT131","2017-04-05","2017-04-05"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","comment","2","10152437784203995","pZt8D","6064431745270","BT131","2017-04-05","2017-04-05"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_engagement","217","10152437784203995","kNwYF","6064431745270","dpZwa","2017-04-04","2017-04-04"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","page_engagement","218","10152437784203995","kNwYF","6064431745270","dpZwa","2017-04-04","2017-04-04"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_reaction","4","10152437784203995","kNwYF","6064431745270","dpZwa","2017-04-04","2017-04-04"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","link_click","213","10152437784203995","kNwYF","6064431745270","dpZwa","2017-04-04","2017-04-04"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","like","1","10152437784203995","kNwYF","6064431745270","dpZwa","2017-04-04","2017-04-04"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_engagement","223","10152437784203995","ygjum","6064431745270","nESev","2017-04-03","2017-04-03"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","page_engagement","223","10152437784203995","ygjum","6064431745270","nESev","2017-04-03","2017-04-03"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_reaction","7","10152437784203995","ygjum","6064431745270","nESev","2017-04-03","2017-04-03"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post","1","10152437784203995","ygjum","6064431745270","nESev","2017-04-03","2017-04-03"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","link_click","213","10152437784203995","ygjum","6064431745270","nESev","2017-04-03","2017-04-03"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","comment","2","10152437784203995","ygjum","6064431745270","nESev","2017-04-03","2017-04-03"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_engagement","219","10152437784203995","FKSUj","6064431745270","bV0Vb","2017-04-02","2017-04-02"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","page_engagement","221","10152437784203995","FKSUj","6064431745270","bV0Vb","2017-04-02","2017-04-02"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_reaction","2","10152437784203995","FKSUj","6064431745270","bV0Vb","2017-04-02","2017-04-02"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","link_click","216","10152437784203995","FKSUj","6064431745270","bV0Vb","2017-04-02","2017-04-02"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","like","2","10152437784203995","FKSUj","6064431745270","bV0Vb","2017-04-02","2017-04-02"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","comment","1","10152437784203995","FKSUj","6064431745270","bV0Vb","2017-04-02","2017-04-02"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_engagement","203","10152437784203995","WPSWt","6064431745270","KDE2f","2017-04-01","2017-04-01"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","page_engagement","208","10152437784203995","WPSWt","6064431745270","KDE2f","2017-04-01","2017-04-01"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","post_reaction","1","10152437784203995","WPSWt","6064431745270","KDE2f","2017-04-01","2017-04-01"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","link_click","202","10152437784203995","WPSWt","6064431745270","KDE2f","2017-04-01","2017-04-01"
"act_10152437784203995","page_campaigns_insights","6064431745270","actions","like","5","10152437784203995","WPSWt","6064431745270","KDE2f","2017-04-01","2017-04-01"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion","10","10152562141153995","TLkaO","6064029033691","fNBib","2017-04-06","2017-04-06"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_engagement","264","10152562141153995","TLkaO","6064029033691","fNBib","2017-04-06","2017-04-06"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","page_engagement","265","10152562141153995","TLkaO","6064029033691","fNBib","2017-04-06","2017-04-06"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_reaction","12","10152562141153995","TLkaO","6064029033691","fNBib","2017-04-06","2017-04-06"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.registration","8","10152562141153995","TLkaO","6064029033691","fNBib","2017-04-06","2017-04-06"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.fb_pixel_lead","1","10152562141153995","TLkaO","6064029033691","fNBib","2017-04-06","2017-04-06"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","link_click","252","10152562141153995","TLkaO","6064029033691","fNBib","2017-04-06","2017-04-06"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","like","1","10152562141153995","TLkaO","6064029033691","fNBib","2017-04-06","2017-04-06"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.custom.270601453373563","1","10152562141153995","TLkaO","6064029033691","fNBib","2017-04-06","2017-04-06"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion","17","10152562141153995","SgcUJ","6064029033691","SwWMC","2017-04-05","2017-04-05"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_engagement","242","10152562141153995","SgcUJ","6064029033691","SwWMC","2017-04-05","2017-04-05"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","page_engagement","243","10152562141153995","SgcUJ","6064029033691","SwWMC","2017-04-05","2017-04-05"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_reaction","8","10152562141153995","SgcUJ","6064029033691","SwWMC","2017-04-05","2017-04-05"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post","2","10152562141153995","SgcUJ","6064029033691","SwWMC","2017-04-05","2017-04-05"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.registration","13","10152562141153995","SgcUJ","6064029033691","SwWMC","2017-04-05","2017-04-05"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.fb_pixel_lead","2","10152562141153995","SgcUJ","6064029033691","SwWMC","2017-04-05","2017-04-05"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","link_click","232","10152562141153995","SgcUJ","6064029033691","SwWMC","2017-04-05","2017-04-05"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","like","1","10152562141153995","SgcUJ","6064029033691","SwWMC","2017-04-05","2017-04-05"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.custom.270601453373563","2","10152562141153995","SgcUJ","6064029033691","SwWMC","2017-04-05","2017-04-05"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion","23","10152562141153995","O3Qbr","6064029033691","dXLBS","2017-04-04","2017-04-04"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_engagement","233","10152562141153995","O3Qbr","6064029033691","dXLBS","2017-04-04","2017-04-04"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","page_engagement","239","10152562141153995","O3Qbr","6064029033691","dXLBS","2017-04-04","2017-04-04"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_reaction","6","10152562141153995","O3Qbr","6064029033691","dXLBS","2017-04-04","2017-04-04"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post","2","10152562141153995","O3Qbr","6064029033691","dXLBS","2017-04-04","2017-04-04"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.registration","9","10152562141153995","O3Qbr","6064029033691","dXLBS","2017-04-04","2017-04-04"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.fb_pixel_lead","7","10152562141153995","O3Qbr","6064029033691","dXLBS","2017-04-04","2017-04-04"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","link_click","225","10152562141153995","O3Qbr","6064029033691","dXLBS","2017-04-04","2017-04-04"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","like","6","10152562141153995","O3Qbr","6064029033691","dXLBS","2017-04-04","2017-04-04"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.custom.270601453373563","7","10152562141153995","O3Qbr","6064029033691","dXLBS","2017-04-04","2017-04-04"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion","16","10152562141153995","e1XHt","6064029033691","BedBO","2017-04-03","2017-04-03"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_engagement","222","10152562141153995","e1XHt","6064029033691","BedBO","2017-04-03","2017-04-03"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","page_engagement","225","10152562141153995","e1XHt","6064029033691","BedBO","2017-04-03","2017-04-03"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_reaction","8","10152562141153995","e1XHt","6064029033691","BedBO","2017-04-03","2017-04-03"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.registration","6","10152562141153995","e1XHt","6064029033691","BedBO","2017-04-03","2017-04-03"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.fb_pixel_lead","5","10152562141153995","e1XHt","6064029033691","BedBO","2017-04-03","2017-04-03"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","link_click","214","10152562141153995","e1XHt","6064029033691","BedBO","2017-04-03","2017-04-03"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","like","3","10152562141153995","e1XHt","6064029033691","BedBO","2017-04-03","2017-04-03"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.custom.270601453373563","5","10152562141153995","e1XHt","6064029033691","BedBO","2017-04-03","2017-04-03"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion","18","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_engagement","331","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","page_engagement","340","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_reaction","22","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post","3","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.registration","4","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.fb_pixel_lead","7","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","link_click","304","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","like","9","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.custom.270601453373563","7","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","comment","2","10152562141153995","juMEZ","6064029033691","TatD1","2017-04-02","2017-04-02"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion","5","10152562141153995","S6ri9","6064029033691","zN5e9","2017-04-01","2017-04-01"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_engagement","177","10152562141153995","S6ri9","6064029033691","zN5e9","2017-04-01","2017-04-01"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","page_engagement","180","10152562141153995","S6ri9","6064029033691","zN5e9","2017-04-01","2017-04-01"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","post_reaction","14","10152562141153995","S6ri9","6064029033691","zN5e9","2017-04-01","2017-04-01"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","offsite_conversion.registration","5","10152562141153995","S6ri9","6064029033691","zN5e9","2017-04-01","2017-04-01"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","link_click","163","10152562141153995","S6ri9","6064029033691","zN5e9","2017-04-01","2017-04-01"
"act_10152562141153995","page_campaigns_insights","6064029033691","actions","like","3","10152562141153995","S6ri9","6064029033691","zN5e9","2017-04-01","2017-04-01"


================================================
File: /test/keboola/snapshots/campaignsinsights/out/tables/campaigns_insights/1507031538125
================================================
"act_10152437784203995","page_campaigns_insights","6074689556670","10152437784203995","L7wDe","6074689556670","iJpYG","1318","2017-09-05","2017-10-02","33258","21275","166"
"act_10152437784203995","page_campaigns_insights","6074690268470","10152437784203995","tbJHb","6074690268470","a38Vu","638","2017-09-05","2017-10-02","108569","49464","392.02"
"act_10152437784203995","page_campaigns_insights","6077413250870","10152437784203995","ypee3","6077413250870","6iuz6","2281","2017-09-05","2017-10-02","130444","63973","683.53"
"act_10152437784203995","page_campaigns_insights","6077417491670","10152437784203995","4IYqn","6077417491670","2CEbM","905","2017-09-05","2017-10-02","315985","116782","496.38"
"act_10152437784203995","page_campaigns_insights","6077980757070","10152437784203995","W7Yd9","6077980757070","6IBcd","549","2017-09-05","2017-10-02","11893","11743","30.9"


================================================
File: /test/keboola/snapshots/campaignsinsights/config.json
================================================
{
  "storage" : { },
  "parameters" : {
    "accounts" : {
      "act_10152562141153995" : {
        "account_id" : "10152562141153995",
        "business_name" : "",
        "currency" : "EUR",
        "id" : "act_10152562141153995",
        "name" : "blabla"
      }
    },
    "api-version" : "v2.9",
    "queries" : [ {
      "name" : "campaigns",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "campaigns",
        "fields" : "insights.action_breakdowns(action_reaction).date_preset(last_28d){account_id,account_name,campaign_id,campaign_name,impressions,clicks,spend,reach} ",
        "ids" : "act_10152562141153995,act_10152437784203995"
      }
    }, {
      "name" : "campaigns_insights_type",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "campaigns",
        "fields" : "insights.time_range({'since':'2017-04-01','until':'2017-04-06'}).action_breakdowns(action_type).time_increment(1){account_id,account_name,campaign_id,campaign_name,actions}",
        "ids" : "act_10152562141153995,act_10152437784203995"
      }
    }, {
      "name" : "campaigns_insights_reaction",
      "type" : "nested-query",
      "disabled" : false,
      "query" : {
        "path" : "campaigns",
        "fields" : "insights.action_breakdowns(action_reaction).date_preset(last_3d).time_increment(1){account_id,account_name,campaign_id,campaign_name,actions}",
        "ids" : "act_10152562141153995,act_10152437784203995"
      }
    } ]
  },
  "authorization" : {
    "oauth_api" : {
      "id" : "keboola.ex-facebook-ads",
      "credentials" : {
        "id" : "main",
        "authorizedFor" : "Myself",
        "creator" : {
          "id" : "1234",
          "description" : "me@keboola.com"
        },
        "created" : "2016-01-31 00:13:30",
        "oauthVersion" : "facebook",
        "appKey" : "xxx",
        "#data" : "{\"token\":\"XXTOKENXX\"}",
        "#appSecret" : "KBC::Encrypted==ENCODEDSTRING=="
      }
    }
  }
}

================================================
File: /test/keboola/test_utils/core.clj
================================================
(ns keboola.test-utils.core
  (:require [clojure.string :as string]
            [clojure.spec.test.alpha :as stest]
            [clojure.java.io :as io]
            [clojure.test :refer [is]]))

(defn test-and-check
  ([spec-test] (test-and-check spec-test 1000))
  ([spec-test num-tests]
   (let [result (stest/summarize-results
                 (stest/check spec-test {:clojure.spec.test.check/opts {:num-tests num-tests}}))]
     (= (:total result) (:check-passed result)))))

(defn delete-recursively
  "Delete dir recursively"
  [fname]
  (let [func (fn [func f]
               (when (.isDirectory f)
                 (doseq [f2 (.listFiles f)]
                   (func func f2)))
               (clojure.java.io/delete-file f))]
    (func func (clojure.java.io/file fname))))

(defmacro with-err-str
  "Evaluates exprs in a context in which *err* is bound to a fresh
  StringWriter.  Returns the string created by any nested printing
  calls."
  {:added "1.0"}
  [& body]
  `(let [s# (new java.io.StringWriter)]
     (binding [*err* s#]
       ~@body
       (str s#))))

(defn prints-error? [error-fn & params]
  (is (= (clojure.string/trim (with-err-str (apply error-fn params))) (clojure.string/join " " params))))


(defn prints-msg? [print-fn & params]
  (is (= (clojure.string/trim (with-out-str (apply print-fn params))) (clojure.string/join " " params))))

(defn mk-path [& args]
  (string/join "/" args))

(defn copy-config-tmp [dir-path tmp-path]
  (let [source-path (str dir-path "/config.json")
        dest-path (str tmp-path "/config.json")]
      (io/copy (io/file source-path) (io/file dest-path))))

(defn mk-tmp-dir!
  "Creates a unique temporary directory on the filesystem. Typically in /tmp on
  *NIX systems. Returns a File object pointing to the new directory. Raises an
  exception if the directory couldn't be created after 100 tries."
  [prefix]
  (let [base-dir (java.io.File. (System/getProperty "java.io.tmpdir"))
        base-name (str prefix (java.util.Date.) "-" (long (rand 100)) "-")
        tmp-base (mk-path base-dir base-name)
        max-attempts 100]
    (loop [num-attempts 1]
      (if (= num-attempts max-attempts)
        (throw (Exception. (str "Failed to create temporary directory after " max-attempts " attempts.")))
        (let [tmp-dir-name (str tmp-base num-attempts)
              tmp-dir (java.io.File. tmp-dir-name)]
          (if (.mkdir tmp-dir)
            tmp-dir
            (recur (inc num-attempts))))))))


(defn
 ^{ :doc "Deletes the given directory even if it contains files or subdirectories. This function will attempt to delete
all of the files and directories in the given directory first, before deleting the directory. If the directory cannot be
deleted, this function aborts and returns nil. If the delete finishes successfully, then this function returns true."}
  recursive-delete [directory]
  (if (.isDirectory directory)
    (when (reduce #(and %1 (recursive-delete %2)) true (.listFiles directory))
      (.delete directory))
    (.delete directory)))


================================================
File: /test/keboola/http/client_test.clj
================================================
(ns keboola.http.client-test
  (:require [keboola.http.client :as sut]
            [clojure.test :refer :all]))

(deftest test-retry-handler
  (is (sut/retry-handler nil 1 nil))
  (is (not (sut/retry-handler nil 4 nil))))


================================================
File: /test/keboola/docker/config_test.clj
================================================
(ns keboola.docker.config-test
  (:require [keboola.docker.config :as sut]
            [clojure.test :as t :refer :all]
            [clojure.string :refer [trim ends-with? starts-with?]]
            [keboola.test-utils.core :as test-utils]))


(def ^:dynamic *tmpdir* "")

(defn setup-tmpdir [f]
  (binding [*tmpdir* (test-utils/mk-tmp-dir! "exfbtest")]
    (f)
    (test-utils/recursive-delete *tmpdir*)))

(defn trimmed? [str-val]
  (= (trim str-val) str-val))

(deftest test-check-path
  (are [test-value] (and (ends-with? test-value "/") (-> test-value (ends-with? "//") not ) (trimmed? test-value))
    (sut/check-path "asd")
    (sut/check-path "asd/")
    (sut/check-path " aa/")
    (sut/check-path " aa")))

(deftest test-out-dir-path
  (let [path (sut/out-dir-path (test-utils/mk-path *tmpdir* "."))]
    (is (and
         (trimmed? path)
         (ends-with? path "out/tables/")
         (.isDirectory (java.io.File. path))
         (.exists (java.io.File. path))))))

(deftest test-parameters
  (is (thrown? java.io.FileNotFoundException (sut/parameters))))

(deftest test-get-fb-token
  (is (empty? (sut/get-fb-token {})))
  (is (= "access_token" (sut/get-fb-token {:access_token "access_token" :token "token"})))
  (is (= "access_token" (sut/get-fb-token {:access_token "access_token"})))
  (is (= "token" (sut/get-fb-token {:token "token"}))))

(use-fixtures :once setup-tmpdir)


================================================
File: /test/keboola/docker/runtime_test.clj
================================================
(ns keboola.docker.runtime-test
  (:require [keboola.docker.runtime :as sut]
            [clojure.test :as t :refer [deftest]]
            [keboola.test-utils.core :refer [prints-error? prints-msg?]]))
            

(deftest test-log-error
  (prints-error? sut/log-error "asd" "fff")
  (prints-error? sut/log-error "asd")
  (prints-error? sut/log-error ""))
  


(deftest test-log-strings
  (prints-msg? sut/log-strings "asd" "asd")
  (prints-msg? sut/log-strings "asf")
  (prints-msg? sut/log-strings "")
  (prints-msg? sut/log-strings))
  


================================================
File: /test/keboola/facebook/api/request_test.clj
================================================
(ns keboola.facebook.api.request-test
  (:require [keboola.facebook.api.request :as sut]
            [keboola.test-utils.core :refer [test-and-check]]
            [clojure.spec.alpha :as s]
            [slingshot.slingshot :refer [try+ throw+]]
            [clojure.test :as t :refer :all])
  (:use clj-http.fake))

(deftest test-make-url
  (is (test-and-check `sut/make-url 10)))

(deftest test-update-url-with-limit
  (let [testfn sut/update-url-with-limit
        stemurl "https://graphapi.com"
        params "?token=aa&ff=ss"
        paramswithlimit (str params "&limit=1&ccc=dd")
        multilimitparams (str paramswithlimit "&limit=2")]
    (is (= (testfn stemurl "25") (str stemurl "?limit=25")))
    (is (= (testfn stemurl 25) (str stemurl "?limit=25")))
    (is (= (testfn (str stemurl params) "25") (str stemurl params "&limit=25")))
    (is (= (testfn (str stemurl paramswithlimit) "25") (str stemurl params "&limit=25&ccc=dd")))
    (is (= (testfn (str stemurl multilimitparams) "25") (str stemurl paramswithlimit "&limit=25")))))

(def reduce-data-response
  {:request-time 21463, :repeatable? false, :protocol-version {:name "HTTP", :major 1, :minor 1}, :streaming? true, :chunked? false, :reason-phrase "Internal Server Error", :headers {}, :orig-content-encoding nil, :status 500, :length 108, :body "{\"error\":{\"code\":1,\"message\":\"Please reduce the amount of data you're asking for, then retry your request\"}}"})

(def error-400-response
  {:request-time 21463, :repeatable? false, :protocol-version {:name "HTTP", :major 1, :minor 1}, :streaming? true, :chunked? false, :reason-phrase "Internal Server Error", :headers {}, :orig-content-encoding nil, :status 400, :length 108, :body "{\"error\":{\"code\":1,\"message\":\"There cannot be more than 93 days (8035200 s) between since and until\"}}"})

(def cannot-include-error
  {:request-time 21463, :repeatable? false, :protocol-version {:name "HTTP", :major 1, :minor 1}, :streaming? true, :chunked? false, :reason-phrase "Internal Server Error", :headers {}, :orig-content-encoding nil, :status 400, :length 108, :body "{\"error\":{\"code\":1,\"message\":\"(#100) Cannot include account_id, account_name, ad_id, ad_name, adset_id, adset_name, campaign_id, campaign_name, impressions, clicks, spend, reach in summary param because they weren't there while creating the report run. All available values are:\"}}"})


(def unknown-error-response
  {:request-time 30136, :repeatable? false, :protocol-version {:name "HTTP", :major 1, :minor 1}, :streaming? true, :chunked? false, :reason-phrase "Internal Server Error", :headers {}, :orig-content-encoding nil, :status 500, :length 77, :body "{\"error\":{\"code\":1,\"message\":\"An unknown error occurred\",\"error_subcode\":99}}", :trace-redirects ["https://graph.facebook.com/v2.8/adsblablabla"]})

(def something-went-wrong-error-response
  {:request-time 30136, :repeatable? false, :protocol-version {:name "HTTP", :major 1, :minor 1}, :streaming? true, :chunked? false, :reason-phrase "Internal Server Error", :headers {}, :orig-content-encoding nil, :status 500, :length 77, :body "<html lang=\"en\" id=\"facebook\">\n  <head>\n    <title>Facebook | Error</title>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"cache-control\" content=\"no-cache\">\n    <meta http-equiv=\"cache-control\" content=\"no-store\">\n    <meta http-equiv=\"cache-control\" content=\"max-age=0\">\n    <meta http-equiv=\"expires\" content=\"-1\">\n    <meta http-equiv=\"pragma\" content=\"no-cache\">\n    <meta name=\"robots\" content=\"noindex,nofollow\">\n    <style>\n      html, body {\n        color: #141823;\n        background-color: #e9eaed;\n        font-family: Helvetica, Lucida Grande, Arial,\n                     Tahoma, Verdana, sans-serif;\n        margin: 0;\n        padding: 0;\n        text-align: center;\n      }\n\n      #header {\n        height: 30px;\n        padding-bottom: 10px;\n        padding-top: 10px;\n        text-align: center;\n      }\n\n      #icon {\n        width: 30px;\n      }\n\n      h1 {\n        font-size: 18px;\n      }\n\n      p {\n        font-size: 13px;\n      }\n\n      #footer {\n        border-top: 1px solid #ddd;\n        color: #9197a3;\n        font-size: 12px;\n        padding: 5px 8px 6px 0;\n      }\n    </style>\n  </head>\n  <body>\n    <div id=\"header\">\n      <a href=\"//www.facebook.com/\">\n        <img id=\"icon\" src=\"//static.facebook.com/images/logos/facebook_2x.png\" />\n      </a>\n    </div>\n    <div id=\"core\">\n      <h1 id=\"sorry\">Sorry, something went wrong.</h1>\n      <p id=\"promise\">\n        We're working on it and we'll get it fixed as soon as we can.\n      </p>\n      <p id=\"back-link\">\n        <a id=\"back\" href=\"//www.facebook.com/\">Go Back</a>\n      </p>\n      <div id=\"footer\">\n        Facebook\n        <span id=\"copyright\">\n          &copy; 2018\n        </span>\n        <span id=\"help-link\">\n          &#183;\n          <a id=\"help\" href=\"//www.facebook.com/help/\">Help Center</a>\n        </span>\n      </div>\n    </div>\n    <script>\n      document.getElementById('back').onclick = function() {\n        if (history.length > 1) {\n          history.back();\n          return false;\n        }\n      };\n\n      // Adjust the display based on the window size\n      if (window.innerHeight < 80 || window.innerWidth < 80) {\n        // Blank if window is too small\n        document.body.style.display = 'none';\n      };\n      if (window.innerWidth < 200 || window.innerHeight < 150) {\n        document.getElementById('back-link').style.display = 'none';\n        document.getElementById('help-link').style.display = 'none';\n      };\n      if (window.innerWidth < 200) {\n        document.getElementById('sorry').style.fontSize = '16px';\n      };\n      if (window.innerWidth < 150) {\n        document.getElementById('promise').style.display = 'none';\n      };\n      if (window.innerHeight < 150) {\n        document.getElementById('sorry').style.margin = '4px 0 0 0';\n        document.getElementById('sorry').style.fontSize = '14px';\n        document.getElementById('promise').style.display = 'none';\n      };\n    </script>\n  </body>\n</html>"})

(def unexpected-error-response
  {:request-time 30136, :repeatable? false, :protocol-version {:name "HTTP", :major 1, :minor 1}, :streaming? true, :chunked? false, :reason-phrase "Internal Server Error", :headers {}, :orig-content-encoding nil, :status 500, :length 77, :body "{\"error\":{\"code\":2,\"message\":\"An unexpected error has occurred. Please retry your request later.\",\"is_transient\":true}}", :trace-redirects ["https://graph.facebook.com/v2.8/adsblablabla"]})

(def success-response
  {:request-time 30, :repeatable? false, :protocol-version {:name "HTTP", :major 1, :minor 1}, :streaming? true, :chunked? false, :headers {}, :orig-content-encoding nil, :status 200, :length 77, :body "{}", :trace-redirects ["https://graph.facebook.com/v2.8/adsblablabla"]})

(def media-posted-before-error-response
  {:request-time 30, :repeatable? false, :protocol-version {:name "HTTP", :major 1, :minor 1}, :streaming? true, :chunked? false, :headers {}, :orig-content-encoding nil, :status 400, :length 77, :body "{\"error\":{\"message\":\"Invalid parameter\",\"type\":\"OAuthException\",\"code\":100,\"error_data\":{\"blame_field_specs\":[[\"\"]]},\"error_subcode\":2108006,\"is_transient\":false,\"error_user_title\":\"Media Posted Before Business Account Conversion\",\"error_user_msg\":\"The media was posted before the most recent time that the user's account was converted to a business account from a personal account.\",\"fbtrace_id\":\"BYNS8WYLLD3\"}}"})

(def error-count (atom 0))
(defn set-error-count [new-count] (reset! error-count new-count))
(defn dec-error-count [] (set-error-count (dec @error-count)))

(def apimocks-templates
  {"https://graph.facebook.com/v2.8/always_media_error?token=asd"
   (fn [req]
     media-posted-before-error-response)
   "https://graph.facebook.com/v2.8/always_400?token=aa"
   (fn [req]
     error-400-response)
   "https://graph.facebook.com/v2.8/always_200?token=aa"
   (fn [req]
     success-response)
   "https://graph.facebook.com/v2.8/always_unknown_error_fail?token=aa"
   (fn [req]
     unknown-error-response)
   "https://graph.facebook.com/v2.8/fail_on_error_count_and_decrement?token=aa"
   (fn [req]
     (if (= @error-count 0)
       success-response
       (do
         (dec-error-count)
         (rand-nth [unexpected-error-response unknown-error-response reduce-data-response something-went-wrong-error-response cannot-include-error]))))})

(deftest test-retry-on-html-error
  (is  (sut/retry-exception? something-went-wrong-error-response)))

(deftest test-400-response
  (with-global-fake-routes-in-isolation
    apimocks-templates
    (try+
     (sut/make-get-request "https://graph.facebook.com/v2.8/always_400?token=aa")
     (catch Object e
       (is (= (:status e) 400))))))

(defn generate-apimocks [max-limit]
  (into {} (mapcat
            (fn [[k v]]
              (map (fn [i] [(str k "&limit=" i) v]) (range 1 max-limit)))
            apimocks-templates)))

(deftest make-get-request-500-200-test
  (with-global-fake-routes-in-isolation
    (generate-apimocks 101)
    (set-error-count 7)
    (is (= 200 (:status (sut/make-get-request "https://graph.facebook.com/v2.8/fail_on_error_count_and_decrement?token=aa&limit=25"))))))

(deftest make-get-request-200-test
  (with-global-fake-routes-in-isolation
    (generate-apimocks 101)
    (is (= 200 (:status (sut/make-get-request "https://graph.facebook.com/v2.8/always_200?token=aa&limit=20"))))))

(deftest test-media-posted-before-error-response
  (with-global-fake-routes-in-isolation
    apimocks-templates
    (try+
     (let [response (sut/make-get-request "https://graph.facebook.com/v2.8/always_media_error?token=asd")]
       (is (contains? response :body))
       (is (contains? (:body response) :data))
       (is (contains? response :status))
       (is (= 200 (:status response)))
       (is (empty? (-> response :body :data)))))))

(deftest test-get-next-page-url
  (let [response {:paging {:previous "https://graph.facebook.com/v16.0/17841401480255572/insights?access_token=XXX&pretty=0&since=1672915646&until=1675248446&metric=total_interactions&metric_type=total_value&period=day"
                           :next "https://graph.facebook.com/v16.0/17841401480255572/insights?access_token=XXX&pretty=0&since=1677581248&until=1679914048&metric=total_interactions&metric_type=total_value&period=day"}}]
    (is (nil? (sut/get-next-page-url response true false)))
    (is (= (sut/get-next-page-url response false false) "https://graph.facebook.com/v16.0/17841401480255572/insights?access_token=XXX&pretty=0&since=1677581248&until=1679914048&metric=total_interactions&metric_type=total_value&period=day")))

  (let [response {:paging {:previous "https://graph.facebook.com/v16.0/17841401480255572/insights?access_token=XXX&pretty=0&since=1672915646&until=1675248446&metric=total_interactions&metric_type=total_value&period=day"}}]
    (is (nil? (sut/get-next-page-url response true false)))
    (is (nil? (sut/get-next-page-url response false false))))

  (let [response {:paging {:next "someurl"} :data []}]
    (is (nil? (sut/get-next-page-url response false true))))

  (let [response {:paging {:next "someurl"} :data [{:some "data"}]}]
    (is (= "someurl" (sut/get-next-page-url response false true))))

  (let [response {:paging {:previous "https://graph.facebook.com/v16.0/17841401480255572/insights?access_token=XXX&pretty=0&metric=total_interactions&metric_type=total_value&period=day"
                           :next "https://graph.facebook.com/v16.0/17841401480255572/insights?access_token=XXX&pretty=0&metric=total_interactions&metric_type=total_value&period=day"}}]
    (is (= (sut/get-next-page-url response false false) "https://graph.facebook.com/v16.0/17841401480255572/insights?access_token=XXX&pretty=0&metric=total_interactions&metric_type=total_value&period=day")))

  (let [response {:paging {:previous "https://graph.facebook.com/v16.0/17841401480255572/insights?access_token=XXX&pretty=0&metric=total_interactions&metric_type=total_value&period=day"
                           :next "https://graph.facebook.com/v16.0/17841401480255572/insights?access_token=XXX&pretty=0&metric=reach&metric_type=total_value&period=day"}}]
    (is (= (sut/get-next-page-url response false false) "https://graph.facebook.com/v16.0/17841401480255572/insights?access_token=XXX&pretty=0&metric=reach&metric_type=total_value&period=day"))))


================================================
File: /test/keboola/facebook/extractor/core_test.clj
================================================
(ns keboola.facebook.extractor.core-test
  (:require [keboola.facebook.extractor.core :as sut]
            [clojure.test :refer :all]
            [slingshot.slingshot :refer [throw+]]))
(deftest test-treat-exception
  (with-redefs [keboola.docker.runtime/app-error (fn [_] "app error")]
    (is (= "app error" (sut/treat #(throw "aaa"))))
    (is (= "app error" (sut/treat #(throw+ "aaa"))))
    (is (= "app error" (sut/treat #(throw+ {:a "aaa"}))))))


================================================
File: /test/keboola/facebook/extractor/query_parser_test.clj
================================================
(ns keboola.facebook.extractor.query-parser-test
  (:require [clojure.test :refer :all]
            [keboola.facebook.extractor.query-parser :as sut])
  (:import [java.time LocalDate]
           [java.time.format DateTimeParseException]
           [java.time.format DateTimeFormatter]))


(deftest test-parse-parameters
  (testing "parse-parameters function"
    ;; Test with multiple parameters
    (is (= (sut/parse-parameters "param1=value1&param2=value2")
           {"param1" "value1", "param2" "value2"}))
    (is (= (sut/parse-parameters "time_ranges=value1&date_preset=last_3d")
           {"time_ranges" "value1", "date_preset" "last_3d"}))
    ;; ;; Test with a single parameter
    (is (= (sut/parse-parameters "param1=value1")
           {"param1" "value1"}))
    ;; ;; Test with empty string
    (is (= {}
           (sut/parse-parameters "")))
    ;; Test with parameter without value
    (is (= (sut/parse-parameters "param1=&param2=value2")
           {"param1" "", "param2" "value2"}))
    ;; Test with duplicate parameter names
    (is (= (sut/parse-parameters "param1=value1&param1=value2")
           {"param1" "value2"}))  ;; The last value should overwrite
    ;; Test with value containing equal sign
    (is (= (sut/parse-parameters "param1=value1=value2")
           {"param1" "value1=value2"}))
    ;; Test with parameter without equal sign
    (is (= (sut/parse-parameters "param1")
           {"param1" nil}))
    ;; Test with parameters having empty keys or values
    (is (= (sut/parse-parameters "=value1&param2=")
           {"" "value1", "param2" ""}))))


(deftest test-parse-time-ranges
  (testing "parse-time-ranges function"
    ;; Test with single time range
    (is (= [{:since "2024-08-10", :until "2024-08-13"}]
           (sut/parse-time-ranges "[{'since':'2024-08-10','until':'2024-08-13'}]")))
    ;; Test with multiple time ranges
    (is (= [{:since "2024-08-10", :until "2024-08-10"}
            {:since "2024-08-11", :until "2024-08-11"}
            {:since "2024-08-12", :until "2024-08-12"}
            {:since "2024-08-13", :until "2024-08-13"}]
           (sut/parse-time-ranges "[{'since':'2024-08-10','until':'2024-08-10'},{'since':'2024-08-11','until':'2024-08-11'},{'since':'2024-08-12','until':'2024-08-12'},{'since':'2024-08-13','until':'2024-08-13'}]")))
    ;; Test with empty string
    (is (= []
           (sut/parse-time-ranges "")))
    ;; Test with invalid JSON (should throw an exception)
    (is (thrown? Exception
                 (sut/parse-time-ranges "[{'since':'2024-08-10','until':'2024-08-13'")))
    ;; Test with nil input (should return nil)
    (is (= []
           (sut/parse-time-ranges nil)))))



(deftest test-date-range
  (testing "date-range function"
    ;; Test with start and end dates being the same
    (is (= [(LocalDate/parse "2024-08-10")]
           (sut/date-range "2024-08-10" "2024-08-10")))
    ;; Test with start date before end date
    (is (= [(LocalDate/parse "2024-08-10")
            (LocalDate/parse "2024-08-11")
            (LocalDate/parse "2024-08-12")]
           (sut/date-range "2024-08-10" "2024-08-13")))
    ;; Test with start date after end date (should return an empty sequence)
    (is (= []
           (sut/date-range "2024-08-13" "2024-08-10")))
    ;; Test with invalid date format (should throw an exception)
    (is (thrown? DateTimeParseException
                 (sut/date-range "2024/08/10" "2024/08-13")))
    ;; Test with nil inputs (should throw an exception)
    (is (thrown? NullPointerException
                 (sut/date-range nil "2024-08-13")))
    (is (thrown? NullPointerException
                 (sut/date-range "2024-08-10" nil)))
    ;; Test with large date range
    (is (= (map #(LocalDate/parse %)
                ["2024-01-01" "2024-01-02" "2024-01-03" "2024-01-04"])
           (sut/date-range "2024-01-01" "2024-01-05")))))

(deftest test-expand-time-ranges
  (testing "expand-time-ranges function"
    ;; Test with a single time range
    (let [input [{:since "2024-08-10" :until "2024-08-13"}]
          expected [{:since "2024-08-10" :until "2024-08-10"}
                    {:since "2024-08-11" :until "2024-08-11"}
                    {:since "2024-08-12" :until "2024-08-12"}]]
      (is (= expected (sut/expand-time-ranges input))))
    ;; Test with multiple time ranges
    (let [input [{:since "2024-08-10" :until "2024-08-11"}
                 {:since "2024-08-13" :until "2024-08-14"}]
          expected [{:since "2024-08-10" :until "2024-08-10"}
                    {:since "2024-08-13" :until "2024-08-13"}]]
      (is (= expected (sut/expand-time-ranges input))))
    ;; Test with start date equal to end date
    (let [input [{:since "2024-08-10" :until "2024-08-10"}]
          expected [{:since "2024-08-10" :until "2024-08-10"}]]
      (is (= expected (sut/expand-time-ranges input))))
    ;; Test with start date after end date (should return empty list)
    (let [input [{:since "2024-08-13" :until "2024-08-10"}]
          expected []]
      (is (= expected (sut/expand-time-ranges input))))
    ;; Test with empty input
    (let [input []
          expected []]
      (is (= expected (sut/expand-time-ranges input))))))


(deftest test-generate-parameters-for-dates
  (testing "generate-parameters-for-dates function with single quotes"
    ;; Test with basic parameters and time-range
    (let [parameters-map {"time_increment" "1"
                          "breakdowns" "product_id"
                          "date_preset" "last_7d"}
          time-range {:since "2024-08-10" :until "2024-08-10"}
          expected "time_increment=1&breakdowns=product_id&time_ranges=[{'since':'2024-08-10','until':'2024-08-10'}]"]
      (is (= expected (sut/generate-parameters-for-dates parameters-map time-range))))

    ;; Test with parameters containing existing time_ranges (should replace time_ranges)
    (let [parameters-map {"time_increment" "1"
                          "breakdowns" "product_id"
                          "time_ranges" "[{'since':'2024-08-10','until':'2024-08-13'}]"}
          time-range {:since "2024-08-10" :until "2024-08-13"}
          expected "time_increment=1&breakdowns=product_id&time_ranges=[{'since':'2024-08-10','until':'2024-08-13'}]"]
      (is (= expected (sut/generate-parameters-for-dates parameters-map time-range))))

    ;; Test with parameters without date_preset
    (let [parameters-map {"time_increment" "1"
                          "breakdowns" "product_id"}
          time-range {:since "2024-08-10" :until "2024-08-10"}
          expected "time_increment=1&breakdowns=product_id&time_ranges=[{'since':'2024-08-10','until':'2024-08-10'}]"]
      (is (= expected (sut/generate-parameters-for-dates parameters-map time-range))))

    ;; Test with parameters containing date_preset and other parameters
    (let [parameters-map {"time_increment" "1"
                          "breakdowns" "product_id"
                          "date_preset" "last_3d"
                          "level" "ad"}
          time-range {:since "2024-08-10" :until "2024-08-12"}
          expected "time_increment=1&breakdowns=product_id&level=ad&time_ranges=[{'since':'2024-08-10','until':'2024-08-12'}]"]
      (is (= expected (sut/generate-parameters-for-dates parameters-map time-range))))

    ;; Test with empty parameters-map
    (let [parameters-map {}
          time-range {:since "2024-08-10" :until "2024-08-10"}
          expected "time_ranges=[{'since':'2024-08-10','until':'2024-08-10'}]"]
      (is (= expected (sut/generate-parameters-for-dates parameters-map time-range))))))


(deftest test-date-preset-to-days
  (testing "date-preset-to-days function"
    ;; Test with known date_preset values
    (is (= 3 (sut/date-preset-to-days "last_3d")))
    (is (= 7 (sut/date-preset-to-days "last_7d")))
    (is (= 30 (sut/date-preset-to-days "last_30d")))
    ;; Test with unknown date_preset value
    (is (= nil (sut/date-preset-to-days "last_5d")))
    ;; Test with nil input
    (is (= nil (sut/date-preset-to-days nil)))
    ;; Test with empty string
    (is (= nil (sut/date-preset-to-days "")))))


(deftest test-get-past-date
  (testing "get-past-date function with reference-date parameter"
    (let [formatter (DateTimeFormatter/ofPattern "yyyy-MM-dd")
          reference-date (LocalDate/of 2024 10 22)] ; Fixed reference date: 2024-10-22
      ;; Test with 0 days ago (should return the reference date)
      (is (= "2024-10-22" (sut/get-past-date 0 reference-date)))
      ;; Test with 1 day ago
      (is (= "2024-10-21" (sut/get-past-date 1 reference-date)))
      ;; Test with 7 days ago
      (is (= "2024-10-15" (sut/get-past-date 7 reference-date)))
      ;; Test with 3 days ago
      (is (= "2024-10-19" (sut/get-past-date 3 reference-date)))
      ;; Test with negative days (future date)
      (is (= "2024-10-25" (sut/get-past-date -3 reference-date)))
      ;; Test with large number of days
      (is (= "2023-10-22" (sut/get-past-date 366 reference-date))))

    (testing "get-past-date function without reference-date (uses LocalDate/now)"
      ;; Since LocalDate/now is used, this test is date-sensitive.
      ;; We'll test that the function returns the same date as calculated here.
      (let [days 5
            formatter (DateTimeFormatter/ofPattern "yyyy-MM-dd")
            expected-date (.format (.minusDays (LocalDate/now) days) formatter)]
        (is (= expected-date (sut/get-past-date days)))))))

================================================
File: /test/keboola/facebook/extractor/choose_token_test.clj
================================================
(ns keboola.facebook.extractor.choose-token-test
  (:require  [clojure.test :refer :all]
             [keboola.facebook.extractor.query :refer [choose-token]])
  (:use clj-http.fake))

(def accounts-response {:request-time 261, :repeatable? false, :protocol-version {:name "HTTP", :major 1, :minor 1}, :streaming? true, :chunked? false, :reason-phrase "OK", :headers {"Content-Type" "text/javascript; charset=UTF-8", "Access-Control-Allow-Origin" "*", "X-FB-Debug" "fXQt79Gaetuj2SncCSgnNZCuKuyJMtzr2dHtTs1lGouuGx3Jpm777iP4+pYPIbRkbb0jGfIMQftbtMN3e/mBBw==", "facebook-api-version" "v3.1", "Strict-Transport-Security" "max-age=15552000; preload", "Connection" "close", "Pragma" "no-cache", "Expires" "Sat, 01 Jan 2000 00:00:00 GMT", "x-fb-rev" "4368033", "ETag" "\"2ee48088b20f04459ee2c5ef75f40d8138ef6ecf\"", "x-fb-trace-id" "AxSI8JAYFqD", "Date" "Mon, 01 Oct 2018 09:34:22 GMT", "Vary" "Accept-Encoding", "Cache-Control" "private, no-cache, no-store, must-revalidate", "x-app-usage" "{\"call_count\":0,\"total_cputime\":0,\"total_time\":0}"}, :orig-content-encoding nil, :status 200, :body "{\"data\":[{\"access_token\":\"pagetoken1\",\"category\":\"Community\",\"category_list\":[{\"id\":\"2612\",\"name\":\"blabla\"}],\"name\":\"page1\",\"id\":\"1017786331693295\",\"tasks\":[\"ANALYZE\",\"ADVERTISE\",\"MODERATE\",\"CREATE_CONTENT\",\"MANAGE\"]},{\"access_token\":\"pagetoken2\",\"category\":\"Community\",\"category_list\":[{\"id\":\"2612\",\"name\":\"4h0CG\"}],\"name\":\"0xk3z\",\"id\":\"1960059394258217\",\"tasks\":[\"ANALYZE\",\"ADVERTISE\",\"MODERATE\",\"CREATE_CONTENT\",\"MANAGE\"]},{\"access_token\":\"pagetoken3\",\"category\":\"Business Consultant\",\"category_list\":[{\"id\":\"179672275401610\",\"name\":\"n2DCf\"},{\"id\":\"2211\",\"name\":\"boKMN\"}],\"name\":\"PInBh\",\"id\":\"177057932317550\",\"tasks\":[\"ANALYZE\"]}],\"paging\":{\"cursors\":{\"before\":\"MTAxNzc4NjMzMTY5MzI5NQZDZD\",\"after\":\"MTc3MDU3OTMyMzE3NTUw\"}}}"})


(def usertoken "XXXTOKEN")

(def api-mock
  {
   "https://graph.facebook.com/v3.1/me/accounts?access_token=XXXTOKEN"
   (fn [req]
     accounts-response)})


(deftest test-choose-token
  (with-global-fake-routes-in-isolation
    api-mock
    (is (= usertoken (choose-token "foo" usertoken "v3.1")))
    (is (= "pagetoken1" (choose-token "1017786331693295" usertoken "v3.1")))))

(deftest test-choose-token-fallback
  (is (= "othertoken" (choose-token "1017786331693295" "othertoken" "v3.1"))))


================================================
File: /test/keboola/facebook/extractor/query_test.clj
================================================
(ns keboola.facebook.extractor.query-test
  (:require [keboola.facebook.extractor.query :as sut]
            [keboola.facebook.extractor.query-parser :as query-parser]
            [keboola.test-utils.core :as test-utils]
            [clojure.java.io :as io]
            [keboola.facebook.api.request-test :refer [media-posted-before-error-response]]
            [clojure.test :refer :all])
  (:use clj-http.fake)
  (:import [java.time LocalDate]
           [java.time.format DateTimeFormatter]))

(def ^:dynamic *tmpdir* "")

(defn setup-tmpdir [f]
  (binding [*tmpdir* (test-utils/mk-tmp-dir! "exfbtestquery")]
    (f)
    (test-utils/recursive-delete *tmpdir*)))

(deftest test-query-contains-insights?
  (is (not (sut/query-contains-insights? {})))
  (is (not (sut/query-contains-insights? {:fields "asasd"})))
  (is (not (sut/query-contains-insights? {:fields "asasd" :path "asdfff"})))
  (is (not (sut/query-contains-insights? {:fields "" :path nil})))
  (is (not (sut/query-contains-insights? {:fields nil :path nil})))
  (is (not (sut/query-contains-insights? {:fields nil :path ""})))
  (is (sut/query-contains-insights? {:fields nil :path "insights"}))
  (is (sut/query-contains-insights? {:fields "asdasdasd,insights" :path "insights"}))
  (is (sut/query-contains-insights? {:fields "asdasdasd,insights" :path "feed"}))
  (is (sut/query-contains-insights? {:fields "asdasdasd,insights" :path nil}))
  (is (sut/query-contains-insights? {:fields nil :path "insights"})))

(deftest test-query-path-feed?
  (is (not (sut/query-path-feed? {})))
  (is (not (sut/query-path-feed? {:path "ratings" :fields "feed"})))
  (is (sut/query-path-feed? {:path "feed" :fields "insights"}))
  (is (sut/query-path-feed? {:path "me/feed" :fields "insights"})))

(deftest test-query-path-posts?
  (is (not (sut/query-path-posts? {})))
  (is (not (sut/query-path-posts? {:path "ratings" :fields "feed"})))
  (is (not (sut/query-path-posts? {:path "feed" :fields "insights"})))
  (is (sut/query-path-posts? {:path "posts" :fields "insights"}))
  (is (sut/query-path-posts? {:path "me/posts" :fields "insights"}))
  (is (sut/query-path-posts? {:path "me/published_posts" :fields "insights"}))
  (is (sut/query-path-posts? {:path "published_posts" :fields "insights"})))

(deftest test-query-need-userinfo?
  (is (not (sut/query-need-userinfo? {})))
  (is (not (sut/query-need-userinfo? {:path "ratings" :fields "feed"})))
  (is (sut/query-need-userinfo? {:path "likes" :fields "insights"}))
  (is (sut/query-need-userinfo? {:path "" :fields "likes"}))
  (is (sut/query-need-userinfo? {:path "me/feed" :fields "from"})))

(defn empty-dir? [path]
  (let [file (io/file path)]
    (assert (.exists file))
    (assert (.isDirectory file))
    (-> file .list empty?)))

(deftest test-media-posted-before-error-response-query
  (let [query {:name "mediatest" :version "v2.11" :query {:path "media" :ids "123" :fields "fields" :since "now" :until "now"}}
        token "token"
        out-dir *tmpdir*]
    (println *tmpdir*)
    (with-global-fake-routes-in-isolation
      {"https://graph.facebook.com/v2.11/media?path=media&ids=123&fields=fields&since=now&until=now&access_token=token"
       (fn [req]
         media-posted-before-error-response)}
      (sut/run-nested-query token out-dir query)
      (is (empty-dir? *tmpdir*)))))

(use-fixtures :once setup-tmpdir)



(deftest test-make-run-insights-query-with-time-range
  (testing "date_preset=last_3d"
    ;; Placeholder values for unimportant parameters
    (let [token "token"
          id "id"
          version "version"
          query {}
          ;; Parameters string as per your example
          parameters-str "time_increment=1&breakdowns=product_id&date_preset=last_3d"
          ;; Atom to capture calls to the mock function
          async-insights-request-calls (atom [])
          ;; Mock function to capture calls and parameters
          mock-async-insights-request-fn (fn [token id new-parameters version query]
                                           (swap! async-insights-request-calls conj
                                                  {:token token
                                                   :id id
                                                   :parameters new-parameters
                                                   :version version
                                                   :query query})
                                           ;; Return a mock result
                                           [{:data "mock-result"}])]

      ;; Call the function under test
      (let [results (sut/make-run-inishgts-query-with-time-range
                     mock-async-insights-request-fn
                     token
                     id
                     parameters-str
                     version
                     query)
            ;; Capture the calls made to the mock function
            calls @async-insights-request-calls
            num-calls (count calls)
            ;; Compute expected dates based on current date
            date-preset "last_3d"
            days (query-parser/date-preset-to-days date-preset) ;; Should be 3 for "last_3d"
            formatter (DateTimeFormatter/ofPattern "yyyy-MM-dd")
            today (LocalDate/now)
            start-date (query-parser/get-past-date days)
            ;; Generate dates including today
            dates (map #(.format % formatter)
                       (query-parser/date-range start-date (.format  today formatter)))
            expected-time-ranges (map (fn [date]
                                        {:since date
                                         :until date})
                                      dates)]

        ;; Verify the number of calls made matches expected number of dates
        (is (= num-calls (count expected-time-ranges))
            (str "Expected " (count expected-time-ranges) " calls to async-insights-request-fn, but got " num-calls))

        ;; Parse the parameters once for use in generating expected parameters
        (let [parameters-map (query-parser/parse-parameters parameters-str)]

          ;; Verify each call was made with the correct parameters
          (doseq [[call expected-time-range] (map vector calls expected-time-ranges)]
            (let [expected-parameters (query-parser/generate-parameters-for-dates parameters-map expected-time-range)]
              (is (= (:parameters call) expected-parameters)
                  (str "Expected parameters: " expected-parameters ", but got: " (:parameters call))))))

        ;; Optionally, verify that results contain the expected data
        (is (= results (apply concat (repeat num-calls [{:data "mock-result"}])))
            "Expected results to contain the mock data repeated for each call"))))
  (testing "time_ranges=[{'since':'2024-08-10','until':'2024-08-12'}]"
    ;; Placeholder values for unimportant parameters
    (let [token "token"
          id "id"
          version "version"
          query {}
          ;; Parameters string as per your example
          parameters-str "time_increment=1&breakdowns=product_id&time_ranges=[{'since':'2024-08-10','until':'2024-08-12'}]"
          ;; Atom to capture calls to the mock function
          async-insights-request-calls (atom [])
          ;; Mock function to capture calls and parameters
          mock-async-insights-request-fn (fn [token id new-parameters version query]
                                           (swap! async-insights-request-calls conj
                                                  {:token token
                                                   :id id
                                                   :parameters new-parameters
                                                   :version version
                                                   :query query})
                                           ;; Return a mock result
                                           [{:data "mock-result"}])]

      ;; Call the function under test
      (let [results (sut/make-run-inishgts-query-with-time-range
                     mock-async-insights-request-fn
                     token
                     id
                     parameters-str
                     version
                     query)
            ;; Capture the calls made to the mock function
            calls @async-insights-request-calls
            num-calls (count calls)
            ;; Compute expected dates based on current date
            time-ranges-str "[{'since':'2024-08-10','until':'2024-08-12'}]"
            time-ranges (query-parser/parse-time-ranges time-ranges-str)
            expected-time-ranges (query-parser/expand-time-ranges time-ranges)]

        ;; Verify the number of calls made matches expected number of dates
        (is (= num-calls (count expected-time-ranges))
            (str "Expected " (count expected-time-ranges) " calls to async-insights-request-fn, but got " num-calls))

        ;; Parse the parameters once for use in generating expected parameters
        (let [parameters-map (query-parser/parse-parameters parameters-str)]

          ;; Verify each call was made with the correct parameters
          (doseq [[call expected-time-range] (map vector calls expected-time-ranges)]
            (let [expected-parameters (query-parser/generate-parameters-for-dates parameters-map expected-time-range)]
              (is (= (:parameters call) expected-parameters)
                  (str "Expected parameters: " expected-parameters ", but got: " (:parameters call))))))

        ;; Optionally, verify that results contain the expected data
        (is (= results (apply concat (repeat num-calls [{:data "mock-result"}])))
            "Expected results to contain the mock data repeated for each call")))))

================================================
File: /test/keboola/facebook/extractor/output_test.clj
================================================
(ns keboola.facebook.extractor.output-test
  (:require [clojure.test :refer :all]
            [keboola.facebook.extractor.output :as sut]))

(defn test-pk [value expected]
  (let [complete-expected (conj expected "parent_id")]
    (is (= (count value) (count complete-expected)))
    (is (= (set value) (set complete-expected)))))

(deftest test-primary-key
  (test-pk (sut/get-primary-key ["id"] "" {} false) [])
  (test-pk (sut/get-primary-key [:id] "" {} false) ["id"])
  (test-pk (sut/get-primary-key ["foo"] "" {} false) [])
  (test-pk (sut/get-primary-key [:foo] "" {} false) [])
  (test-pk (sut/get-primary-key [:id :key] "" {} false) ["id"])
  (test-pk (sut/get-primary-key [:id :key1 :foo :key2] "insights" {} false) ["id" "key1" "key2"])
  (test-pk (sut/get-primary-key [:id :placement :device_platform :foo :key2 :age :ad_id :adset_id] "insights" {} false) ["id" "placement" "key2" "age" "device_platform"])
  (test-pk (sut/get-primary-key [:id :placement :device_platform :foo :key2 :age :ad_id :adset_id :date_start :date_stop] "insights" {} true) ["id" "placement" "key2" "age" "device_platform" "date_stop" "date_start" "ad_id" "adset_id"])
  (test-pk (sut/get-primary-key [:id :placement :foo :key2 :age :region :country :gender] "asdasfoo" {} false) ["id" "key2"])
  (test-pk (sut/get-primary-key [:id :key1 :foo :key2] "" {} false) ["id" "key1" "key2"])
  (test-pk (sut/get-primary-key [:id :key1 :foo :key2] "" {:path ""} false) ["id" "key1" "key2"])
  (test-pk (sut/get-primary-key [:id :key1 :foo :key2 :ad_id] "" {:path ""} false) ["id" "key1" "key2" "ad_id"])
  (test-pk (sut/get-primary-key [:id :key1 :foo :key2 :ad_id :adset_id] "" {:path ""} false) ["id" "key1" "key2" "ad_id"])
  (test-pk (sut/get-primary-key [:id :key1 :foo :key2 :adset_id] "" {:path ""} false) ["id" "key1" "key2" "adset_id"])
  (test-pk (sut/get-primary-key [:id :key1 :foo :key2 :ad_id] "" {:path "ads"} false) ["id" "key1" "key2"])
  (test-pk (sut/get-primary-key [:id :key1 :foo :key2 :reviewer_id] "ratings" {} false) ["id" "key1" "key2" "reviewer_id"]))


